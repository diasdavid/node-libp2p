(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2p = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2p=(()=>{var p0=Object.defineProperty;var q_=t=>p0(t,"__esModule",{value:!0});var qi=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Pe=(t,e)=>()=>(t&&(e=t(t=0)),e);var S=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),pt=(t,e)=>{q_(t);for(var r in e)p0(t,r,{get:e[r],enumerable:!0})};var Bu=S((e5,y0)=>{var Ui=1e3,Mi=Ui*60,Fi=Mi*60,Xn=Fi*24,U_=Xn*7,M_=Xn*365.25;y0.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return F_(t);if(r==="number"&&isFinite(t))return e.long?V_(t):K_(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function F_(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*M_;case"weeks":case"week":case"w":return r*U_;case"days":case"day":case"d":return r*Xn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Fi;case"minutes":case"minute":case"mins":case"min":case"m":return r*Mi;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ui;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function K_(t){var e=Math.abs(t);return e>=Xn?Math.round(t/Xn)+"d":e>=Fi?Math.round(t/Fi)+"h":e>=Mi?Math.round(t/Mi)+"m":e>=Ui?Math.round(t/Ui)+"s":t+"ms"}function V_(t){var e=Math.abs(t);return e>=Xn?Sa(t,e,Xn,"day"):e>=Fi?Sa(t,e,Fi,"hour"):e>=Mi?Sa(t,e,Mi,"minute"):e>=Ui?Sa(t,e,Ui,"second"):t+" ms"}function Sa(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var m0=S((t5,g0)=>{function j_(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=Bu(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let f=0;for(let d=0;d<l.length;d++)f=(f<<5)-f+l.charCodeAt(d),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(l){let f,d=null,p,h;function g(...v){if(!g.enabled)return;let _=g,B=Number(new Date),L=B-(f||B);_.diff=L,_.prev=f,_.curr=B,f=B,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let z=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(k,te)=>{if(k==="%%")return"%";z++;let se=r.formatters[te];if(typeof se=="function"){let j=v[z];k=se.call(_,j),v.splice(z,1),z--}return k}),r.formatArgs.call(_,v),(_.log||r.log).apply(_,v)}return g.namespace=l,g.useColors=r.useColors(),g.color=r.selectColor(l),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==r.namespaces&&(p=r.namespaces,h=r.enabled(l)),h),set:v=>{d=v}}),typeof r.init=="function"&&r.init(g),g}function n(l,f){let d=r(this.namespace+(typeof f=="undefined"?":":f)+l);return d.log=this.log,d}function i(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,d=(typeof l=="string"?l:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)!d[f]||(l=d[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.substr(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let f,d;for(f=0,d=r.skips.length;f<d;f++)if(r.skips[f].test(l))return!1;for(f=0,d=r.names.length;f<d;f++)if(r.names[f].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}g0.exports=j_});var Ne=S((zt,xa)=>{zt.formatArgs=H_;zt.save=z_;zt.load=G_;zt.useColors=$_;zt.storage=Y_();zt.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();zt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function $_(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function H_(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+xa.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}zt.log=console.debug||console.log||(()=>{});function z_(t){try{t?zt.storage.setItem("debug",t):zt.storage.removeItem("debug")}catch(e){}}function G_(){let t;try{t=zt.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function Y_(){try{return localStorage}catch(t){}}xa.exports=m0()(zt);var{formatters:W_}=xa.exports;W_.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Jt=S((r5,Pu)=>{"use strict";var Ki=typeof Reflect=="object"?Reflect:null,v0=Ki&&typeof Ki.apply=="function"?Ki.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},_a;Ki&&typeof Ki.ownKeys=="function"?_a=Ki.ownKeys:Object.getOwnPropertySymbols?_a=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:_a=function(e){return Object.getOwnPropertyNames(e)};function Q_(t){console&&console.warn&&console.warn(t)}var b0=Number.isNaN||function(e){return e!==e};function Ue(){Ue.init.call(this)}Pu.exports=Ue;Pu.exports.once=eA;Ue.EventEmitter=Ue;Ue.prototype._events=void 0;Ue.prototype._eventsCount=0;Ue.prototype._maxListeners=void 0;var E0=10;function Aa(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ue,"defaultMaxListeners",{enumerable:!0,get:function(){return E0},set:function(t){if(typeof t!="number"||t<0||b0(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");E0=t}});Ue.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ue.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||b0(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function w0(t){return t._maxListeners===void 0?Ue.defaultMaxListeners:t._maxListeners}Ue.prototype.getMaxListeners=function(){return w0(this)};Ue.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")v0(c,this,r);else for(var u=c.length,l=C0(c,u),n=0;n<u;++n)v0(l[n],this,r);return!0};function S0(t,e,r,n){var i,s,o;if(Aa(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=w0(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Q_(a)}return t}Ue.prototype.addListener=function(e,r){return S0(this,e,r,!1)};Ue.prototype.on=Ue.prototype.addListener;Ue.prototype.prependListener=function(e,r){return S0(this,e,r,!0)};function X_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function x0(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=X_.bind(n);return i.listener=r,n.wrapFn=i,i}Ue.prototype.once=function(e,r){return Aa(r),this.on(e,x0(this,e,r)),this};Ue.prototype.prependOnceListener=function(e,r){return Aa(r),this.prependListener(e,x0(this,e,r)),this};Ue.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Aa(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Z_(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Ue.prototype.off=Ue.prototype.removeListener;Ue.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function _0(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?J_(i):C0(i,i.length)}Ue.prototype.listeners=function(e){return _0(this,e,!0)};Ue.prototype.rawListeners=function(e){return _0(this,e,!1)};Ue.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):A0.call(t,e)};Ue.prototype.listenerCount=A0;function A0(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ue.prototype.eventNames=function(){return this._eventsCount>0?_a(this._events):[]};function C0(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Z_(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function J_(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function eA(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}I0(t,e,s,{once:!0}),e!=="error"&&tA(t,i,{once:!0})})}function tA(t,e,r){typeof t.on=="function"&&I0(t,"error",e,r)}function I0(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var he=S((n5,R0)=>{"use strict";function T0(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function rA(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return T0(t,r)}catch(n){r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),T0(new i,r)}}R0.exports=rA});function P0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=oA;)e[r++]=t&255|B0,t/=128;for(;t&sA;)e[r++]=t&255|B0,t>>>=7;return e[r]=t|0,P0.bytes=r-n+1,e}function Nu(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o)throw Nu.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&N0)<<n:(s&N0)*Math.pow(2,n),n+=7}while(s>=cA);return Nu.bytes=i-e,r}var nA,B0,iA,sA,oA,aA,cA,N0,uA,lA,fA,dA,hA,pA,yA,gA,mA,vA,bA,EA,ao,D0=Pe(()=>{nA=P0,B0=128,iA=127,sA=~iA,oA=Math.pow(2,31);aA=Nu,cA=128,N0=127;uA=Math.pow(2,7),lA=Math.pow(2,14),fA=Math.pow(2,21),dA=Math.pow(2,28),hA=Math.pow(2,35),pA=Math.pow(2,42),yA=Math.pow(2,49),gA=Math.pow(2,56),mA=Math.pow(2,63),vA=function(t){return t<uA?1:t<lA?2:t<fA?3:t<dA?4:t<hA?5:t<pA?6:t<yA?7:t<gA?8:t<mA?9:10},bA={encode:nA,decode:aA,encodingLength:vA},EA=bA,ao=EA});var co,Vi,ji,Ca=Pe(()=>{D0();co=t=>[ao.decode(t),ao.decode.bytes],Vi=(t,e,r=0)=>(ao.encode(t,e,r),e),ji=t=>ao.encodingLength(t)});var o5,L0,Qr,k0,q0,yn=Pe(()=>{o5=new Uint8Array(0),L0=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Qr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},k0=t=>new TextEncoder().encode(t),q0=t=>new TextDecoder().decode(t)});var lo={};pt(lo,{Digest:()=>$i,create:()=>uo,decode:()=>Du,equals:()=>Ou});var uo,Du,Ou,$i,Hi=Pe(()=>{yn();Ca();uo=(t,e)=>{let r=e.byteLength,n=ji(t),i=n+ji(r),s=new Uint8Array(i+r);return Vi(t,s,0),Vi(r,s,n),s.set(e,i),new $i(t,r,e,s)},Du=t=>{let e=Qr(t),[r,n]=co(e),[i,s]=co(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new $i(r,i,o,e)},Ou=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&L0(t.bytes,e.bytes),$i=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});function wA(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,v=0,_=0,B=h.length;_!==B&&h[_]===0;)_++,g++;for(var L=(B-_)*l+1>>>0,z=new Uint8Array(L);_!==B;){for(var q=h[_],k=0,te=L-1;(q!==0||k<v)&&te!==-1;te--,k++)q+=256*z[te]>>>0,z[te]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");v=k,_++}for(var se=L-v;se!==L&&z[se]===0;)se++;for(var j=c.repeat(g);se<L;++se)j+=t.charAt(z[se]);return j}function d(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var v=0,_=0;h[g]===c;)v++,g++;for(var B=(h.length-g)*u+1>>>0,L=new Uint8Array(B);h[g];){var z=r[h.charCodeAt(g)];if(z===255)return;for(var q=0,k=B-1;(z!==0||q<_)&&k!==-1;k--,q++)z+=a*L[k]>>>0,L[k]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");_=q,g++}if(h[g]!==" "){for(var te=B-_;te!==B&&L[te]===0;)te++;for(var se=new Uint8Array(v+(B-te)),j=v;te!==B;)se[j++]=L[te++];return se}}}function p(h){var g=d(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:d,decode:p}}var SA,xA,M0,F0=Pe(()=>{SA=wA,xA=SA,M0=xA});var K0,V0,j0,$0,H0,Ia,gn,_A,AA,nt,Ar=Pe(()=>{F0();yn();K0=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},V0=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return $0(this,e)}},j0=class{constructor(e){this.decoders=e}or(e){return $0(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},$0=(t,e)=>new j0({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),H0=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new K0(e,r,n),this.decoder=new V0(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ia=({name:t,prefix:e,encode:r,decode:n})=>new H0(t,e,r,n),gn=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=M0(r,e);return Ia({prefix:t,name:e,encode:n,decode:s=>Qr(i(s))})},_A=(t,e,r,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},AA=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},nt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ia({prefix:e,name:t,encode(i){return AA(i,n,r)},decode(i){return _A(i,n,r,t)}})});var mn={};pt(mn,{base58btc:()=>Cr,base58flickr:()=>CA});var Cr,CA,vn=Pe(()=>{Ar();Cr=gn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),CA=gn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Zn={};pt(Zn,{base32:()=>zi,base32hex:()=>BA,base32hexpad:()=>NA,base32hexpadupper:()=>DA,base32hexupper:()=>PA,base32pad:()=>TA,base32padupper:()=>RA,base32upper:()=>IA,base32z:()=>OA});var zi,IA,TA,RA,BA,PA,NA,DA,OA,Jn=Pe(()=>{Ar();zi=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),IA=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),TA=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),RA=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),BA=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),PA=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),NA=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),DA=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),OA=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var ho={};pt(ho,{CID:()=>lt});var lt,LA,kA,qA,fo,UA,z0,G0,Ta,Ra,MA,FA,KA,Gi=Pe(()=>{Ca();Hi();vn();Jn();yn();lt=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Ra,byteLength:Ra,code:Ta,version:Ta,multihash:Ta,bytes:Ta,_baseCache:Ra,asCID:Ra})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==fo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==UA)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return lt.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=uo(e,r);return lt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ou(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return kA(r,i,e||Cr.encoder);default:return qA(r,i,e||zi.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return FA(/^0\.0/,KA),!!(e&&(e[G0]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof lt)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new lt(r,n,i,s||z0(r,n,i.bytes))}else if(e!=null&&e[G0]===!0){let{version:r,multihash:n,code:i}=e,s=Du(n);return lt.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==fo)throw new Error(`Version 0 CID must use dag-pb (code: ${fo}) block encoding`);return new lt(e,r,n,n.bytes)}case 1:{let i=z0(e,r,n.bytes);return new lt(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return lt.create(0,fo,e)}static createV1(e,r){return lt.create(1,e,r)}static decode(e){let[r,n]=lt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=lt.inspectBytes(e),n=r.size-r.multihashSize,i=Qr(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new $i(r.multihashCode,r.digestSize,s,i);return[r.version===0?lt.createV0(o):lt.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[f,d]=co(e.subarray(r));return r+=d,f},i=n(),s=fo;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),u=r+c,l=u-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,i]=LA(e,r),s=lt.decode(i);return s._baseCache.set(n,e),s}},LA=(t,e)=>{switch(t[0]){case"Q":{let r=e||Cr;return[Cr.prefix,r.decode(`${Cr.prefix}${t}`)]}case Cr.prefix:{let r=e||Cr;return[Cr.prefix,r.decode(t)]}case zi.prefix:{let r=e||zi;return[zi.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},kA=(t,e,r)=>{let{prefix:n}=r;if(n!==Cr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},qA=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},fo=112,UA=18,z0=(t,e,r)=>{let n=ji(t),i=n+ji(e),s=new Uint8Array(i+r.byteLength);return Vi(t,s,0),Vi(e,s,n),s.set(r,i),s},G0=Symbol.for("@ipld/js-cid/CID"),Ta={writable:!1,configurable:!1,enumerable:!0},Ra={writable:!1,enumerable:!1,configurable:!1},MA="0.0.0-dev",FA=(t,e)=>{if(t.test(MA))console.warn(e);else throw new Error(e)},KA=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Ba={};pt(Ba,{base36:()=>VA,base36upper:()=>jA});var VA,jA,Lu=Pe(()=>{Ar();VA=gn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jA=gn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Yi={};pt(Yi,{base64:()=>$A,base64pad:()=>HA,base64url:()=>zA,base64urlpad:()=>GA});var $A,HA,zA,GA,po=Pe(()=>{Ar();$A=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),HA=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zA=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),GA=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Pa={};pt(Pa,{base16:()=>YA,base16upper:()=>WA});var YA,WA,ku=Pe(()=>{Ar();YA=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),WA=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var W0=S((x5,Y0)=>{"use strict";Y0.exports=QA;function QA(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(l){if(s)if(s=!1,l)c(l);else{for(var f=new Array(arguments.length-1),d=0;d<f.length;)f[d++]=arguments[d];a.apply(null,f)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var J0=S(Z0=>{"use strict";var Na=Z0;Na.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Wi=new Array(64),Q0=new Array(123);for(yr=0;yr<64;)Q0[Wi[yr]=yr<26?yr+65:yr<52?yr+71:yr<62?yr-4:yr-59|43]=yr++;var yr;Na.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var u=e[r++];switch(a){case 0:s[o++]=Wi[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=Wi[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=Wi[c|u>>6],s[o++]=Wi[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Wi[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var X0="invalid encoding";Na.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=Q0[c])===void 0)throw Error(X0);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(X0);return n-i};Na.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var th=S((A5,eh)=>{"use strict";eh.exports=Da;function Da(){this._listeners={}}Da.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Da.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Da.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var ch=S((C5,ah)=>{"use strict";ah.exports=rh(rh);function rh(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,nh),t.writeFloatBE=e.bind(null,ih);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,sh),t.readFloatBE=r.bind(null,oh)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+s);else{var f=Math.floor(Math.log(o)/Math.LN2);f===1024&&(f=1023),l=o*Math.pow(2,-f),n(l*4503599627370496>>>0,a,c+i),n((u<<31|f+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,nh,0,4),t.writeDoubleBE=e.bind(null,ih,4,0);function r(n,i,s,o,a){var c=n(o,a+i),u=n(o,a+s),l=(u>>31)*2+1,f=u>>>20&2047,d=4294967296*(u&1048575)+c;return f===2047?d?NaN:l*(1/0):f===0?l*5e-324*d:l*Math.pow(2,f-1075)*(d+4503599627370496)}t.readDoubleLE=r.bind(null,sh,0,4),t.readDoubleBE=r.bind(null,oh,4,0)}(),t}function nh(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function ih(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function sh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function oh(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var uh=S((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var fh=S(lh=>{"use strict";var qu=lh;qu.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(e.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};qu.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};qu.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var hh=S((T5,dh)=>{"use strict";dh.exports=XA;function XA(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return t(c);o+c>n&&(s=t(n),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var yh=S((R5,ph)=>{"use strict";ph.exports=yt;var yo=En();function yt(t,e){this.lo=t>>>0,this.hi=e>>>0}var ei=yt.zero=new yt(0,0);ei.toNumber=function(){return 0};ei.zzEncode=ei.zzDecode=function(){return this};ei.length=function(){return 1};var ZA=yt.zeroHash="\0\0\0\0\0\0\0\0";yt.fromNumber=function(e){if(e===0)return ei;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new yt(n,i)};yt.from=function(e){if(typeof e=="number")return yt.fromNumber(e);if(yo.isString(e))if(yo.Long)e=yo.Long.fromString(e);else return yt.fromNumber(parseInt(e,10));return e.low||e.high?new yt(e.low>>>0,e.high>>>0):ei};yt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};yt.prototype.toLong=function(e){return yo.Long?new yo.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var bn=String.prototype.charCodeAt;yt.fromHash=function(e){return e===ZA?ei:new yt((bn.call(e,0)|bn.call(e,1)<<8|bn.call(e,2)<<16|bn.call(e,3)<<24)>>>0,(bn.call(e,4)|bn.call(e,5)<<8|bn.call(e,6)<<16|bn.call(e,7)<<24)>>>0)};yt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};yt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};yt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};yt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var En=S(Uu=>{"use strict";var oe=Uu;oe.asPromise=W0();oe.base64=J0();oe.EventEmitter=th();oe.float=ch();oe.inquire=uh();oe.utf8=fh();oe.pool=hh();oe.LongBits=yh();oe.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);oe.global=oe.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Uu;oe.emptyArray=Object.freeze?Object.freeze([]):[];oe.emptyObject=Object.freeze?Object.freeze({}):{};oe.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};oe.isString=function(e){return typeof e=="string"||e instanceof String};oe.isObject=function(e){return e&&typeof e=="object"};oe.isset=oe.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};oe.Buffer=function(){try{var t=oe.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();oe._Buffer_from=null;oe._Buffer_allocUnsafe=null;oe.newBuffer=function(e){return typeof e=="number"?oe.Buffer?oe._Buffer_allocUnsafe(e):new oe.Array(e):oe.Buffer?oe._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};oe.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;oe.Long=oe.global.dcodeIO&&oe.global.dcodeIO.Long||oe.global.Long||oe.inquire("long");oe.key2Re=/^true|false|0|1$/;oe.key32Re=/^-?(?:0|[1-9][0-9]*)$/;oe.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;oe.longToHash=function(e){return e?oe.LongBits.from(e).toHash():oe.LongBits.zeroHash};oe.longFromHash=function(e,r){var n=oe.LongBits.fromHash(e);return oe.Long?oe.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function gh(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}oe.merge=gh;oe.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function mh(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&gh(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}oe.newError=mh;oe.ProtocolError=mh("ProtocolError");oe.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};oe.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};oe.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};oe._configure=function(){var t=oe.Buffer;if(!t){oe._Buffer_from=oe._Buffer_allocUnsafe=null;return}oe._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},oe._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Hu=S((P5,wh)=>{"use strict";wh.exports=Ie;var er=En(),Mu,Oa=er.LongBits,vh=er.base64,bh=er.utf8;function go(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Fu(){}function JA(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Ie(){this.len=0,this.head=new go(Fu,0,0),this.tail=this.head,this.states=null}var Eh=function(){return er.Buffer?function(){return(Ie.create=function(){return new Mu})()}:function(){return new Ie}};Ie.create=Eh();Ie.alloc=function(e){return new er.Array(e)};er.Array!==Array&&(Ie.alloc=er.pool(Ie.alloc,er.Array.prototype.subarray));Ie.prototype._push=function(e,r,n){return this.tail=this.tail.next=new go(e,r,n),this.len+=r,this};function Ku(t,e,r){e[r]=t&255}function eC(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Vu(t,e){this.len=t,this.next=void 0,this.val=e}Vu.prototype=Object.create(go.prototype);Vu.prototype.fn=eC;Ie.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Vu((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ie.prototype.int32=function(e){return e<0?this._push(ju,10,Oa.fromNumber(e)):this.uint32(e)};Ie.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function ju(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Ie.prototype.uint64=function(e){var r=Oa.from(e);return this._push(ju,r.length(),r)};Ie.prototype.int64=Ie.prototype.uint64;Ie.prototype.sint64=function(e){var r=Oa.from(e).zzEncode();return this._push(ju,r.length(),r)};Ie.prototype.bool=function(e){return this._push(Ku,1,e?1:0)};function $u(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Ie.prototype.fixed32=function(e){return this._push($u,4,e>>>0)};Ie.prototype.sfixed32=Ie.prototype.fixed32;Ie.prototype.fixed64=function(e){var r=Oa.from(e);return this._push($u,4,r.lo)._push($u,4,r.hi)};Ie.prototype.sfixed64=Ie.prototype.fixed64;Ie.prototype.float=function(e){return this._push(er.float.writeFloatLE,4,e)};Ie.prototype.double=function(e){return this._push(er.float.writeDoubleLE,8,e)};var tC=er.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};Ie.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ku,1,0);if(er.isString(e)){var n=Ie.alloc(r=vh.length(e));vh.decode(e,n,0),e=n}return this.uint32(r)._push(tC,r,e)};Ie.prototype.string=function(e){var r=bh.length(e);return r?this.uint32(r)._push(bh.write,r,e):this._push(Ku,1,0)};Ie.prototype.fork=function(){return this.states=new JA(this),this.head=this.tail=new go(Fu,0,0),this.len=0,this};Ie.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new go(Fu,0,0),this.len=0),this};Ie.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};Ie.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};Ie._configure=function(t){Mu=t,Ie.create=Eh(),Mu._configure()}});var _h=S((N5,xh)=>{"use strict";xh.exports=Ir;var Sh=Hu();(Ir.prototype=Object.create(Sh.prototype)).constructor=Ir;var wn=En();function Ir(){Sh.call(this)}Ir._configure=function(){Ir.alloc=wn._Buffer_allocUnsafe,Ir.writeBytesBuffer=wn.Buffer&&wn.Buffer.prototype instanceof Uint8Array&&wn.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Ir.prototype.bytes=function(e){wn.isString(e)&&(e=wn._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Ir.writeBytesBuffer,r,e),this};function rC(t,e,r){t.length<40?wn.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Ir.prototype.string=function(e){var r=wn.Buffer.byteLength(e);return this.uint32(r),r&&this._push(rC,r,e),this};Ir._configure()});var Yu=S((D5,Rh)=>{"use strict";Rh.exports=at;var Tr=En(),zu,Ah=Tr.LongBits,nC=Tr.utf8;function gr(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function at(t){this.buf=t,this.pos=0,this.len=t.length}var Ch=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new at(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new at(e);throw Error("illegal buffer")},Ih=function(){return Tr.Buffer?function(r){return(at.create=function(i){return Tr.Buffer.isBuffer(i)?new zu(i):Ch(i)})(r)}:Ch};at.create=Ih();at.prototype._slice=Tr.Array.prototype.subarray||Tr.Array.prototype.slice;at.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,gr(this,10);return e}}();at.prototype.int32=function(){return this.uint32()|0};at.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Gu(){var t=new Ah(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw gr(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw gr(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}at.prototype.bool=function(){return this.uint32()!==0};function La(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}at.prototype.fixed32=function(){if(this.pos+4>this.len)throw gr(this,4);return La(this.buf,this.pos+=4)};at.prototype.sfixed32=function(){if(this.pos+4>this.len)throw gr(this,4);return La(this.buf,this.pos+=4)|0};function Th(){if(this.pos+8>this.len)throw gr(this,8);return new Ah(La(this.buf,this.pos+=4),La(this.buf,this.pos+=4))}at.prototype.float=function(){if(this.pos+4>this.len)throw gr(this,4);var e=Tr.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};at.prototype.double=function(){if(this.pos+8>this.len)throw gr(this,4);var e=Tr.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};at.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw gr(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};at.prototype.string=function(){var e=this.bytes();return nC.read(e,0,e.length)};at.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw gr(this,e);this.pos+=e}else do if(this.pos>=this.len)throw gr(this);while(this.buf[this.pos++]&128);return this};at.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};at._configure=function(t){zu=t,at.create=Ih(),zu._configure();var e=Tr.Long?"toLong":"toNumber";Tr.merge(at.prototype,{int64:function(){return Gu.call(this)[e](!1)},uint64:function(){return Gu.call(this)[e](!0)},sint64:function(){return Gu.call(this).zzDecode()[e](!1)},fixed64:function(){return Th.call(this)[e](!0)},sfixed64:function(){return Th.call(this)[e](!1)}})}});var Dh=S((O5,Nh)=>{"use strict";Nh.exports=ti;var Bh=Yu();(ti.prototype=Object.create(Bh.prototype)).constructor=ti;var Ph=En();function ti(t){Bh.call(this,t)}ti._configure=function(){Ph.Buffer&&(ti.prototype._slice=Ph.Buffer.prototype.slice)};ti.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};ti._configure()});var Lh=S((L5,Oh)=>{"use strict";Oh.exports=mo;var Wu=En();(mo.prototype=Object.create(Wu.EventEmitter.prototype)).constructor=mo;function mo(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Wu.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}mo.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Wu.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};mo.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var qh=S(kh=>{"use strict";var iC=kh;iC.Service=Lh()});var Mh=S((q5,Uh)=>{"use strict";Uh.exports={}});var Vh=S(Kh=>{"use strict";var Ft=Kh;Ft.build="minimal";Ft.Writer=Hu();Ft.BufferWriter=_h();Ft.Reader=Yu();Ft.BufferReader=Dh();Ft.util=En();Ft.rpc=qh();Ft.roots=Mh();Ft.configure=Fh;function Fh(){Ft.util._configure(),Ft.Writer._configure(Ft.BufferWriter),Ft.Reader._configure(Ft.BufferReader)}Fh()});var Xr=S((M5,jh)=>{"use strict";jh.exports=Vh()});var qa=S((F5,Hh)=>{"use strict";var ri=Xr(),ka=ri.Reader,$h=ri.Writer,_t=ri.util,tr=ri.roots["libp2p-crypto-keys"]||(ri.roots["libp2p-crypto-keys"]={});tr.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();tr.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=_t.newBuffer([]),t.encode=function(r,n){return n||(n=$h.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof ka||(r=ka.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new tr.PublicKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw _t.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw _t.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof tr.PublicKey)return r;var n=new tr.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?_t.base64.decode(r.Data,n.Data=_t.newBuffer(_t.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=_t.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?tr.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?_t.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ri.util.toJSONOptions)},t}();tr.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=_t.newBuffer([]),t.encode=function(r,n){return n||(n=$h.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof ka||(r=ka.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new tr.PrivateKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw _t.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw _t.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof tr.PrivateKey)return r;var n=new tr.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?_t.base64.decode(r.Data,n.Data=_t.newBuffer(_t.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=_t.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?tr.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?_t.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ri.util.toJSONOptions)},t}();Hh.exports=tr});var Ee=S((K5,zh)=>{zh.exports={options:{usePureJavaScript:!1}}});var Wh=S((V5,Yh)=>{var Qu={};Yh.exports=Qu;var Gh={};Qu.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=sC(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,u=t[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join(`\r
`)}return n};Qu.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Gh[e];if(!r){r=Gh[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*i,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function sC(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Ke=S((j5,Jh)=>{var Qh=Ee(),Xh=Wh(),R=Jh.exports=Qh.util=Qh.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){R.nextTick=process.nextTick,typeof setImmediate=="function"?R.setImmediate=setImmediate:R.setImmediate=R.nextTick;return}if(typeof setImmediate=="function"){R.setImmediate=function(){return setImmediate.apply(void 0,arguments)},R.nextTick=function(a){return setImmediate(a)};return}if(R.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,t="forge.setImmediate",e=[];R.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=R.setImmediate;R.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}R.nextTick=R.setImmediate})();R.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;R.globalScope=function(){return R.isNodejs?globalThis:typeof self=="undefined"?window:self}();R.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};R.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};R.isArrayBufferView=function(t){return t&&R.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function vo(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}R.ByteBuffer=Xu;function Xu(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(R.isArrayBuffer(t)||R.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(n){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Xu||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}R.ByteStringBuffer=Xu;var oC=4096;R.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>oC&&(this.data.substr(0,1),this._constructedStringLength=0)};R.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};R.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};R.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};R.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};R.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};R.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(R.encodeUtf8(t))};R.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};R.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};R.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};R.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};R.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};R.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};R.ByteStringBuffer.prototype.putInt=function(t,e){vo(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};R.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};R.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};R.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};R.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};R.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};R.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};R.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};R.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};R.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};R.ByteStringBuffer.prototype.getInt=function(t){vo(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};R.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};R.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};R.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};R.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};R.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};R.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};R.ByteStringBuffer.prototype.copy=function(){var t=R.createBuffer(this.data);return t.read=this.read,t};R.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};R.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};R.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};R.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};R.ByteStringBuffer.prototype.toString=function(){return R.decodeUtf8(this.bytes())};function aC(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=R.isArrayBuffer(t),n=R.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}R.DataBuffer=aC;R.DataBuffer.prototype.length=function(){return this.write-this.read};R.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};R.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};R.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};R.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};R.DataBuffer.prototype.putBytes=function(t,e){if(R.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(R.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof R.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&R.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof R.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=R.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=R.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};R.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};R.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};R.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};R.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};R.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};R.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};R.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};R.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};R.DataBuffer.prototype.putInt=function(t,e){vo(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};R.DataBuffer.prototype.putSignedInt=function(t,e){return vo(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};R.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};R.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};R.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};R.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};R.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};R.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};R.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};R.DataBuffer.prototype.getInt=function(t){vo(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};R.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};R.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};R.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};R.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};R.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};R.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};R.DataBuffer.prototype.copy=function(){return new R.DataBuffer(this)};R.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};R.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};R.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};R.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};R.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return R.binary.raw.encode(e);if(t==="hex")return R.binary.hex.encode(e);if(t==="base64")return R.binary.base64.encode(e);if(t==="utf8")return R.text.utf8.decode(e);if(t==="utf16")return R.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};R.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=R.encodeUtf8(t)),new R.ByteBuffer(t)};R.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};R.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};R.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};R.bytesToHex=function(t){return R.createBuffer(t).toHex()};R.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Sn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",xn=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Zh="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";R.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=Sn.charAt(i>>2),r+=Sn.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Sn.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Sn.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};R.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=xn[t.charCodeAt(o++)-43],n=xn[t.charCodeAt(o++)-43],i=xn[t.charCodeAt(o++)-43],s=xn[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};R.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};R.decodeUtf8=function(t){return decodeURIComponent(escape(t))};R.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Xh.encode,decode:Xh.decode}};R.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};R.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};R.binary.hex.encode=R.bytesToHex;R.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};R.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=Sn.charAt(i>>2),r+=Sn.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Sn.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":Sn.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};R.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,u=r;c<t.length;)i=xn[t.charCodeAt(c++)-43],s=xn[t.charCodeAt(c++)-43],o=xn[t.charCodeAt(c++)-43],a=xn[t.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};R.binary.base58.encode=function(t,e){return R.binary.baseN.encode(t,Zh,e)};R.binary.base58.decode=function(t,e){return R.binary.baseN.decode(t,Zh,e)};R.text={utf8:{},utf16:{}};R.text.utf8.encode=function(t,e,r){t=R.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};R.text.utf8.decode=function(t){return R.decodeUtf8(String.fromCharCode.apply(null,t))};R.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};R.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};R.deflate=function(t,e,r){if(e=R.decode64(t.deflate(R.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};R.inflate=function(t,e,r){var n=t.inflate(R.encode64(e)).rval;return n===null?null:R.decode64(n)};var Zu=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=R.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Ju=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(R.decode64(r))),r},cC=function(t,e,r,n){var i=Ju(t,e);i===null&&(i={}),i[r]=n,Zu(t,e,i)},uC=function(t,e,r){var n=Ju(t,e);return n!==null&&(n=r in n?n[r]:null),n},lC=function(t,e,r){var n=Ju(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Zu(t,e,n)}},fC=function(t,e){Zu(t,e,null)},Ua=function(t,e,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};R.setItem=function(t,e,r,n,i){Ua(cC,arguments,i)};R.getItem=function(t,e,r,n){return Ua(uC,arguments,n)};R.removeItem=function(t,e,r,n){Ua(lC,arguments,n)};R.clearItems=function(t,e,r){Ua(fC,arguments,r)};R.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),n=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(n.port!==80&&n.scheme==="http"||n.port!==443&&n.scheme==="https")&&(n.fullHost+=":"+n.port):n.scheme==="http"?n.port=80:n.scheme==="https"&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var Ma=null;R.getQueryVariables=function(t){var e=function(n){for(var i={},s=n.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,u;a>0?(c=s[o].substring(0,a),u=s[o].substring(a+1)):(c=s[o],u=null),c in i||(i[c]=[]),!(c in Object.prototype)&&u!==null&&i[c].push(unescape(u))}return i},r;return typeof t=="undefined"?(Ma===null&&(typeof window!="undefined"&&window.location&&window.location.search?Ma=e(window.location.search.substring(1)):Ma={}),r=Ma):r=e(t),r};R.parseFragment=function(t){var e=t,r="",n=t.indexOf("?");n>0&&(e=t.substring(0,n),r=t.substring(n+1));var i=e.split("/");i.length>0&&i[0]===""&&i.shift();var s=r===""?{}:R.getQueryVariables(r);return{pathString:e,queryString:r,path:i,query:s}};R.makeRequest=function(t){var e=R.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(n){return typeof n=="undefined"?e.path:e.path[n]},getQuery:function(n,i){var s;return typeof n=="undefined"?s=e.query:(s=e.query[n],s&&typeof i!="undefined"&&(s=s[i])),s},getQueryLast:function(n,i){var s,o=r.getQuery(n);return o?s=o[o.length-1]:s=i,s}};return r};R.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var n=jQuery.param(e||{});return r=r||"",t+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")};R.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};R.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};R.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};R.formatSize=function(t){return t>=1073741824?t=R.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=R.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=R.formatNumber(t/1024,0)+" KiB":t=R.formatNumber(t,0)+" bytes",t};R.bytesFromIP=function(t){return t.indexOf(".")!==-1?R.bytesFromIPv4(t):t.indexOf(":")!==-1?R.bytesFromIPv6(t):null};R.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=R.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};R.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=R.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=R.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};R.bytesToIP=function(t){return t.length===4?R.bytesToIPv4(t):t.length===16?R.bytesToIPv6(t):null};R.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};R.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=R.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};R.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in R&&!t.update)return e(null,R.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return R.cores=navigator.hardwareConcurrency,e(null,R.cores);if(typeof Worker=="undefined")return R.cores=1,e(null,R.cores);if(typeof Blob=="undefined")return R.cores=2,e(null,R.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,f){return l+f},0)/o.length);return R.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,R.cores)}i(c,function(l,f){o.push(s(c,f)),n(o,a-1,c)})}function i(o,a){for(var c=[],u=[],l=0;l<o;++l){var f=new Worker(r);f.addEventListener("message",function(d){if(u.push(d.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(f)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],f=c[u]=[],d=0;d<o;++d)if(u!==d){var p=a[d];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&f.push(d)}return c.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var Qi=S(($5,ep)=>{var bo=Ee();bo.pki=bo.pki||{};var el=ep.exports=bo.pki.oids=bo.oids=bo.oids||{};function H(t,e){el[t]=e,el[e]=t}function De(t,e){el[t]=e}H("1.2.840.113549.1.1.1","rsaEncryption");H("1.2.840.113549.1.1.4","md5WithRSAEncryption");H("1.2.840.113549.1.1.5","sha1WithRSAEncryption");H("1.2.840.113549.1.1.7","RSAES-OAEP");H("1.2.840.113549.1.1.8","mgf1");H("1.2.840.113549.1.1.9","pSpecified");H("1.2.840.113549.1.1.10","RSASSA-PSS");H("1.2.840.113549.1.1.11","sha256WithRSAEncryption");H("1.2.840.113549.1.1.12","sha384WithRSAEncryption");H("1.2.840.113549.1.1.13","sha512WithRSAEncryption");H("1.3.101.112","EdDSA25519");H("1.2.840.10040.4.3","dsa-with-sha1");H("1.3.14.3.2.7","desCBC");H("1.3.14.3.2.26","sha1");H("2.16.840.1.101.3.4.2.1","sha256");H("2.16.840.1.101.3.4.2.2","sha384");H("2.16.840.1.101.3.4.2.3","sha512");H("1.2.840.113549.2.5","md5");H("1.2.840.113549.1.7.1","data");H("1.2.840.113549.1.7.2","signedData");H("1.2.840.113549.1.7.3","envelopedData");H("1.2.840.113549.1.7.4","signedAndEnvelopedData");H("1.2.840.113549.1.7.5","digestedData");H("1.2.840.113549.1.7.6","encryptedData");H("1.2.840.113549.1.9.1","emailAddress");H("1.2.840.113549.1.9.2","unstructuredName");H("1.2.840.113549.1.9.3","contentType");H("1.2.840.113549.1.9.4","messageDigest");H("1.2.840.113549.1.9.5","signingTime");H("1.2.840.113549.1.9.6","counterSignature");H("1.2.840.113549.1.9.7","challengePassword");H("1.2.840.113549.1.9.8","unstructuredAddress");H("1.2.840.113549.1.9.14","extensionRequest");H("1.2.840.113549.1.9.20","friendlyName");H("1.2.840.113549.1.9.21","localKeyId");H("1.2.840.113549.1.9.22.1","x509Certificate");H("1.2.840.113549.1.12.10.1.1","keyBag");H("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");H("1.2.840.113549.1.12.10.1.3","certBag");H("1.2.840.113549.1.12.10.1.4","crlBag");H("1.2.840.113549.1.12.10.1.5","secretBag");H("1.2.840.113549.1.12.10.1.6","safeContentsBag");H("1.2.840.113549.1.5.13","pkcs5PBES2");H("1.2.840.113549.1.5.12","pkcs5PBKDF2");H("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");H("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");H("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");H("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");H("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");H("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");H("1.2.840.113549.2.7","hmacWithSHA1");H("1.2.840.113549.2.8","hmacWithSHA224");H("1.2.840.113549.2.9","hmacWithSHA256");H("1.2.840.113549.2.10","hmacWithSHA384");H("1.2.840.113549.2.11","hmacWithSHA512");H("1.2.840.113549.3.7","des-EDE3-CBC");H("2.16.840.1.101.3.4.1.2","aes128-CBC");H("2.16.840.1.101.3.4.1.22","aes192-CBC");H("2.16.840.1.101.3.4.1.42","aes256-CBC");H("2.5.4.3","commonName");H("2.5.4.5","serialName");H("2.5.4.6","countryName");H("2.5.4.7","localityName");H("2.5.4.8","stateOrProvinceName");H("2.5.4.9","streetAddress");H("2.5.4.10","organizationName");H("2.5.4.11","organizationalUnitName");H("2.5.4.13","description");H("2.5.4.15","businessCategory");H("2.5.4.17","postalCode");H("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");H("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");H("2.16.840.1.113730.1.1","nsCertType");H("2.16.840.1.113730.1.13","nsComment");De("2.5.29.1","authorityKeyIdentifier");De("2.5.29.2","keyAttributes");De("2.5.29.3","certificatePolicies");De("2.5.29.4","keyUsageRestriction");De("2.5.29.5","policyMapping");De("2.5.29.6","subtreesConstraint");De("2.5.29.7","subjectAltName");De("2.5.29.8","issuerAltName");De("2.5.29.9","subjectDirectoryAttributes");De("2.5.29.10","basicConstraints");De("2.5.29.11","nameConstraints");De("2.5.29.12","policyConstraints");De("2.5.29.13","basicConstraints");H("2.5.29.14","subjectKeyIdentifier");H("2.5.29.15","keyUsage");De("2.5.29.16","privateKeyUsagePeriod");H("2.5.29.17","subjectAltName");H("2.5.29.18","issuerAltName");H("2.5.29.19","basicConstraints");De("2.5.29.20","cRLNumber");De("2.5.29.21","cRLReason");De("2.5.29.22","expirationDate");De("2.5.29.23","instructionCode");De("2.5.29.24","invalidityDate");De("2.5.29.25","cRLDistributionPoints");De("2.5.29.26","issuingDistributionPoint");De("2.5.29.27","deltaCRLIndicator");De("2.5.29.28","issuingDistributionPoint");De("2.5.29.29","certificateIssuer");De("2.5.29.30","nameConstraints");H("2.5.29.31","cRLDistributionPoints");H("2.5.29.32","certificatePolicies");De("2.5.29.33","policyMappings");De("2.5.29.34","policyConstraints");H("2.5.29.35","authorityKeyIdentifier");De("2.5.29.36","policyConstraints");H("2.5.29.37","extKeyUsage");De("2.5.29.46","freshestCRL");De("2.5.29.54","inhibitAnyPolicy");H("1.3.6.1.4.1.11129.2.4.2","timestampList");H("1.3.6.1.5.5.7.1.1","authorityInfoAccess");H("1.3.6.1.5.5.7.3.1","serverAuth");H("1.3.6.1.5.5.7.3.2","clientAuth");H("1.3.6.1.5.5.7.3.3","codeSigning");H("1.3.6.1.5.5.7.3.4","emailProtection");H("1.3.6.1.5.5.7.3.8","timeStamping")});var _n=S((H5,rp)=>{var He=Ee();Ke();Qi();var Z=rp.exports=He.asn1=He.asn1||{};Z.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Z.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Z.create=function(t,e,r,n,i){if(He.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||He.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=Z.copy(a)),a};Z.copy=function(t,e){var r;if(He.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(Z.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Z.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Z.equals=function(t,e,r){if(He.util.isArray(t)){if(!He.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Z.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Z.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};Z.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Eo(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var dC=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Eo(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};Z.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=He.util.createBuffer(t)),Fa(t,t.length(),0,e)};function Fa(t,e,r,n){var i;Eo(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=dC(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,f,d=(s&32)==32;if(d)if(l=[],c===void 0)for(;;){if(Eo(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),l.push(Fa(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),l.push(Fa(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(l===void 0&&o===Z.Class.UNIVERSAL&&a===Z.Type.BITSTRING&&(f=t.bytes(c)),l===void 0&&n.decodeBitStrings&&o===Z.Class.UNIVERSAL&&a===Z.Type.BITSTRING&&c>1){var p=t.read,h=e,g=0;if(a===Z.Type.BITSTRING&&(Eo(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={verbose:n.verbose,strict:!0,decodeBitStrings:!0},_=Fa(t,e,r+1,v),B=i-t.length();e-=B,a==Z.Type.BITSTRING&&B++;var L=_.tagClass;B===c&&(L===Z.Class.UNIVERSAL||L===Z.Class.CONTEXT_SPECIFIC)&&(l=[_])}catch(q){}l===void 0&&(t.read=p,e=h)}if(l===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Z.Type.BMPSTRING)for(l="";c>0;c-=2)Eo(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c)}var z=f===void 0?null:{bitStringContents:f};return Z.create(o,a,d,l,z)}Z.toDer=function(t){var e=He.util.createBuffer(),r=t.tagClass|t.type,n=He.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=Z.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(Z.toDer(t.value[s]))}else if(t.type===Z.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===Z.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};Z.oidToDer=function(t){var e=t.split("."),r=He.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};Z.derToOid=function(t){var e;typeof t=="string"&&(t=He.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};Z.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),f=parseInt(t.substr(u+4,2),10),d=l*60+f;d*=6e4,c==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};Z.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var f=t.length-5,d=t.charAt(f);if(d==="+"||d==="-"){var p=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10);u=p*60+h,u*=6e4,d==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};Z.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Z.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Z.integerToDer=function(t){var e=He.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Z.derToInteger=function(t){typeof t=="string"&&(t=He.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Z.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(i=!0,e.value&&He.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=Z.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var tp=/[^\\u0000-\\u00ff]/;Z.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case Z.Class.UNIVERSAL:n+="Universal:";break;case Z.Class.APPLICATION:n+="Application:";break;case Z.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case Z.Class.PRIVATE:n+="Private:";break}if(t.tagClass===Z.Class.UNIVERSAL)switch(n+=t.type,t.type){case Z.Type.NONE:n+=" (None)";break;case Z.Type.BOOLEAN:n+=" (Boolean)";break;case Z.Type.INTEGER:n+=" (Integer)";break;case Z.Type.BITSTRING:n+=" (Bit string)";break;case Z.Type.OCTETSTRING:n+=" (Octet string)";break;case Z.Type.NULL:n+=" (Null)";break;case Z.Type.OID:n+=" (Object Identifier)";break;case Z.Type.ODESC:n+=" (Object Descriptor)";break;case Z.Type.EXTERNAL:n+=" (External or Instance of)";break;case Z.Type.REAL:n+=" (Real)";break;case Z.Type.ENUMERATED:n+=" (Enumerated)";break;case Z.Type.EMBEDDED:n+=" (Embedded PDV)";break;case Z.Type.UTF8:n+=" (UTF8)";break;case Z.Type.ROID:n+=" (Relative Object Identifier)";break;case Z.Type.SEQUENCE:n+=" (Sequence)";break;case Z.Type.SET:n+=" (Set)";break;case Z.Type.PRINTABLESTRING:n+=" (Printable String)";break;case Z.Type.IA5String:n+=" (IA5String (ASCII))";break;case Z.Type.UTCTIME:n+=" (UTC time)";break;case Z.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case Z.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=Z.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===Z.Type.OID){var c=Z.derToOid(t.value);n+=c,He.pki&&He.pki.oids&&c in He.pki.oids&&(n+=" ("+He.pki.oids[c]+") ")}if(t.type===Z.Type.INTEGER)try{n+=Z.derToInteger(t.value)}catch(l){n+="0x"+He.util.bytesToHex(t.value)}else if(t.type===Z.Type.BITSTRING){if(t.value.length>1?n+="0x"+He.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else t.type===Z.Type.OCTETSTRING?(tp.test(t.value)||(n+="("+t.value+") "),n+="0x"+He.util.bytesToHex(t.value)):t.type===Z.Type.UTF8?n+=He.util.decodeUtf8(t.value):t.type===Z.Type.PRINTABLESTRING||t.type===Z.Type.IA5String?n+=t.value:tp.test(t.value)?n+="0x"+He.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var rl=S((z5,np)=>{var gt=Ee();Ke();np.exports=gt.cipher=gt.cipher||{};gt.cipher.algorithms=gt.cipher.algorithms||{};gt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};gt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};gt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),gt.cipher.algorithms[t]=e};gt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in gt.cipher.algorithms?gt.cipher.algorithms[t]:null};var tl=gt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};tl.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=gt.util.createBuffer(),this.output=t.output||gt.util.createBuffer(),this.mode.start(e)};tl.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};tl.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var il=S((G5,ip)=>{var mt=Ee();Ke();mt.cipher=mt.cipher||{};var we=ip.exports=mt.cipher.modes=mt.cipher.modes||{};we.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};we.ecb.prototype.start=function(t){};we.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};we.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};we.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};we.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};we.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};we.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Ka(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};we.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};we.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};we.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};we.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};we.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=mt.util.createBuffer(),this._partialBytes=0};we.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ka(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};we.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};we.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};we.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=mt.util.createBuffer(),this._partialBytes=0};we.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ka(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};we.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};we.ofb.prototype.decrypt=we.ofb.prototype.encrypt;we.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=mt.util.createBuffer(),this._partialBytes=0};we.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Ka(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};we.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Va(this._inBlock)};we.ctr.prototype.decrypt=we.ctr.prototype.encrypt;we.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=mt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};we.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=mt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=mt.util.createBuffer(t.additionalData):r=mt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=mt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(nl(n*8)))}this._inBlock=this._j0.slice(0),Va(this._inBlock),this._partialBytes=0,r=mt.util.createBuffer(r),this._aDataLength=nl(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};we.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Va(this._inBlock)};we.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Va(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};we.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=mt.util.createBuffer();var n=this._aDataLength.concat(nl(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};we.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};we.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};we.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};we.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};we.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,u=(n-1-o%n)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};we.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function Ka(t,e){if(typeof t=="string"&&(t=mt.util.createBuffer(t)),mt.util.isArray(t)&&t.length>4){var r=t;t=mt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!mt.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function Va(t){t[t.length-1]=t[t.length-1]+1&4294967295}function nl(t){return[t/4294967296|0,t&4294967295]}});var Ji=S((Y5,cp)=>{var Ve=Ee();rl();il();Ke();cp.exports=Ve.aes=Ve.aes||{};Ve.aes.startEncrypting=function(t,e,r,n){var i=ja({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};Ve.aes.createEncryptionCipher=function(t,e){return ja({key:t,output:null,decrypt:!1,mode:e})};Ve.aes.startDecrypting=function(t,e,r,n){var i=ja({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};Ve.aes.createDecryptionCipher=function(t,e){return ja({key:t,output:null,decrypt:!0,mode:e})};Ve.aes.Algorithm=function(t,e){sl||op();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return al(r._w,n,i,!1)},decrypt:function(n,i){return al(r._w,n,i,!0)}}}),r._init=!1};Ve.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Ve.util.createBuffer(e);else if(Ve.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Ve.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Ve.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!Ve.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=ap(e,t.decrypt&&!o),this._init=!0}};Ve.aes._expandKey=function(t,e){return sl||op(),ap(t,e)};Ve.aes._updateBlock=al;Xi("AES-ECB",Ve.cipher.modes.ecb);Xi("AES-CBC",Ve.cipher.modes.cbc);Xi("AES-CFB",Ve.cipher.modes.cfb);Xi("AES-OFB",Ve.cipher.modes.ofb);Xi("AES-CTR",Ve.cipher.modes.ctr);Xi("AES-GCM",Ve.cipher.modes.gcm);function Xi(t,e){var r=function(){return new Ve.aes.Algorithm(t,e)};Ve.cipher.registerAlgorithm(t,r)}var sl=!1,Zi=4,Nt,ol,sp,ni,mr;function op(){sl=!0,sp=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Nt=new Array(256),ol=new Array(256),ni=new Array(4),mr=new Array(4);for(var e=0;e<4;++e)ni[e]=new Array(256),mr[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,u,l,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Nt[r]=a,ol[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var f=0;f<4;++f)ni[f][r]=u,mr[f][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function ap(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=Zi*o,c=s;c<a;++c)n=r[c-1],c%s==0?(n=Nt[n>>>16&255]<<24^Nt[n>>>8&255]<<16^Nt[n&255]<<8^Nt[n>>>24]^sp[i]<<24,i++):s>6&&c%s==4&&(n=Nt[n>>>24]<<24^Nt[n>>>16&255]<<16^Nt[n>>>8&255]<<8^Nt[n&255]),r[c]=r[c-s]^n;if(e){var u,l=mr[0],f=mr[1],d=mr[2],p=mr[3],h=r.slice(0);a=r.length;for(var c=0,g=a-Zi;c<a;c+=Zi,g-=Zi)if(c===0||c===a-Zi)h[c]=r[g],h[c+1]=r[g+3],h[c+2]=r[g+2],h[c+3]=r[g+1];else for(var v=0;v<Zi;++v)u=r[g+v],h[c+(3&-v)]=l[Nt[u>>>24]]^f[Nt[u>>>16&255]]^d[Nt[u>>>8&255]]^p[Nt[u&255]];r=h}return r}function al(t,e,r,n){var i=t.length/4-1,s,o,a,c,u;n?(s=mr[0],o=mr[1],a=mr[2],c=mr[3],u=ol):(s=ni[0],o=ni[1],a=ni[2],c=ni[3],u=Nt);var l,f,d,p,h,g,v;l=e[0]^t[0],f=e[n?3:1]^t[1],d=e[2]^t[2],p=e[n?1:3]^t[3];for(var _=3,B=1;B<i;++B)h=s[l>>>24]^o[f>>>16&255]^a[d>>>8&255]^c[p&255]^t[++_],g=s[f>>>24]^o[d>>>16&255]^a[p>>>8&255]^c[l&255]^t[++_],v=s[d>>>24]^o[p>>>16&255]^a[l>>>8&255]^c[f&255]^t[++_],p=s[p>>>24]^o[l>>>16&255]^a[f>>>8&255]^c[d&255]^t[++_],l=h,f=g,d=v;r[0]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[d>>>8&255]<<8^u[p&255]^t[++_],r[n?3:1]=u[f>>>24]<<24^u[d>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^t[++_],r[2]=u[d>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[f&255]^t[++_],r[n?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[d&255]^t[++_]}function ja(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Ve.cipher.createDecipher(r,t.key):n=Ve.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof Ve.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Ha=S((W5,lp)=>{var ze=Ee();rl();il();Ke();lp.exports=ze.des=ze.des||{};ze.des.startEncrypting=function(t,e,r,n){var i=$a({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ze.des.createEncryptionCipher=function(t,e){return $a({key:t,output:null,decrypt:!1,mode:e})};ze.des.startDecrypting=function(t,e,r,n){var i=$a({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};ze.des.createDecryptionCipher=function(t,e){return $a({key:t,output:null,decrypt:!0,mode:e})};ze.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return up(r._keys,n,i,!1)},decrypt:function(n,i){return up(r._keys,n,i,!0)}}}),r._init=!1};ze.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=ze.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=wC(e),this._init=!0}};Rr("DES-ECB",ze.cipher.modes.ecb);Rr("DES-CBC",ze.cipher.modes.cbc);Rr("DES-CFB",ze.cipher.modes.cfb);Rr("DES-OFB",ze.cipher.modes.ofb);Rr("DES-CTR",ze.cipher.modes.ctr);Rr("3DES-ECB",ze.cipher.modes.ecb);Rr("3DES-CBC",ze.cipher.modes.cbc);Rr("3DES-CFB",ze.cipher.modes.cfb);Rr("3DES-OFB",ze.cipher.modes.ofb);Rr("3DES-CTR",ze.cipher.modes.ctr);function Rr(t,e){var r=function(){return new ze.des.Algorithm(t,e)};ze.cipher.registerAlgorithm(t,r)}var hC=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],pC=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],yC=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],gC=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],mC=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],vC=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],bC=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],EC=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function wC(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],_=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],B=0,L,z=0;z<g;z++){var q=t.getInt32(),k=t.getInt32();L=(q>>>4^k)&252645135,k^=L,q^=L<<4,L=(k>>>-16^q)&65535,q^=L,k^=L<<-16,L=(q>>>2^k)&858993459,k^=L,q^=L<<2,L=(k>>>-16^q)&65535,q^=L,k^=L<<-16,L=(q>>>1^k)&1431655765,k^=L,q^=L<<1,L=(k>>>8^q)&16711935,q^=L,k^=L<<8,L=(q>>>1^k)&1431655765,k^=L,q^=L<<1,L=q<<8|k>>>20&240,q=k<<24|k<<8&16711680|k>>>8&65280|k>>>24&240,k=L;for(var te=0;te<_.length;++te){_[te]?(q=q<<2|q>>>26,k=k<<2|k>>>26):(q=q<<1|q>>>27,k=k<<1|k>>>27),q&=-15,k&=-15;var se=e[q>>>28]|r[q>>>24&15]|n[q>>>20&15]|i[q>>>16&15]|s[q>>>12&15]|o[q>>>8&15]|a[q>>>4&15],j=c[k>>>28]|u[k>>>24&15]|l[k>>>20&15]|f[k>>>16&15]|d[k>>>12&15]|p[k>>>8&15]|h[k>>>4&15];L=(j>>>16^se)&65535,v[B++]=se^L,v[B++]=j^L<<16}}return v}function up(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var l=s[u+1],f=s[u+2],d=s[u];d!=l;d+=f){var p=c^t[d],h=(c>>>4|c<<28)^t[d+1];o=a,a=c,c=o^(pC[p>>>24&63]|gC[p>>>16&63]|vC[p>>>8&63]|EC[p&63]|hC[h>>>24&63]|yC[h>>>16&63]|mC[h>>>8&63]|bC[h&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function $a(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=ze.cipher.createDecipher(r,t.key):n=ze.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof ze.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var An=S((Q5,fp)=>{var za=Ee();fp.exports=za.md=za.md||{};za.md.algorithms=za.md.algorithms||{}});var hp=S((X5,dp)=>{var Zr=Ee();An();Ke();var SC=dp.exports=Zr.hmac=Zr.hmac||{};SC.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Zr.md.algorithms)e=Zr.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Zr.util.createBuffer(o);else if(Zr.util.isArray(o)){var a=o;o=Zr.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Zr.util.createBuffer(),n=Zr.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var es=S(()=>{});var cl=S((eL,pp)=>{var Dt=Ee();hp();An();Ke();var xC=Dt.pkcs5=Dt.pkcs5||{},Jr;Dt.util.isNodejs&&!Dt.options.usePureJavaScript&&(Jr=es());pp.exports=Dt.pbkdf2=xC.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Dt.util.isNodejs&&!Dt.options.usePureJavaScript&&Jr.pbkdf2&&(i===null||typeof i!="object")&&(Jr.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Jr.pbkdf2Sync.length===4?Jr.pbkdf2(t,e,r,n,function(L,z){if(L)return s(L);s(null,z.toString("binary"))}):Jr.pbkdf2(t,e,r,n,i,function(L,z){if(L)return s(L);s(null,z.toString("binary"))}):Jr.pbkdf2Sync.length===4?Jr.pbkdf2Sync(t,e,r,n).toString("binary"):Jr.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Dt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Dt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),u=n-(c-1)*o,l=Dt.hmac.create();l.start(i,t);var f="",d,p,h;if(!s){for(var g=1;g<=c;++g){l.start(null,null),l.update(e),l.update(Dt.util.int32ToBytes(g)),d=h=l.digest().getBytes();for(var v=2;v<=r;++v)l.start(null,null),l.update(h),p=l.digest().getBytes(),d=Dt.util.xorBytes(d,p,o),h=p;f+=g<c?d:d.substr(0,u)}return f}var g=1,v;function _(){if(g>c)return s(null,f);l.start(null,null),l.update(e),l.update(Dt.util.int32ToBytes(g)),d=h=l.digest().getBytes(),v=2,B()}function B(){if(v<=r)return l.start(null,null),l.update(h),p=l.digest().getBytes(),d=Dt.util.xorBytes(d,p,o),h=p,++v,Dt.util.setImmediate(B);f+=g<c?d:d.substr(0,u),++g,_()}_()}});var Wa=S((tL,gp)=>{var Ga=Ee();Ke();var yp=gp.exports=Ga.pem=Ga.pem||{};yp.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Ya(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Ya(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Ya(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Ya(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Ga.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};yp.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:Ga.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(i),c=0;s&&c<a.length;){for(var u=a[c].replace(/\s+$/,""),l=c+1;l<a.length;++l){var f=a[l];if(!/\s/.test(f[0]))break;u+=f,c=l}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),h=0;h<p.length;++h)d.values.push(_C(p[h]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Ya(t){for(var e=t.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function _C(t){return t.replace(/^\s+/,"")}});var Sp=S((rL,wp)=>{var Br=Ee();An();Ke();var mp=wp.exports=Br.sha256=Br.sha256||{};Br.md.sha256=Br.md.algorithms.sha256=mp;mp.create=function(){vp||AC();var t=null,e=Br.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Br.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Br.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Ep(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Br.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(ul.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ep(f,r,i);var d=Br.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},n};var ul=null,vp=!1,bp=null;function AC(){ul=String.fromCharCode(128),ul+=Br.util.fillString(String.fromCharCode(0),64),bp=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],vp=!0}function Ep(t,e,r){for(var n,i,s,o,a,c,u,l,f,d,p,h,g,v,_,B=r.length();B>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(l=t.h0,f=t.h1,d=t.h2,p=t.h3,h=t.h4,g=t.h5,v=t.h6,_=t.h7,u=0;u<64;++u)o=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),a=v^h&(g^v),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|d&(l^f),n=_+o+a+bp[u]+e[u],i=s+c,_=v,v=g,g=h,h=p+n>>>0,p=d,d=f,f=l,l=n+i>>>0;t.h0=t.h0+l|0,t.h1=t.h1+f|0,t.h2=t.h2+d|0,t.h3=t.h3+p|0,t.h4=t.h4+h|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+_|0,B-=64}}});var _p=S((nL,xp)=>{var Pr=Ee();Ke();var Qa=null;Pr.util.isNodejs&&!Pr.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Qa=es());var CC=xp.exports=Pr.prng=Pr.prng||{};CC.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var f=e.plugin.cipher,d=e.plugin.increment,p=e.plugin.formatKey,h=e.plugin.formatSeed,g=Pr.util.createBuffer();e.key=null,v();function v(_){if(_)return l(_);if(g.length()>=u)return l(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Pr.util.nextTick(function(){s(v)});var B=f(e.key,e.seed);e.generated+=B.length,g.putBytes(B),e.key=p(f(e.key,d(e.seed))),e.seed=h(f(e.key,e.seed)),Pr.util.setImmediate(v)}},e.generateSync=function(u){var l=e.plugin.cipher,f=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var h=Pr.util.createBuffer();h.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=l(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=d(l(e.key,f(e.seed))),e.seed=p(l(e.key,e.seed))}return h.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(f,d){if(f)return u(f);e.collect(d),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,f=0;f<32;++f)e.reseeds%l==0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var d=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function c(u){var l=null,f=Pr.util.globalScope,d=f.crypto||f.msCrypto;d&&d.getRandomValues&&(l=function(q){return d.getRandomValues(q)});var p=Pr.util.createBuffer();if(l)for(;p.length()<u;){var h=Math.max(1,Math.min(u-p.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{l(g);for(var v=0;v<g.length;++v)p.putInt32(g[v])}catch(q){if(!(typeof QuotaExceededError!="undefined"&&q instanceof QuotaExceededError))throw q}}if(p.length()<u)for(var _,B,L,z=Math.floor(Math.random()*65536);p.length()<u;){B=16807*(z&65535),_=16807*(z>>16),B+=(_&32767)<<16,B+=_>>15,B=(B&2147483647)+(B>>31),z=B&4294967295;for(var v=0;v<3;++v)L=z>>>(v<<3),L^=Math.floor(Math.random()*256),p.putByte(String.fromCharCode(L&255))}return p.getBytes(u)}return Qa?(e.seedFile=function(u,l){Qa.randomBytes(u,function(f,d){if(f)return l(f);l(null,d.toString())})},e.seedFileSync=function(u){return Qa.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(f){l(f)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,f=0;f<l;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var f="",d=0;d<l;d+=8)f+=String.fromCharCode(u>>d&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,d){function p(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",p),d(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var d=f.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(p,h){u.postMessage({forge:{prng:{err:p,bytes:h}}})})};u.addEventListener("message",l)}},e}});var ii=S((iL,ll)=>{var vt=Ee();Ji();Sp();_p();Ke();(function(){if(vt.random&&vt.random.getBytes){ll.exports=vt.random;return}(function(t){var e={},r=new Array(4),n=vt.util.createBuffer();e.formatKey=function(f){var d=vt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),vt.aes._expandKey(f,!1)},e.formatSeed=function(f){var d=vt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),f},e.cipher=function(f,d){return vt.aes._updateBlock(f,d,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(f){return++f[3],f},e.md=vt.md.sha256;function i(){var f=vt.prng.create(e);return f.getBytes=function(d,p){return f.generate(d,p)},f.getBytesSync=function(d){return f.generate(d)},f}var s=i(),o=null,a=vt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(f){return c.getRandomValues(f)}),vt.options.usePureJavaScript||!vt.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(f){}s.collect(u),u=null}t&&(t().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),t().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!vt.random)vt.random=s;else for(var l in s)vt.random[l]=s[l];vt.random.createInstance=i,ll.exports=vt.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Tp=S((sL,Ip)=>{var Kt=Ee();Ke();var fl=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Ap=[1,2,3,5],IC=function(t,e){return t<<e&65535|(t&65535)>>16-e},TC=function(t,e){return(t&65535)>>e|t<<16-e&65535};Ip.exports=Kt.rc2=Kt.rc2||{};Kt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Kt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(fl[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,fl[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,fl[r.at(a+1)^r.at(a+s)]);return r};var Cp=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,u,l,f=[];for(t=Kt.rc2.expandKey(t,e),u=0;u<64;u++)f.push(t.getInt16Le());r?(a=function(h){for(u=0;u<4;u++)h[u]+=f[l]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),h[u]=IC(h[u],Ap[u]),l++},c=function(h){for(u=0;u<4;u++)h[u]+=f[h[(u+3)%4]&63]}):(a=function(h){for(u=3;u>=0;u--)h[u]=TC(h[u],Ap[u]),h[u]-=f[l]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),l--},c=function(h){for(u=3;u>=0;u--)h[u]-=f[h[(u+3)%4]&63]});var d=function(h){var g=[];for(u=0;u<4;u++){var v=i.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),g.push(v&65535)}l=r?0:63;for(var _=0;_<h.length;_++)for(var B=0;B<h[_][0];B++)h[_][1](g);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},p=null;return p={start:function(h,g){h&&typeof h=="string"&&(h=Kt.util.createBuffer(h)),n=!1,i=Kt.util.createBuffer(),s=g||new Kt.util.createBuffer,o=h,p.output=s},update:function(h){for(n||i.putBuffer(h);i.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(h){var g=!0;if(r)if(h)g=h(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,p.update()),!r&&(g=i.length()===0,g))if(h)g=h(8,s,!r);else{var _=s.length(),B=s.at(_-1);B>_?g=!1:s.truncate(B)}return g}},p};Kt.rc2.startEncrypting=function(t,e,r){var n=Kt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createEncryptionCipher=function(t,e){return Cp(t,e,!0)};Kt.rc2.startDecrypting=function(t,e,r){var n=Kt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Kt.rc2.createDecryptionCipher=function(t,e){return Cp(t,e,!1)}});var Ja=S((oL,kp)=>{var dl=Ee();kp.exports=dl.jsbn=dl.jsbn||{};var en,RC=244837814094590,Rp=(RC&16777215)==15715070;function K(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}dl.jsbn.BigInteger=K;function Te(){return new K(null)}function BC(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function PC(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=c&1073741823}return i}function Bp(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+r.data[n]+i,i=(c>>28)+(l>>14)+a*u,r.data[n++]=c&268435455}return i}typeof navigator=="undefined"?(K.prototype.am=Bp,en=28):Rp&&navigator.appName=="Microsoft Internet Explorer"?(K.prototype.am=PC,en=30):Rp&&navigator.appName!="Netscape"?(K.prototype.am=BC,en=26):(K.prototype.am=Bp,en=28);K.prototype.DB=en;K.prototype.DM=(1<<en)-1;K.prototype.DV=1<<en;var hl=52;K.prototype.FV=Math.pow(2,hl);K.prototype.F1=hl-en;K.prototype.F2=2*en-hl;var NC="0123456789abcdefghijklmnopqrstuvwxyz",Xa=new Array,ts,rr;ts="0".charCodeAt(0);for(rr=0;rr<=9;++rr)Xa[ts++]=rr;ts="a".charCodeAt(0);for(rr=10;rr<36;++rr)Xa[ts++]=rr;ts="A".charCodeAt(0);for(rr=10;rr<36;++rr)Xa[ts++]=rr;function Pp(t){return NC.charAt(t)}function Np(t,e){var r=Xa[t.charCodeAt(e)];return r??-1}function DC(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function OC(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Cn(t){var e=Te();return e.fromInt(t),e}function LC(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:Np(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&K.ZERO.subTo(this,this)}function kC(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function qC(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Pp(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Pp(n));return i?s:"0"}function UC(){var t=Te();return K.ZERO.subTo(this,t),t}function MC(){return this.s<0?this.negate():this}function FC(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Za(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function KC(){return this.t<=0?0:this.DB*(this.t-1)+Za(this.data[this.t-1]^this.s&this.DM)}function VC(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function jC(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function $C(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function HC(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function zC(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function GC(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&K.ZERO.subTo(e,e)}function YC(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function WC(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Te());var s=Te(),o=this.s,a=t.s,c=this.DB-Za(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var f=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),d=this.FV/f,p=(1<<this.F1)/f,h=1<<this.F2,g=r.t,v=g-u,_=e??Te();for(s.dlShiftTo(v,_),r.compareTo(_)>=0&&(r.data[r.t++]=1,r.subTo(_,r)),K.ONE.dlShiftTo(u,_),_.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--v>=0;){var B=r.data[--g]==l?this.DM:Math.floor(r.data[g]*d+(r.data[g-1]+h)*p);if((r.data[g]+=s.am(0,B,r,v,0,u))<B)for(s.dlShiftTo(v,_),r.subTo(_,r);r.data[g]<--B;)r.subTo(_,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&K.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&K.ZERO.subTo(r,r)}}}function QC(t){var e=Te();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(K.ZERO)>0&&t.subTo(e,e),e}function si(t){this.m=t}function XC(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function ZC(t){return t}function JC(t){t.divRemTo(this.m,null,t)}function eI(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function tI(t,e){t.squareTo(e),this.reduce(e)}si.prototype.convert=XC;si.prototype.revert=ZC;si.prototype.reduce=JC;si.prototype.mulTo=eI;si.prototype.sqrTo=tI;function rI(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function oi(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function nI(t){var e=Te();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(K.ZERO)>0&&this.m.subTo(e,e),e}function iI(t){var e=Te();return t.copyTo(e),this.reduce(e),e}function sI(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function oI(t,e){t.squareTo(e),this.reduce(e)}function aI(t,e,r){t.multiplyTo(e,r),this.reduce(r)}oi.prototype.convert=nI;oi.prototype.revert=iI;oi.prototype.reduce=sI;oi.prototype.mulTo=aI;oi.prototype.sqrTo=oI;function cI(){return(this.t>0?this.data[0]&1:this.s)==0}function uI(t,e){if(t>4294967295||t<1)return K.ONE;var r=Te(),n=Te(),i=e.convert(this),s=Za(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function lI(t,e){var r;return t<256||e.isEven()?r=new si(e):r=new oi(e),this.exp(t,r)}K.prototype.copyTo=DC;K.prototype.fromInt=OC;K.prototype.fromString=LC;K.prototype.clamp=kC;K.prototype.dlShiftTo=VC;K.prototype.drShiftTo=jC;K.prototype.lShiftTo=$C;K.prototype.rShiftTo=HC;K.prototype.subTo=zC;K.prototype.multiplyTo=GC;K.prototype.squareTo=YC;K.prototype.divRemTo=WC;K.prototype.invDigit=rI;K.prototype.isEven=cI;K.prototype.exp=uI;K.prototype.toString=qC;K.prototype.negate=UC;K.prototype.abs=MC;K.prototype.compareTo=FC;K.prototype.bitLength=KC;K.prototype.mod=QC;K.prototype.modPowInt=lI;K.ZERO=Cn(0);K.ONE=Cn(1);function fI(){var t=Te();return this.copyTo(t),t}function dI(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function hI(){return this.t==0?this.s:this.data[0]<<24>>24}function pI(){return this.t==0?this.s:this.data[0]<<16>>16}function yI(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function gI(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function mI(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Cn(r),i=Te(),s=Te(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function vI(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=Np(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&K.ZERO.subTo(this,this)}function bI(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(K.ONE.shiftLeft(t-1),pl,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(K.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function EI(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function wI(t){return this.compareTo(t)==0}function SI(t){return this.compareTo(t)<0?this:t}function xI(t){return this.compareTo(t)>0?this:t}function _I(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function AI(t,e){return t&e}function CI(t){var e=Te();return this.bitwiseTo(t,AI,e),e}function pl(t,e){return t|e}function II(t){var e=Te();return this.bitwiseTo(t,pl,e),e}function Dp(t,e){return t^e}function TI(t){var e=Te();return this.bitwiseTo(t,Dp,e),e}function Op(t,e){return t&~e}function RI(t){var e=Te();return this.bitwiseTo(t,Op,e),e}function BI(){for(var t=Te(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function PI(t){var e=Te();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function NI(t){var e=Te();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function DI(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function OI(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+DI(this.data[t]);return this.s<0?this.t*this.DB:-1}function LI(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function kI(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=LI(this.data[r]^e);return t}function qI(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function UI(t,e){var r=K.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function MI(t){return this.changeBit(t,pl)}function FI(t){return this.changeBit(t,Op)}function KI(t){return this.changeBit(t,Dp)}function VI(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function jI(t){var e=Te();return this.addTo(t,e),e}function $I(t){var e=Te();return this.subTo(t,e),e}function HI(t){var e=Te();return this.multiplyTo(t,e),e}function zI(t){var e=Te();return this.divRemTo(t,e,null),e}function GI(t){var e=Te();return this.divRemTo(t,null,e),e}function YI(t){var e=Te(),r=Te();return this.divRemTo(t,e,r),new Array(e,r)}function WI(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function QI(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function wo(){}function Lp(t){return t}function XI(t,e,r){t.multiplyTo(e,r)}function ZI(t,e){t.squareTo(e)}wo.prototype.convert=Lp;wo.prototype.revert=Lp;wo.prototype.mulTo=XI;wo.prototype.sqrTo=ZI;function JI(t){return this.exp(t,new wo)}function eT(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function tT(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function rs(t){this.r2=Te(),this.q3=Te(),K.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function rT(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Te();return t.copyTo(e),this.reduce(e),e}function nT(t){return t}function iT(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function sT(t,e){t.squareTo(e),this.reduce(e)}function oT(t,e,r){t.multiplyTo(e,r),this.reduce(r)}rs.prototype.convert=rT;rs.prototype.revert=nT;rs.prototype.reduce=iT;rs.prototype.mulTo=oT;rs.prototype.sqrTo=sT;function aT(t,e){var r=t.bitLength(),n,i=Cn(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new si(e):e.isEven()?s=new rs(e):s=new oi(e);var o=new Array,a=3,c=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var l=Te();for(s.sqrTo(o[1],l);a<=u;)o[a]=Te(),s.mulTo(l,o[a-2],o[a]),a+=2}var f=t.t-1,d,p=!0,h=Te(),g;for(r=Za(t.data[f])-1;f>=0;){for(r>=c?d=t.data[f]>>r-c&u:(d=(t.data[f]&(1<<r+1)-1)<<c-r,f>0&&(d|=t.data[f-1]>>this.DB+r-c)),a=n;(d&1)==0;)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--f),p)o[d].copyTo(i),p=!1;else{for(;a>1;)s.sqrTo(i,h),s.sqrTo(h,i),a-=2;a>0?s.sqrTo(i,h):(g=i,i=h,h=g),s.mulTo(h,o[d],i)}for(;f>=0&&(t.data[f]&1<<r)==0;)s.sqrTo(i,h),g=i,i=h,h=g,--r<0&&(r=this.DB-1,--f)}return s.revert(i)}function cT(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function uT(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function lT(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return K.ZERO;for(var r=t.clone(),n=this.clone(),i=Cn(1),s=Cn(0),o=Cn(0),a=Cn(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(K.ONE)!=0)return K.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var vr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],fT=(1<<26)/vr[vr.length-1];function dT(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=vr[vr.length-1]){for(e=0;e<vr.length;++e)if(r.data[0]==vr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<vr.length;){for(var n=vr[e],i=e+1;i<vr.length&&n<fT;)n*=vr[i++];for(n=r.modInt(n);e<i;)if(n%vr[e++]==0)return!1}return r.millerRabin(t)}function hT(t){var e=this.subtract(K.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=pT(),s,o=0;o<t;++o){do s=new K(this.bitLength(),i);while(s.compareTo(K.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(K.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(K.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function pT(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}K.prototype.chunkSize=yI;K.prototype.toRadix=mI;K.prototype.fromRadix=vI;K.prototype.fromNumber=bI;K.prototype.bitwiseTo=_I;K.prototype.changeBit=UI;K.prototype.addTo=VI;K.prototype.dMultiply=WI;K.prototype.dAddOffset=QI;K.prototype.multiplyLowerTo=eT;K.prototype.multiplyUpperTo=tT;K.prototype.modInt=uT;K.prototype.millerRabin=hT;K.prototype.clone=fI;K.prototype.intValue=dI;K.prototype.byteValue=hI;K.prototype.shortValue=pI;K.prototype.signum=gI;K.prototype.toByteArray=EI;K.prototype.equals=wI;K.prototype.min=SI;K.prototype.max=xI;K.prototype.and=CI;K.prototype.or=II;K.prototype.xor=TI;K.prototype.andNot=RI;K.prototype.not=BI;K.prototype.shiftLeft=PI;K.prototype.shiftRight=NI;K.prototype.getLowestSetBit=OI;K.prototype.bitCount=kI;K.prototype.testBit=qI;K.prototype.setBit=MI;K.prototype.clearBit=FI;K.prototype.flipBit=KI;K.prototype.add=jI;K.prototype.subtract=$I;K.prototype.multiply=HI;K.prototype.divide=zI;K.prototype.remainder=GI;K.prototype.divideAndRemainder=YI;K.prototype.modPow=aT;K.prototype.modInverse=lT;K.prototype.pow=JI;K.prototype.gcd=cT;K.prototype.isProbablePrime=dT});var Kp=S((aL,Fp)=>{var Nr=Ee();An();Ke();var qp=Fp.exports=Nr.sha1=Nr.sha1||{};Nr.md.sha1=Nr.md.algorithms.sha1=qp;qp.create=function(){Up||yT();var t=null,e=Nr.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Nr.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Nr.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Mp(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Nr.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(yl.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Mp(f,r,i);var d=Nr.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},n};var yl=null,Up=!1;function yT(){yl=String.fromCharCode(128),yl+=Nr.util.fillString(String.fromCharCode(0),64),Up=!0}function Mp(t,e,r){for(var n,i,s,o,a,c,u,l,f=r.length();f>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)n=r.getInt32(),e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<20;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<32;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<40;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<60;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<80;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,f-=64}}});var $p=S((cL,jp)=>{var Dr=Ee();Ke();ii();Kp();var Vp=jp.exports=Dr.pkcs1=Dr.pkcs1||{};Vp.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Dr.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var l=s.digest(),f="",d=c-e.length,p=0;p<d;p++)f+="\0";var h=l.getBytes()+f+""+e;if(!i)i=Dr.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var g=ec(i,a-s.digestLength-1,o),v=Dr.util.xorBytes(h,g,h.length),_=ec(v,s.digestLength,o),B=Dr.util.xorBytes(i,_,i.length);return"\0"+B+v};Vp.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=o,v}if(i===void 0?i=Dr.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),u=e.substring(1,i.digestLength+1),l=e.substring(1+i.digestLength),f=ec(l,i.digestLength,s),d=Dr.util.xorBytes(u,f,u.length),p=ec(d,o-i.digestLength-1,s),h=Dr.util.xorBytes(l,p,l.length),g=h.substring(0,i.digestLength),v=c!=="\0",_=0;_<i.digestLength;++_)v|=a.charAt(_)!==g.charAt(_);for(var B=1,L=i.digestLength,z=i.digestLength;z<h.length;z++){var q=h.charCodeAt(z),k=q&1^1,te=B?65534:0;v|=q&te,B=B&k,L+=B}if(v||h.charCodeAt(L)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(L+1)};function ec(t,e,r){r||(r=Dr.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var Hp=S((uL,gl)=>{var In=Ee();Ke();Ja();ii();(function(){if(In.prime){gl.exports=In.prime;return}var t=gl.exports=In.prime=In.prime||{},e=In.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(f,d){return f|d};t.generateProbablePrime=function(f,d,p){typeof d=="function"&&(p=d,d={}),d=d||{};var h=d.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=d.prng||In.random,v={nextBytes:function(_){for(var B=g.getBytesSync(_.length),L=0;L<_.length;++L)_[L]=B.charCodeAt(L)}};if(h.name==="PRIMEINC")return s(f,v,h.options,p);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(f,d,p,h){return"workers"in p?c(f,d,p,h):o(f,d,p,h)}function o(f,d,p,h){var g=u(f,d),v=0,_=l(g.bitLength());"millerRabinTests"in p&&(_=p.millerRabinTests);var B=10;"maxBlockTime"in p&&(B=p.maxBlockTime),a(g,f,d,v,_,B,h)}function a(f,d,p,h,g,v,_){var B=+new Date;do{if(f.bitLength()>d&&(f=u(d,p)),f.isProbablePrime(g))return _(null,f);f.dAddOffset(r[h++%8],0)}while(v<0||+new Date-B<v);In.util.setImmediate(function(){a(f,d,p,h,g,v,_)})}function c(f,d,p,h){if(typeof Worker=="undefined")return o(f,d,p,h);var g=u(f,d),v=p.workers,_=p.workLoad||100,B=_*30/8,L=p.workerScript||"forge/prime.worker.js";if(v===-1)return In.util.estimateCores(function(q,k){q&&(k=2),v=k-1,z()});z();function z(){v=Math.max(1,v);for(var q=[],k=0;k<v;++k)q[k]=new Worker(L);for(var te=v,k=0;k<v;++k)q[k].addEventListener("message",j);var se=!1;function j(_e){if(!se){--te;var ge=_e.data;if(ge.found){for(var pe=0;pe<q.length;++pe)q[pe].terminate();return se=!0,h(null,new e(ge.prime,16))}g.bitLength()>f&&(g=u(f,d));var Je=g.toString(16);_e.target.postMessage({hex:Je,workLoad:_}),g.dAddOffset(B,0)}}}}function u(f,d){var p=new e(f,d),h=f-1;return p.testBit(h)||p.bitwiseTo(e.ONE.shiftLeft(h),i,p),p.dAddOffset(31-p.mod(n).byteValue(),0),p}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})()});var So=S((lL,Zp)=>{var fe=Ee();_n();Ja();Qi();$p();Hp();ii();Ke();typeof xe=="undefined"&&(xe=fe.jsbn.BigInteger);var xe,ml=fe.util.isNodejs?es():null,O=fe.asn1,nr=fe.util;fe.pki=fe.pki||{};Zp.exports=fe.pki.rsa=fe.rsa=fe.rsa||{};var de=fe.pki,gT=[6,4,2,4,2,4,6,2],mT={name:"PrivateKeyInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},vT={name:"RSAPrivateKey",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},bT={name:"RSAPublicKey",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ET=fe.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},wT=function(t){var e;if(t.algorithm in de.oids)e=de.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=O.oidToDer(e).getBytes(),i=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),s=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);s.value.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,n)),s.value.push(O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,""));var o=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),O.toDer(i).getBytes()},zp=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(xe.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(xe.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new xe(fe.util.bytesToHex(fe.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(xe.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};de.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Gp(t,e,r)):(i=fe.util.createBuffer(),i.putBytes(t));for(var o=new xe(i.toHex(),16),a=zp(o,e,n),c=a.toString(16),u=fe.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(fe.util.hexToBytes(c)),u.getBytes()};de.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new xe(fe.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=zp(o,e,r),c=a.toString(16),u=fe.util.createBuffer(),l=i-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(fe.util.hexToBytes(c)),n!==!1?tc(u.getBytes(),e,r):u.getBytes()};de.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||fe.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new xe(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};de.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new xe(null);r.fromInt(30);for(var n=0,i=function(f,d){return f|d},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new xe(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(xe.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(xT(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(gT[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(xe.ONE).gcd(t.e).compareTo(xe.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(xe.ONE),t.q1=t.q.subtract(xe.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(xe.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:de.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:de.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};de.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!fe.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Yp("generateKeyPair"))return ml.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:de.privateKeyFromPem(u),publicKey:de.publicKeyFromPem(c)})});if(Wp("generateKey")&&Wp("exportKey"))return nr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Xp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return nr.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=de.privateKeyFromAsn1(O.fromDer(fe.util.createBuffer(a)));n(null,{privateKey:c,publicKey:de.setRsaPublicKey(c.n,c.e)})}});if(Qp("generateKey")&&Qp("exportKey")){var i=nr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Xp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,u=nr.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var f=l.target.result,d=de.privateKeyFromAsn1(O.fromDer(fe.util.createBuffer(f)));n(null,{privateKey:d,publicKey:de.setRsaPublicKey(d.n,d.e)})},u.onerror=function(l){n(l)}},i.onerror=function(a){n(a)};return}}else if(Yp("generateKeyPairSync")){var s=ml.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:de.privateKeyFromPem(s.privateKey),publicKey:de.publicKeyFromPem(s.publicKey)}}}var o=de.rsa.createKeyPairGenerationState(t,e,r);if(!n)return de.rsa.stepKeyPairGenerationState(o,0),o.keys;ST(o,r,n)};de.setRsaPublicKey=de.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,u){return Gp(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return fe.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return de.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=tc(c,r,!0);var u=O.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=tc(c,r,!0),a===c}});var o=de.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};de.setRsaPrivateKey=de.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var d=de.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:tc};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,h){return fe.pkcs1.decode_rsa_oaep(h,p,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(d,c,!1)},c.sign=function(u,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:wT},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},f=1);var d=l.encode(u,c.n.bitLength());return de.rsa.encrypt(d,c,f)},c};de.wrapRsaPrivateKey=function(t){return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(0).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(de.oids.rsaEncryption).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")]),O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,O.toDer(t).getBytes())])};de.privateKeyFromAsn1=function(t){var e={},r=[];if(O.validate(t,mT,e,r)&&(t=O.fromDer(fe.util.createBuffer(e.privateKey))),e={},r=[],!O.validate(t,vT,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,u,l,f;return i=fe.util.createBuffer(e.privateKeyModulus).toHex(),s=fe.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=fe.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=fe.util.createBuffer(e.privateKeyPrime1).toHex(),c=fe.util.createBuffer(e.privateKeyPrime2).toHex(),u=fe.util.createBuffer(e.privateKeyExponent1).toHex(),l=fe.util.createBuffer(e.privateKeyExponent2).toHex(),f=fe.util.createBuffer(e.privateKeyCoefficient).toHex(),de.setRsaPrivateKey(new xe(i,16),new xe(s,16),new xe(o,16),new xe(a,16),new xe(c,16),new xe(u,16),new xe(l,16),new xe(f,16))};de.privateKeyToAsn1=de.privateKeyToRSAPrivateKey=function(t){return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(0).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.n)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.e)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.d)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.p)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.q)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.dP)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.dQ)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.qInv))])};de.publicKeyFromAsn1=function(t){var e={},r=[];if(O.validate(t,ET,e,r)){var n=O.derToOid(e.publicKeyOid);if(n!==de.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!O.validate(t,bT,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=fe.util.createBuffer(e.publicKeyModulus).toHex(),o=fe.util.createBuffer(e.publicKeyExponent).toHex();return de.setRsaPublicKey(new xe(s,16),new xe(o,16))};de.publicKeyToAsn1=de.publicKeyToSubjectPublicKeyInfo=function(t){return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(de.oids.rsaEncryption).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,[de.publicKeyToRSAPublicKey(t)])])};de.publicKeyToRSAPublicKey=function(t){return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.n)),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,Or(t.e))])};function Gp(t,e,r){var n=fe.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var u=0,l=fe.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function tc(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=fe.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function ST(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){fe.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(xe.ONE).gcd(t.e).compareTo(xe.ONE)!==0){t.p=null,i();return}if(t.q.subtract(xe.ONE).gcd(t.e).compareTo(xe.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(xe.ONE),t.q1=t.q.subtract(xe.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(xe.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:de.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:de.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Or(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=fe.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function xT(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Yp(t){return fe.util.isNodejs&&typeof ml[t]=="function"}function Wp(t){return typeof nr.globalScope!="undefined"&&typeof nr.globalScope.crypto=="object"&&typeof nr.globalScope.crypto.subtle=="object"&&typeof nr.globalScope.crypto.subtle[t]=="function"}function Qp(t){return typeof nr.globalScope!="undefined"&&typeof nr.globalScope.msCrypto=="object"&&typeof nr.globalScope.msCrypto.subtle=="object"&&typeof nr.globalScope.msCrypto.subtle[t]=="function"}function Xp(t){for(var e=fe.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var vl=S((fL,ny)=>{var ee=Ee();Ji();_n();Ha();An();Qi();cl();Wa();ii();Tp();So();Ke();typeof Jp=="undefined"&&(Jp=ee.jsbn.BigInteger);var Jp,U=ee.asn1,ye=ee.pki=ee.pki||{};ny.exports=ye.pbe=ee.pbe=ee.pbe||{};var ai=ye.oids,_T={name:"EncryptedPrivateKeyInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},AT={name:"PBES2Algorithms",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},CT={name:"pkcs-12PbeParams",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"iterations"}]};ye.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=ee.random.getBytesSync(r.saltSize),i=r.count,s=U.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,f;switch(r.algorithm){case"aes128":o=16,u=16,l=ai["aes128-CBC"],f=ee.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=ai["aes192-CBC"],f=ee.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=ai["aes256-CBC"],f=ee.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=ai.desCBC,f=ee.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),h=ry(p),g=ee.pkcs5.pbkdf2(e,n,i,o,h),v=ee.random.getBytesSync(u),_=f(g);_.start(v),_.update(U.toDer(t)),_.finish(),c=_.output.getBytes();var B=IT(n,s,o,p);a=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ai.pkcs5PBES2).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ai.pkcs5PBKDF2).getBytes()),B]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var L=new ee.util.ByteBuffer(n),g=ye.pbe.generatePkcs12Key(e,L,1,i,o),v=ye.pbe.generatePkcs12Key(e,L,2,i,o),_=ee.des.createEncryptionCipher(g);_.start(v),_.update(U.toDer(t)),_.finish(),c=_.output.getBytes(),a=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ai["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var z=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[a,U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,c)]);return z};ye.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!U.validate(t,_T,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=U.derToOid(n.encryptionOid),a=ye.pbe.getCipher(o,n.encryptionParams,e),c=ee.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=U.fromDer(a.output)),r};ye.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:U.toDer(t).getBytes()};return ee.pem.encode(r,{maxline:e})};ye.encryptedPrivateKeyFromPem=function(t){var e=ee.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return U.fromDer(e.body)};ye.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=ye.wrapRsaPrivateKey(ye.privateKeyToAsn1(t));return n=ye.encryptPrivateKeyInfo(n,e,r),ye.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=ee.random.getBytesSync(8),a=ee.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=ee.random.getBytesSync(8),a=ee.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=ee.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(U.toDer(ye.privateKeyToAsn1(t))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:ee.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return ee.pem.encode(f)};ye.decryptRsaPrivateKey=function(t,e){var r=null,n=ee.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=ee.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=ee.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=ee.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=ee.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=ee.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(f){return ee.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,o=function(f){return ee.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,o=function(f){return ee.rc2.createDecryptionCipher(f,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=ee.util.hexToBytes(n.dekInfo.parameters),c=ee.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(ee.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=ye.decryptPrivateKeyInfo(U.fromDer(r),e):r=U.fromDer(r),r!==null&&(r=ye.privateKeyFromAsn1(r)),r};ye.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in ee.md))throw new Error('"sha1" hash algorithm unavailable.');s=ee.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new ee.util.ByteBuffer,f=new ee.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)f.putInt16(t.charCodeAt(a));f.putInt16(0)}var d=f.length(),p=e.length(),h=new ee.util.ByteBuffer;h.fillWithByte(r,u);var g=u*Math.ceil(p/u),v=new ee.util.ByteBuffer;for(a=0;a<g;a++)v.putByte(e.at(a%p));var _=u*Math.ceil(d/u),B=new ee.util.ByteBuffer;for(a=0;a<_;a++)B.putByte(f.at(a%d));var L=v;L.putBuffer(B);for(var z=Math.ceil(i/c),q=1;q<=z;q++){var k=new ee.util.ByteBuffer;k.putBytes(h.bytes()),k.putBytes(L.bytes());for(var te=0;te<n;te++)s.start(),s.update(k.getBytes()),k=s.digest();var se=new ee.util.ByteBuffer;for(a=0;a<u;a++)se.putByte(k.at(a%c));var j=Math.ceil(p/u)+Math.ceil(d/u),_e=new ee.util.ByteBuffer;for(o=0;o<j;o++){var ge=new ee.util.ByteBuffer(L.getBytes(u)),pe=511;for(a=se.length()-1;a>=0;a--)pe=pe>>8,pe+=se.at(a)+ge.at(a),ge.setAt(a,pe&255);_e.putBuffer(ge)}L=_e,l.putBuffer(k)}return l.truncate(l.length()-i),l};ye.pbe.getCipher=function(t,e,r){switch(t){case ye.oids.pkcs5PBES2:return ye.pbe.getCipherForPBES2(t,e,r);case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:return ye.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};ye.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!U.validate(e,AT,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=U.derToOid(n.kdfOid),t!==ye.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=U.derToOid(n.encOid),t!==ye.oids["aes128-CBC"]&&t!==ye.oids["aes192-CBC"]&&t!==ye.oids["aes256-CBC"]&&t!==ye.oids["des-EDE3-CBC"]&&t!==ye.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=ee.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(ye.oids[t]){case"aes128-CBC":c=16,u=ee.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=ee.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=ee.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=ee.des.createDecryptionCipher;break;case"desCBC":c=8,u=ee.des.createDecryptionCipher;break}var l=ty(n.prfOid),f=ee.pkcs5.pbkdf2(r,o,a,c,l),d=n.encIv,p=u(f);return p.start(d),p};ye.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!U.validate(e,CT,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=ee.util.createBuffer(n.salt),a=ee.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=ee.des.startDecrypting;break;case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(g,v){var _=ee.rc2.createDecryptionCipher(g,40);return _.start(v,null),_};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var f=ty(n.prfOid),d=ye.pbe.generatePkcs12Key(r,o,1,a,c,f);f.start();var p=ye.pbe.generatePkcs12Key(r,o,2,a,u,f);return l(d,p)};ye.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in ee.md))throw new Error('"md5" hash algorithm unavailable.');n=ee.md.md5.create()}e===null&&(e="");for(var i=[ey(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(ey(n,i[o-1]+t+e));return i.join("").substr(0,r)};function ey(t,e){return t.start().update(e).digest().getBytes()}function ty(t){var e;if(!t)e="hmacWithSHA1";else if(e=ye.oids[U.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return ry(e)}function ry(t){var e=ee.md;switch(t){case"hmacWithSHA224":e=ee.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function IT(t,e,r,n){var i=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,t),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,ee.util.hexToBytes(r.toString(16))),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ye.oids[n]).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])),i}});var bl={};pt(bl,{identity:()=>TT});var TT,iy=Pe(()=>{Ar();yn();TT=Ia({prefix:"\0",name:"identity",encode:t=>q0(t),decode:t=>k0(t)})});var El={};pt(El,{base2:()=>RT});var RT,sy=Pe(()=>{Ar();RT=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var wl={};pt(wl,{base8:()=>BT});var BT,oy=Pe(()=>{Ar();BT=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var Sl={};pt(Sl,{base10:()=>PT});var PT,ay=Pe(()=>{Ar();PT=gn({prefix:"9",name:"base10",alphabet:"0123456789"})});var xo,cy,rc=Pe(()=>{Hi();xo=({name:t,code:e,encode:r})=>new cy(t,e,r),cy=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return uo(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var Tn={};pt(Tn,{sha256:()=>NT,sha512:()=>DT});var ly,NT,DT,ci=Pe(()=>{rc();ly=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),NT=xo({name:"sha2-256",code:18,encode:ly("SHA-256")}),DT=xo({name:"sha2-512",code:19,encode:ly("SHA-512")})});var _o={};pt(_o,{identity:()=>OT});var OT,nc=Pe(()=>{rc();yn();OT=xo({name:"identity",code:0,encode:t=>Qr(t)})});var fy=Pe(()=>{yn()});var SL,xL,dy=Pe(()=>{SL=new TextEncoder,xL=new TextDecoder});var hy=Pe(()=>{Gi();Ca();yn();rc();Hi()});var xl,IL,py=Pe(()=>{iy();sy();oy();ay();ku();Jn();Lu();vn();po();ci();nc();fy();dy();hy();xl={...bl,...El,...wl,...Sl,...Pa,...Zn,...Ba,...mn,...Yi},IL={...Tn,..._o}});function yy(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var gy,_l,qT,ic,Al=Pe(()=>{py();gy=yy("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),_l=yy("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),qT={utf8:gy,"utf-8":gy,hex:xl.base16,latin1:_l,ascii:_l,binary:_l,...xl},ic=qT});var At={};pt(At,{fromString:()=>Cl});function Cl(t,e="utf8"){let r=ic[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var St=Pe(()=>{Al()});var Rn={};pt(Rn,{concat:()=>UT});function UT(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var Bn=Pe(()=>{});var Ao=S(my=>{"use strict";my.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var Il=S((DL,by)=>{"use strict";var{concat:MT}=(Bn(),Rn),{fromString:vy}=(St(),At),FT=Ao();function KT({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:s=32767}={}){let o=FT.get();r*=8;async function a(u,l){let f=o.getRandomValues(new Uint8Array(i)),d=o.getRandomValues(new Uint8Array(e)),p={name:t,iv:d},h={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},g=await o.subtle.importKey("raw",vy(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(h,g,{name:t,length:r},!0,["encrypt"]),_=await o.subtle.encrypt(p,v,u);return MT([f,p.iv,new Uint8Array(_)])}async function c(u,l){let f=u.slice(0,i),d=u.slice(i,i+e),p=u.slice(i+e),h={name:t,iv:d},g={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},v=await o.subtle.importKey("raw",vy(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_=await o.subtle.deriveKey(g,v,{name:t,length:r},!0,["decrypt"]),B=await o.subtle.decrypt(h,_,p);return new Uint8Array(B)}return{encrypt:a,decrypt:c}}by.exports={create:KT}});var wy=S((OL,Ey)=>{"use strict";var{base64:VT}=(po(),Yi),jT=Il();Ey.exports={import:async function(t,e){let r=VT.decode(t);return await jT.create().decrypt(r,e)}}});var Lr={};pt(Lr,{equals:()=>$T});function $T(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var kr=Pe(()=>{});var Ct={};pt(Ct,{toString:()=>Tl});function Tl(t,e="utf8"){let r=ic[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var xt=Pe(()=>{Al()});var Pl=S((kL,Ay)=>{var $e=Ee();An();Ke();var Co=Ay.exports=$e.sha512=$e.sha512||{};$e.md.sha512=$e.md.algorithms.sha512=Co;var Sy=$e.sha384=$e.sha512.sha384=$e.sha512.sha384||{};Sy.create=function(){return Co.create("SHA-384")};$e.md.sha384=$e.md.algorithms.sha384=Sy;$e.sha512.sha256=$e.sha512.sha256||{create:function(){return Co.create("SHA-512/256")}};$e.md["sha512/256"]=$e.md.algorithms["sha512/256"]=$e.sha512.sha256;$e.sha512.sha224=$e.sha512.sha224||{create:function(){return Co.create("SHA-512/224")}};$e.md["sha512/224"]=$e.md.algorithms["sha512/224"]=$e.sha512.sha224;Co.create=function(t){if(xy||HT(),typeof t=="undefined"&&(t="SHA-512"),!(t in ui))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=ui[t],r=null,n=$e.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=$e.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=$e.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=a.fullMessageLength.length-1;f>=0;--f)a.fullMessageLength[f]+=l[1],l[1]=l[0]+(a.fullMessageLength[f]/4294967296>>>0),a.fullMessageLength[f]=a.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return n.putBytes(c),_y(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=$e.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(Rl.substr(0,a.blockLength-l));for(var f,d,p=a.fullMessageLength[0]*8,h=0;h<a.fullMessageLength.length-1;++h)f=a.fullMessageLength[h+1]*8,d=f/4294967296>>>0,p+=d,c.putInt32(p>>>0),p=f>>>0;c.putInt32(p);for(var g=new Array(r.length),h=0;h<r.length;++h)g[h]=r[h].slice(0);_y(g,i,c);var v=$e.util.createBuffer(),_;t==="SHA-512"?_=g.length:t==="SHA-384"?_=g.length-2:_=g.length-4;for(var h=0;h<_;++h)v.putInt32(g[h][0]),(h!==_-1||t!=="SHA-512/224")&&v.putInt32(g[h][1]);return v},a};var Rl=null,xy=!1,Bl=null,ui=null;function HT(){Rl=String.fromCharCode(128),Rl+=$e.util.fillString(String.fromCharCode(0),128),Bl=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],ui={},ui["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],ui["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],ui["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],ui["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],xy=!0}function _y(t,e,r){for(var n,i,s,o,a,c,u,l,f,d,p,h,g,v,_,B,L,z,q,k,te,se,j,_e,ge,pe,Je,et,Ae,qe,re,Ht,qt,Wr,Ut,$=r.length();$>=128;){for(Ae=0;Ae<16;++Ae)e[Ae][0]=r.getInt32()>>>0,e[Ae][1]=r.getInt32()>>>0;for(;Ae<80;++Ae)Ht=e[Ae-2],qe=Ht[0],re=Ht[1],n=((qe>>>19|re<<13)^(re>>>29|qe<<3)^qe>>>6)>>>0,i=((qe<<13|re>>>19)^(re<<3|qe>>>29)^(qe<<26|re>>>6))>>>0,Wr=e[Ae-15],qe=Wr[0],re=Wr[1],s=((qe>>>1|re<<31)^(qe>>>8|re<<24)^qe>>>7)>>>0,o=((qe<<31|re>>>1)^(qe<<24|re>>>8)^(qe<<25|re>>>7))>>>0,qt=e[Ae-7],Ut=e[Ae-16],re=i+qt[1]+o+Ut[1],e[Ae][0]=n+qt[0]+s+Ut[0]+(re/4294967296>>>0)>>>0,e[Ae][1]=re>>>0;for(g=t[0][0],v=t[0][1],_=t[1][0],B=t[1][1],L=t[2][0],z=t[2][1],q=t[3][0],k=t[3][1],te=t[4][0],se=t[4][1],j=t[5][0],_e=t[5][1],ge=t[6][0],pe=t[6][1],Je=t[7][0],et=t[7][1],Ae=0;Ae<80;++Ae)u=((te>>>14|se<<18)^(te>>>18|se<<14)^(se>>>9|te<<23))>>>0,l=((te<<18|se>>>14)^(te<<14|se>>>18)^(se<<23|te>>>9))>>>0,f=(ge^te&(j^ge))>>>0,d=(pe^se&(_e^pe))>>>0,a=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,c=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,p=(g&_|L&(g^_))>>>0,h=(v&B|z&(v^B))>>>0,re=et+l+d+Bl[Ae][1]+e[Ae][1],n=Je+u+f+Bl[Ae][0]+e[Ae][0]+(re/4294967296>>>0)>>>0,i=re>>>0,re=c+h,s=a+p+(re/4294967296>>>0)>>>0,o=re>>>0,Je=ge,et=pe,ge=j,pe=_e,j=te,_e=se,re=k+i,te=q+n+(re/4294967296>>>0)>>>0,se=re>>>0,q=L,k=z,L=_,z=B,_=g,B=v,re=i+o,g=n+s+(re/4294967296>>>0)>>>0,v=re>>>0;re=t[0][1]+v,t[0][0]=t[0][0]+g+(re/4294967296>>>0)>>>0,t[0][1]=re>>>0,re=t[1][1]+B,t[1][0]=t[1][0]+_+(re/4294967296>>>0)>>>0,t[1][1]=re>>>0,re=t[2][1]+z,t[2][0]=t[2][0]+L+(re/4294967296>>>0)>>>0,t[2][1]=re>>>0,re=t[3][1]+k,t[3][0]=t[3][0]+q+(re/4294967296>>>0)>>>0,t[3][1]=re>>>0,re=t[4][1]+se,t[4][0]=t[4][0]+te+(re/4294967296>>>0)>>>0,t[4][1]=re>>>0,re=t[5][1]+_e,t[5][0]=t[5][0]+j+(re/4294967296>>>0)>>>0,t[5][1]=re>>>0,re=t[6][1]+pe,t[6][0]=t[6][0]+ge+(re/4294967296>>>0)>>>0,t[6][1]=re>>>0,re=t[7][1]+et,t[7][0]=t[7][0]+Je+(re/4294967296>>>0)>>>0,t[7][1]=re>>>0,$-=128}}});var Iy=S((qL,Cy)=>{"use strict";var sc=65536;function zT(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>sc)for(;r<t;)r+sc>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+sc)),r+=sc);else crypto.getRandomValues(e);return e}Cy.exports=zT});var oc=S((UL,Ty)=>{"use strict";var GT=Iy(),YT=he();Ty.exports=function(t){if(isNaN(t)||t<=0)throw YT(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return GT(t)}});var ac=S(Io=>{"use strict";Ke();Ja();var WT=Ee(),{fromString:QT}=(St(),At),{toString:Ry}=(xt(),Ct),{concat:By}=(Bn(),Rn);Io.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=By([new Uint8Array(e-r.length),r])}return Ry(r,"base64url")};Io.base64urlToBigInteger=t=>{let e=Io.base64urlToBuffer(t);return new WT.jsbn.BigInteger(Ry(e,"base16"),16)};Io.base64urlToBuffer=(t,e)=>{let r=QT(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=By([new Uint8Array(e-r.length),r])}return r}});var Dy=S(To=>{"use strict";_n();So();var Pn=Ee(),{bigIntegerToUintBase64url:qr,base64urlToBigInteger:Ur}=ac(),{fromString:Py}=(St(),At),{toString:Ny}=(xt(),Ct);To.pkcs1ToJwk=function(t){let e=Pn.asn1.fromDer(Ny(t,"ascii")),r=Pn.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:qr(r.n),e:qr(r.e),d:qr(r.d),p:qr(r.p),q:qr(r.q),dp:qr(r.dP),dq:qr(r.dQ),qi:qr(r.qInv),alg:"RS256",kid:"2011-04-29"}};To.jwkToPkcs1=function(t){let e=Pn.pki.privateKeyToAsn1({n:Ur(t.n),e:Ur(t.e),d:Ur(t.d),p:Ur(t.p),q:Ur(t.q),dP:Ur(t.dp),dQ:Ur(t.dq),qInv:Ur(t.qi)});return Py(Pn.asn1.toDer(e).getBytes(),"ascii")};To.pkixToJwk=function(t){let e=Pn.asn1.fromDer(Ny(t,"ascii")),r=Pn.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:qr(r.n),e:qr(r.e),alg:"RS256",kid:"2011-04-29"}};To.jwkToPkix=function(t){let e=Pn.pki.publicKeyToAsn1({n:Ur(t.n),e:Ur(t.e)});return Py(Pn.asn1.toDer(e).getBytes(),"ascii")}});var qy=S((KL,ky)=>{"use strict";So();var Oy=Ee(),{base64urlToBigInteger:XT}=ac();function Ly(t,e){return e.map(r=>XT(t[r]))}function ZT(t){return Oy.pki.setRsaPrivateKey(...Ly(t,["n","e","d","p","q","dp","dq","qi"]))}function JT(t){return Oy.pki.setRsaPublicKey(...Ly(t,["n","e"]))}ky.exports={jwk2pub:JT,jwk2priv:ZT}});var Fy=S(rn=>{"use strict";var tn=Ao(),eR=oc(),{toString:tR}=(xt(),Ct),{fromString:rR}=(St(),At);rn.utils=Dy();rn.generateKey=async function(t){let e=await tn.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Uy(e);return{privateKey:r[0],publicKey:r[1]}};rn.unmarshalPrivateKey=async function(t){let r=[await tn.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await nR(t)],n=await Uy({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};rn.getRandomValues=eR;rn.hashAndSign=async function(t,e){let r=await tn.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await tn.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};rn.hashAndVerify=async function(t,e,r){let n=await tn.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return tn.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function Uy(t){return Promise.all([tn.get().subtle.exportKey("jwk",t.privateKey),tn.get().subtle.exportKey("jwk",t.publicKey)])}function nR(t){return tn.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:iR,jwk2priv:sR}=qy();function My(t,e,r,n){let i=e?iR(t):sR(t),s=tR(Uint8Array.from(r),"ascii"),o=n(s,i);return rR(o,"ascii")}rn.encrypt=function(t,e){return My(t,!0,e,(r,n)=>n.encrypt(r))};rn.decrypt=function(t,e){return My(t,!1,e,(r,n)=>n.decrypt(r))}});var cc=S((jL,Ky)=>{"use strict";var{base64:oR}=(po(),Yi),aR=Il();Ky.exports={export:async function(t,e){let n=await aR.create().encrypt(t,e);return oR.encode(n)}}});var zy=S(($L,Hy)=>{"use strict";var{sha256:Vy}=(ci(),Tn),jy=he(),{equals:$y}=(kr(),Lr),{toString:cR}=(xt(),Ct);Pl();var uc=Ee(),ir=Fy(),lc=qa(),uR=cc(),fc=class{constructor(e){this._key=e}async verify(e,r){return ir.hashAndVerify(this._key,r,e)}marshal(){return ir.utils.jwkToPkix(this._key)}get bytes(){return lc.PublicKey.encode({Type:lc.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return ir.encrypt(this._key,e)}equals(e){return $y(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vy.digest(this.bytes);return e}},Ro=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return ir.getRandomValues(16)}async sign(e){return ir.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw jy(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new fc(this._publicKey)}decrypt(e){return ir.decrypt(this._key,e)}marshal(){return ir.utils.jwkToPkcs1(this._key)}get bytes(){return lc.PrivateKey.encode({Type:lc.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return $y(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vy.digest(this.bytes);return e}async id(){let e=await this.public.hash();return cR(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new uc.util.ByteBuffer(this.marshal()),i=uc.asn1.fromDer(n),s=uc.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return uc.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return uR.export(this.bytes,e);throw jy(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function lR(t){let e=ir.utils.pkcs1ToJwk(t),r=await ir.unmarshalPrivateKey(e);return new Ro(r.privateKey,r.publicKey)}function fR(t){let e=ir.utils.pkixToJwk(t);return new fc(e)}async function dR(t){let e=await ir.unmarshalPrivateKey(t);return new Ro(e.privateKey,e.publicKey)}async function hR(t){let e=await ir.generateKey(t);return new Ro(e.privateKey,e.publicKey)}Hy.exports={RsaPublicKey:fc,RsaPrivateKey:Ro,unmarshalRsaPublicKey:fR,unmarshalRsaPrivateKey:lR,generateKeyPair:hR,fromJwk:dR}});var eg=S((Ye,Jy)=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.utils=Ye.verify=Ye.sign=Ye.getPublicKey=Ye.SignResult=Ye.Signature=Ye.Point=Ye.ExtendedPoint=Ye.CURVE=void 0;var tt={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,P:2n**255n-19n,n:2n**252n+27742317777372353535851937790883648493n,h:8n,Gx:15112221349535400772501151409588531511454012693041857206046113283949847762202n,Gy:46316835694926478169428394003475163141307993866256225615783033603165251855960n};Ye.CURVE=tt;var Ot=32,Bo=19681161376707505956807079304988542015446066515923890162744021073123829784752n,pR=25063068953384623474111414158702152701244531502492656460079210482610430750235n,yR=54469307008909316920995813868745141605393597292927456921205312896311721017578n,gR=1159843021668779879193775521855586647937357759715417654439879720876111806838n,mR=40440834346308536858101042469323190826248399146238708352240133220865137265952n,Me=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof Ge))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Ge.ZERO)?Me.ZERO:new Me(e.x,e.y,1n,V(e.x*e.y))}static toAffineBatch(e){let r=bR(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}static fromRistrettoHash(e){let r=Ol(e.slice(0,Ot)),n=this.calcElligatorRistrettoMap(r),i=Ol(e.slice(Ot,Ot*2)),s=this.calcElligatorRistrettoMap(i);return n.add(s)}static calcElligatorRistrettoMap(e){let{d:r}=tt,n=V(Bo*e*e),i=V((n+1n)*gR),s=-1n,o=V((s-r*n)*V(n+r)),{isValid:a,value:c}=kl(i,o),u=V(c*e);Dn(u)||(u=V(-u)),a||(c=u),a||(s=n);let l=V(s*(n-1n)*mR-o),f=c*c,d=V((c+c)*o),p=V(l*pR),h=V(1n-f),g=V(1n+f);return new Me(V(d*g),V(h*p),V(p*g),V(d*h))}static fromRistrettoBytes(e){let{a:r,d:n}=tt,i="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",s=Ol(e);if(!SR(Yy(s,Ot),e)||Dn(s))throw new Error(i);let o=V(s*s),a=V(1n+r*o),c=V(1n-r*o),u=V(a*a),l=V(c*c),f=V(r*n*u-l),{isValid:d,value:p}=Qy(V(f*l)),h=V(p*c),g=V(p*h*f),v=V((s+s)*h);Dn(v)&&(v=V(-v));let _=V(a*g),B=V(v*_);if(!d||Dn(B)||_===0n)throw new Error(i);return new Me(v,_,1n,B)}toRistrettoBytes(){let{x:e,y:r,z:n,t:i}=this,s=V((n+r)*(n-r)),o=V(e*r),{value:a}=Qy(V(s*o**2n)),c=V(a*s),u=V(a*o),l=V(c*u*i),f;Dn(i*l)?([e,r]=[V(r*Bo),V(e*Bo)],f=V(c*yR)):f=u,Dn(e*l)&&(r=V(-r));let d=V((n-r)*f);return Dn(d)&&(d=V(-d)),Yy(d,Ot)}equals(e){let r=this,n=e,[i,s,o,a]=[r.t,n.t,r.z,n.z];return V(i*a)===V(s*o)}negate(){return new Me(V(-this.x),this.y,this.z,V(-this.t))}double(){let e=this.x,r=this.y,n=this.z,{a:i}=tt,s=V(e**2n),o=V(r**2n),a=V(2n*n**2n),c=V(i*s),u=V((e+r)**2n-s-o),l=V(c+o),f=V(l-a),d=V(c-o),p=V(u*f),h=V(l*d),g=V(u*d),v=V(f*l);return new Me(p,h,v,g)}add(e){let r=this.x,n=this.y,i=this.z,s=this.t,o=e.x,a=e.y,c=e.z,u=e.t,l=V((n-r)*(a+o)),f=V((n+r)*(a-o)),d=V(f-l);if(d===0n)return this.double();let p=V(i*2n*u),h=V(s*2n*c),g=V(h+p),v=V(f+l),_=V(h-p),B=V(g*d),L=V(v*_),z=V(g*_),q=V(d*v);return new Me(B,L,q,z)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){if(!Wy(e))throw new TypeError("Point#multiply: expected number or bigint");let r=V(BigInt(e),tt.n);if(r===1n)return this;let n=Me.ZERO,i=this;for(;r>0n;)r&1n&&(n=n.add(i)),i=i.double(),r>>=1n;return n}precomputeWindow(e){let r=256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Me.BASE)&&(r=Ge.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Nl.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Me.normalizeZ(i),Nl.set(r,i)));let s=Me.ZERO,o=Me.ZERO,a=256/n+1,c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let d=0;d<a;d++){let p=d*c,h=Number(e&u);if(e>>=f,h>c&&(h-=l,e+=1n),h===0)o=o.add(d%2?i[p].negate():i[p]);else{let g=i[p+Math.abs(h)-1];s=s.add(h<0?g.negate():g)}}return[s,o]}multiply(e,r){if(!Wy(e))throw new TypeError("Point#multiply: expected number or bigint");let n=V(BigInt(e),tt.n);return Me.normalizeZ(this.wNAF(n,r))[0]}toAffine(e=Ll(this.z)){let r=V(this.x*e),n=V(this.y*e);return new Ge(r,n)}};Ye.ExtendedPoint=Me;Me.BASE=new Me(tt.Gx,tt.Gy,1n,V(tt.Gx*tt.Gy));Me.ZERO=new Me(0n,1n,1n,0n);var Nl=new WeakMap,Ge=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Nl.delete(this)}static fromHex(e){let{d:r,P:n}=tt,i=e instanceof Uint8Array?e:Po(e);if(i.length!==32)throw new Error("Point.fromHex: expected 32 bytes");let s=i[31],o=s&~128,a=(s&128)!=0,c=Uint8Array.from(Array.from(i.slice(0,31)).concat(o)),u=ns(c);if(u>=n)throw new Error("Point.fromHex expects hex <= Fp");let l=V(u*u),f=V(l-1n),d=V(r*l+1n),{isValid:p,value:h}=kl(f,d);if(!p)throw new Error("Point.fromHex: invalid y coordinate");let g=(h&1n)===1n;return a!==g&&(h=V(-h)),new Ge(h,u)}static async fromPrivateKey(e){let r=await Ye.utils.sha512(Zy(e));return Ge.BASE.multiply(Xy(r))}toRawBytes(){let e=Dl(this.y),r=new Uint8Array(Ot);for(let i=e.length-2,s=0;s<Ot&&i>=0;i-=2,s++)r[s]=Number.parseInt(e[i]+e[i+1],16);let n=this.x&1n?128:0;return r[Ot-1]|=n,r}toHex(){return Gy(this.toRawBytes())}toX25519(){return V((1n+this.y)*Ll(1n-this.y))}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Ge(V(-this.x),this.y)}add(e){return Me.fromAffine(this).add(Me.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Me.fromAffine(this).multiply(e,this).toAffine()}};Ye.Point=Ge;Ge.BASE=new Ge(tt.Gx,tt.Gy);Ge.ZERO=new Ge(0n,1n);var Nn=class{constructor(e,r){this.r=e,this.s=r}static fromHex(e){e=Ul(e);let r=Ge.fromHex(e.slice(0,32)),n=ns(e.slice(32));if(!xR(n))throw new Error("Signature.fromHex expects s <= CURVE.n");return new Nn(r,n)}toRawBytes(){let e=Po(Dl(this.s)).reverse(),r=new Uint8Array(Ot);r.set(e);let n=new Uint8Array(Ot*2);return n.set(this.r.toRawBytes()),n.set(r,32),n}toHex(){return Gy(this.toRawBytes())}};Ye.Signature=Nn;Ye.SignResult=Nn;function vR(...t){if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function Gy(t){let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e}function Po(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2;e[r]=Number.parseInt(t.slice(n,n+2),16)}return e}function Dl(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Yy(t,e=Ot){let r=Dl(t).padStart(e*2,"0");return Po(r).reverse()}function Dn(t){return(V(t)&1n)===1n}function Wy(t){return!!(typeof t=="bigint"&&t>0n||typeof t=="number"&&t>0&&Number.isSafeInteger(t))}function ns(t){let e=0n;for(let r=0;r<t.length;r++)e+=BigInt(t[r])<<8n*BigInt(r);return e}function Ol(t){return V(ns(t)&2n**255n-1n)}function V(t,e=tt.P){let r=t%e;return r>=0n?r:e+r}function Ll(t,e=tt.P){if(t===0n||e<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=V(t,e),n=e,[i,s,o,a]=[0n,1n,1n,0n];for(;r!==0n;){let u=n/r,l=n%r,f=i-o*u,d=s-a*u;[n,r]=[r,l],[i,s]=[o,a],[o,a]=[f,d]}if(n!==1n)throw new Error("invert: does not exist");return V(i,e)}function bR(t,e=tt.P){let r=t.length,n=new Array(r),i=1n;for(let s=0;s<r;s++)t[s]!==0n&&(n[s]=i,i=V(i*t[s],e));i=Ll(i,e);for(let s=r-1;s>=0;s--){if(t[s]===0n)continue;let o=V(i*t[s],e);t[s]=V(i*n[s],e),i=o}return t}function Mr(t,e){let{P:r}=tt,n=t;for(;e-- >0n;)n*=n,n%=r;return n}function ER(t){let{P:e}=tt,n=t*t%e*t%e,i=Mr(n,2n)*n%e,s=Mr(i,1n)*t%e,o=Mr(s,5n)*s%e,a=Mr(o,10n)*o%e,c=Mr(a,20n)*a%e,u=Mr(c,40n)*c%e,l=Mr(u,80n)*u%e,f=Mr(l,80n)*u%e,d=Mr(f,10n)*o%e;return Mr(d,2n)*t%e}function kl(t,e){let r=V(e*e*e),n=V(r*r*e),i=V(t*r*ER(t*n)),s=V(e*i*i),o=i,a=V(i*Bo),c=s===t,u=s===V(-t),l=s===V(-t*Bo);return c&&(i=o),(u||l)&&(i=a),Dn(i)&&(i=V(-i)),{isValid:c||u,value:i}}function Qy(t){return kl(1n,t)}async function ql(...t){let e=vR(...t),r=await Ye.utils.sha512(e),n=ns(r);return V(n,tt.n)}function wR(t){return t.slice(Ot)}function Xy(t){let e=Ot-1,r=t.slice(0,Ot);return r[0]&=248,r[e]&=127,r[e]|=64,V(ns(r),tt.n)}function SR(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ul(t){return t instanceof Uint8Array?t:Po(t)}function xR(t){return 0<t&&t<tt.n}function Zy(t){let e;if(typeof t=="bigint"||typeof t=="number"&&Number.isSafeInteger(t)){if(e=BigInt(t),e<0n||e>2n**256n)throw new Error("Expected 32 bytes of private key");t=e.toString(16).padStart(Ot*2,"0")}if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");return Po(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");return t}else throw new TypeError("Expected valid private key")}async function _R(t){let e=await Ge.fromPrivateKey(t);return typeof t=="string"?e.toHex():e.toRawBytes()}Ye.getPublicKey=_R;async function AR(t,e){let r=await Ye.utils.sha512(Zy(e)),n=Xy(r),i=Ge.BASE.multiply(n),s=Ul(t),o=await ql(wR(r),s),a=Ge.BASE.multiply(o),c=await ql(a.toRawBytes(),i.toRawBytes(),s),u=V(o+c*n,tt.n),l=new Nn(a,u);return typeof t=="string"?l.toHex():l.toRawBytes()}Ye.sign=AR;async function CR(t,e,r){e=Ul(e),r instanceof Ge||(r=Ge.fromHex(r)),t instanceof Nn||(t=Nn.fromHex(t));let n=await ql(t.r.toRawBytes(),r.toRawBytes(),e),i=Me.fromAffine(r).multiplyUnsafe(n),s=Me.BASE.multiply(t.s);return Me.fromAffine(t.r).add(i).subtract(s).multiplyUnsafe(8n).equals(Me.ZERO)}Ye.verify=CR;Ge.BASE._setWindowSize(8);var On=(()=>{let t=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof Jy!="undefined"&&typeof qi=="function"&&!t?es():void 0,web:t}})();Ye.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],randomBytes:(t=32)=>{if(On.web)return On.web.getRandomValues(new Uint8Array(t));if(On.node){let{randomBytes:e}=On.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=1024;for(;t--;){let e=Ye.utils.randomBytes(32),r=ns(e);if(r>1n&&r<tt.n)return e}throw new Error("Valid private key was not found in 1024 iterations. PRNG is broken")},sha512:async t=>{if(On.web){let e=await On.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(On.node)return Uint8Array.from(On.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Ge.BASE){let r=e.equals(Ge.BASE)?e:new Ge(e.x,e.y);return r._setWindowSize(t),r.multiply(1n),r}}});var rg=S(Ln=>{"use strict";var No=eg(),IR=32,TR=64,dc=32;Ln.publicKeyLength=IR;Ln.privateKeyLength=TR;Ln.generateKey=async function(){let t=No.utils.randomPrivateKey(),e=await No.getPublicKey(t);return{privateKey:tg(t,e),publicKey:e}};Ln.generateKeyFromSeed=async function(t){if(t.length!==dc)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await No.getPublicKey(e);return{privateKey:tg(e,r),publicKey:r}};Ln.hashAndSign=function(t,e){let r=t.slice(0,dc);return No.sign(e,r)};Ln.hashAndVerify=function(t,e,r){return No.verify(e,r,t)};function tg(t,e){let r=new Uint8Array(Ln.privateKeyLength);for(let n=0;n<dc;n++)r[n]=t[n],r[dc+n]=e[n];return r}});var ag=S((zL,og)=>{"use strict";var ng=he(),{equals:ig}=(kr(),Lr),{sha256:sg}=(ci(),Tn),{base58btc:RR}=(vn(),mn),{identity:BR}=(nc(),_o),It=rg(),hc=qa(),PR=cc(),pc=class{constructor(e){this._key=ss(e,It.publicKeyLength)}async verify(e,r){return It.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return hc.PublicKey.encode({Type:hc.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return ig(this.bytes,e.bytes)}async hash(){let{bytes:e}=await sg.digest(this.bytes);return e}},is=class{constructor(e,r){this._key=ss(e,It.privateKeyLength),this._publicKey=ss(r,It.publicKeyLength)}async sign(e){return It.hashAndSign(this._key,e)}get public(){return new pc(this._publicKey)}marshal(){return this._key}get bytes(){return hc.PrivateKey.encode({Type:hc.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return ig(this.bytes,e.bytes)}async hash(){let{bytes:e}=await sg.digest(this.bytes);return e}async id(){let e=await BR.digest(this.public.bytes);return RR.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return PR.export(this.bytes,e);throw ng(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function NR(t){if(t.length>It.privateKeyLength){t=ss(t,It.privateKeyLength+It.publicKeyLength);let n=t.slice(0,It.privateKeyLength),i=t.slice(It.privateKeyLength,t.length);return new is(n,i)}t=ss(t,It.privateKeyLength);let e=t.slice(0,It.privateKeyLength),r=t.slice(It.publicKeyLength);return new is(e,r)}function DR(t){return t=ss(t,It.publicKeyLength),new pc(t)}async function OR(){let{privateKey:t,publicKey:e}=await It.generateKey();return new is(t,e)}async function LR(t){let{privateKey:e,publicKey:r}=await It.generateKeyFromSeed(t);return new is(e,r)}function ss(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw ng(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}og.exports={Ed25519PublicKey:pc,Ed25519PrivateKey:is,unmarshalEd25519PrivateKey:NR,unmarshalEd25519PublicKey:DR,generateKeyPair:OR,generateKeyPairFromSeed:LR}});var Sg=S((Be,wg)=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.utils=Be.schnorr=Be.verify=Be.signSync=Be.sign=Be.getSharedSecret=Be.recoverPublicKey=Be.getPublicKey=Be.SignResult=Be.Signature=Be.Point=Be.CURVE=void 0;var Oe={a:0n,b:7n,P:2n**256n-2n**32n-977n,n:2n**256n-432420386565659656852420866394968145599n,h:1n,Gx:55066263022277343669578718895168534326250603453777594175500187360389116729240n,Gy:32670510020758816978083085130507043184471273380659243275938904335757337482424n,beta:0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501een};Be.CURVE=Oe;function cg(t){let{a:e,b:r}=Oe;return ne(t**3n+e*t+r)}var yc=Oe.a===0n,Re=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof Le))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Re(e.x,e.y,1n)}static toAffineBatch(e){let r=qR(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Re.toAffineBatch(e).map(Re.fromAffine)}equals(e){let r=this,n=e,i=ne(r.z*r.z),s=ne(r.z*i),o=ne(n.z*n.z),a=ne(n.z*o);return ne(r.x*o)===ne(i*n.x)&&ne(r.y*a)===ne(s*n.y)}negate(){return new Re(this.x,ne(-this.y),this.z)}double(){let e=this.x,r=this.y,n=this.z,i=ne(e**2n),s=ne(r**2n),o=ne(s**2n),a=ne(2n*(ne(ne((e+s)**2n))-i-o)),c=ne(3n*i),u=ne(c**2n),l=ne(u-2n*a),f=ne(c*(a-l)-8n*o),d=ne(2n*r*n);return new Re(l,f,d)}add(e){if(!(e instanceof Re))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,n=this.y,i=this.z,s=e.x,o=e.y,a=e.z;if(s===0n||o===0n)return this;if(r===0n||n===0n)return e;let c=ne(i**2n),u=ne(a**2n),l=ne(r*u),f=ne(s*c),d=ne(n*a*u),p=ne(ne(o*i)*c),h=ne(f-l),g=ne(p-d);if(h===0n)return g===0n?this.double():Re.ZERO;let v=ne(h**2n),_=ne(h*v),B=ne(l*v),L=ne(g**2n-_-2n*B),z=ne(g*(B-L)-d*_),q=ne(i*a*h);return new Re(L,z,q)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){if(!fg(e))throw new TypeError("Point#multiply: expected valid scalar");let r=ne(BigInt(e),Oe.n);if(!yc){let l=Re.ZERO,f=this;for(;r>0n;)r&1n&&(l=l.add(f)),f=f.double(),r>>=1n;return l}let[n,i,s,o]=hg(r),a=Re.ZERO,c=Re.ZERO,u=this;for(;i>0n||o>0n;)i&1n&&(a=a.add(u)),o&1n&&(c=c.add(u)),u=u.double(),i>>=1n,o>>=1n;return n&&(a=a.negate()),s&&(c=c.negate()),c=new Re(ne(c.x*Oe.beta),c.y,c.z),a.add(c)}precomputeWindow(e){let r=yc?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Re.BASE)&&(r=Le.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Ml.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Re.normalizeZ(i),Ml.set(r,i)));let s=Re.ZERO,o=Re.ZERO,a=yc?128/n+1:256/n+1,c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let d=0;d<a;d++){let p=d*c,h=Number(e&u);if(e>>=f,h>c&&(h-=l,e+=1n),h===0)o=o.add(d%2?i[p].negate():i[p]);else{let g=i[p+Math.abs(h)-1];s=s.add(h<0?g.negate():g)}}return[s,o]}multiply(e,r){if(!fg(e))throw new TypeError("Point#multiply: expected valid scalar");let n=ne(BigInt(e),Oe.n),i,s;if(yc){let[o,a,c,u]=hg(n),l,f,d,p;[l,d]=this.wNAF(a,r),[f,p]=this.wNAF(u,r),o&&(l=l.negate()),c&&(f=f.negate()),f=new Re(ne(f.x*Oe.beta),f.y,f.z),[i,s]=[l.add(f),d.add(p)]}else[i,s]=this.wNAF(n,r);return Re.normalizeZ([i,s])[0]}toAffine(e=Lo(this.z)){let r=e**2n,n=ne(this.x*r),i=ne(this.y*r*e);return new Le(n,i)}};Re.BASE=new Re(Oe.Gx,Oe.Gy,1n);Re.ZERO=new Re(0n,1n,0n);var Ml=new WeakMap,Le=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Ml.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=sr(r?e:e.slice(1)),i=cg(n),s=kR(i),o=(s&1n)===1n;r?o&&(s=ne(-s)):(e[0]&1)==1!==o&&(s=ne(-s));let a=new Le(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=sr(e.slice(1,33)),n=sr(e.slice(33)),i=new Le(r,n);return i.assertValidity(),i}static fromHex(e){let r=vc(e),n=r[0];if(r.length===32||r.length===33&&(n===2||n===3))return this.fromCompressedHex(r);if(r.length===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(e){return Le.BASE.multiply(os(e))}static fromSignature(e,r,n){let i=e instanceof Uint8Array?sr(e):sn(e),s=gg(r),{r:o,s:a}=s;if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid yParity bit");let c=2+(n&1),u=Le.fromHex(`0${c}${kn(o)}`),l=Re.fromAffine(u).multiplyUnsafe(a),f=Re.BASE.multiply(i),d=Lo(o,Oe.n),h=l.subtract(f).multiplyUnsafe(d).toAffine();return h.assertValidity(),h}toRawBytes(e=!1){return qn(this.toHex(e))}toHex(e=!1){let r=kn(this.x);return e?`${this.y&1n?"03":"02"}${r}`:`04${r}${kn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{P:r}=Oe,{x:n,y:i}=this;if(n===0n||i===0n||n>=r||i>=r)throw new Error(e);let s=ne(i*i),o=cg(n);if((s-o)%r!==0n)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Le(this.x,ne(-this.y))}double(){return Re.fromAffine(this).double().toAffine()}add(e){return Re.fromAffine(this).add(Re.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Re.fromAffine(this).multiply(e,this).toAffine()}};Be.Point=Le;Le.BASE=new Le(Oe.Gx,Oe.Gy);Le.ZERO=new Le(0n,0n);function ug(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}var nn=class{constructor(e,r){this.r=e,this.s=r}static fromCompact(e){if(typeof e!="string"&&!(e instanceof Uint8Array))throw new TypeError("Signature.fromCompact: Expected string or Uint8Array");let r=e instanceof Uint8Array?gc(e):e;if(r.length!==128)throw new Error("Signature.fromCompact: Expected 64-byte hex");let n=new nn(sn(r.slice(0,64)),sn(r.slice(64,128)));return n.assertValidity(),n}static fromDER(e){let r="Signature.fromDER";if(typeof e!="string"&&!(e instanceof Uint8Array))throw new TypeError(`${r}: Expected string or Uint8Array`);let n=e instanceof Uint8Array?gc(e):e,i=Oo(n.slice(2,4));if(n.slice(0,2)!=="30"||i!==n.length-4||n.slice(4,6)!=="02")throw new Error(`${r}: Invalid signature ${n}`);let s=Oo(n.slice(6,8)),o=8+s,a=n.slice(8,o);if(a.startsWith("00")&&Oo(a.slice(2,4))<=127)throw new Error(`${r}: Invalid r with trailing length`);let c=sn(a);if(n.slice(o,o+2)!=="02")throw new Error(`${r}: Invalid r-s separator`);let l=Oo(n.slice(o+2,o+4)),f=i-l-s-10;if(f>0||f===-4)throw new Error(`${r}: Invalid total length`);if(l>i-s-4)throw new Error(`${r}: Invalid s`);let d=o+4,p=n.slice(d,d+l);if(p.startsWith("00")&&Oo(p.slice(2,4))<=127)throw new Error(`${r}: Invalid s with trailing length`);let h=sn(p),g=new nn(c,h);return g.assertValidity(),g}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!ko(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!ko(r))throw new Error("Invalid Signature: s must be 0 < s < n")}toDERRawBytes(e=!1){return qn(this.toDERHex(e))}toDERHex(e=!1){let r=ug(Do(this.s));if(e)return r;let n=ug(Do(this.r)),i=Do(n.length/2),s=Do(r.length/2);return`30${Do(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return qn(this.toCompactHex())}toCompactHex(){return kn(this.r)+kn(this.s)}};Be.Signature=nn;Be.SignResult=nn;function lg(...t){if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function gc(t){let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e}function kn(t){return t.toString(16).padStart(64,"0")}function mc(t){return qn(kn(t))}function Do(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function sn(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function qn(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2;e[r]=Number.parseInt(t.slice(n,n+2),16)}return e}function vc(t){return t instanceof Uint8Array?t:qn(t)}function sr(t){return sn(gc(t))}function Oo(t){return Number.parseInt(t,16)*2}function fg(t){return!!(typeof t=="bigint"&&t>0n||typeof t=="number"&&t>0&&Number.isSafeInteger(t))}function ne(t,e=Oe.P){let r=t%e;return r>=0?r:e+r}function or(t,e){let{P:r}=Oe,n=t;for(;e-- >0n;)n*=n,n%=r;return n}function kR(t){let{P:e}=Oe,r=t*t*t%e,n=r*r*t%e,i=or(n,3n)*n%e,s=or(i,3n)*n%e,o=or(s,2n)*r%e,a=or(o,11n)*o%e,c=or(a,22n)*a%e,u=or(c,44n)*c%e,l=or(u,88n)*u%e,f=or(l,44n)*c%e,d=or(f,3n)*n%e,p=or(d,23n)*a%e,h=or(p,6n)*r%e;return or(h,2n)}function Lo(t,e=Oe.P){if(t===0n||e<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ne(t,e),n=e,[i,s,o,a]=[0n,1n,1n,0n];for(;r!==0n;){let u=n/r,l=n%r,f=i-o*u,d=s-a*u;[n,r]=[r,l],[i,s]=[o,a],[o,a]=[f,d]}if(n!==1n)throw new Error("invert: does not exist");return ne(i,e)}function qR(t,e=Oe.P){let r=t.length,n=new Array(r),i=1n;for(let s=0;s<r;s++)t[s]!==0n&&(n[s]=i,i=ne(i*t[s],e));i=Lo(i,e);for(let s=r-1;s>=0;s--){if(t[s]===0n)continue;let o=ne(i*t[s],e);t[s]=ne(i*n[s],e),i=o}return t}var dg=(t,e)=>(t+e/2n)/e,bc=2n**128n;function hg(t){let{n:e}=Oe,r=0x3086d221a7d46bcde86c90e49284eb15n,n=-0xe4437ed6010e88286f547fa90abfe4c3n,i=0x114ca50f7a8e2f3f657c1108d9d44cfd8n,s=r,o=dg(s*t,e),a=dg(-n*t,e),c=ne(t-o*r-a*i,e),u=ne(-o*n-a*s,e),l=c>bc,f=u>bc;if(l&&(c=e-c),f&&(u=e-u),c>bc||u>bc)throw new Error("splitScalarEndo: Endomorphism failed");return[l,c,f,u]}function UR(t){typeof t!="string"&&(t=gc(t));let e=sn(t||"0"),n=t.length/2*8-256;return n>0&&(e=e>>BigInt(n)),e>=Oe.n&&(e-=Oe.n),e}function pg(t,e){if(t==null)throw new Error(`sign: expected valid msgHash, not "${t}"`);let r=typeof t=="string"?sn(t):sr(t),n=mc(r),i=sr(n),s=mc(e),o=new Uint8Array(32).fill(1),a=new Uint8Array(32).fill(0),c=Uint8Array.from([0]),u=Uint8Array.from([1]);return[n,i,s,o,a,c,u]}async function MR(t,e){let r=os(e),[n,i,s,o,a,c,u]=pg(t,r),l=Be.utils.hmacSha256;a=await l(a,o,c,s,n),o=await l(a,o),a=await l(a,o,u,s,n),o=await l(a,o);for(let f=0;f<1e3;f++){o=await l(a,o);let d=yg(o,i,r);if(d)return d;a=await l(a,o,c),o=await l(a,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function FR(t,e){let r=os(e),[n,i,s,o,a,c,u]=pg(t,r),l=Be.utils.hmacSha256Sync;if(!l)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");if(a=l(a,o,c,s,n),a instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");o=l(a,o),a=l(a,o,u,s,n),o=l(a,o);for(let f=0;f<1e3;f++){o=l(a,o);let d=yg(o,i,r);if(d)return d;a=l(a,o,c),o=l(a,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function ko(t){return 0<t&&t<Oe.n}function yg(t,e,r){let n=sr(t);if(!ko(n))return;let i=Oe.n,s=Le.BASE.multiply(n),o=ne(s.x,i),a=ne(Lo(n,i)*(e+o*r),i);if(!(o===0n||a===0n))return[s,o,a]}function os(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=sn(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=sr(t)}else throw new TypeError("Expected valid private key");if(!ko(e))throw new Error("Expected private key: 0 < key < n");return e}function Fl(t){return t instanceof Le?(t.assertValidity(),t):Le.fromHex(t)}function gg(t){return t instanceof nn?(t.assertValidity(),t):nn.fromDER(t)}function KR(t,e=!1){let r=Le.fromPrivateKey(t);return typeof t=="string"?r.toHex(e):r.toRawBytes(e)}Be.getPublicKey=KR;function VR(t,e,r){let n=Le.fromSignature(t,e,r);return typeof t=="string"?n.toHex():n.toRawBytes()}Be.recoverPublicKey=VR;function mg(t){let e=t instanceof Uint8Array,r=typeof t=="string",n=(e||r)&&t.length;return e?n===33||n===65:r?n===66||n===130:t instanceof Le}function jR(t,e,r=!1){if(mg(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!mg(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=Fl(e);n.assertValidity();let i=n.multiply(os(t));return typeof t=="string"?i.toHex(r):i.toRawBytes(r)}Be.getSharedSecret=jR;function vg(t,e,r=!1){let[n,i,s]=t,{canonical:o,der:a,recovered:c}=e,u=(n.x===i?0:2)|Number(n.y&1n),l=s,f=Oe.n>>1n;s>f&&o&&(l=Oe.n-s,u^=1);let d=new nn(i,l);d.assertValidity();let p=a===!1?d.toCompactHex():d.toDERHex(),h=r?p:qn(p);return c?[h,u]:h}async function $R(t,e,r={}){return vg(await MR(t,e),r,typeof t=="string")}Be.sign=$R;function HR(t,e,r={}){return vg(FR(t,e),r,typeof t=="string")}Be.signSync=HR;function zR(t,e,r){let{n}=Oe,i;try{i=gg(t)}catch(v){return!1}let{r:s,s:o}=i,a=UR(e);if(a===0n)return!1;let c=Re.fromAffine(Fl(r)),u=Lo(o,n),l=ne(a*u,n),f=ne(s*u,n),d=Re.BASE.multiply(l),p=c.multiplyUnsafe(f),h=d.add(p).toAffine();return ne(h.x,n)===s}Be.verify=zR;async function Kl(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),n=await Be.utils.sha256(r),i=await Be.utils.sha256(lg(n,n,...e));return sr(i)}async function bg(t,e,r){let n=mc(t),i=await Kl("BIP0340/challenge",n,e.toRawX(),r);return ne(i,Oe.n)}function Vl(t){return ne(t.y,2n)===0n}var li=class{constructor(e,r){if(this.r=e,this.s=r,e<=0n||r<=0n||e>=Oe.P||r>=Oe.n)throw new Error("Invalid signature")}static fromHex(e){let r=vc(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=sr(r.slice(0,32)),i=sr(r.slice(32));return new li(n,i)}toHex(){return kn(this.r)+kn(this.s)}toRawBytes(){return qn(this.toHex())}};function GR(t){let e=Le.fromPrivateKey(t);return typeof t=="string"?e.toHexX():e.toRawX()}async function YR(t,e,r=Be.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);e||(e=0n);let{n}=Oe,i=vc(t),s=os(e),o=vc(r);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let a=Le.fromPrivateKey(s),c=Vl(a)?s:n-s,u=await Kl("BIP0340/aux",o),l=c^u,f=await Kl("BIP0340/nonce",mc(l),a.toRawX(),i),d=ne(f,n);if(d===0n)throw new Error("sign: Creation of signature failed. k is zero");let p=Le.fromPrivateKey(d),h=Vl(p)?d:n-d,g=await bg(p.x,a,i),v=new li(p.x,ne(h+g*c,n));if(!await Eg(v.toRawBytes(),i,a.toRawX()))throw new Error("sign: Invalid signature produced");return typeof t=="string"?v.toHex():v.toRawBytes()}async function Eg(t,e,r){let n=t instanceof li?t:li.fromHex(t),i=typeof e=="string"?qn(e):e,s=Fl(r),o=await bg(n.r,s,i),a=Le.fromPrivateKey(n.s),c=s.multiply(o),u=a.subtract(c);return!(u.equals(Le.BASE)||!Vl(u)||u.x!==n.r)}Be.schnorr={Signature:li,getPublicKey:GR,sign:YR,verify:Eg};Le.BASE._setWindowSize(8);var Gt=(()=>{let t=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof wg!="undefined"&&typeof qi=="function"&&!t?es():void 0,web:t}})();Be.utils={isValidPrivateKey(t){try{return os(t),!0}catch(e){return!1}},randomBytes:(t=32)=>{if(Gt.web)return Gt.web.getRandomValues(new Uint8Array(t));if(Gt.node){let{randomBytes:e}=Gt.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){let e=Be.utils.randomBytes(32),r=sr(e);if(ko(r)&&r!==1n)return e}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async t=>{if(Gt.web){let e=await Gt.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(Gt.node){let{createHash:e}=Gt.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Gt.web){let r=await Gt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=lg(...e),i=await Gt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Gt.node){let{createHmac:r}=Gt.node,n=r("sha256",t);for(let i of e)n.update(i);return Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=Le.BASE){let r=e===Le.BASE?e:new Le(e.x,e.y);return r._setWindowSize(t),r.multiply(3n),r}}});var Ag=S((GL,_g)=>{"use strict";var qo=he(),Un=Sg(),{sha256:xg}=(ci(),Tn);_g.exports=()=>{let t=32;function e(){return Un.utils.randomPrivateKey()}async function r(u,l){let{digest:f}=await xg.digest(l);try{return await Un.sign(f,u)}catch(d){throw qo(d,"ERR_INVALID_INPUT")}}async function n(u,l,f){try{let{digest:d}=await xg.digest(f);return Un.verify(l,d,u)}catch(d){throw qo(d,"ERR_INVALID_INPUT")}}function i(u){return Un.Point.fromHex(u).toRawBytes(!0)}function s(u){return Un.Point.fromHex(u).toRawBytes(!1)}function o(u){try{Un.getPublicKey(u,!0)}catch(l){throw qo(l,"ERR_INVALID_PRIVATE_KEY")}}function a(u){try{Un.Point.fromHex(u)}catch(l){throw qo(l,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return Un.getPublicKey(u,!0)}catch(l){throw qo(l,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:a,computePublicKey:c}}});var Rg=S((YL,Tg)=>{"use strict";var{sha256:Cg}=(ci(),Tn),WR=he(),{equals:Ig}=(kr(),Lr),{toString:QR}=(xt(),Ct),XR=cc();Tg.exports=(t,e,r)=>{r=r||Ag()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Ig(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Cg.digest(this.bytes);return u}}class i{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Ig(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Cg.digest(this.bytes);return u}async id(){let u=await this.public.hash();return QR(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return XR.export(this.bytes,u);throw WR(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new i(c)}function o(c){return new n(c)}async function a(){let c=await r.generateKey();return new i(c)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var Pg=S((WL,Bg)=>{"use strict";Bg.exports={SHA1:20,SHA256:32,SHA512:64}});var jl=S(Dg=>{"use strict";var Ng=Ao(),ZR=Pg(),JR={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},e8=async(t,e)=>{let r=await Ng.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};Dg.create=async function(t,e){let r=JR[t],n=await Ng.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return e8(n,i)},length:ZR[t]}}});var Ug=S((XL,qg)=>{"use strict";var Og=he(),{concat:Lg}=(Bn(),Rn),{fromString:t8}=(St(),At),r8=jl(),kg={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};qg.exports=async(t,e,r)=>{let n=kg[t];if(!n){let B=Object.keys(kg).join(" / ");throw Og(new Error(`unknown cipher type '${t}'. Must be ${B}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw Og(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,a=t8("key expansion"),c=2*(s+i+o),u=await r8.create(e,r),l=await u.digest(a),f=[],d=0;for(;d<c;){let B=await u.digest(Lg([l,a])),L=B.length;d+L>c&&(L=c-d),f.push(B),d+=L,l=await u.digest(l)}let p=c/2,h=Lg(f),g=h.slice(0,p),v=h.slice(p,c),_=B=>({iv:B.slice(0,s),cipherKey:B.slice(s,s+i),macKey:B.slice(s+i)});return{k1:_(g),k2:_(v)}}});var Fg=S((ZL,Mg)=>{"use strict";var n8=he();Mg.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw n8(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var zg=S(Hg=>{"use strict";var i8=he(),Uo=Ao(),{base64urlToBuffer:Kg}=ac(),s8=Fg(),{toString:$l}=(xt(),Ct),{concat:o8}=(Bn(),Rn),{equals:a8}=(kr(),Lr),Vg={"P-256":256,"P-384":384,"P-521":521};Hg.generateEphmeralKeyPair=async function(t){s8(Object.keys(Vg),t);let e=await Uo.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,s)=>{let o;s?o=await Uo.get().subtle.importKey("jwk",u8(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await Uo.get().subtle.importKey("jwk",$g(t,i),{name:"ECDH",namedCurve:t},!1,[]),o],c=await Uo.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],Vg[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},n=await Uo.get().subtle.exportKey("jwk",e.publicKey);return{key:c8(n),genSharedKey:r}};var jg={"P-256":32,"P-384":48,"P-521":66};function c8(t){let e=jg[t.crv];return o8([Uint8Array.from([4]),Kg(t.x,e),Kg(t.y,e)],1+e*2)}function $g(t,e){let r=jg[t];if(a8(!e.slice(0,1),Uint8Array.from([4])))throw i8(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:$l(e.slice(1,r+1),"base64url"),y:$l(e.slice(1+r),"base64url"),ext:!0}}var u8=(t,e)=>({...$g(t,e.public),d:$l(e.private,"base64url")})});var Yg=S((ek,Gg)=>{"use strict";var l8=zg();Gg.exports=async t=>l8.generateEphmeralKeyPair(t)});var wc=S((tk,Qg)=>{"use strict";var Fr=qa();_n();vl();var Hl=Ee(),Mo=he(),{fromString:f8}=(St(),At),d8=wy(),ar={rsa:zy(),ed25519:ag(),secp256k1:Rg()(Fr,oc())},Ec={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function as(t){let e=ar[t.toLowerCase()];if(!e){let r=Object.keys(ar).join(" / ");throw Mo(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var h8=async(t,e)=>as(t).generateKeyPair(e),p8=async(t,e,r)=>{let n=as(t);if(t.toLowerCase()!=="ed25519")throw Mo(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},y8=t=>{let e=Fr.PublicKey.decode(t),r=e.Data;switch(e.Type){case Fr.KeyType.RSA:return ar.rsa.unmarshalRsaPublicKey(r);case Fr.KeyType.Ed25519:return ar.ed25519.unmarshalEd25519PublicKey(r);case Fr.KeyType.Secp256k1:if(ar.secp256k1)return ar.secp256k1.unmarshalSecp256k1PublicKey(r);throw Mo(new Error(Ec.message),Ec.code);default:as(e.Type)}},g8=(t,e)=>(e=(e||"rsa").toLowerCase(),as(e),t.bytes),Wg=async t=>{let e=Fr.PrivateKey.decode(t),r=e.Data;switch(e.Type){case Fr.KeyType.RSA:return ar.rsa.unmarshalRsaPrivateKey(r);case Fr.KeyType.Ed25519:return ar.ed25519.unmarshalEd25519PrivateKey(r);case Fr.KeyType.Secp256k1:if(ar.secp256k1)return ar.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Mo(new Error(Ec.message),Ec.code);default:as(e.Type)}},m8=(t,e)=>(e=(e||"rsa").toLowerCase(),as(e),t.bytes),v8=async(t,e)=>{try{let i=await d8.import(t,e);return Wg(i)}catch(i){}let r=Hl.pki.decryptRsaPrivateKey(t,e);if(r===null)throw Mo(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=Hl.asn1.toDer(Hl.pki.privateKeyToAsn1(r));return n=f8(n.getBytes(),"ascii"),ar.rsa.unmarshalRsaPrivateKey(n)};Qg.exports={supportedKeys:ar,keysPBM:Fr,keyStretcher:Ug(),generateEphemeralKeyPair:Yg(),generateKeyPair:h8,generateKeyPairFromSeed:p8,unmarshalPublicKey:y8,marshalPublicKey:g8,unmarshalPrivateKey:Wg,marshalPrivateKey:m8,import:v8}});var Xg=S((rk,zl)=>{"use strict";function b8(t,{className:e,symbolName:r}){let n=Symbol.for(r),i={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=s=>!!(s&&s[n]),i}function E8(t,{className:e,symbolName:r,withoutNew:n}){let i=Symbol.for(r),s={[e]:function(...o){if(n&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[i]&&Object.defineProperty(a,i,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[i]),s}zl.exports=b8;zl.exports.proto=E8});var em=S((nk,Jg)=>{"use strict";var cs=Xr(),Zg=cs.Reader,w8=cs.Writer,ft=cs.util,Fo=cs.roots["libp2p-peer-id"]||(cs.roots["libp2p-peer-id"]={});Fo.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.id=ft.newBuffer([]),t.prototype.pubKey=ft.newBuffer([]),t.prototype.privKey=ft.newBuffer([]),t.encode=function(r,n){return n||(n=w8.create()),n.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&n.uint32(26).bytes(r.privKey),n},t.decode=function(r,n){r instanceof Zg||(r=Zg.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Fo.PeerIdProto;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw ft.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Fo.PeerIdProto)return r;var n=new Fo.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?ft.base64.decode(r.id,n.id=ft.newBuffer(ft.base64.length(r.id)),0):r.id.length&&(n.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?ft.base64.decode(r.pubKey,n.pubKey=ft.newBuffer(ft.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?ft.base64.decode(r.privKey,n.privKey=ft.newBuffer(ft.base64.length(r.privKey)),0):r.privKey.length&&(n.privKey=r.privKey)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.id="":(i.id=[],n.bytes!==Array&&(i.id=ft.newBuffer(i.id))),n.bytes===String?i.pubKey="":(i.pubKey=[],n.bytes!==Array&&(i.pubKey=ft.newBuffer(i.pubKey))),n.bytes===String?i.privKey="":(i.privKey=[],n.bytes!==Array&&(i.privKey=ft.newBuffer(i.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(i.id=n.bytes===String?ft.base64.encode(r.id,0,r.id.length):n.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?ft.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(i.privKey=n.bytes===String?ft.base64.encode(r.privKey,0,r.privKey.length):n.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,cs.util.toJSONOptions)},t}();Jg.exports=Fo});var ct=S((Tt,cm)=>{"use strict";var{CID:Gl}=(Gi(),ho),S8=(Jn(),Zn),x8=(Lu(),Ba),_8=(vn(),mn),A8=(po(),Yi),{base58btc:Yl}=(vn(),mn),{base32:C8}=(Jn(),Zn),{base16:tm}=(ku(),Pa),Ko=(Hi(),lo),Kr=wc(),I8=Xg(),{PeerIdProto:rm}=em(),{equals:fi}=(kr(),Lr),{fromString:Vo}=(St(),At),{toString:T8}=(xt(),Ct),{identity:Sc}=(nc(),_o),nm={...S8,...x8,..._8,...A8},R8=Object.keys(nm).reduce((t,e)=>t.or(nm[e]),C8.decoder),B8=112,im=114,sm=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&n&&!fi(r.public.bytes,n.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=Yl.encode(this.id).substring(1),this._privKey=r,this._pubKey=n}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Ko.decode(this.id);e.code===Sc.code&&(this._pubKey=Kr.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return Kr.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return Kr.marshalPrivateKey(this.privKey)}marshal(e){return rm.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:am(this.marshalPrivKey()),pubKey:am(this.marshalPubKey())}}toHexString(){return tm.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=Gl.createV1(im,Ko.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return fi(this.id,e);if(e.id)return fi(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&fi(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Ko.decode(this.id).code===Sc.code)return!0}catch(e){}return!1}},Vr=I8(sm,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});Tt=cm.exports=Vr;var jo=t=>t.bytes.length<=42?Ko.create(Sc.code,t.bytes).bytes:t.hash(),Wl=async(t,e)=>{let r=await jo(e);return new Vr(r,t,e)};Tt.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await Kr.generateKeyPair(t.keyType,t.bits);return Wl(e,e.public)};Tt.createFromHexString=t=>new Vr(tm.decode("f"+t));Tt.createFromBytes=t=>{try{let e=Gl.decode(t);if(!om(e))throw new Error("Supplied PeerID CID is invalid");return Tt.createFromCID(e)}catch{if(Ko.decode(t).code!==Sc.code)throw new Error("Supplied PeerID CID is invalid");return new Vr(t)}};Tt.createFromB58String=t=>Tt.createFromBytes(Yl.decode("z"+t));var om=t=>t.code===im||t.code===B8;Tt.createFromCID=t=>{if(t=Gl.asCID(t),!t||!om(t))throw new Error("Supplied PeerID CID is invalid");return new Vr(t.multihash.bytes)};Tt.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=Vo(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await Kr.unmarshalPublicKey(e);return Wl(void 0,r)};Tt.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=Vo(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await Kr.unmarshalPrivateKey(t);return Wl(e,e.public)};Tt.createFromJSON=async t=>{let e=Yl.decode("z"+t.id),r=t.privKey&&Vo(t.privKey,"base64pad"),n=t.pubKey&&Vo(t.pubKey,"base64pad"),i=n&&await Kr.unmarshalPublicKey(n);if(!r)return new Vr(e,void 0,i);let s=await Kr.unmarshalPrivateKey(r),o=await jo(s.public),a;if(i&&(a=await jo(i)),i&&!fi(o,a))throw new Error("Public and private key do not match");if(e&&!fi(o,e))throw new Error("Id and private key do not match");return new Vr(e,s,i)};Tt.createFromProtobuf=async t=>{typeof t=="string"&&(t=Vo(t,"base16"));let{id:e,privKey:r,pubKey:n}=rm.decode(t);r=r?await Kr.unmarshalPrivateKey(r):!1,n=n?await Kr.unmarshalPublicKey(n):!1;let i,s;if(r&&(s=await jo(r.public)),n&&(i=await jo(n)),r){if(n&&!fi(s,i))throw new Error("Public and private key do not match");return new Vr(s,r,r.public)}if(n)return new Vr(i,void 0,n);if(e)return new Vr(e);throw new Error("Protobuf did not contain any usable key material")};Tt.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),Tt.createFromBytes(R8.decode(t)));Tt.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function am(t){if(t)return T8(t,"base64pad")}});var Xl=S((ik,lm)=>{"use strict";var um="[a-fA-F\\d:]",Mn=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${um})|(?<=${um})(?=\\s|$))`:"",br="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ut="[a-fA-F\\d]{1,4}",xc=`
(?:
(?:${ut}:){7}(?:${ut}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ut}:){6}(?:${br}|:${ut}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ut}:){5}(?::${br}|(?::${ut}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ut}:){4}(?:(?::${ut}){0,1}:${br}|(?::${ut}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ut}:){3}(?:(?::${ut}){0,2}:${br}|(?::${ut}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ut}:){2}(?:(?::${ut}){0,3}:${br}|(?::${ut}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ut}:){1}(?:(?::${ut}){0,4}:${br}|(?::${ut}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ut}){0,5}:${br}|(?::${ut}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),P8=new RegExp(`(?:^${br}$)|(?:^${xc}$)`),N8=new RegExp(`^${br}$`),D8=new RegExp(`^${xc}$`),Ql=t=>t&&t.exact?P8:new RegExp(`(?:${Mn(t)}${br}${Mn(t)})|(?:${Mn(t)}${xc}${Mn(t)})`,"g");Ql.v4=t=>t&&t.exact?N8:new RegExp(`${Mn(t)}${br}${Mn(t)}`,"g");Ql.v6=t=>t&&t.exact?D8:new RegExp(`${Mn(t)}${xc}${Mn(t)}`,"g");lm.exports=Ql});var Jl=S((sk,fm)=>{"use strict";var Zl=Xl(),us=t=>Zl({exact:!0}).test(t);us.v4=t=>Zl.v4({exact:!0}).test(t);us.v6=t=>Zl.v6({exact:!0}).test(t);us.version=t=>us(t)?us.v4(t)?4:6:void 0;fm.exports=us});var gm=S((ok,ym)=>{"use strict";var ef=Jl(),{toString:dm}=(xt(),Ct),O8=ef,tf=ef.v4,hm=ef.v6,pm=function(t,e,r){r=~~r;let n;if(tf(t))n=e||new Uint8Array(r+4),t.split(/\./g).map(function(i){n[r++]=parseInt(i,10)&255});else if(hm(t)){let i=t.split(":",8),s;for(s=0;s<i.length;s++){let o=tf(i[s]),a;o&&(a=pm(i[s]),i[s]=dm(a.slice(0,2),"base16")),a&&++s<8&&i.splice(s,0,dm(a.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(s=0;s<i.length&&i[s]!=="";s++);let o=[s,"1"];for(s=9-i.length;s>0;s--)o.push("0");i.splice.apply(i,o)}for(n=e||new Uint8Array(r+16),s=0;s<i.length;s++){let o=parseInt(i[s],16);n[r++]=o>>8&255,n[r++]=o&255}}if(!n)throw Error("Invalid ip address: "+t);return n},L8=function(t,e,r){e=~~e,r=r||t.length-e;let n=[],i,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)n.push(t[e+o]);i=n.join(".")}else if(r===16){for(let o=0;o<r;o+=2)n.push(s.getUint16(e+o).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};ym.exports={isIP:O8,isV4:tf,isV6:hm,toBytes:pm,toString:L8}});var $o=S((ak,vm)=>{"use strict";function Vt(t){if(typeof t=="number"){if(Vt.codes[t])return Vt.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(Vt.names[t])return Vt.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var cr=-1;Vt.lengthPrefixedVarSize=cr;Vt.V=cr;Vt.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,cr,"ip6zone"],[53,cr,"dns","resolvable"],[54,cr,"dns4","resolvable"],[55,cr,"dns6","resolvable"],[56,cr,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,cr,"unix",!1,"path"],[421,cr,"ipfs"],[421,cr,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,cr,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,cr,"memory"]];Vt.names={};Vt.codes={};Vt.table.map(t=>{let e=mm.apply(null,t);return Vt.codes[e.code]=e,Vt.names[e.name]=e,null});Vt.object=mm;function mm(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}vm.exports=Vt});var wm=S((ck,Em)=>{Em.exports=rf;var bm=128,k8=127,q8=~k8,U8=Math.pow(2,31);function rf(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw rf.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=U8;)e[r++]=t&255|bm,t/=128;for(;t&q8;)e[r++]=t&255|bm,t>>>=7;return e[r]=t|0,rf.bytes=r-n+1,e}});var _m=S((uk,xm)=>{xm.exports=nf;var M8=128,Sm=127;function nf(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o||n>49)throw nf.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&Sm)<<n:(s&Sm)*Math.pow(2,n),n+=7}while(s>=M8);return nf.bytes=i-e,r}});var Cm=S((lk,Am)=>{var F8=Math.pow(2,7),K8=Math.pow(2,14),V8=Math.pow(2,21),j8=Math.pow(2,28),$8=Math.pow(2,35),H8=Math.pow(2,42),z8=Math.pow(2,49),G8=Math.pow(2,56),Y8=Math.pow(2,63);Am.exports=function(t){return t<F8?1:t<K8?2:t<V8?3:t<j8?4:t<$8?5:t<H8?6:t<z8?7:t<G8?8:t<Y8?9:10}});var di=S((fk,Im)=>{Im.exports={encode:wm(),decode:_m(),encodingLength:Cm()}});var Lm=S((dk,Om)=>{"use strict";var _c=gm(),Tm=$o(),{CID:W8}=(Gi(),ho),{base32:Rm}=(Jn(),Zn),{base58btc:Q8}=(vn(),mn),X8=(Hi(),lo),ls=di(),{toString:Ac}=(xt(),Ct),{fromString:Bm}=(St(),At),{concat:Cc}=(Bn(),Rn);Om.exports=Ho;function Ho(t,e){return e instanceof Uint8Array?Ho.toString(t,e):Ho.toBytes(t,e)}Ho.toString=function(e,r){switch(Tm(e).code){case 4:case 41:return Z8(r);case 6:case 273:case 33:case 132:return Nm(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return e4(r);case 421:return r4(r);case 444:return Dm(r);case 445:return Dm(r);default:return Ac(r,"base16")}};Ho.toBytes=function(e,r){switch(Tm(e).code){case 4:return Pm(r);case 41:return Pm(r);case 6:case 273:case 33:case 132:return sf(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return J8(r);case 421:return t4(r);case 444:return n4(r);case 445:return i4(r);default:return Bm(r,"base16")}};function Pm(t){if(!_c.isIP(t))throw new Error("invalid ip address");return _c.toBytes(t)}function Z8(t){let e=_c.toString(t);if(!e||!_c.isIP(e))throw new Error("invalid ip address");return e}function sf(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function Nm(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function J8(t){let e=Bm(t),r=Uint8Array.from(ls.encode(e.length));return Cc([r,e],r.length+e.length)}function e4(t){let e=ls.decode(t);if(t=t.slice(ls.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return Ac(t)}function t4(t){let e;t[0]==="Q"||t[0]==="1"?e=X8.decode(Q8.decode(`z${t}`)).bytes:e=W8.parse(t).multihash.bytes;let r=Uint8Array.from(ls.encode(e.length));return Cc([r,e],r.length+e.length)}function r4(t){let e=ls.decode(t),r=t.slice(ls.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return Ac(r,"base58btc")}function n4(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=Rm.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=sf(n);return Cc([r,i],r.length+i.length)}function i4(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=Rm.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=sf(n);return Cc([r,i],r.length+i.length)}function Dm(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Ac(e,"base32"),i=Nm(r);return n+":"+i}});var Gm=S((hk,zm)=>{"use strict";var km=Lm(),of=$o(),zo=di(),{concat:qm}=(Bn(),Rn),{toString:s4}=(xt(),Ct);zm.exports={stringToStringTuples:Um,stringTuplesToString:Mm,tuplesToStringTuples:Km,stringTuplesToTuples:Fm,bytesToTuples:af,tuplesToBytes:Vm,bytesToString:o4,stringToBytes:$m,fromString:a4,fromBytes:Hm,validateBytes:cf,isValidBytes:c4,cleanPath:Ic,ParseError:uf,protoFromTuple:Go,sizeForAddr:jm};function Um(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=of(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw uf("invalid address: "+t);if(s.path){e.push([i,Ic(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function Mm(t){let e=[];return t.map(r=>{let n=Go(r);return e.push(n.name),r.length>1&&e.push(r[1]),null}),Ic(e.join("/"))}function Fm(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=Go(e);return e.length>1?[r.code,km.toBytes(r.code,e[1])]:[r.code]})}function Km(t){return t.map(e=>{let r=Go(e);return e[1]?[r.code,km.toString(r.code,e[1])]:[r.code]})}function Vm(t){return Hm(qm(t.map(e=>{let r=Go(e),n=Uint8Array.from(zo.encode(r.code));return e.length>1&&(n=qm([n,e[1]])),n})))}function jm(t,e){return t.size>0?t.size/8:t.size===0?0:zo.decode(e)+zo.decode.bytes}function af(t){let e=[],r=0;for(;r<t.length;){let n=zo.decode(t,r),i=zo.decode.bytes,s=of(n),o=jm(s,t.slice(r+i));if(o===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+o);if(r+=o+i,r>t.length)throw uf("Invalid address Uint8Array: "+s4(t,"base16"));e.push([n,a])}return e}function o4(t){let e=af(t),r=Km(e);return Mm(r)}function $m(t){t=Ic(t);let e=Um(t),r=Fm(e);return Vm(r)}function a4(t){return $m(t)}function Hm(t){let e=cf(t);if(e)throw e;return Uint8Array.from(t)}function cf(t){try{af(t)}catch(e){return e}}function c4(t){return cf(t)===void 0}function Ic(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function uf(t){return new Error("Error parsing address: "+t)}function Go(t){return of(t[0])}});var Rt=S((pk,Qm)=>{"use strict";var Er=Gm(),fs=$o(),Ym=di(),{CID:u4}=(Gi(),ho),{base58btc:l4}=(vn(),mn),f4=he(),d4=Symbol.for("nodejs.util.inspect.custom"),{toString:Tc}=(xt(),Ct),{equals:h4}=(kr(),Lr),lf=new Map,Wm=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Lt=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,Wm,{value:!0}),e instanceof Uint8Array)this.bytes=Er.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Er.fromString(e)}else if(Lt.isMultiaddr(e))this.bytes=Er.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Er.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},fs(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=Ym.decode(r,n),s=Ym.decode.bytes,o=fs(i);n+=Er.sizeForAddr(o,r.slice(n+s))+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Er.bytesToTuples(this.bytes)}stringTuples(){let e=Er.bytesToTuples(this.bytes);return Er.tuplesToStringTuples(e)}encapsulate(e){return e=new Lt(e),new Lt(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new Lt(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Lt(Er.tuplesToBytes(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===fs.names.ipfs.code).pop();if(r&&r[1]){let n=r[1];return n[0]==="Q"||n[0]==="1"?Tc(l4.decode(`z${n}`),"base58btc"):Tc(u4.parse(n).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!fs(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return h4(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(!e)return[this];let r=lf.get(e.name);if(!r)throw f4(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(i=>new Lt(i))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new Lt("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return Lt.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof Lt||Boolean(e&&e[Wm])}[d4](){return"<Multiaddr "+Tc(this.bytes,"base16")+" - "+Er.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+Tc(this.bytes,"base16")+" - "+Er.bytesToString(this.bytes)+">"}};Lt.protocols=fs;Lt.resolvers=lf;function p4(t){return new Lt(t)}Qm.exports={Multiaddr:Lt,multiaddr:p4,protocols:fs,resolvers:lf}});var Fe=S(ff=>{"use strict";ff.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};ff.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var df=S((gk,Xm)=>{"use strict";var y4=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};Xm.exports=y4});var Jm=S((mk,Zm)=>{"use strict";var g4=async function*(t,e){for await(let r of t)yield e(r)};Zm.exports=g4});var t1=S((vk,e1)=>{"use strict";var m4=async function*(t,e){let r=0;if(!(e<1)){for await(let n of t)if(yield n,r++,r===e)return}};e1.exports=m4});var hf=S((bk,r1)=>{"use strict";var v4=he(),b4=df(),E4=Jm(),w4=t1();function S4(t,e){return E4(t,r=>(e.addressBook.add(r.id,r.multiaddrs),r))}function x4(t){let e=new Set;return b4(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*_4(t,e=1){let r=0;for await(let n of t)r++,yield n;if(r<e)throw v4(new Error("not found"),"NOT_FOUND")}function A4(t,e){return e?w4(t,e):t}r1.exports={storeAddresses:S4,uniquePeers:x4,requirePeers:_4,maybeLimitSource:A4}});var i1=S((Ek,Rc)=>{"use strict";var{AbortController:n1,AbortSignal:C4}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;Rc.exports=n1;Rc.exports.AbortSignal=C4;Rc.exports.default=n1});var yf=S((wk,pf)=>{"use strict";var Bc;globalThis.AbortController&&globalThis.AbortSignal?Bc=globalThis:Bc=i1();pf.exports.AbortSignal=Bc.AbortSignal;pf.exports.AbortController=Bc.AbortController});var o1=S((Sk,s1)=>{"use strict";s1.exports=function(){return Date.now()}});var Yo=S((xk,c1)=>{"use strict";var Pc=o1(),a1=class{constructor(e,r,n){let i=this;this._started=Pc(),this._rescheduled=0,this._scheduled=r,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(Pc()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=Pc();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=Pc(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function I4(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new a1(arguments[0],arguments[1],t)}c1.exports=I4});var gf=S((_k,l1)=>{"use strict";var{AbortController:T4}=yf(),u1=Yo(),Nc=class extends T4{constructor(e){super();this._ms=e,this._timer=u1(()=>this.abort(),e),Object.setPrototypeOf(this,Nc.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=u1(()=>this.abort(),this._ms)}};l1.exports={TimeoutController:Nc}});var d1=S((Ck,f1)=>{f1.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var mf=S((Tk,p1)=>{var h1=d1();p1.exports=class{constructor(e){this.hwm=e||16,this.head=new h1(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new h1(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var bf=S((Rk,y1)=>{var vf=mf();y1.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new vf,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let g,v=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;v.push(g.value)}return{done:g.done,value:v}}let h=r.shift();if(h.error)throw h.error;return h}return s?{done:!0}:new Promise((h,g)=>{i=v=>(i=null,v.error?g(v.error):t.writev&&!v.done?h({done:v.done,value:[v.value]}):h(v),n)})},a=h=>i?i(h):(r.push(h),n),c=h=>(r=new vf,i?i({error:h}):(r.push({error:h}),n)),u=h=>s?n:a({done:!1,value:h}),l=h=>s?n:(s=!0,h?c(h):a({done:!0})),f=()=>(r=new vf,l(),{done:!0}),d=h=>(l(h),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:f,throw:d,push:u,end:l},!e)return n;let p=n;return n={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(h){return p.throw(h),e&&(e(h),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(h){return p.end(h),e&&(e(h),e=null),n}},n}});var Ef=S((Bk,g1)=>{"use strict";var R4=bf(),B4=async function*(...t){let e=R4();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};g1.exports=B4});var jr=S((Pk,ds)=>{var m1=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},wf=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),Dc=t=>t&&typeof t.sink=="function"&&wf(t.source),P4=t=>e=>(t.sink(e),t.source),v1=(...t)=>{if(Dc(t[0])){let e=t[0];t[0]=()=>e.source}else if(wf(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&Dc(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)Dc(t[e])&&(t[e]=P4(t[e]));return m1(...t)};ds.exports=v1;ds.exports.pipe=v1;ds.exports.rawPipe=m1;ds.exports.isIterable=wf;ds.exports.isDuplex=Dc});var Sf=S((Nk,b1)=>{"use strict";var N4=async t=>{for await(let e of t)return e};b1.exports=N4});var Oc=S((Dk,E1)=>{"use strict";var D4=async t=>{for await(let e of t);};E1.exports=D4});var xf=S((Ok,w1)=>{"use strict";var hs=new Map,O4=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function L4(t,e,r){for(;hs.get(r);){try{await t()}catch(n){setTimeout(()=>{throw n},1);break}if(!hs.get(r))break;await new Promise(n=>{let i=setTimeout(n,e);hs.set(r,i)})}}function k4(t,e,r){r=r||e;let n=O4(),i=setTimeout(()=>{L4(t,e,n)},r);return hs.set(n,i),n}function q4(t){let e=hs.get(t);e&&(clearTimeout(e),hs.delete(t))}w1.exports={setDelayedInterval:k4,clearDelayedInterval:q4}});var _1=S((Lk,x1)=>{"use strict";var U4=he(),{messages:M4,codes:F4}=Fe(),S1=class{constructor(e){this._dht=e}async findPeer(e,r={}){let n={id:e,multiaddrs:[]},i=!1;for await(let s of this._dht.findPeer(e,r)){let o;switch(s.name){case"FINAL_PEER":i=!0,o=s.peer.multiaddrs;break;case"PEER_RESPONSE":i=!0;let a=s.closer.find(c=>c.id.equals(e));a&&(o=a.multiaddrs);break;default:continue}if(o&&o.length>0)for(let a of o){let c=!1;for(let u of n.multiaddrs)u.equals(a)&&(c=!0);c||n.multiaddrs.push(a)}if(s.name==="FINAL_PEER")return n}if(i)return n;throw U4(new Error(M4.NOT_FOUND),F4.ERR_NOT_FOUND)}async*getClosestPeers(e,r={}){for await(let n of this._dht.getClosestPeers(e,r))n.name==="PEER_RESPONSE"&&(yield*n.closer)}};x1.exports={DHTPeerRouting:S1}});var D1=S((kk,N1)=>{"use strict";var A1=Ne(),C1=Object.assign(A1("libp2p:peer-routing"),{error:A1("libp2p:peer-routing:err")}),Lc=he(),Wo=Fe(),{storeAddresses:I1,uniquePeers:K4,requirePeers:V4}=hf(),{TimeoutController:j4}=gf(),T1=Ef(),{pipe:R1}=jr(),$4=Sf(),H4=Oc(),z4=df(),{setDelayedInterval:G4,clearDelayedInterval:Y4}=xf(),{DHTPeerRouting:W4}=_1(),{setMaxListeners:B1}=Jt(),P1=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new W4(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=G4(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await H4(this.getClosestPeers(this._peerId.id,{timeout:this._refreshManagerOptions.timeout||1e4}))}catch(e){C1.error(e)}}stop(){Y4(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw Lc(new Error("No peer routers available"),Wo.codes.ERR_NO_ROUTERS_AVAILABLE);if(e.toB58String()===this._peerId.toB58String())throw Lc(new Error("Should not try to find self"),Wo.codes.ERR_FIND_SELF);let n=await R1(T1(...this._routers.map(i=>async function*(){try{yield await i.findPeer(e,r)}catch(s){C1.error(s)}}())),i=>z4(i,Boolean),i=>I1(i,this._peerStore),i=>$4(i));if(n)return n;throw Lc(new Error(Wo.messages.NOT_FOUND),Wo.codes.ERR_NOT_FOUND)}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw Lc(new Error("No peer routers available"),Wo.codes.ERR_NO_ROUTERS_AVAILABLE);if(r.timeout){let n=new j4(r.timeout);B1&&B1(1/0,n.signal),r.signal=n.signal}yield*R1(T1(...this._routers.map(n=>n.getClosestPeers(e,r))),n=>I1(n,this._peerStore),n=>K4(n),n=>V4(n))}};N1.exports=P1});var k1=S((qk,L1)=>{"use strict";var Q4=Oc(),O1=class{constructor(e){this._dht=e}async provide(e){await Q4(this._dht.provide(e))}async*findProviders(e,r){for await(let n of this._dht.findProviders(e,r))n.name==="PROVIDER"&&(yield*n.providers)}};L1.exports={DHTContentRouting:O1}});var M1=S((Uk,U1)=>{"use strict";var hi=he(),{messages:Qo,codes:pi}=Fe(),{storeAddresses:X4,uniquePeers:Z4,requirePeers:J4,maybeLimitSource:eB}=hf(),tB=Oc(),rB=Ef(),{pipe:nB}=jr(),{DHTContentRouting:iB}=k1(),q1=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new iB(this.dht))}async*findProviders(e,r={}){if(!this.routers.length)throw hi(new Error("No content this.routers available"),pi.ERR_NO_ROUTERS_AVAILABLE);yield*nB(rB(...this.routers.map(n=>n.findProviders(e,r))),n=>X4(n,this.libp2p.peerStore),n=>Z4(n),n=>eB(n,r.maxNumProviders),n=>J4(n))}async provide(e){if(!this.routers.length)throw hi(new Error("No content routers available"),pi.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(r=>r.provide(e)))}async put(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw hi(new Error(Qo.NOT_STARTED_YET),pi.DHT_NOT_STARTED);await tB(this.dht.put(e,r,n))}async get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw hi(new Error(Qo.NOT_STARTED_YET),pi.DHT_NOT_STARTED);for await(let n of this.dht.get(e,r))if(n.name==="VALUE")return{from:n.peerId,val:n.value};throw hi(new Error(Qo.NOT_FOUND),pi.ERR_NOT_FOUND)}async*getMany(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw hi(new Error(Qo.NOT_STARTED_YET),pi.DHT_NOT_STARTED);if(!r)return;let i=0;for await(let s of this.dht.get(e,n))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},i++,i===r))break;if(i===0)throw hi(new Error(Qo.NOT_FOUND),pi.ERR_NOT_FOUND)}};U1.exports=q1});var _f=S((Mk,j1)=>{"use strict";var sB=ct(),{Multiaddr:F1}=Rt(),K1=he(),{codes:V1}=Fe();function oB(t){typeof t=="string"&&(t=new F1(t));let e;if(F1.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw K1(new Error(`${t} does not have a valid peer type`),V1.ERR_INVALID_MULTIADDR);try{t=sB.createFromB58String(r)}catch(n){throw K1(new Error(`${t} is not a valid peer type`),V1.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}j1.exports=oB});var H1=S((Fk,$1)=>{"use strict";$1.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var gs=S((W1,Q1)=>{"use strict";var kc=H1(),{hasOwnProperty:z1}=Object.prototype,{propertyIsEnumerable:aB}=Object,ps=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),cB=W1,G1={concatArrays:!1,ignoreUndefined:!1},qc=t=>{let e=[];for(let r in t)z1.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)aB.call(t,n)&&e.push(n)}return e};function ys(t){return Array.isArray(t)?uB(t):kc(t)?lB(t):t}function uB(t){let e=t.slice(0,0);return qc(t).forEach(r=>{ps(e,r,ys(t[r]))}),e}function lB(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return qc(t).forEach(r=>{ps(e,r,ys(t[r]))}),e}var Y1=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]=="undefined"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?ps(t,i,Af(t[i],e[i],n)):ps(t,i,ys(e[i])))}),t),fB=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!z1.call(s,a)||(o.push(String(a)),s===t?ps(n,i++,s[a]):ps(n,i++,ys(s[a])));n=Y1(n,s,qc(s).filter(a=>!o.includes(a)),r)}),n};function Af(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?fB(t,e,r):!kc(e)||!kc(t)?ys(e):Y1(t,e,qc(e),r)}Q1.exports=function(...t){let e=Af(ys(G1),this!==cB&&this||{},G1),r={_:{}};for(let n of t)if(n!==void 0){if(!kc(n))throw new TypeError("`"+n+"` is not an Option Object");r=Af(r,{_:n},e)}return r._}});var J1=S((Kk,Z1)=>{"use strict";Z1.exports=X1;var dB=Bu(),Fn=X1.prototype,hB=new Date%1e9;function pB(){return(Math.random()*1e9>>>0)+hB++}function X1(t){t=t||{},this.id=t.id||pB(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Fn.has=function(t){return t in this._lookup};Fn.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Fn.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};Fn.set=function(t,e,r){var n=this._lookup[t],i=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this};Fn.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};Fn.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=dB(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this};Fn.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};Fn.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var Xo=S((ms,ev)=>{"use strict";var yB=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof on!="undefined")return on;throw new Error("unable to locate global object")},on=yB();ev.exports=ms=on.fetch;on.fetch&&(ms.default=on.fetch.bind(on));ms.Headers=on.Headers;ms.Request=on.Request;ms.Response=on.Response});var tv=S((Vk,Cf)=>{"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?Cf.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:Cf.exports={default:Xo().default,Headers:Xo().Headers,Request:Xo().Request,Response:Xo().Response}});var nv=S((jk,rv)=>{"use strict";var{default:gB,Headers:mB}=tv();function vB({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function bB(t){return gB(t,{headers:new mB({accept:"application/dns-json"})})}function EB(t,e){return`${e}_${t}`}rv.exports={buildResource:vB,fetch:bB,getCacheKey:EB}});var ov=S(($k,sv)=>{"use strict";var iv=Ne(),Uc=iv("dns-over-http-resolver");Uc.error=iv("dns-over-http-resolver:error");var wB=J1(),ur=nv(),Mc=class{constructor({maxCache:e=100}={}){this._cache=new wB({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let n=Math.floor(Math.random()*r),i=e[r];e[r]=e[n],e[n]=i}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",n=this._cache.get(ur.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await ur.fetch(ur.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(ur.getCacheKey(e,r),a,{ttl:c}),a}catch(s){Uc.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",n=this._cache.get(ur.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await ur.fetch(ur.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(ur.getCacheKey(e,r),a,{ttl:c}),a}catch(s){Uc.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",n=this._cache.get(ur.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await ur.fetch(ur.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(ur.getCacheKey(e,r),a,{ttl:c}),a}catch(s){Uc.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};Mc.Resolver=Mc;sv.exports=Mc});var cv=S((Hk,av)=>{"use strict";var SB=ov();av.exports=SB});var lv=S((zk,uv)=>{"use strict";var xB=$o(),{code:_B}=xB("dnsaddr");async function AB(t){let e=cv(),r=new e,n=t.getPeerId(),[,i]=t.stringTuples().find(([a])=>a===_B)||[],o=(await r.resolveTxt(`_dnsaddr.${i}`)).flat().map(a=>a.split("=")[1]);return n&&(o=o.filter(a=>a.includes(n))),o}uv.exports={dnsaddrResolver:AB}});var Fc=S((Gk,fv)=>{"use strict";fv.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var If=S((Yk,CB)=>{CB.exports={name:"libp2p",version:"0.35.6",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/peer-routing/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.21.0","libp2p-interfaces":"^2.0.1","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","nat-api":"^0.3.1","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^2.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^5.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3","datastore-core":"^6.0.7",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.1","libp2p-floodsub":"^0.28.0","libp2p-gossipsub":"^0.12.1","libp2p-interfaces-compliance-tests":"^2.0.1","libp2p-interop":"^0.5.0","libp2p-kad-dht":"^0.27.1","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.1","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","Volker Mische <volker.mische@gmail.com>","Robert Kiel <robert.kiel@hoprnet.org>","Richard Littauer <richard.littauer@gmail.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Franck Royer <franck@royer.one>","Thomas Eizinger <thomas@eizinger.io>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Elven <mon.samuel@qq.com>","Samlior <samlior@foxmail.com>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Soeren <nikorpoulsen@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","greenSnot <greenSnot@users.noreply.github.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Marston Connell <34043723+TheMarstonConnell@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>"]}});var Tf=S((Wk,$r)=>{"use strict";var IB=If().version;$r.exports.PROTOCOL_VERSION="ipfs/0.1.0";$r.exports.AGENT_VERSION=`js-libp2p/${IB}`;$r.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";$r.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";$r.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";$r.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";$r.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";$r.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";$r.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var Kc=S((Qk,hv)=>{"use strict";var dv=60*1e3;hv.exports={ADVERTISE_BOOT_DELAY:15*dv,ADVERTISE_TTL:30*dv,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var pv=S(Zo=>{(function(){var t,e,r,n,i,s,o,a;a=function(c){var u,l,f,d;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,f=(c&255<<8)>>>8,d=c&255,[u,l,f,d].join(".")},o=function(c){var u,l,f,d,p,h;for(u=[],f=d=0;d<=3&&c.length!==0;f=++d){if(f>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}h=e(c),p=h[0],l=h[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},n=r("0"),s=r("a"),i=r("A"),e=function(c){var u,l,f,d,p;for(d=0,u=10,l="9",f=0,c.length>1&&c[f]==="0"&&(c[f+1]==="x"||c[f+1]==="X"?(f+=2,u=16):"0"<=c[f+1]&&c[f+1]<="9"&&(f++,u=8,l="7")),p=f;f<c.length;){if("0"<=c[f]&&c[f]<=l)d=d*u+(r(c[f])-n)>>>0;else if(u===16)if("a"<=c[f]&&c[f]<="f")d=d*u+(10+r(c[f])-s)>>>0;else if("A"<=c[f]&&c[f]<="F")d=d*u+(10+r(c[f])-i)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");f++}if(f===p)throw new Error("empty octet");return[d,f]},t=function(){function c(u,l){var f,d,p,h;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(h=u.split("/",2),u=h[0],l=h[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(g){throw f=g,new Error("Invalid mask: "+l)}for(d=p=32;p>=0;d=--p)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(g){throw f=g,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,f,d;for(d=o(this.first),f=o(this.last),l=0;d<=f;)u(a(d),d,l),l++,d++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),Zo.ip2long=o,Zo.long2ip=a,Zo.Netmask=t}).call(Zo)});var gv=S((yv,Vc)=>{(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},n=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(p,h){if(p.indexOf("::")!==p.lastIndexOf("::"))return null;let g=0,v=-1,_=(p.match(a.zoneIndex)||[])[0],B,L;for(_&&(_=_.substring(1),p=p.replace(/%.+$/,""));(v=p.indexOf(":",v+1))>=0;)g++;if(p.substr(0,2)==="::"&&g--,p.substr(-2,2)==="::"&&g--,g>h)return null;for(L=h-g,B=":";L--;)B+="0:";return p=p.replace("::",B),p[0]===":"&&(p=p.slice(1)),p[p.length-1]===":"&&(p=p.slice(0,-1)),h=function(){let z=p.split(":"),q=[];for(let k=0;k<z.length;k++)q.push(parseInt(z[k],16));return q}(),{parts:h,zoneId:_}}function u(p,h,g,v){if(p.length!==h.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let _=0,B;for(;v>0;){if(B=g-v,B<0&&(B=0),p[_]>>B!=h[_]>>B)return!1;v-=g,_+=1}return!0}function l(p){if(i.test(p))return parseInt(p,16);if(p[0]==="0"&&!isNaN(parseInt(p[1],10))){if(n.test(p))return parseInt(p,8);throw new Error(`ipaddr: cannot parse ${p} as octal`)}return parseInt(p,10)}function f(p,h){for(;p.length<h;)p=`0${p}`;return p}let d={};d.IPv4=function(){function p(h){if(h.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let g,v;for(g=0;g<h.length;g++)if(v=h[g],!(0<=v&&v<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=h}return p.prototype.SpecialRanges={unspecified:[[new p([0,0,0,0]),8]],broadcast:[[new p([255,255,255,255]),32]],multicast:[[new p([224,0,0,0]),4]],linkLocal:[[new p([169,254,0,0]),16]],loopback:[[new p([127,0,0,0]),8]],carrierGradeNat:[[new p([100,64,0,0]),10]],private:[[new p([10,0,0,0]),8],[new p([172,16,0,0]),12],[new p([192,168,0,0]),16]],reserved:[[new p([192,0,0,0]),24],[new p([192,0,2,0]),24],[new p([192,88,99,0]),24],[new p([198,51,100,0]),24],[new p([203,0,113,0]),24],[new p([240,0,0,0]),4]]},p.prototype.kind=function(){return"ipv4"},p.prototype.match=function(h,g){let v;if(g===void 0&&(v=h,h=v[0],g=v[1]),h.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,h.octets,8,g)},p.prototype.prefixLengthFromSubnetMask=function(){let h=0,g=!1,v={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},_,B,L;for(_=3;_>=0;_-=1)if(B=this.octets[_],B in v){if(L=v[B],g&&L!==0)return null;L!==8&&(g=!0),h+=L}else return null;return 32-h},p.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){return this.octets.slice(0)},p.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)},p.prototype.toNormalizedString=function(){return this.toString()},p.prototype.toString=function(){return this.octets.join(".")},p}(),d.IPv4.broadcastAddressFromCIDR=function(p){try{let h=this.parseCIDR(p),g=h[0].toByteArray(),v=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),_=[],B=0;for(;B<4;)_.push(parseInt(g[B],10)|parseInt(v[B],10)^255),B++;return new this(_)}catch(h){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(p){return this.parser(p)!==null},d.IPv4.isValid=function(p){try{return new this(this.parser(p)),!0}catch(h){return!1}},d.IPv4.isValidFourPartDecimal=function(p){return!!(d.IPv4.isValid(p)&&p.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},d.IPv4.networkAddressFromCIDR=function(p){let h,g,v,_,B;try{for(h=this.parseCIDR(p),v=h[0].toByteArray(),B=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),_=[],g=0;g<4;)_.push(parseInt(v[g],10)&parseInt(B[g],10)),g++;return new this(_)}catch(L){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(p){let h=this.parser(p);if(h===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(h)},d.IPv4.parseCIDR=function(p){let h;if(h=p.match(/^(.+)\/(\d+)$/)){let g=parseInt(h[2]);if(g>=0&&g<=32){let v=[this.parse(h[1]),g];return Object.defineProperty(v,"toString",{value:function(){return this.join("/")}}),v}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(p){let h,g,v;if(h=p.match(r.fourOctet))return function(){let _=h.slice(1,6),B=[];for(let L=0;L<_.length;L++)g=_[L],B.push(l(g));return B}();if(h=p.match(r.longValue)){if(v=l(h[1]),v>4294967295||v<0)throw new Error("ipaddr: address outside defined range");return function(){let _=[],B;for(B=0;B<=24;B+=8)_.push(v>>B&255);return _}().reverse()}else return(h=p.match(r.twoOctet))?function(){let _=h.slice(1,4),B=[];if(v=l(_[1]),v>16777215||v<0)throw new Error("ipaddr: address outside defined range");return B.push(l(_[0])),B.push(v>>16&255),B.push(v>>8&255),B.push(v&255),B}():(h=p.match(r.threeOctet))?function(){let _=h.slice(1,5),B=[];if(v=l(_[2]),v>65535||v<0)throw new Error("ipaddr: address outside defined range");return B.push(l(_[0])),B.push(l(_[1])),B.push(v>>8&255),B.push(v&255),B}():null},d.IPv4.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>32)throw new Error("ipaddr: invalid IPv4 prefix length");let h=[0,0,0,0],g=0,v=Math.floor(p/8);for(;g<v;)h[g]=255,g++;return v<4&&(h[v]=Math.pow(2,p%8)-1<<8-p%8),new this(h)},d.IPv6=function(){function p(h,g){let v,_;if(h.length===16)for(this.parts=[],v=0;v<=14;v+=2)this.parts.push(h[v]<<8|h[v+1]);else if(h.length===8)this.parts=h;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(v=0;v<this.parts.length;v++)if(_=this.parts[v],!(0<=_&&_<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");g&&(this.zoneId=g)}return p.prototype.SpecialRanges={unspecified:[new p([0,0,0,0,0,0,0,0]),128],linkLocal:[new p([65152,0,0,0,0,0,0,0]),10],multicast:[new p([65280,0,0,0,0,0,0,0]),8],loopback:[new p([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new p([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new p([0,0,0,0,0,65535,0,0]),96],rfc6145:[new p([0,0,0,0,65535,0,0,0]),96],rfc6052:[new p([100,65435,0,0,0,0,0,0]),96],"6to4":[new p([8194,0,0,0,0,0,0,0]),16],teredo:[new p([8193,0,0,0,0,0,0,0]),32],reserved:[[new p([8193,3512,0,0,0,0,0,0]),32]]},p.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},p.prototype.kind=function(){return"ipv6"},p.prototype.match=function(h,g){let v;if(g===void 0&&(v=h,h=v[0],g=v[1]),h.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,h.parts,16,g)},p.prototype.prefixLengthFromSubnetMask=function(){let h=0,g=!1,v={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},_,B;for(let L=7;L>=0;L-=1)if(_=this.parts[L],_ in v){if(B=v[_],g&&B!==0)return null;B!==16&&(g=!0),h+=B}else return null;return 128-h},p.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){let h,g=[],v=this.parts;for(let _=0;_<v.length;_++)h=v[_],g.push(h>>8),g.push(h&255);return g},p.prototype.toFixedLengthString=function(){let h=function(){let v=[];for(let _=0;_<this.parts.length;_++)v.push(f(this.parts[_].toString(16),4));return v}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),h+g},p.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let h=this.parts.slice(-2),g=h[0],v=h[1];return new d.IPv4([g>>8,g&255,v>>8,v&255])},p.prototype.toNormalizedString=function(){let h=function(){let v=[];for(let _=0;_<this.parts.length;_++)v.push(this.parts[_].toString(16));return v}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),h+g},p.prototype.toRFC5952String=function(){let h=/((^|:)(0(:|$)){2,})/g,g=this.toNormalizedString(),v=0,_=-1,B;for(;B=h.exec(g);)B[0].length>_&&(v=B.index,_=B[0].length);return _<0?g:`${g.substring(0,v)}::${g.substring(v+_)}`},p.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},p}(),d.IPv6.broadcastAddressFromCIDR=function(p){try{let h=this.parseCIDR(p),g=h[0].toByteArray(),v=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),_=[],B=0;for(;B<16;)_.push(parseInt(g[B],10)|parseInt(v[B],10)^255),B++;return new this(_)}catch(h){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${h})`)}},d.IPv6.isIPv6=function(p){return this.parser(p)!==null},d.IPv6.isValid=function(p){if(typeof p=="string"&&p.indexOf(":")===-1)return!1;try{let h=this.parser(p);return new this(h.parts,h.zoneId),!0}catch(h){return!1}},d.IPv6.networkAddressFromCIDR=function(p){let h,g,v,_,B;try{for(h=this.parseCIDR(p),v=h[0].toByteArray(),B=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),_=[],g=0;g<16;)_.push(parseInt(v[g],10)&parseInt(B[g],10)),g++;return new this(_)}catch(L){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${L})`)}},d.IPv6.parse=function(p){let h=this.parser(p);if(h.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(h.parts,h.zoneId)},d.IPv6.parseCIDR=function(p){let h,g,v;if((g=p.match(/^(.+)\/(\d+)$/))&&(h=parseInt(g[2]),h>=0&&h<=128))return v=[this.parse(g[1]),h],Object.defineProperty(v,"toString",{value:function(){return this.join("/")}}),v;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(p){let h,g,v,_,B,L;if(v=p.match(a.deprecatedTransitional))return this.parser(`::ffff:${v[1]}`);if(a.native.test(p))return c(p,8);if((v=p.match(a.transitional))&&(L=v[6]||"",h=c(v[1].slice(0,-1)+L,6),h.parts)){for(B=[parseInt(v[2]),parseInt(v[3]),parseInt(v[4]),parseInt(v[5])],g=0;g<B.length;g++)if(_=B[g],!(0<=_&&_<=255))return null;return h.parts.push(B[0]<<8|B[1]),h.parts.push(B[2]<<8|B[3]),{parts:h.parts,zoneId:h.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>128)throw new Error("ipaddr: invalid IPv6 prefix length");let h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,v=Math.floor(p/8);for(;g<v;)h[g]=255,g++;return v<16&&(h[v]=Math.pow(2,p%8)-1<<8-p%8),new this(h)},d.fromByteArray=function(p){let h=p.length;if(h===4)return new d.IPv4(p);if(h===16)return new d.IPv6(p);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(p){return d.IPv6.isValid(p)||d.IPv4.isValid(p)},d.parse=function(p){if(d.IPv6.isValid(p))return d.IPv6.parse(p);if(d.IPv4.isValid(p))return d.IPv4.parse(p);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(p){try{return d.IPv6.parseCIDR(p)}catch(h){try{return d.IPv4.parseCIDR(p)}catch(g){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(p){let h=this.parse(p);return h.kind()==="ipv6"&&h.isIPv4MappedAddress()?h.toIPv4Address():h},d.subnetMatch=function(p,h,g){let v,_,B,L;g==null&&(g="unicast");for(_ in h)if(Object.prototype.hasOwnProperty.call(h,_)){for(B=h[_],B[0]&&!(B[0]instanceof Array)&&(B=[B]),v=0;v<B.length;v++)if(L=B[v],p.kind()===L[0].kind()&&p.match.apply(p,L))return _}return g},typeof Vc!="undefined"&&Vc.exports?Vc.exports=d:t.ipaddr=d})(yv)});var Ev=S(Jo=>{"use strict";var mv=Jo&&Jo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jo,"__esModule",{value:!0});var TB=pv(),RB=mv(Xl()),BB=mv(Jl()),vv=gv(),PB=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],NB=PB.map(t=>new TB.Netmask(t));function DB(t){for(let e of NB)if(e.contains(t))return!0;return!1}function bv(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}Jo.default=t=>{if(vv.isValid(t)){let e=vv.parse(t);if(e.kind()==="ipv4")return DB(e.toNormalizedString());if(e.kind()==="ipv6")return bv(t)}else if(BB.default(t)&&RB.default.v6().test(t))return bv(t)}});var Rf=S((Jk,wv)=>{"use strict";wv.exports=Ev().default});var xv=S((eq,Sv)=>{"use strict";var OB=Rf();function LB(t){let{address:e}=t.nodeAddress();return OB(e)}Sv.exports=LB});var Bf=S((tq,Av)=>{"use strict";var _v=xv();function kB(t,e){let r=_v(t.multiaddr),n=_v(e.multiaddr);return r&&!n?1:!r&&n||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function qB(t){return[...t].sort(kB)}Av.exports.publicAddressesFirst=qB});var Iv=S((rq,Pf)=>{"use strict";var Cv=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};Pf.exports=Cv;Pf.exports.default=Cv});var Rv=S((nq,Nf)=>{"use strict";var Tv=(t,...e)=>new Promise(r=>{r(t(...e))});Nf.exports=Tv;Nf.exports.default=Tv});var Pv=S((iq,Df)=>{"use strict";var UB=Rv(),Bv=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,n=()=>{r--,e.length>0&&e.shift()()},i=(a,c,...u)=>{r++;let l=UB(a,...u);c(l),l.then(n,n)},s=(a,c,...u)=>{r<t?i(a,c,...u):e.push(i.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};Df.exports=Bv;Df.exports.default=Bv});var Dv=S((sq,Nv)=>{"use strict";var Of=Iv(),MB=Pv();Nv.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,n=MB(r);return Promise.all(t.map(i=>i&&typeof i.then=="function"?Of(i):Of(typeof i=="function"?n(()=>i()):Promise.resolve(i))))}});var kv=S((oq,Lv)=>{"use strict";var vs=Xr(),Ov=vs.Reader,FB=vs.Writer,We=vs.util,ea=vs.roots["libp2p-envelope"]||(vs.roots["libp2p-envelope"]={});ea.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=We.newBuffer([]),t.prototype.payloadType=We.newBuffer([]),t.prototype.payload=We.newBuffer([]),t.prototype.signature=We.newBuffer([]),t.encode=function(r,n){return n||(n=FB.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof Ov||(r=Ov.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ea.Envelope;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ea.Envelope)return r;var n=new ea.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?We.base64.decode(r.publicKey,n.publicKey=We.newBuffer(We.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?We.base64.decode(r.payloadType,n.payloadType=We.newBuffer(We.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?We.base64.decode(r.payload,n.payload=We.newBuffer(We.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?We.base64.decode(r.signature,n.signature=We.newBuffer(We.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=We.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=We.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=We.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=We.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?We.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?We.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?We.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?We.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,vs.util.toJSONOptions)},t}();Lv.exports=ea});var $c=S((aq,Mv)=>{"use strict";var KB=he(),{concat:VB}=(Bn(),Rn),{fromString:jB}=(St(),At),$B=wc(),HB=ct(),Lf=di(),{equals:jc}=(kr(),Lr),{codes:zB}=Fe(),{Envelope:qv}=kv(),Kn=class{constructor({peerId:e,payloadType:r,payload:n,signature:i}){this.peerId=e,this.payloadType=r,this.payload=n,this.signature=i,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=$B.marshalPublicKey(this.peerId.pubKey);return this._marshal=qv.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return jc(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&jc(this.payloadType,e.payloadType)&&jc(this.payload,e.payload)&&jc(this.signature,e.signature)}validate(e){let r=Uv(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},Uv=(t,e,r)=>{let n=jB(t),i=Lf.encode(n.byteLength),s=Lf.encode(e.length),o=Lf.encode(r.length);return VB([new Uint8Array(i),n,new Uint8Array(s),e,new Uint8Array(o),r])};Kn.createFromProtobuf=async t=>{let e=qv.decode(t),r=await HB.createFromPubKey(e.publicKey);return new Kn({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Kn.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),s=Uv(r,n,i),o=await e.privKey.sign(s);return new Kn({peerId:e,payloadType:n,payload:i,signature:o})};Kn.openAndCertify=async(t,e)=>{let r=await Kn.createFromProtobuf(t);if(!await r.validate(e))throw KB(new Error("envelope signature is not valid for the given domain"),zB.ERR_SIGNATURE_NOT_VALID);return r};Mv.exports=Kn});var Kv=S((cq,Fv)=>{"use strict";function GB(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,n)=>e[n].equals(r))}Fv.exports=GB});var $v=S((uq,jv)=>{"use strict";var yi=Xr(),Hc=yi.Reader,Vv=yi.Writer,it=yi.util,lr=yi.roots["libp2p-peer-record"]||(yi.roots["libp2p-peer-record"]={});lr.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.peerId=it.newBuffer([]),t.prototype.seq=it.Long?it.Long.fromBits(0,0,!0):0,t.prototype.addresses=it.emptyArray,t.encode=function(r,n){if(n||(n=Vv.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&n.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)lr.PeerRecord.AddressInfo.encode(r.addresses[i],n.uint32(26).fork()).ldelim();return n},t.decode=function(r,n){r instanceof Hc||(r=Hc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new lr.PeerRecord;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(lr.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof lr.PeerRecord)return r;var n=new lr.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?it.base64.decode(r.peerId,n.peerId=it.newBuffer(it.base64.length(r.peerId)),0):r.peerId.length&&(n.peerId=r.peerId)),r.seq!=null&&(it.Long?(n.seq=it.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new it.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=lr.PeerRecord.AddressInfo.fromObject(r.addresses[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=it.newBuffer(i.peerId))),it.Long){var s=new it.Long(0,0,!0);i.seq=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.seq=n.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?it.base64.encode(r.peerId,0,r.peerId.length):n.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?it.Long.prototype.toString.call(r.seq):n.longs===Number?new it.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){i.addresses=[];for(var o=0;o<r.addresses.length;++o)i.addresses[o]=lr.PeerRecord.AddressInfo.toObject(r.addresses[o],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,yi.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=it.newBuffer([]),e.encode=function(n,i){return i||(i=Vv.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof Hc||(n=Hc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new lr.PeerRecord.AddressInfo;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof lr.PeerRecord.AddressInfo)return n;var i=new lr.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?it.base64.decode(n.multiaddr,i.multiaddr=it.newBuffer(it.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=it.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?it.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,yi.util.toJSONOptions)},e}(),t}();jv.exports=lr});var zv=S((lq,Hv)=>{"use strict";var YB="libp2p-peer-record",WB=Uint8Array.from([3,1]);Hv.exports={ENVELOPE_DOMAIN_PEER_RECORD:YB,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:WB}});var zc=S((fq,Wv)=>{"use strict";var{Multiaddr:QB}=Rt(),XB=ct(),ZB=Kv(),{PeerRecord:Gv}=$v(),{ENVELOPE_DOMAIN_PEER_RECORD:Yv,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:JB}=zv(),gi=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:n=Date.now()}){this.domain=Yv,this.codec=JB,this.peerId=e,this.multiaddrs=r,this.seqNumber=n,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=Gv.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof gi)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!ZB(this.multiaddrs,e.multiaddrs))}};gi.createFromProtobuf=t=>{let e=Gv.decode(t),r=XB.createFromBytes(e.peerId),n=(e.addresses||[]).map(s=>new QB(s.multiaddr)),i=Number(e.seq);return new gi({peerId:r,multiaddrs:n,seqNumber:i})};gi.DOMAIN=Yv;Wv.exports=gi});var kf=S((dq,Qv)=>{"use strict";var eP=$c(),tP=zc();async function rP(t){let e=new tP({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await eP.seal(e,t.peerId);t.peerStore.addressBook.consumePeerRecord(r)}Qv.exports.updateSelfPeerRecord=rP});var Uf=S((hq,Jv)=>{"use strict";var Xv=Ne(),mi=Object.assign(Xv("libp2p:transports"),{error:Xv("libp2p:transports:err")}),nP=Dv(),{codes:bs}=Fe(),ta=he(),{updateSelfPeerRecord:Zv}=kf(),qf=class{constructor({libp2p:e,upgrader:r,faultTolerance:n=Gc.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=n}add(e,r,n={}){if(mi("adding %s",e),!e)throw ta(new Error(`Transport must have a valid key, was given '${e}'`),bs.ERR_INVALID_KEY);if(this._transports.has(e))throw ta(new Error("There is already a transport with this key"),bs.ERR_DUPLICATE_TRANSPORT);let i=new r({...n,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,i),this._listenerOptions.set(e,n.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,n]of this._listeners)for(mi("closing listeners for %s",r);n.length;){let i=n.pop();i.removeAllListeners("listening"),i.removeAllListeners("close"),e.push(i.close())}await Promise.all(e),mi("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let n=this.transportForMultiaddr(e);if(!n)throw ta(new Error(`No transport available for address ${String(e)}`),bs.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,r)}catch(i){throw i.code||(i.code=bs.ERR_TRANSPORT_DIAL_FAILED),i}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let n of r)e=[...e,...n.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){mi("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[n,i]of this._transports.entries()){let s=i.filter(e),o=[];for(let u of s){mi("creating listener for %s on %s",n,u);let l=i.createListener(this._listenerOptions.get(n));this._listeners.get(n).push(l),l.on("listening",()=>Zv(this.libp2p)),l.on("close",()=>Zv(this.libp2p)),o.push(l.listen(u))}if(o.length===0){r.push(n);continue}if(!(await nP(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==Gc.NO_FATAL)throw ta(new Error(`Transport (${n}) could not listen on any available address`),bs.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let n=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===Gc.FATAL_ALL)throw ta(new Error(n),bs.ERR_NO_VALID_ADDRESSES);mi(`libp2p in dial mode only: ${n}`)}}async remove(e){if(mi("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},Gc={FATAL_ALL:0,NO_FATAL:1};qf.FaultTolerance=Gc;Jv.exports=qf});var rb=S((pq,tb)=>{"use strict";var iP=gs(),{dnsaddrResolver:sP}=lv(),Mf=Fc(),{AGENT_VERSION:oP}=Tf(),eb=Kc(),{publicAddressesFirst:aP}=Bf(),{FaultTolerance:cP}=Uf(),uP={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},transportManager:{faultTolerance:cP.FATAL_ALL},dialer:{maxParallelDials:Mf.MAX_PARALLEL_DIALS,maxDialsPerPeer:Mf.MAX_PER_PEER_DIALS,dialTimeout:Mf.DIAL_TIMEOUT,resolvers:{dnsaddr:sP},addressSorter:aP},host:{agentVersion:oP},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:eb.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:eb.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};tb.exports.validate=t=>{let e=iP(uP,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var sb=S((yq,ib)=>{"use strict";var{EventEmitter:lP}=Jt(),{Multiaddr:ra}=Rt(),fP=ct(),nb=class extends lP{constructor(e,{listen:r=[],announce:n=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(i=>i.toString())),this.announce=new Set(n.map(i=>i.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new ra(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new ra(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new ra(e))}addObservedAddr(e){let r=new ra(e),n=r.getPeerId();n&&fP.createFromB58String(n).equals(this.peerId)&&(r=r.decapsulate(new ra(`/p2p/${this.peerId}`)));let i=r.toString();this.observed.has(i)||(this.observed.add(i),this.emit("change:addresses"))}};ib.exports=nb});var cb=S((gq,ab)=>{"use strict";var{EventEmitter:dP}=Jt(),Ff=Ne()("latency-monitor:VisibilityChangeEmitter"),ob=class extends dP{constructor(){super();if(typeof document=="undefined"){Ff('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?Ff("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];Ff(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};ab.exports=ob});var fb=S((mq,lb)=>{"use strict";var{EventEmitter:hP}=Jt(),pP=cb(),an=Ne()("latency-monitor:LatencyMonitor"),ub=class extends hP{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:i}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=i||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,an("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?an("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):an("Not emitting summaries"),s.asyncTestFn=n}start(){globalThis.process&&globalThis.process.hrtime?(an("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(an("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(an("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),yP()&&(this._visibilityChangeEmitter=new pP,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),an("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,n={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},i=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(n.startTime)-n.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,an("MS: %s Data: %O",s,e._latencyData)};an("localData: %O",n),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(n.deltaOffset=0,n.startTime=e.now(),e.asyncTestFn(i)):(n.deltaOffset-=1,i())},n.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function yP(){return typeof window!="undefined"}lb.exports=ub});var vb=S((vq,mb)=>{"use strict";var db=Ne(),cn=Object.assign(db("libp2p:connection-manager"),{error:db("libp2p:connection-manager:err")}),hb=he(),gP=gs(),mP=fb(),pb=Yo(),{EventEmitter:vP}=Jt(),bP=ct(),{codes:{ERR_INVALID_PARAMETERS:yb}}=Fe(),EP={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},Es="connection-manager",Kf="peer-connections",Vf="all-connections",gb=class extends vP{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=gP.call({ignoreUndefined:!0},EP,r),this._options.maxConnections<this._options.minConnections)throw hb(new Error("Connection Manager maxConnections must be greater than minConnections"),yb);cn("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new mP({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||pb(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,cn("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),cn("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let n of r)e.push(n.close());await Promise.all(e),this.connections.clear(),this._libp2p.metrics&&this._libp2p.metrics.updateComponentMetric(Es,Kf,0),this._libp2p.metrics&&this._libp2p.metrics.updateComponentMetric(Es,Vf,0)}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",r);let n=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",n);let i=r+n;this._checkMaxLimit("maxData",i),cn("metrics update",i),this._timer=pb(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let r=e.remotePeer,n=r.toB58String(),i=this.connections.get(n);this.emit("peer:connect",e),i?i.push(e):(this.connections.set(n,[e]),this._libp2p.metrics&&this._libp2p.metrics.updateComponentMetric(Es,Kf,this.connections.size),this._libp2p.metrics&&this._libp2p.metrics.updateComponentMetric(Es,Vf,this.size)),this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(n)||this._peerValues.set(n,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let r=e.remotePeer.toB58String(),n=this.connections.get(r);n&&n.length>1?(n=n.filter(i=>i.id!==e.id),this.connections.set(r,n)):n&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e),this._libp2p.metrics&&this._libp2p.metrics.onPeerDisconnected(e.remotePeer)),this._libp2p.metrics&&this._libp2p.metrics.updateComponentMetric(Es,Kf,this.connections.size),this._libp2p.metrics&&this._libp2p.metrics.updateComponentMetric(Es,Vf,this.size)}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!bP.isPeerId(e))throw hb(new Error("peerId must be an instance of peer-id"),yb);let r=e.toB58String(),n=this.connections.get(r);return n?n.filter(i=>i.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,r){let n=this._options[e];cn("checking limit of %s. current value: %d of %d",e,r,n),r>n&&(cn("%s: limit exceeded: %s, %d",this._peerId,e,r),this._maybeDisconnectOne())}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((n,i)=>n[1]-i[1])));cn("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let n=r[0];cn("%s: lowest value peer is %s",this._peerId,n),cn("%s: closing a connection to %j",this._peerId,n);for(let i of this.connections.values())if(i[0].remotePeer.toB58String()===n){i[0].close();break}}}}};mb.exports=gb});var xb=S((bq,Sb)=>{"use strict";var bb=Ne(),wP=gs(),Eb=Yo(),vi=Object.assign(bb("libp2p:connection-manager:auto-dialler"),{error:bb("libp2p:connection-manager:auto-dialler:err")}),SP={enabled:!0,minConnections:0,autoDialInterval:1e4},wb=class{constructor(e,r={}){this._options=wP.call({ignoreUndefined:!0},SP,r),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),vi("options: %j",this._options)}start(){if(!this._options.enabled){vi("not enabled");return}this._running=!0,this._autoDial(),vi("started")}async stop(){if(!this._options.enabled){vi("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),vi("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=Eb(this._autoDial,this._options.autoDialInterval);return}let r=Array.from(this._libp2p.peerStore.peers.values()).sort((n,i)=>i.protocols&&i.protocols.length&&(!n.protocols||!n.protocols.length)||i.id.pubKey&&!n.id.pubKey?1:-1);for(let n=0;this._running&&n<r.length&&this._libp2p.connections.size<e;n++)if(!this._libp2p.connectionManager.get(r[n].id)){vi("connecting to a peerStore stored peer %s",r[n].id.toB58String());try{await this._libp2p.dialer.connectToPeer(r[n].id)}catch(i){vi.error("could not connect to peerStore stored peer",i)}}!this._running||(this._autoDialTimeout=Eb(this._autoDial,this._options.autoDialInterval))}};Sb.exports=wb});var Ob=S((Eq,Db)=>{"use strict";var{Multiaddr:jf}=Rt(),_b=ce("dns4"),Ab=ce("dns6"),Cb=ce("dnsaddr"),bi=Bt(ce("dns"),Cb,_b,Ab),na=Bt(ce("ip4"),ce("ip6")),ws=Bt(be(na,ce("tcp")),be(bi,ce("tcp"))),$f=be(na,ce("udp")),Ib=be($f,ce("utp")),Tb=be($f,ce("quic")),Ss=Bt(be(ws,ce("ws")),be(bi,ce("ws"))),xs=Bt(be(ws,ce("wss")),be(bi,ce("wss"))),Yc=Bt(be(ws,ce("http")),be(na,ce("http")),be(bi,ce("http"))),Wc=Bt(be(ws,ce("https")),be(na,ce("https")),be(bi,ce("https"))),Hf=Bt(be(Ss,ce("p2p-webrtc-star"),ce("p2p")),be(xs,ce("p2p-webrtc-star"),ce("p2p")),be(Ss,ce("p2p-webrtc-star")),be(xs,ce("p2p-webrtc-star"))),xP=Bt(be(Ss,ce("p2p-websocket-star"),ce("p2p")),be(xs,ce("p2p-websocket-star"),ce("p2p")),be(Ss,ce("p2p-websocket-star")),be(xs,ce("p2p-websocket-star"))),zf=Bt(be(Yc,ce("p2p-webrtc-direct"),ce("p2p")),be(Wc,ce("p2p-webrtc-direct"),ce("p2p")),be(Yc,ce("p2p-webrtc-direct")),be(Wc,ce("p2p-webrtc-direct"))),_s=Bt(Ss,xs,Yc,Wc,Hf,zf,ws,Ib,Tb,bi),_P=Bt(be(_s,ce("p2p-stardust"),ce("p2p")),be(_s,ce("p2p-stardust"))),Vn=Bt(be(_s,ce("p2p")),Hf,zf,ce("p2p")),Rb=Bt(be(Vn,ce("p2p-circuit"),Vn),be(Vn,ce("p2p-circuit")),be(ce("p2p-circuit"),Vn),be(_s,ce("p2p-circuit")),be(ce("p2p-circuit"),_s),ce("p2p-circuit")),Bb=()=>Bt(be(Rb,Bb),Rb),As=Bb(),Pb=Bt(be(As,Vn,As),be(Vn,As),be(As,Vn),As,Vn);Db.exports={DNS:bi,DNS4:_b,DNS6:Ab,DNSADDR:Cb,IP:na,TCP:ws,UDP:$f,QUIC:Tb,UTP:Ib,HTTP:Yc,HTTPS:Wc,WebSockets:Ss,WebSocketsSecure:xs,WebSocketStar:xP,WebRTCStar:Hf,WebRTCDirect:zf,Reliable:_s,Stardust:_P,Circuit:As,P2P:Pb,IPFS:Pb};function Nb(t){function e(r){if(!jf.isMultiaddr(r))try{r=new jf(r)}catch(i){return!1}let n=t(r.protoNames());return n===null?!1:n===!0||n===!1?n:n.length===0}return e}function be(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Nb(e),partialMatch:e}}function Bt(...t){function e(n){let i=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(n):s.partialMatch(n);return o?(i=o,!0):!1}),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Nb(e),partialMatch:e}}function ce(t){let e=t;function r(i){let s;if(typeof i=="string"||i instanceof Uint8Array)try{s=new jf(i)}catch(a){return!1}else s=i;let o=s.protoNames();return o.length===1&&o[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}});var Cs=S((wq,kb)=>{"use strict";var Ei=Xr(),Qc=Ei.Reader,Lb=Ei.Writer,fr=Ei.util,bt=Ei.roots["libp2p-circuit"]||(Ei.roots["libp2p-circuit"]={});bt.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,n){return n||(n=Lb.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&n.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&bt.CircuitRelay.Peer.encode(r.srcPeer,n.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&bt.CircuitRelay.Peer.encode(r.dstPeer,n.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&n.uint32(32).int32(r.code),n},t.decode=function(r,n){r instanceof Qc||(r=Qc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new bt.CircuitRelay;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=bt.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=bt.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof bt.CircuitRelay)return r;var n=new bt.CircuitRelay;switch(r.type){case"HOP":case 1:n.type=1;break;case"STOP":case 2:n.type=2;break;case"STATUS":case 3:n.type=3;break;case"CAN_HOP":case 4:n.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");n.srcPeer=bt.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");n.dstPeer=bt.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:n.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:n.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:n.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:n.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:n.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:n.code=260;break;case"HOP_CANT_DIAL_DST":case 261:n.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:n.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:n.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:n.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:n.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:n.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:n.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:n.code=351;break;case"STOP_RELAY_REFUSED":case 390:n.code=390;break;case"MALFORMED_MESSAGE":case 400:n.code=400;break}return n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.type=n.enums===String?"HOP":1,i.srcPeer=null,i.dstPeer=null,i.code=n.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(i.type=n.enums===String?bt.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(i.srcPeer=bt.CircuitRelay.Peer.toObject(r.srcPeer,n)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(i.dstPeer=bt.CircuitRelay.Peer.toObject(r.dstPeer,n)),r.code!=null&&r.hasOwnProperty("code")&&(i.code=n.enums===String?bt.CircuitRelay.Status[r.code]:r.code),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ei.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.id=fr.newBuffer([]),e.prototype.addrs=fr.emptyArray,e.encode=function(n,i){if(i||(i=Lb.create()),i.uint32(10).bytes(n.id),n.addrs!=null&&n.addrs.length)for(var s=0;s<n.addrs.length;++s)i.uint32(18).bytes(n.addrs[s]);return i},e.decode=function(n,i){n instanceof Qc||(n=Qc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new bt.CircuitRelay.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(n.bytes());break;default:n.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw fr.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(n){if(n instanceof bt.CircuitRelay.Peer)return n;var i=new bt.CircuitRelay.Peer;if(n.id!=null&&(typeof n.id=="string"?fr.base64.decode(n.id,i.id=fr.newBuffer(fr.base64.length(n.id)),0):n.id.length&&(i.id=n.id)),n.addrs){if(!Array.isArray(n.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");i.addrs=[];for(var s=0;s<n.addrs.length;++s)typeof n.addrs[s]=="string"?fr.base64.decode(n.addrs[s],i.addrs[s]=fr.newBuffer(fr.base64.length(n.addrs[s])),0):n.addrs[s].length&&(i.addrs[s]=n.addrs[s])}return i},e.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addrs=[]),i.defaults&&(i.bytes===String?s.id="":(s.id=[],i.bytes!==Array&&(s.id=fr.newBuffer(s.id)))),n.id!=null&&n.hasOwnProperty("id")&&(s.id=i.bytes===String?fr.base64.encode(n.id,0,n.id.length):i.bytes===Array?Array.prototype.slice.call(n.id):n.id),n.addrs&&n.addrs.length){s.addrs=[];for(var o=0;o<n.addrs.length;++o)s.addrs[o]=i.bytes===String?fr.base64.encode(n.addrs[o],0,n.addrs[o].length):i.bytes===Array?Array.prototype.slice.call(n.addrs[o]):n.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ei.util.toJSONOptions)},e}(),t}();kb.exports=bt});var Ub=S((Sq,qb)=>{qb.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Fb=S((_q,Mb)=>{Mb.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var Wf=S((Aq,wi)=>{var AP=Ub(),Gf=Fb(),Kb=(t,e,r)=>Yf(t,Array.isArray(e)?e:[{signal:e,options:r}]),Yf=(t,e)=>{t=AP(t),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*r(){let n,i=()=>{n&&n()};for(let{signal:s}of e)s.addEventListener("abort",i);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new Gf(u,l)}let o=new Promise((a,c)=>{n=()=>{let{options:u}=e.find(({signal:d})=>d.aborted),{abortMessage:l,abortCode:f}=u;c(new Gf(l,f))}});s=await Promise.race([o,t.next()]),n=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",i);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function"&&await t.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",i)}return r()},Vb=(t,e,r)=>jb(t,Array.isArray(e)?e:[{signal:e,options:r}]),jb=(t,e)=>r=>t(Yf(r,e)),CP=(t,e,r)=>IP(t,Array.isArray(e)?e:[{signal:e,options:r}]),IP=(t,e)=>({sink:jb(t.sink,e),source:Yf(t.source,e)});wi.exports=Kb;wi.exports.AbortError=Gf;wi.exports.source=Kb;wi.exports.sink=Vb;wi.exports.transform=Vb;wi.exports.duplex=CP});var zb=S((Cq,Hb)=>{"use strict";var{source:$b}=Wf(),TP=Ne(),RP=TP("libp2p:stream:converter");function BP({stream:t,remoteAddr:e,localAddr:r},n={}){let{sink:i,source:s}=t,o={async sink(c){n.signal&&(c=$b(c,n.signal));try{await i(c)}catch(u){u.type!=="aborted"&&RP(u)}a()},source:n.signal?$b(s,n.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return i(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Hb.exports=BP});var ia=S((Iq,Gb)=>{"use strict";Gb.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var Wb=S((Tq,Yb)=>{"use strict";var{EventEmitter:PP}=Jt(),{Multiaddr:NP}=Rt();Yb.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await t.dial(new NP(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),i.emit("listening")}function n(){let s=[];for(let o of e.values())s.push(o);return s}let i=Object.assign(new PP,{close:()=>Promise.resolve(),listen:r,getAddrs:n});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&i.emit("close")}),i}});var Qf=S((Rq,Zb)=>{"use strict";var{Multiaddr:Qb}=Rt(),{CircuitRelay:Si}=Cs();function Xb(t,e){t.write({type:Si.Type.STATUS,code:e})}function DP(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new Qb(r))}catch(r){throw Xb(e,t.type===Si.Type.HOP?Si.Status.HOP_DST_MULTIADDR_INVALID:Si.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new Qb(r))}catch(r){throw Xb(e,t.type===Si.Type.HOP?Si.Status.HOP_SRC_MULTIADDR_INVALID:Si.Status.STOP_SRC_MULTIADDR_INVALID),r}}Zb.exports={validateAddrs:DP}});var tE=S(Xc=>{"use strict";Xc.byteLength=LP;Xc.toByteArray=qP;Xc.fromByteArray=FP;var Hr=[],dr=[],OP=typeof Uint8Array!="undefined"?Uint8Array:Array,Xf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(xi=0,Jb=Xf.length;xi<Jb;++xi)Hr[xi]=Xf[xi],dr[Xf.charCodeAt(xi)]=xi;var xi,Jb;dr["-".charCodeAt(0)]=62;dr["_".charCodeAt(0)]=63;function eE(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function LP(t){var e=eE(t),r=e[0],n=e[1];return(r+n)*3/4-n}function kP(t,e,r){return(e+r)*3/4-r}function qP(t){var e,r=eE(t),n=r[0],i=r[1],s=new OP(kP(t,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=dr[t.charCodeAt(c)]<<18|dr[t.charCodeAt(c+1)]<<12|dr[t.charCodeAt(c+2)]<<6|dr[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=dr[t.charCodeAt(c)]<<2|dr[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=dr[t.charCodeAt(c)]<<10|dr[t.charCodeAt(c+1)]<<4|dr[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function UP(t){return Hr[t>>18&63]+Hr[t>>12&63]+Hr[t>>6&63]+Hr[t&63]}function MP(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(UP(n));return i.join("")}function FP(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(MP(t,o,o+s>a?a:o+s));return n===1?(e=t[r-1],i.push(Hr[e>>2]+Hr[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Hr[e>>10]+Hr[e>>4&63]+Hr[e<<2&63]+"=")),i.join("")}});var rE=S(Zf=>{Zf.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=t[e+f];for(f+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=s*256+t[e+f],f+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=o*256+t[e+f],f+=d,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(p?-1:1)*o*Math.pow(2,s-n)};Zf.write=function(t,e,r,n,i,s){var o,a,c,u=s*8-i-1,l=(1<<u)-1,f=l>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=d/c:e+=d*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=a&255,p+=h,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+p]=o&255,p+=h,o/=256,u-=8);t[r+p-h]|=g*128}});var $n=S(Bs=>{"use strict";var Jf=tE(),Is=rE(),nE=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Bs.Buffer=M;Bs.SlowBuffer=zP;Bs.INSPECT_MAX_BYTES=50;var Zc=2147483647;Bs.kMaxLength=Zc;M.TYPED_ARRAY_SUPPORT=KP();!M.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function KP(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(M.prototype,"parent",{enumerable:!0,get:function(){if(!!M.isBuffer(this))return this.buffer}});Object.defineProperty(M.prototype,"offset",{enumerable:!0,get:function(){if(!!M.isBuffer(this))return this.byteOffset}});function un(t){if(t>Zc)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,M.prototype),e}function M(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ed(t)}return iE(t,e,r)}M.poolSize=8192;function iE(t,e,r){if(typeof t=="string")return jP(t,e);if(ArrayBuffer.isView(t))return $P(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(zr(t,ArrayBuffer)||t&&zr(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(zr(t,SharedArrayBuffer)||t&&zr(t.buffer,SharedArrayBuffer)))return rd(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return M.from(n,e,r);let i=HP(t);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return M.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}M.from=function(t,e,r){return iE(t,e,r)};Object.setPrototypeOf(M.prototype,Uint8Array.prototype);Object.setPrototypeOf(M,Uint8Array);function sE(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function VP(t,e,r){return sE(t),t<=0?un(t):e!==void 0?typeof r=="string"?un(t).fill(e,r):un(t).fill(e):un(t)}M.alloc=function(t,e,r){return VP(t,e,r)};function ed(t){return sE(t),un(t<0?0:nd(t)|0)}M.allocUnsafe=function(t){return ed(t)};M.allocUnsafeSlow=function(t){return ed(t)};function jP(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!M.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=oE(t,e)|0,n=un(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function td(t){let e=t.length<0?0:nd(t.length)|0,r=un(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function $P(t){if(zr(t,Uint8Array)){let e=new Uint8Array(t);return rd(e.buffer,e.byteOffset,e.byteLength)}return td(t)}function rd(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,M.prototype),n}function HP(t){if(M.isBuffer(t)){let e=nd(t.length)|0,r=un(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||od(t.length)?un(0):td(t);if(t.type==="Buffer"&&Array.isArray(t.data))return td(t.data)}function nd(t){if(t>=Zc)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Zc.toString(16)+" bytes");return t|0}function zP(t){return+t!=t&&(t=0),M.alloc(+t)}M.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==M.prototype};M.compare=function(e,r){if(zr(e,Uint8Array)&&(e=M.from(e,e.offset,e.byteLength)),zr(r,Uint8Array)&&(r=M.from(r,r.offset,r.byteLength)),!M.isBuffer(e)||!M.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0};M.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};M.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return M.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=M.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){let o=e[n];if(zr(o,Uint8Array))s+o.length>i.length?(M.isBuffer(o)||(o=M.from(o)),o.copy(i,s)):Uint8Array.prototype.set.call(i,o,s);else if(M.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function oE(t,e){if(M.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||zr(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return sd(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return vE(t).length;default:if(i)return n?-1:sd(t).length;e=(""+e).toLowerCase(),i=!0}}M.byteLength=oE;function GP(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return n3(this,e,r);case"utf8":case"utf-8":return uE(this,e,r);case"ascii":return t3(this,e,r);case"latin1":case"binary":return r3(this,e,r);case"base64":return JP(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i3(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}M.prototype._isBuffer=!0;function _i(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}M.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)_i(this,r,r+1);return this};M.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)_i(this,r,r+3),_i(this,r+1,r+2);return this};M.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)_i(this,r,r+7),_i(this,r+1,r+6),_i(this,r+2,r+5),_i(this,r+3,r+4);return this};M.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?uE(this,0,e):GP.apply(this,arguments)};M.prototype.toLocaleString=M.prototype.toString;M.prototype.equals=function(e){if(!M.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:M.compare(this,e)===0};M.prototype.inspect=function(){let e="",r=Bs.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};nE&&(M.prototype[nE]=M.prototype.inspect);M.prototype.compare=function(e,r,n,i,s){if(zr(e,Uint8Array)&&(e=M.from(e,e.offset,e.byteLength)),!M.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let o=s-i,a=n-r,c=Math.min(o,a),u=this.slice(i,s),l=e.slice(r,n);for(let f=0;f<c;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0};function aE(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,od(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=M.from(e,n)),M.isBuffer(e))return e.length===0?-1:cE(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):cE(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function cE(t,e,r,n,i){let s=1,o=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}let u;if(i){let l=-1;for(u=r;u<o;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){let l=!0;for(let f=0;f<a;f++)if(c(t,u+f)!==c(e,f)){l=!1;break}if(l)return u}return-1}M.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};M.prototype.indexOf=function(e,r,n){return aE(this,e,r,n,!0)};M.prototype.lastIndexOf=function(e,r,n){return aE(this,e,r,n,!1)};function YP(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let o;for(o=0;o<n;++o){let a=parseInt(e.substr(o*2,2),16);if(od(a))return o;t[r+o]=a}return o}function WP(t,e,r,n){return Jc(sd(e,t.length-r),t,r,n)}function QP(t,e,r,n){return Jc(c3(e),t,r,n)}function XP(t,e,r,n){return Jc(vE(e),t,r,n)}function ZP(t,e,r,n){return Jc(u3(e,t.length-r),t,r,n)}M.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return YP(this,e,r,n);case"utf8":case"utf-8":return WP(this,e,r,n);case"ascii":case"latin1":case"binary":return QP(this,e,r,n);case"base64":return XP(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ZP(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};M.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function JP(t,e,r){return e===0&&r===t.length?Jf.fromByteArray(t):Jf.fromByteArray(t.slice(e,r))}function uE(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=r){let c,u,l,f;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[i+1],(c&192)==128&&(f=(s&31)<<6|c&63,f>127&&(o=f));break;case 3:c=t[i+1],u=t[i+2],(c&192)==128&&(u&192)==128&&(f=(s&15)<<12|(c&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:c=t[i+1],u=t[i+2],l=t[i+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(f=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=a}return e3(n)}var lE=4096;function e3(t){let e=t.length;if(e<=lE)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=lE));return r}function t3(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function r3(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function n3(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let s=e;s<r;++s)i+=l3[t[s]];return i}function i3(t,e,r){let n=t.slice(e,r),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}M.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,M.prototype),i};function Et(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}M.prototype.readUintLE=M.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Et(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return i};M.prototype.readUintBE=M.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Et(e,r,this.length);let i=this[e+--r],s=1;for(;r>0&&(s*=256);)i+=this[e+--r]*s;return i};M.prototype.readUint8=M.prototype.readUInt8=function(e,r){return e=e>>>0,r||Et(e,1,this.length),this[e]};M.prototype.readUint16LE=M.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Et(e,2,this.length),this[e]|this[e+1]<<8};M.prototype.readUint16BE=M.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Et(e,2,this.length),this[e]<<8|this[e+1]};M.prototype.readUint32LE=M.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Et(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};M.prototype.readUint32BE=M.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Et(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};M.prototype.readBigUInt64LE=jn(function(e){e=e>>>0,Rs(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sa(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))});M.prototype.readBigUInt64BE=jn(function(e){e=e>>>0,Rs(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sa(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)});M.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Et(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*r)),i};M.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Et(e,r,this.length);let i=r,s=1,o=this[e+--i];for(;i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};M.prototype.readInt8=function(e,r){return e=e>>>0,r||Et(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};M.prototype.readInt16LE=function(e,r){e=e>>>0,r||Et(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};M.prototype.readInt16BE=function(e,r){e=e>>>0,r||Et(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};M.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Et(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};M.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Et(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};M.prototype.readBigInt64LE=jn(function(e){e=e>>>0,Rs(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sa(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});M.prototype.readBigInt64BE=jn(function(e){e=e>>>0,Rs(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sa(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});M.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Et(e,4,this.length),Is.read(this,e,!0,23,4)};M.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Et(e,4,this.length),Is.read(this,e,!1,23,4)};M.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Et(e,8,this.length),Is.read(this,e,!0,52,8)};M.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Et(e,8,this.length),Is.read(this,e,!1,52,8)};function jt(t,e,r,n,i,s){if(!M.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}M.prototype.writeUintLE=M.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;jt(this,e,r,n,a,0)}let s=1,o=0;for(this[r]=e&255;++o<n&&(s*=256);)this[r+o]=e/s&255;return r+n};M.prototype.writeUintBE=M.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;jt(this,e,r,n,a,0)}let s=n-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+n};M.prototype.writeUint8=M.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,1,255,0),this[r]=e&255,r+1};M.prototype.writeUint16LE=M.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};M.prototype.writeUint16BE=M.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};M.prototype.writeUint32LE=M.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};M.prototype.writeUint32BE=M.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function fE(t,e,r,n,i){mE(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function dE(t,e,r,n,i){mE(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}M.prototype.writeBigUInt64LE=jn(function(e,r=0){return fE(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});M.prototype.writeBigUInt64BE=jn(function(e,r=0){return dE(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});M.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);jt(this,e,r,n,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<n&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};M.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);jt(this,e,r,n,c-1,-c)}let s=n-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};M.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};M.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};M.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};M.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};M.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||jt(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};M.prototype.writeBigInt64LE=jn(function(e,r=0){return fE(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});M.prototype.writeBigInt64BE=jn(function(e,r=0){return dE(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function hE(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function pE(t,e,r,n,i){return e=+e,r=r>>>0,i||hE(t,e,r,4,34028234663852886e22,-34028234663852886e22),Is.write(t,e,r,n,23,4),r+4}M.prototype.writeFloatLE=function(e,r,n){return pE(this,e,r,!0,n)};M.prototype.writeFloatBE=function(e,r,n){return pE(this,e,r,!1,n)};function yE(t,e,r,n,i){return e=+e,r=r>>>0,i||hE(t,e,r,8,17976931348623157e292,-17976931348623157e292),Is.write(t,e,r,n,52,8),r+8}M.prototype.writeDoubleLE=function(e,r,n){return yE(this,e,r,!0,n)};M.prototype.writeDoubleBE=function(e,r,n){return yE(this,e,r,!1,n)};M.prototype.copy=function(e,r,n,i){if(!M.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),s};M.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!M.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{let o=M.isBuffer(e)?e:M.from(e,i),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=o[s%a]}return this};var Ts={};function id(t,e,r){Ts[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}id("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);id("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);id("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=gE(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=gE(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function gE(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function s3(t,e,r){Rs(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&sa(e,t.length-(r+1))}function mE(t,e,r,n,i,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new Ts.ERR_OUT_OF_RANGE("value",a,t)}s3(n,i,s)}function Rs(t,e){if(typeof t!="number")throw new Ts.ERR_INVALID_ARG_TYPE(e,"number",t)}function sa(t,e,r){throw Math.floor(t)!==t?(Rs(t,r),new Ts.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new Ts.ERR_BUFFER_OUT_OF_BOUNDS:new Ts.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var o3=/[^+/0-9A-Za-z-_]/g;function a3(t){if(t=t.split("=")[0],t=t.trim().replace(o3,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function sd(t,e){e=e||1/0;let r,n=t.length,i=null,s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function c3(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function u3(t,e){let r,n,i,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}function vE(t){return Jf.toByteArray(a3(t))}function Jc(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function zr(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function od(t){return t!==t}var l3=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function jn(t){return typeof BigInt=="undefined"?f3:t}function f3(){throw new Error("BigInt not supported")}});var Ai=S((Oq,EE)=>{"use strict";var{Buffer:wr}=$n(),bE=Symbol.for("BufferList");function je(t){if(!(this instanceof je))return new je(t);je._init.call(this,t)}je._init=function(e){Object.defineProperty(this,bE,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};je.prototype._new=function(e){return new je(e)};je.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){let i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}};je.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r};je.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};je.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};je.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||wr.alloc(0);let s=!!e,o=this._offset(n),a=i-n,c=a,u=s&&r||0,l=o[1];if(n===0&&i===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:wr.concat(this._bufs,this.length);for(let f=0;f<this._bufs.length;f++)this._bufs[f].copy(e,u),u+=this._bufs[f].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,r,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=wr.allocUnsafe(a));for(let f=o[0];f<this._bufs.length;f++){let d=this._bufs[f].length-l;if(c>d)this._bufs[f].copy(e,u,l),u+=d;else{this._bufs[f].copy(e,u,l,l+c),u+=d;break}c-=d,l&&(l=0)}return e.length>u?e.slice(0,u):e};je.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let n=this._offset(e),i=this._offset(r),s=this._bufs.slice(n[0],i[0]+1);return i[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,i[1]),n[1]!==0&&(s[0]=s[0].slice(n[1])),this._new(s)};je.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)};je.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};je.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};je.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(wr.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(wr.from(e));return this};je.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};je.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=wr.from([t]):typeof t=="string"?t=wr.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=wr.from(t.buffer,t.byteOffset,t.byteLength):wr.isBuffer(t)||(t=wr.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],s=n[1];for(;i<this._bufs.length;i++){let o=this._bufs[i];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([i,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([i,s]);if(this._match(c,t))return c;s++}s=0}return-1};je.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?je.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:je.prototype[r]=function(n=0){return this.slice(n,n+t[r])[r](0)}})(e)})();je.prototype._isBufferList=function(e){return e instanceof je||je.isBufferList(e)};je.isBufferList=function(e){return e!=null&&e[bE]};EE.exports=je});var ad=S((Lq,xE)=>{"use strict";var wE=di(),{Buffer:d3}=$n(),SE=(t,e,r)=>{let n=wE.encode(t,e,r);return SE.bytes=wE.encode.bytes,e||d3.from(n)};xE.exports=SE});var RE=S((kq,eu)=>{"use strict";var{Buffer:_E}=$n(),AE=Ai(),CE=ad(),cd=8,IE=10*1024;function TE(t){t=t||{};let e=Math.max(t.poolSize||IE,t.minPoolSize||cd),r=t.lengthEncoder||CE;return async function*(i){let s=_E.alloc(e),o=0;for await(let a of i){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<cd&&(s=_E.alloc(e),o=0),yield new AE().append(c).append(a)}}}TE.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||CE;return new AE([r(t.length),t.slice()])};eu.exports=TE;eu.exports.MIN_POOL_SIZE=cd;eu.exports.DEFAULT_POOL_SIZE=IE});var ud=S((qq,NE)=>{"use strict";var BE=di(),{Buffer:h3}=$n(),p3=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),PE=t=>{let e=BE.decode(h3.isBuffer(t)?t:p3(t));return PE.bytes=BE.decode.bytes,e};NE.exports=PE});var kE=S((Uq,tu)=>{"use strict";var{Buffer:y3}=$n(),ld=Ai(),g3=ud(),DE=8,OE=1024*1024*4,LE=y3.alloc(0),Hn={LENGTH:"readLength",DATA:"readData"},m3={[Hn.LENGTH]:(t,e,r,n)=>{e=e.append(t);let i;try{i=n.lengthDecoder(e)}catch(s){if(e.length>n.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Hn.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(i>n.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(n.lengthDecoder.bytes),e=new ld,n.onLength&&n.onLength(i),i<=0?(n.onData&&n.onData(LE),{mode:Hn.LENGTH,chunk:t,buffer:e,data:LE}):{mode:Hn.DATA,chunk:t,buffer:e,state:{dataLength:i},data:void 0}},[Hn.DATA]:(t,e,r,n)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:Hn.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=e.shallowSlice(0,i),o=e.length>i?e.shallowSlice(i):void 0;return e=new ld,n.onData&&n.onData(s),{mode:Hn.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function fd(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||g3,maxLengthLength:t.maxLengthLength||DE,maxDataLength:t.maxDataLength||OE,onLength:t.onLength,onData:t.onData};return async function*(n){let i=new ld,s=Hn.LENGTH,o;for await(let a of n){let c=a;for(;c;){let u=m3[s](c,i,o,e);s=u.mode,c=u.chunk,i=u.buffer,o=u.state,u.data&&(yield u.data)}}if(i.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}fd.fromReader=(t,e)=>{let r=1,n={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return fd({...e||{},onLength:s=>{r=s}})(n)};tu.exports=fd;tu.exports.MAX_LENGTH_LENGTH=DE;tu.exports.MAX_DATA_LENGTH=OE});var ME=S((Mq,UE)=>{"use strict";var{Buffer:v3}=$n(),qE=(t,e,r)=>(e=e||v3.allocUnsafe(4),e.writeInt32BE(t,r),e);qE.bytes=4;UE.exports=qE});var VE=S((Fq,KE)=>{"use strict";var FE=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};FE.bytes=4;KE.exports=FE});var oa=S(Ci=>{"use strict";Ci.encode=RE();Ci.decode=kE();Ci.varintEncode=ad();Ci.varintDecode=ud();Ci.int32BEEncode=ME();Ci.int32BEDecode=VE()});var hd=S((Vq,jE)=>{var dd=Ai();jE.exports=t=>{let e=async function*(){let r=yield,n=new dd;for await(let i of t){if(!r){r=yield n.append(i),n=new dd;continue}for(n.append(i);n.length>=r;){let s=n.shallowSlice(0,r);if(n.consume(r),r=yield s,!r){n.length&&(r=yield n,n=new dd);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e}});var pd=S((jq,$E)=>{"use strict";var b3=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};$E.exports=b3});var aa=S(($q,HE)=>{"use strict";var E3=hd(),w3=bf(),S3=pd();HE.exports=t=>{let e=w3(),r=E3(t.source),n=S3(),i,s=t.sink(async function*(){yield*e,yield*await n.promise}());return s.catch(a=>{i=a}),{reader:r,writer:e,stream:{sink:a=>i?Promise.reject(i):(n.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var nu=S((Hq,QE)=>{"use strict";var zE=Ne(),ru=Object.assign(zE("libp2p:circuit:stream-handler"),{error:zE("libp2p:circuit:stream-handler:err")}),GE=oa(),x3=aa(),{CircuitRelay:YE}=Cs(),WE=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=x3(this.stream),this.decoder=GE.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=YE.decode(e.value.slice());return ru("read message type",r.type),r}ru("read received no value, closing stream"),this.close()}write(e){ru("write message type %s",e.type),this.shake.write(GE.encode.single(YE.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){ru("closing the stream"),this.rest().sink([])}};QE.exports=WE});var md=S((zq,gd)=>{"use strict";var XE=Ne(),ca=Object.assign(XE("libp2p:circuit:stop"),{error:XE("libp2p:circuit:stop:err")}),{CircuitRelay:yd}=Cs(),_3=ia(),A3=nu(),{validateAddrs:C3}=Qf();gd.exports.handleStop=function({connection:e,request:r,streamHandler:n}){try{C3(r,n)}catch(i){return ca.error("invalid stop request via peer %s",e.remotePeer.toB58String(),i)}return ca("stop request is valid"),n.write({type:yd.Type.STATUS,code:yd.Status.SUCCESS}),n.rest()};gd.exports.stop=async function({connection:e,request:r}){let{stream:n}=await e.newStream([_3.relay]);ca("starting stop request to %s",e.remotePeer.toB58String());let i=new A3({stream:n});i.write(r);let s=await i.read();if(!s)return i.close();if(s.code===yd.Status.SUCCESS)return ca("stop request to %s was successful",e.remotePeer.toB58String()),i.rest();ca("stop request failed with code %d",s.code),i.close()}});var vd=S((Gq,nw)=>{"use strict";var ZE=Ne(),ln=Object.assign(ZE("libp2p:circuit:hop"),{error:ZE("libp2p:circuit:hop:err")}),JE=he(),I3=ct(),{validateAddrs:T3}=Qf(),ew=nu(),{CircuitRelay:Yt}=Cs(),{pipe:R3}=jr(),{codes:tw}=Fe(),{stop:B3}=md(),rw=ia();async function P3({connection:t,request:e,streamHandler:r,circuit:n}){if(!n._options.hop.enabled)return ln("HOP request received but we are not acting as a relay"),r.end({type:Yt.Type.STATUS,code:Yt.Status.HOP_CANT_SPEAK_RELAY});try{T3(e,r)}catch(u){return ln.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){ln("HOP request received but we do not receive a dstPeer");return}let i=new I3(e.dstPeer.id),s=n._connectionManager.get(i);if(!s&&!n._options.hop.active)return ln("HOP request received but we are not connected to the destination peer"),r.end({type:Yt.Type.STATUS,code:Yt.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:Yt.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await B3({connection:s,request:o})}catch(u){return ln.error(u)}ln("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:Yt.Type.STATUS,code:Yt.Status.SUCCESS});let c=r.rest();return R3(c,a,c)}async function N3({connection:t,request:e}){let{stream:r}=await t.newStream([rw.relay]),n=new ew({stream:r});n.write(e);let i=await n.read();if(!i)throw JE(new Error("HOP request had no response"),tw.ERR_HOP_REQUEST_FAILED);if(i.code===Yt.Status.SUCCESS)return ln("hop request was successful"),n.rest();throw ln("hop request failed with code %d, closing stream",i.code),n.close(),JE(new Error(`HOP request failed with code ${i.code}`),tw.ERR_HOP_REQUEST_FAILED)}async function D3({connection:t}){let{stream:e}=await t.newStream([rw.relay]),r=new ew({stream:e});r.write({type:Yt.Type.CAN_HOP});let n=await r.read();return await r.close(),!(!n||n.code!==Yt.Status.SUCCESS)}function O3({connection:t,streamHandler:e,circuit:r}){let n=r._options.hop.enabled;ln("can hop (%s) request from %s",n,t.remotePeer.toB58String()),e.end({type:Yt.Type.STATUS,code:n?Yt.Status.SUCCESS:Yt.Status.HOP_CANT_SPEAK_RELAY})}nw.exports={handleHop:P3,hop:N3,canHop:D3,handleCanHop:O3}});var uw=S((Yq,cw)=>{"use strict";var iw=Ne(),fn=Object.assign(iw("libp2p:circuit"),{error:iw("libp2p:circuit:err")}),L3=he(),k3=Ob(),{Multiaddr:ua}=Rt(),sw=ct(),{CircuitRelay:la}=Cs(),{codes:q3}=Fe(),ow=zb(),{relay:U3}=ia(),M3=Wb(),{handleCanHop:F3,handleHop:K3,hop:V3}=vd(),{handleStop:j3}=md(),$3=nu(),H3=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),aw=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(U3,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let n=new $3({stream:r}),i=await n.read();if(!i)return;let s=this,o;switch(i.type){case la.Type.CAN_HOP:{fn("received CAN_HOP request from %s",e.remotePeer.toB58String()),await F3({circuit:s,connection:e,streamHandler:n});break}case la.Type.HOP:{fn("received HOP request from %s",e.remotePeer.toB58String()),o=await K3({connection:e,request:i,streamHandler:n,circuit:s});break}case la.Type.STOP:{fn("received STOP request from %s",e.remotePeer.toB58String()),o=await j3({connection:e,request:i,streamHandler:n});break}default:fn("Request of type %s not supported",i.type)}if(o){let a=new ua(i.dstPeer.addrs[0]),c=new ua(i.srcPeer.addrs[0]),u=ow({stream:o,remoteAddr:a,localAddr:c}),l=i.type===la.Type.HOP?"relay":"inbound";fn("new %s connection %s",l,u.remoteAddr);let f=await this._upgrader.upgradeInbound(u);fn("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(f)}}async dial(e,r){let n=e.toString().split("/p2p-circuit"),i=new ua(n[0]),s=new ua(n[n.length-1]),o=i.getPeerId(),a=s.getPeerId();if(!o||!a){let d="Circuit relay dial failed as addresses did not have peer id";throw fn.error(d),L3(new Error(d),q3.ERR_RELAYED_DIAL)}let c=sw.createFromB58String(o),u=sw.createFromB58String(a),l=!1,f=this._connectionManager.get(c);f||(f=await this._dialer.connectToPeer(i,r),l=!0);try{let d=await V3({connection:f,request:{type:la.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(g=>g.bytes)},dstPeer:{id:u.toBytes(),addrs:[new ua(s).bytes]}}}),p=i.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),h=ow({stream:d,remoteAddr:e,localAddr:p});return fn("new outbound connection %s",h.remoteAddr),this._upgrader.upgradeOutbound(h)}catch(d){throw fn.error("Circuit relay dial failed",d),l&&await f.close(),d}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,M3(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>k3.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[H3])}};cw.exports=aw});var bd=S((Wq,lw)=>{"use strict";var{CID:z3}=(Gi(),ho),{sha256:G3}=(ci(),Tn);lw.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await G3.digest(e);return z3.createV0(r)}});var mw=S((Qq,gw)=>{"use strict";var fw=Ne(),dw=Object.assign(fw("libp2p:auto-relay"),{error:fw("libp2p:auto-relay:err")}),{fromString:Y3}=(St(),At),{toString:W3}=(xt(),Ct),{Multiaddr:Q3}=Rt(),X3=ct(),{relay:Z3}=ia(),{canHop:J3}=vd(),{namespaceToCid:eN}=bd(),{CIRCUIT_PROTO_CODE:tN,HOP_METADATA_KEY:hw,HOP_METADATA_VALUE:pw,RELAY_RENDEZVOUS_NS:rN}=Kc(),yw=class{constructor({libp2p:e,maxListeners:r=1,onError:n}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(i,s)=>{dw.error(s||i),n&&n(i,s)}}async _onProtocolChange({peerId:e,protocols:r}){let n=e.toB58String(),i=r.find(s=>s===Z3);if(!i&&this._listenRelays.has(n)){this._removeListenRelay(n);return}else if(!i||this._listenRelays.has(n))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(tN)){dw(`relayed connection to ${n} will not be used to hop on`);return}await J3({connection:s})&&(this._peerStore.metadataBook.set(e,hw,Y3(pw)),await this._addListenRelay(s,n))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let n=e.remotePeer.toB58String();!this._listenRelays.has(n)||this._removeListenRelay(n)}async _addListenRelay(e,r){if(this._listenRelays.size>=this.maxListeners)return;let n=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!n||!n.length)return;let i=`${n[0].toString()}/p2p-circuit`;this._listenRelays.add(r);try{await this._transportManager.listen([new Q3(i)])}catch(s){this._onError(s),this._listenRelays.delete(r)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[];for(let[n,i]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(n)||e.includes(n))continue;let s=i.get(hw);if(!s||W3(s)!==pw)continue;let o=X3.createFromB58String(n),a=this._connectionManager.get(o);if(!a){r.push(o);continue}if(await this._addListenRelay(a,n),this._listenRelays.size>=this.maxListeners)return}for(let n of r)if(await this._tryToListenOnRelay(n),this._listenRelays.size>=this.maxListeners)return;try{let n=await eN(rN);for await(let i of this._libp2p.contentRouting.findProviders(n)){if(!i.multiaddrs.length)continue;let s=i.id;if(this._peerStore.addressBook.add(s,i.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(n){this._onError(n)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};gw.exports=yw});var Sw=S((Xq,ww)=>{"use strict";var vw=Ne(),bw=Object.assign(vw("libp2p:relay"),{error:vw("libp2p:relay:err")}),{codes:nN}=Fe(),{setDelayedInterval:iN,clearDelayedInterval:sN}=xf(),oN=mw(),{namespaceToCid:aN}=bd(),{RELAY_RENDEZVOUS_NS:cN}=Kc(),Ew=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new oN({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=iN(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){sN(this._timeout)}async _advertiseService(){try{let e=await aN(cN);await this._libp2p.contentRouting.provide(e)}catch(e){e.code===nN.ERR_NO_ROUTERS_AVAILABLE?(bw.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):bw.error(e)}}};ww.exports=Ew});var wd=S((Zq,Ed)=>{var{AbortController:uN}=yf();function xw(t){let e=new uN;function r(){e.abort();for(let n of t)!n||!n.removeEventListener||n.removeEventListener("abort",r)}for(let n of t)if(!(!n||!n.addEventListener)){if(n.aborted){r();break}n.addEventListener("abort",r)}return e.signal}Ed.exports=xw;Ed.exports.anySignal=xw});var Iw=S((eU,Cw)=>{var _w=mf(),Aw=pd();Cw.exports=class{constructor(){this._buffer=new _w,this._waitingConsumers=new _w}push(e){let{promise:r,resolve:n}=Aw();return this._buffer.push({chunk:e,resolve:n}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=Aw();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var Rw=S((tU,Tw)=>{"use strict";Tw.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(n,r.indent.repeat(e))}});var Bw=S(()=>{});var Ow=S((iU,Dw)=>{"use strict";var Pw=Bw(),Nw=/\s+at.*(?:\(|\s)(.*)\)?/,lN=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,fN=typeof Pw.homedir=="undefined"?"":Pw.homedir();Dw.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let n=r.match(Nw);if(n===null||!n[1])return!0;let i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!lN.test(i)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(Nw,(n,i)=>n.replace(i,i.replace(fN,"~"))):r).join(`
`))});var qw=S((sU,kw)=>{"use strict";var dN=Rw(),hN=Ow(),pN=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Lw=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=e.map(n=>typeof n.stack=="string"?pN(hN(n.stack)):String(n)).join(`
`);r=`
`+dN(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};kw.exports=Lw});var Uw=S((oU,xd)=>{"use strict";var Sd=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},fa=class{static fn(e){return(...r)=>new fa((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new Sd(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(fa.prototype,Promise.prototype);xd.exports=fa;xd.exports.CancelError=Sd});var Fw=S((aU,iu)=>{"use strict";var Mw=qw(),yN=Uw(),_d=class extends Error{},gN=(t,e)=>new yN((r,n,i)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){n(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,f=new Set,d=()=>(a.length===s&&(r(a),l=!0),u-c.length<s&&(n(new Mw(c)),l=!0),l),p=()=>{for(let h of t)!f.has(h)&&typeof h.cancel=="function"&&h.cancel()};i(p);for(let h of t)u++,(async()=>{try{let g=await h;if(l)return;if(!o(g))throw new _d("Value does not satisfy filter");a.push(g)}catch(g){c.push(g)}finally{f.add(h),!l&&d()&&p()}})();s>u&&(n(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});iu.exports=gN;iu.exports.AggregateError=Mw;iu.exports.FilterError=_d});var Kw=S((cU,Cd)=>{"use strict";var Ad=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},da=class{static fn(e){return(...r)=>new da((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new Ad(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(da.prototype,Promise.prototype);Cd.exports=da;Cd.exports.CancelError=Ad});var jw=S((uU,Id)=>{"use strict";var Vw=Fw(),mN=Kw();Id.exports=(t,e)=>{let r=Vw(t,{...e,count:1});return mN.fn(async n=>{n(()=>{r.cancel()});let[i]=await r;return i})()};Id.exports.AggregateError=Vw.AggregateError});var Gw=S((lU,zw)=>{"use strict";var vN=he(),{anySignal:bN}=wd(),EN=Iw(),wN=jw(),{setMaxListeners:$w}=Jt(),{codes:SN}=Fe(),Hw=class{constructor({addrs:e,dialAction:r,dialer:n}){this.addrs=e,this.dialer=n,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw vN(new Error("No dial tokens available"),SN.ERR_NO_DIAL_TOKENS);let n=new EN;r.forEach(o=>n.push(o));let i=this.addrs.map(()=>{let o=new AbortController;return $w&&$w(1/0,o.signal),o}),s=0;try{return await wN(this.addrs.map(async(o,a)=>{let c=await n.shift(),u;try{let l=i[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?bN([l,e.signal]):l}),i.splice(a,1)}finally{s++,this.addrs.length-s>=r.length?n.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{i.map(o=>o.abort()),r.forEach(o=>this.dialer.releaseToken(o))}}};zw.exports=Hw});var Zw=S((fU,Xw)=>{"use strict";var Yw=Ne(),Ps=Object.assign(Yw("libp2p:dialer"),{error:Yw("libp2p:dialer:err")}),Td=he(),{Multiaddr:Rd}=Rt(),{TimeoutController:xN}=gf(),{AbortError:_N}=Wf(),{anySignal:AN}=wd(),{setMaxListeners:Ww}=Jt(),CN=Gw(),{publicAddressesFirst:IN}=Bf(),TN=_f(),{codes:su}=Fe(),{DIAL_TIMEOUT:RN,MAX_PARALLEL_DIALS:BN,MAX_PER_PEER_DIALS:PN,MAX_ADDRS_TO_DIAL:NN}=Fc(),Ns="dialler",Bd="pending-dials",Pd="pending-dial-targets",Qw=class{constructor({transportManager:e,peerStore:r,addressSorter:n=IN,maxParallelDials:i=BN,maxAddrsToDial:s=NN,dialTimeout:o=RN,maxDialsPerPeer:a=PN,resolvers:c={},metrics:u}){this.transportManager=e,this.peerStore=r,this.addressSorter=n,this.maxParallelDials=i,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(i)].map((l,f)=>f),this._pendingDials=new Map,this._pendingDialTargets=new Map,this._metrics=u;for(let[l,f]of Object.entries(c))Rd.resolvers.set(l,f)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){Ps.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new _N("Dialer was destroyed"));this._pendingDialTargets.clear(),this._metrics&&this._metrics.updateComponentMetric(Ns,Bd,0),this._metrics&&this._metrics.updateComponentMetric(Ns,Pd,0)}async connectToPeer(e,r={}){let n=await this._createCancellableDialTarget(e);if(!n.addrs.length)throw Td(new Error("The dial request has no valid addresses"),su.ERR_NO_VALID_ADDRESSES);let i=this._pendingDials.get(n.id)||this._createPendingDial(n,r);try{let s=await i.promise;return Ps("dial succeeded to %s",n.id),s}catch(s){throw i.controller.signal.aborted&&(s.code=su.ERR_TIMEOUT),Ps.error(s),s}finally{i.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,n=new Promise((i,s)=>{this._pendingDialTargets.set(r,{resolve:i,reject:s}),this._metrics&&this._metrics.updateComponentMetric(Ns,Pd,this._pendingDialTargets.size)});try{return await Promise.race([this._createDialTarget(e),n])}finally{this._pendingDialTargets.delete(r),this._metrics&&this._metrics.updateComponentMetric(Ns,Pd,this._pendingDialTargets.size)}}async _createDialTarget(e){let{id:r,multiaddrs:n}=TN(e);n&&this.peerStore.addressBook.add(r,n);let i=this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter)||[];Rd.isMultiaddr(e)&&(i=i.filter(a=>!e.equals(a)),i.unshift(e));let s=[];for(let a of i)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(r),Td(new Error("dial with more addresses than allowed"),su.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let n=(u,l)=>{if(l.signal.aborted)throw Td(new Error("already aborted"),su.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},i=new CN({addrs:e.addrs,dialAction:n,dialer:this}),s=new xN(this.timeout);Ww&&Ww(1/0,s.signal);let o=[s.signal];r.signal&&o.push(r.signal);let a=AN(o),c={dialRequest:i,controller:s,promise:i.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id),this._metrics&&this._metrics.updateComponentMetric(Ns,Bd,this._pendingDials.size)}};return this._pendingDials.set(e.id,c),this._metrics&&this._metrics.updateComponentMetric(Ns,Bd,this._pendingDials.size),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,r);return Ps("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),n}releaseToken(e){this.tokens.indexOf(e)>-1||(Ps("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let n=await this._resolveRecord(e);return(await Promise.all(n.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new Rd(e.toString()),await e.resolve()}catch(r){return Ps.error(`multiaddr ${e} could not be resolved`),[]}}};Xw.exports=Qw});var e2=S((dU,Jw)=>{"use strict";function DN(t){return t>=55296&&t<=56319}function ON(t){return t>=56320&&t<=57343}Jw.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,s=0,o,a,c=0;c<i;c+=1){if(o=r.charCodeAt(c),a=r[c],DN(o)&&ON(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===n)return r.slice(0,c+1);if(s>n)return r.slice(0,c-a.length+1)}return r}});var r2=S((hU,t2)=>{"use strict";function LN(t){return t>=55296&&t<=56319}function kN(t){return t>=56320&&t<=57343}t2.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,s=null,o=0;o<r;o++)i=e.charCodeAt(o),kN(i)?s!=null&&LN(s)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),s=i;return n}});var i2=S((pU,n2)=>{"use strict";var qN=e2(),UN=r2();n2.exports=qN.bind(null,UN)});var a2=S((yU,o2)=>{"use strict";var MN=i2(),FN=/[\/\?<>\\:\*\|"]/g,KN=/[\x00-\x1f\x80-\x9f]/g,VN=/^\.+$/,jN=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,$N=/[\. ]+$/;function s2(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(FN,e).replace(KN,e).replace(VN,e).replace(jN,e).replace($N,e);return MN(r,255)}o2.exports=function(t,e){var r=e&&e.replacement||"",n=s2(t,r);return r===""?n:s2(n,"")}});var l2=S((gU,u2)=>{"use strict";Ji();var ou=Ee(),{toString:Ds}=(xt(),Ct),{fromString:c2}=(St(),At);u2.exports={createCipheriv:(t,e,r)=>{let n=ou.cipher.createCipher("AES-CTR",Ds(e,"ascii"));return n.start({iv:Ds(r,"ascii")}),{update:i=>(n.update(ou.util.createBuffer(Ds(i,"ascii"))),c2(n.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let n=ou.cipher.createDecipher("AES-CTR",Ds(e,"ascii"));return n.start({iv:Ds(r,"ascii")}),{update:i=>(n.update(ou.util.createBuffer(Ds(i,"ascii"))),c2(n.output.getBytes(),"ascii"))}}}});var h2=S((mU,d2)=>{"use strict";var HN=he(),f2={16:"aes-128-ctr",32:"aes-256-ctr"};d2.exports=function(t){let e=f2[t.length];if(!e){let r=Object.entries(f2).map(([n,i])=>`${n} (${i})`).join(" / ");throw HN(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var g2=S(y2=>{"use strict";var p2=l2(),zN=h2();y2.create=async function(t,e){let r=zN(t),n=p2.createCipheriv(r,t,e),i=p2.createDecipheriv(r,t,e);return{async encrypt(o){return n.update(o)},async decrypt(o){return i.update(o)}}}});var b2=S((bU,v2)=>{"use strict";var GN=cl(),YN=Ke(),WN=he(),m2={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function QN(t,e,r,n,i){let s=m2[i];if(!s){let a=Object.keys(m2).join(" / ");throw WN(new Error(`Hash '${i}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=GN(t,e,r,n,s);return YN.encode64(o)}v2.exports=QN});var Nd=S(Os=>{"use strict";var XN=jl(),ZN=g2(),JN=wc();Os.aes=ZN;Os.hmac=XN;Os.keys=JN;Os.randomBytes=oc();Os.pbkdf2=b2()});var E2=Pe(()=>{});var w2,S2=Pe(()=>{E2();w2=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=r[t]&63;n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n<63?e+="_":e+="-"}return e}});var Dd={};pt(Dd,{Key:()=>$t});function eD(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function tD(t){let e=t.split(":");return e[e.length-1]}function rD(t){return[].concat(...t)}var dn,x2,au,$t,Od=Pe(()=>{S2();xt();St();dn="/",x2=new TextEncoder().encode(dn),au=x2[0],$t=class{constructor(e,r){if(typeof e=="string")this._buf=Cl(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==au)throw new Error("Invalid key")}toString(e="utf8"){return Tl(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new $t(e.join(dn))}static random(){return new $t(w2().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new $t(e):e.uint8Array?new $t(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=x2),this._buf[0]!==au){let e=new Uint8Array(this._buf.byteLength+1);e.fill(au,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===au;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],o=n[i];if(s<o)return!0;if(s>o)return!1}return r.length<n.length}reverse(){return $t.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(dn).slice(1)}type(){return eD(this.baseNamespace())}name(){return tD(this.baseNamespace())}instance(e){return new $t(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(dn)||(e+=dn),e+=this.type(),new $t(e)}parent(){let e=this.list();return e.length===1?new $t(dn):new $t(e.slice(0,-1).join(dn))}child(e){return this.toString()===dn?e:e.toString()===dn?this:new $t(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return $t.withNamespaces([...this.namespaces(),...rD(e.map(r=>r.namespaces()))])}}});var I2=S((TU,C2)=>{var Ls=Ee();_n();Ke();var J=Ls.asn1,ks=C2.exports=Ls.pkcs7asn1=Ls.pkcs7asn1||{};Ls.pkcs7=Ls.pkcs7||{};Ls.pkcs7.asn1=ks;var _2={name:"ContentInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};ks.contentInfoValidator=_2;var A2={name:"EncryptedContentInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};ks.envelopedDataValidator={name:"EnvelopedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(A2)};ks.encryptedDataValidator={name:"EncryptedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"}].concat(A2)};var nD={name:"SignerInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:J.Class.UNIVERSAL,type:J.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:J.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};ks.signedDataValidator={name:"SignedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},_2,{name:"SignedData.Certificates",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:J.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,capture:"signerInfos",optional:!0,value:[nD]}]};ks.recipientInfoValidator={name:"RecipientInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:J.Class.UNIVERSAL,type:J.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var R2=S((RU,T2)=>{var Ii=Ee();Ke();Ii.mgf=Ii.mgf||{};var iD=T2.exports=Ii.mgf.mgf1=Ii.mgf1=Ii.mgf1||{};iD.create=function(t){var e={generate:function(r,n){for(var i=new Ii.util.ByteBuffer,s=Math.ceil(n/t.digestLength),o=0;o<s;o++){var a=new Ii.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return e}});var P2=S((BU,B2)=>{var cu=Ee();R2();B2.exports=cu.mgf=cu.mgf||{};cu.mgf.mgf1=cu.mgf1});var D2=S((PU,N2)=>{var Ti=Ee();ii();Ke();var sD=N2.exports=Ti.pss=Ti.pss||{};sD.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=Ti.util.createBuffer(i));var s;if("saltLength"in t)s=t.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||Ti.random,a={};return a.encode=function(c,u){var l,f=u-1,d=Math.ceil(f/8),p=c.digest().getBytes();if(d<n+s+2)throw new Error("Message is too long to encrypt.");var h;i===null?h=o.getBytesSync(s):h=i.bytes();var g=new Ti.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(p),g.putBytes(h),e.start(),e.update(g.getBytes());var v=e.digest().getBytes(),_=new Ti.util.ByteBuffer;_.fillWithByte(0,d-s-n-2),_.putByte(1),_.putBytes(h);var B=_.getBytes(),L=d-n-1,z=r.generate(v,L),q="";for(l=0;l<L;l++)q+=String.fromCharCode(B.charCodeAt(l)^z.charCodeAt(l));var k=65280>>8*d-f&255;return q=String.fromCharCode(q.charCodeAt(0)&~k)+q.substr(1),q+v+String.fromCharCode(188)},a.verify=function(c,u,l){var f,d=l-1,p=Math.ceil(d/8);if(u=u.substr(-p),p<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=p-n-1,g=u.substr(0,h),v=u.substr(h,n),_=65280>>8*p-d&255;if((g.charCodeAt(0)&_)!=0)throw new Error("Bits beyond keysize not zero as expected.");var B=r.generate(v,h),L="";for(f=0;f<h;f++)L+=String.fromCharCode(g.charCodeAt(f)^B.charCodeAt(f));L=String.fromCharCode(L.charCodeAt(0)&~_)+L.substr(1);var z=p-n-s-2;for(f=0;f<z;f++)if(L.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(L.charCodeAt(z)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var q=L.substr(-s),k=new Ti.util.ByteBuffer;k.fillWithByte(0,8),k.putBytes(c),k.putBytes(q),e.start(),e.update(k.getBytes());var te=e.digest().getBytes();return v===te},a}});var kd=S((NU,q2)=>{var Q=Ee();Ji();_n();Ha();An();P2();Qi();Wa();D2();So();Ke();var y=Q.asn1,G=q2.exports=Q.pki=Q.pki||{},ue=G.oids,st={};st.CN=ue.commonName;st.commonName="CN";st.C=ue.countryName;st.countryName="C";st.L=ue.localityName;st.localityName="L";st.ST=ue.stateOrProvinceName;st.stateOrProvinceName="ST";st.O=ue.organizationName;st.organizationName="O";st.OU=ue.organizationalUnitName;st.organizationalUnitName="OU";st.E=ue.emailAddress;st.emailAddress="E";var O2=Q.pki.rsa.publicKeyValidator,oD={name:"Certificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},O2,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},aD={name:"rsapss",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},cD={name:"CertificationRequestInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},O2,{name:"CertificationRequestInfo.attributes",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0}]}]}]},uD={name:"CertificationRequest",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[cD,{name:"CertificationRequest.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};G.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,s,o=0;o<t.value.length;++o){n=t.value[o];for(var a=0;a<n.value.length;++a)s={},i=n.value[a],s.type=y.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in ue&&(s.name=ue[s.type],s.name in st&&(s.shortName=st[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};G.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=y.derToOid(n.value[0].value),s=n.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=i,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in ue&&(a.name=ue[a.type],a.name in st&&(a.shortName=st[a.name])),a.type===ue.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(G.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function zn(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var uu=function(t,e,r){var n={};if(t!==ue["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:ue.sha1},mgf:{algorithmOid:ue.mgf1,hash:{algorithmOid:ue.sha1}},saltLength:20});var i={},s=[];if(!y.validate(e,aD,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=y.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=y.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=y.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n};G.certificateFromPem=function(t,e,r){var n=Q.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=y.fromDer(n.body,r);return G.certificateFromAsn1(s,e)};G.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:y.toDer(G.certificateToAsn1(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.publicKeyFromPem=function(t){var e=Q.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=y.fromDer(e.body);return G.publicKeyFromAsn1(n)};G.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:y.toDer(G.publicKeyToAsn1(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:y.toDer(G.publicKeyToRSAPublicKey(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||Q.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=y.toDer(G.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=y.toDer(G.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};G.certificationRequestFromPem=function(t,e,r){var n=Q.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=y.fromDer(n.body,r);return G.certificationRequestFromAsn1(s,e)};G.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:y.toDer(G.certificationRequestToAsn1(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return zn(t.issuer,e)},t.issuer.addField=function(e){hr([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return zn(t.subject,e)},t.subject.addField=function(e){hr([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){hr(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){hr(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)L2(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||Q.md.sha1.create();var n=ue[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=G.getTBSCertificate(t);var s=y.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=n.attributes,s.actualIssuer=i.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in ue){var a=ue[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=Q.md.sha1.create();break;case"md5WithRSAEncryption":o=Q.md.md5.create();break;case"sha256WithRSAEncryption":o=Q.md.sha256.create();break;case"sha384WithRSAEncryption":o=Q.md.sha384.create();break;case"sha512WithRSAEncryption":o=Q.md.sha512.create();break;case"RSASSA-PSS":o=Q.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||G.getTBSCertificate(e),u=y.toDer(c);o.update(u.getBytes())}if(o!==null){var l;switch(e.signatureOid){case ue.sha1WithRSAEncryption:l=void 0;break;case ue["RSASSA-PSS"]:var f,d;if(f=ue[e.signatureParameters.mgf.hash.algorithmOid],f===void 0||Q.md[f]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=f,s}if(d=ue[e.signatureParameters.mgf.algorithmOid],d===void 0||Q.mgf[d]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=d,s}if(d=Q.mgf[d].create(Q.md[f].create()),f=ue[e.signatureParameters.hash.algorithmOid],f===void 0||Q.md[f]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:f};l=Q.pss.create(Q.md[f].create(),d,e.signatureParameters.saltLength);break}r=t.publicKey.verify(o.digest().getBytes(),e.signature,l)}return r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,o,a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return G.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=ue.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return Q.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};G.certificateFromAsn1=function(t,e){var r={},n=[];if(!y.validate(t,oD,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=y.derToOid(r.publicKeyOid);if(s!==G.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=G.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=Q.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=Q.asn1.derToOid(r.certSignatureOid),o.signatureParameters=uu(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=Q.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=uu(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(y.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(y.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){if(o.md=null,o.signatureOid in ue){var s=ue[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Q.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Q.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Q.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Q.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Q.md.sha512.create();break;case"RSASSA-PSS":o.md=Q.md.sha256.create();break}}if(o.md===null){var i=new Error("Could not compute certificate digest. Unknown signature OID.");throw i.signatureOid=o.signatureOid,i}var u=y.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=Q.md.sha1.create();o.issuer.getField=function(d){return zn(o.issuer,d)},o.issuer.addField=function(d){hr([d]),o.issuer.attributes.push(d)},o.issuer.attributes=G.RDNAttributesAsArray(r.certIssuer,l),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var f=Q.md.sha1.create();return o.subject.getField=function(d){return zn(o.subject,d)},o.subject.addField=function(d){hr([d]),o.subject.attributes.push(d)},o.subject.attributes=G.RDNAttributesAsArray(r.certSubject,f),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=f.digest().toHex(),r.certExtensions?o.extensions=G.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=G.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};G.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(G.certificateExtensionFromAsn1(n.value[i]));return e};G.certificateExtensionFromAsn1=function(t){var e={};if(e.id=y.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===y.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in ue){if(e.name=ue[e.id],e.name==="keyUsage"){var r=y.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)==128,e.nonRepudiation=(n&64)==64,e.keyEncipherment=(n&32)==32,e.dataEncipherment=(n&16)==16,e.keyAgreement=(n&8)==8,e.keyCertSign=(n&4)==4,e.cRLSign=(n&2)==2,e.encipherOnly=(n&1)==1,e.decipherOnly=(i&128)==128}else if(e.name==="basicConstraints"){var r=y.fromDer(e.value);r.value.length>0&&r.value[0].type===y.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===y.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=y.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=y.fromDer(e.value),o=0;o<r.value.length;++o){var a=y.derToOid(r.value[o].value);a in ue?e[ue[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=y.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)==128,e.server=(n&64)==64,e.email=(n&32)==32,e.objsign=(n&16)==16,e.reserved=(n&8)==8,e.sslCA=(n&4)==4,e.emailCA=(n&2)==2,e.objCA=(n&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=y.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=Q.util.bytesToIP(c.value);break;case 8:l.oid=y.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=y.fromDer(e.value);e.subjectKeyIdentifier=Q.util.bytesToHex(r.value)}}return e};G.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!y.validate(t,uD,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=y.derToOid(r.publicKeyOid);if(s!==G.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=G.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=Q.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=uu(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=Q.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=uu(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){if(o.md=null,o.signatureOid in ue){var s=ue[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Q.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Q.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Q.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Q.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Q.md.sha512.create();break;case"RSASSA-PSS":o.md=Q.md.sha256.create();break}}if(o.md===null){var i=new Error("Could not compute certification request digest. Unknown signature OID.");throw i.signatureOid=o.signatureOid,i}var a=y.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=Q.md.sha1.create();return o.subject.getField=function(u){return zn(o.subject,u)},o.subject.addField=function(u){hr([u]),o.subject.attributes.push(u)},o.subject.attributes=G.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=G.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(u){return zn(o,u)},o.addAttribute=function(u){hr([u]),o.attributes.push(u)},o.attributes=G.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};G.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return zn(t.subject,e)},t.subject.addField=function(e){hr([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return zn(t,e)},t.addAttribute=function(e){hr([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){hr(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){hr(e),t.attributes=e},t.sign=function(e,r){t.md=r||Q.md.sha1.create();var n=ue[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=G.getCertificationRequestInfo(t);var s=y.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){if(t.signatureOid in ue){var n=ue[t.signatureOid];switch(n){case"sha1WithRSAEncryption":r=Q.md.sha1.create();break;case"md5WithRSAEncryption":r=Q.md.md5.create();break;case"sha256WithRSAEncryption":r=Q.md.sha256.create();break;case"sha384WithRSAEncryption":r=Q.md.sha384.create();break;case"sha512WithRSAEncryption":r=Q.md.sha512.create();break;case"RSASSA-PSS":r=Q.md.sha256.create();break}}if(r===null){var i=new Error("Could not compute certification request digest. Unknown signature OID.");throw i.signatureOid=t.signatureOid,i}var s=t.certificationRequestInfo||G.getCertificationRequestInfo(t),o=y.toDer(s);r.update(o.getBytes())}if(r!==null){var a;switch(t.signatureOid){case ue.sha1WithRSAEncryption:break;case ue["RSASSA-PSS"]:var c,u;if(c=ue[t.signatureParameters.mgf.hash.algorithmOid],c===void 0||Q.md[c]===void 0){var i=new Error("Unsupported MGF hash function.");throw i.oid=t.signatureParameters.mgf.hash.algorithmOid,i.name=c,i}if(u=ue[t.signatureParameters.mgf.algorithmOid],u===void 0||Q.mgf[u]===void 0){var i=new Error("Unsupported MGF function.");throw i.oid=t.signatureParameters.mgf.algorithmOid,i.name=u,i}if(u=Q.mgf[u].create(Q.md[c].create()),c=ue[t.signatureParameters.hash.algorithmOid],c===void 0||Q.md[c]===void 0){var i=new Error("Unsupported RSASSA-PSS hash function.");throw i.oid=t.signatureParameters.hash.algorithmOid,i.name=c,i}a=Q.pss.create(Q.md[c].create(),u,t.signatureParameters.saltLength);break}e=t.publicKey.verify(r.digest().getBytes(),t.signature,a)}return e},t};function qs(t){for(var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,s=0;s<i.length;++s){r=i[s];var o=r.value,a=y.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===y.Type.UTF8&&(o=Q.util.encodeUtf8(o))),n=y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(r.type).getBytes()),y.create(y.Class.UNIVERSAL,a,!1,o)])]),e.value.push(n)}return e}function hr(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in G.oids?e.name=G.oids[e.type]:e.shortName&&e.shortName in st&&(e.name=G.oids[st[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in G.oids)e.type=G.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName=="undefined"&&e.name&&e.name in st&&(e.shortName=st[e.name]),e.type===ue.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=y.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(G.certificateExtensionToAsn1(L2(e.extensions[i])))}if(typeof e.value=="undefined"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function L2(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in G.oids&&(t.name=G.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in G.oids)t.id=G.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var n=0,i=0,s=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);s!==0?o+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(o+=String.fromCharCode(i)),t.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in ue?a.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(ue[c]).getBytes())):c.indexOf(".")!==-1&&a.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);i!==0&&(o+=String.fromCharCode(i)),t.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Q.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=y.oidToDer(y.oidToDer(u.oid)):o=y.oidToDer(o));t.value.value.push(y.create(y.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=y.create(y.Class.UNIVERSAL,y.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var f=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=f.toHex(),t.value=y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,f.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var d=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!1,d))}if(t.authorityCertIssuer){var p=[y.create(y.Class.CONTEXT_SPECIFIC,4,!0,[qs(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,p))}if(t.serialNumber){var h=Q.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(t.name==="cRLDistributionPoints"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var a=t.value.value,g=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),v=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Q.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=y.oidToDer(y.oidToDer(u.oid)):o=y.oidToDer(o));v.value.push(y.create(y.Class.CONTEXT_SPECIFIC,u.type,!1,o))}g.value.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[v])),a.push(g)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function Ld(t,e){switch(t){case ue["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.mgf.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.mgf.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.saltLength).getBytes())])),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,r);default:return y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")}}function lD(t){var e=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,o=y.Type.UTF8;"valueTagClass"in i&&(o=i.valueTagClass),o===y.Type.UTF8&&(s=Q.util.encodeUtf8(s));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var c=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(i.type).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var fD=new Date("1950-01-01T00:00:00Z"),dD=new Date("2050-01-01T00:00:00Z");function k2(t){return t>=fD&&t<dD?y.create(y.Class.UNIVERSAL,y.Type.UTCTIME,!1,y.dateToUtcTime(t)):y.create(y.Class.UNIVERSAL,y.Type.GENERALIZEDTIME,!1,y.dateToGeneralizedTime(t))}G.getTBSCertificate=function(t){var e=k2(t.validity.notBefore),r=k2(t.validity.notAfter),n=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.version).getBytes())]),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,Q.util.hexToBytes(t.serialNumber)),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.siginfo.algorithmOid).getBytes()),Ld(t.siginfo.algorithmOid,t.siginfo.parameters)]),qs(t.issuer),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,r]),qs(t.subject),G.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(G.certificateExtensionsToAsn1(t.extensions)),n};G.getCertificationRequestInfo=function(t){var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.version).getBytes()),qs(t.subject),G.publicKeyToAsn1(t.publicKey),lD(t)]);return e};G.distinguishedNameToAsn1=function(t){return qs(t)};G.certificateToAsn1=function(t){var e=t.tbsCertificate||G.getTBSCertificate(t);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.signatureOid).getBytes()),Ld(t.signatureOid,t.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};G.certificateExtensionsToAsn1=function(t){var e=y.create(y.Class.CONTEXT_SPECIFIC,3,!0,[]),r=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(G.certificateExtensionToAsn1(t[n]));return e};G.certificateExtensionToAsn1=function(t){var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);e.value.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.id).getBytes())),t.critical&&e.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=y.toDer(r).getBytes()),e.value.push(y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,r)),e};G.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||G.getCertificationRequestInfo(t);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.signatureOid).getBytes()),Ld(t.signatureOid,t.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};G.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=Q.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];Q.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=Q.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;Q.util.isArray(a)||(a=[a]);for(var c=y.toDer(G.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=y.toDer(G.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!Q.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=Q.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!Q.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=y.toDer(G.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var f=y.toDer(G.certificateToAsn1(c[l])).getBytes();u===f&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return n(o),e.certs[o.hash]||null}function n(o){if(!o.hash){var a=Q.md.sha1.create();o.attributes=G.RDNAttributesAsArray(qs(o),a),o.hash=a.digest().toHex()}}if(t)for(var i=0;i<t.length;++i){var s=t[i];e.addCertificate(s)}return e};G.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};G.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i=="undefined"&&(i=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(i&&(i<c.validity.notBefore||i>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:G.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:i}),o===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var f=u;Q.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){u=f.shift();try{d=u.verify(c)}catch(q){}}d||(o={message:"Certificate signature is invalid.",error:G.certificateError.bad_certificate})}o===null&&(!u||l)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:G.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:G.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},h=0;o===null&&h<c.extensions.length;++h){var g=c.extensions[h];g.critical&&!(g.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:G.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var v=c.getExtension("basicConstraints"),_=c.getExtension("keyUsage");if(_!==null&&(!_.keyCertSign||v===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:G.certificateError.bad_certificate}),o===null&&v!==null&&!v.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:G.certificateError.bad_certificate}),o===null&&_!==null&&"pathLenConstraint"in v){var B=a-1;B>v.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:G.certificateError.bad_certificate})}}var L=o===null?!0:o.error,z=r.verify?r.verify(L,a,n):L;if(z===!0)o=null;else throw L===!0&&(o={message:"The application rejected the certificate.",error:G.certificateError.bad_certificate}),(z||z===0)&&(typeof z=="object"&&!Q.util.isArray(z)?(z.message&&(o.message=z.message),z.error&&(o.error=z.error)):typeof z=="string"&&(o.error=z)),o;s=!1,++a}while(e.length>0);return!0}});var F2=S((DU,M2)=>{var X=Ee();Ji();_n();Ha();Qi();Wa();I2();ii();Ke();kd();var T=X.asn1,kt=M2.exports=X.pkcs7=X.pkcs7||{};kt.messageFromPem=function(t){var e=X.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=T.fromDer(e.body);return kt.messageFromAsn1(n)};kt.messageToPem=function(t,e){var r={type:"PKCS7",body:T.toDer(t.toAsn1()).getBytes()};return X.pem.encode(r,{maxline:e})};kt.messageFromAsn1=function(t){var e={},r=[];if(!T.validate(t,kt.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=T.derToOid(e.contentType),s;switch(i){case X.pki.oids.envelopedData:s=kt.createEnvelopedData();break;case X.pki.oids.encryptedData:s=kt.createEncryptedData();break;case X.pki.oids.signedData:s=kt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};kt.createSignedData=function(){var t=null;return t={type:X.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(Ud(t,n,kt.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,s=0;s<i.length;++s)t.certificates.push(X.pki.certificateFromAsn1(i[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(X.pki.certificateToAsn1(t.certificates[i]));var s=[],o=T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&o.value[0].value.push(T.create(T.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&o.value[0].value.push(T.create(T.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(T.create(T.Class.UNIVERSAL,T.Type.SET,!0,t.signerInfos)),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.type).getBytes()),o])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var o=n.certificate;typeof o=="string"&&(o=X.pki.certificateFromPem(o)),i=o.issuer.attributes,s=o.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=X.pki.privateKeyFromPem(a));var c=n.digestAlgorithm||X.pki.oids.sha1;switch(c){case X.pki.oids.sha1:case X.pki.oids.sha256:case X.pki.oids.sha384:case X.pki.oids.sha512:case X.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var l=!1,f=!1,d=0;d<u.length;++d){var p=u[d];if(!l&&p.type===X.pki.oids.contentType){if(l=!0,f)break;continue}if(!f&&p.type===X.pki.oids.messageDigest){if(f=!0,l)break;continue}}if(!l||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:i,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:X.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(X.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof X.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=X.util.encodeUtf8(t.content)),n.detached?t.detachedContent=T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=X.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var s=t.signers[i],o=s.digestAlgorithm;o in n||(n[o]=X.md[X.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=n[o]:s.md=X.md[X.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in n)t.digestAlgorithmIdentifiers.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(o).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]));return n}function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=T.derToOid(t.contentInfo.value[0].value),o=T.toDer(i);o.getByte(),T.getBerValueLength(o),o=o.getBytes();for(var a in n)n[a].start().update(o);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==X.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[]),d=0;d<l.authenticatedAttributes.length;++d){var p=l.authenticatedAttributes[d];p.type===X.pki.oids.messageDigest?p.value=n[l.digestAlgorithm].digest():p.type===X.pki.oids.signingTime&&(p.value||(p.value=c)),f.value.push(qd(p)),l.authenticatedAttributesAsn1.value.push(qd(p))}o=T.toDer(f).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=vD(t.signers)}};kt.createEncryptedData=function(){var t=null;return t={type:X.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:X.pki.oids["aes256-CBC"]},fromAsn1:function(e){Ud(t,e,kt.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),U2(t)}},t};kt.createEnvelopedData=function(){var t=null;return t={type:X.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:X.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=Ud(t,e,kt.asn1.envelopedDataValidator);t.recipients=yD(r.recipientInfos.value)},toAsn1:function(){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.type).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,gD(t.recipients)),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,bD(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],s=i.issuer;if(i.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case X.pki.oids.rsaEncryption:case X.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=X.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}U2(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:X.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,s;switch(r){case X.pki.oids["aes128-CBC"]:n=16,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["aes192-CBC"]:n=24,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["aes256-CBC"]:n=32,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=X.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=X.util.createBuffer(X.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=X.util.createBuffer(X.random.getBytes(i));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case X.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function hD(t){var e={},r=[];if(!T.validate(t,kt.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:X.pki.RDNAttributesAsArray(e.issuer),serialNumber:X.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:T.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function pD(t){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[X.pki.distinguishedNameToAsn1({attributes:t.issuer}),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,X.util.hexToBytes(t.serialNumber))]),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.encryptedContent.algorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function yD(t){for(var e=[],r=0;r<t.length;++r)e.push(hD(t[r]));return e}function gD(t){for(var e=[],r=0;r<t.length;++r)e.push(pD(t[r]));return e}function mD(t){var e=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[X.pki.distinguishedNameToAsn1({attributes:t.issuer}),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,X.util.hexToBytes(t.serialNumber))]),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.digestAlgorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.signatureAlgorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")])),e.value.push(T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=T.create(T.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(qd(i))}e.value.push(r)}return e}function vD(t){for(var e=[],r=0;r<t.length;++r)e.push(mD(t[r]));return e}function qd(t){var e;if(t.type===X.pki.oids.contentType)e=T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.value).getBytes());else if(t.type===X.pki.oids.messageDigest)e=T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===X.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=T.utcTimeToDate(i):i=T.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?e=T.create(T.Class.UNIVERSAL,T.Type.UTCTIME,!1,T.dateToUtcTime(i)):e=T.create(T.Class.UNIVERSAL,T.Type.GENERALIZEDTIME,!1,T.dateToGeneralizedTime(i))}return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.type).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[e])])}function bD(t){return[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(X.pki.oids.data).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.algorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.parameter.getBytes())]),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.content.getBytes())])]}function Ud(t,e,r){var n={},i=[];if(!T.validate(e,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=T.derToOid(n.contentType);if(o!==X.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(X.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==T.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[c].value}else a=n.encryptedContent;t.encryptedContent={algorithm:T.derToOid(n.encAlgorithm),parameter:X.util.createBuffer(n.encParameter.value),content:X.util.createBuffer(a)}}if(n.content){var a="";if(X.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==T.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[c].value}else a=n.content;t.content=X.util.createBuffer(a)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function U2(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case X.pki.oids["aes128-CBC"]:case X.pki.oids["aes192-CBC"]:case X.pki.oids["aes256-CBC"]:e=X.aes.createDecryptionCipher(t.encryptedContent.key);break;case X.pki.oids.desCBC:case X.pki.oids["des-EDE3-CBC"]:e=X.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var j2=S((OU,V2)=>{"use strict";kd();var ED=Ee(),K2=ED.pki,wD=(t,e)=>{let r=K2.setRsaPublicKey(e.n,e.e),n=K2.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);let i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e),n};async function SD(t,e){let r=t.map(e),i=(await Promise.all(r)).findIndex(s=>s);return t[i]}V2.exports={certificateForKey:wD,findAsync:SD}});var G2=S((LU,z2)=>{"use strict";F2();vl();var Gn=Ee(),{certificateForKey:xD,findAsync:_D}=j2(),Us=he(),{fromString:$2}=(St(),At),{toString:AD}=(xt(),Ct),{codes:Ms}=Fe(),Md=new WeakMap,H2=class{constructor(e,r){if(!e)throw Us(new Error("keychain is required"),Ms.ERR_KEYCHAIN_REQUIRED);this.keychain=e,Md.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw Us(new Error("Plain data must be a Uint8Array"),Ms.ERR_INVALID_PARAMETERS);let n=await this.keychain.findKeyByName(e),i=await this.keychain._getPrivateKey(e),s=Md.get(this).dek,o=Gn.pki.decryptRsaPrivateKey(i,s),a=await xD(n,o),c=Gn.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Gn.util.createBuffer(r),c.encrypt();let u=Gn.asn1.toDer(c.toAsn1()).getBytes();return $2(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw Us(new Error("CMS data is required"),Ms.ERR_INVALID_PARAMETERS);let r;try{let u=Gn.util.createBuffer(AD(e,"ascii")),l=Gn.asn1.fromDer(u);r=Gn.pkcs7.messageFromAsn1(l)}catch(u){throw Us(new Error("Invalid CMS: "+u.message),Ms.ERR_INVALID_CMS)}let n=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),i=await _D(n,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!i){let u=n.map(l=>l.keyId);throw Us(new Error("Decryption needs one of the key(s): "+u.join(", ")),Ms.ERR_MISSING_KEYS,{missingKeys:u})}let s=await this.keychain.findKeyById(i.keyId);if(!s)throw Us(new Error("No key available to decrypto"),Ms.ERR_NO_KEY);let o=await this.keychain._getPrivateKey(s.name),a=Md.get(this).dek,c=Gn.pki.decryptRsaPrivateKey(o,a);return r.decrypt(i.recipient,c),$2(r.content.getBytes(),"ascii")}};z2.exports=H2});var eS=S((kU,J2)=>{"use strict";var Y2=Ne(),W2=Object.assign(Y2("libp2p:keychain"),{error:Y2("libp2p:keychain:err")}),CD=a2(),ID=gs(),Ri=Nd(),{Key:Q2}=(Od(),Dd),TD=G2(),Qe=he(),{codes:Xe}=Fe(),{toString:Bi}=(xt(),Ct),{fromString:hn}=(St(),At);Pl();var RD="/pkcs8/",X2="/info/",Yn=new WeakMap,Pi={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Fd={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function pn(t){return!t||typeof t!="string"?!1:t===CD(t.trim())}async function ke(t){let e=200,r=1e3,n=Math.random()*(r-e)+e;throw await new Promise(i=>setTimeout(i,n)),t}function Gr(t){return new Q2(RD+t)}function Wn(t){return new Q2(X2+t)}var Z2=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=ID(Fd,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Pi.minKeyLength)throw new Error(`dek.keyLength must be least ${Pi.minKeyLength} bytes`);if(this.opts.dek.salt.length<Pi.minSaltLength)throw new Error(`dek.saltLength must be least ${Pi.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Pi.minIterationCount)throw new Error(`dek.iterationCount must be least ${Pi.minIterationCount}`);let n=this.opts.pass?Ri.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Yn.set(this,{dek:n})}get cms(){return new TD(this,Yn.get(this).dek)}static generateOptions(){let e=Object.assign({},Fd),r=Math.ceil(Pi.minSaltLength/3)*3;return e.dek.salt=Bi(Ri.randomBytes(r),"base64"),e}static get options(){return Fd}async createKey(e,r,n=2048){let i=this;if(!pn(e)||e==="self")return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));if(typeof r!="string")return ke(Qe(new Error(`Invalid key type '${r}'`),Xe.ERR_INVALID_KEY_TYPE));let s=Gr(e);if(await i.store.has(s))return ke(Qe(new Error(`Key '${e}' already exists`),Xe.ERR_KEY_ALREADY_EXISTS));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)return ke(Qe(new Error(`Invalid RSA key size ${n}`),Xe.ERR_INVALID_KEY_SIZE));break;default:break}let a;try{let c=await Ri.keys.generateKeyPair(r,n),u=await c.id(),l=Yn.get(this).dek,f=await c.export(l);a={name:e,id:u};let d=i.store.batch();d.put(s,hn(f)),d.put(Wn(e),hn(JSON.stringify(a))),await d.commit()}catch(c){return ke(c)}return a}async listKeys(){let e=this,r={prefix:X2},n=[];for await(let i of e.store.query(r))n.push(JSON.parse(Bi(i.value)));return n}async findKeyById(e){try{return(await this.listKeys()).find(n=>n.id===e)}catch(r){return ke(r)}}async findKeyByName(e){if(!pn(e))return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));let r=Wn(e);try{let n=await this.store.get(r);return JSON.parse(Bi(n))}catch(n){return ke(Qe(new Error(`Key '${e}' does not exist. ${n.message}`),Xe.ERR_KEY_NOT_FOUND))}}async removeKey(e){let r=this;if(!pn(e)||e==="self")return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));let n=Gr(e),i=await r.findKeyByName(e),s=r.store.batch();return s.delete(n),s.delete(Wn(e)),await s.commit(),i}async renameKey(e,r){let n=this;if(!pn(e)||e==="self")return ke(Qe(new Error(`Invalid old key name '${e}'`),Xe.ERR_OLD_KEY_NAME_INVALID));if(!pn(r)||r==="self")return ke(Qe(new Error(`Invalid new key name '${r}'`),Xe.ERR_NEW_KEY_NAME_INVALID));let i=Gr(e),s=Gr(r),o=Wn(e),a=Wn(r);if(await n.store.has(s))return ke(Qe(new Error(`Key '${r}' already exists`),Xe.ERR_KEY_ALREADY_EXISTS));try{let u=await n.store.get(i),l=await n.store.get(o),f=JSON.parse(Bi(l));f.name=r;let d=n.store.batch();return d.put(s,u),d.put(a,hn(JSON.stringify(f))),d.delete(i),d.delete(o),await d.commit(),f}catch(u){return ke(u)}}async exportKey(e,r){if(!pn(e))return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));if(!r)return ke(Qe(new Error("Password is required"),Xe.ERR_PASSWORD_REQUIRED));let n=Gr(e);try{let i=await this.store.get(n),s=Bi(i),o=Yn.get(this).dek;return(await Ri.keys.import(s,o)).export(r)}catch(i){return ke(i)}}async importKey(e,r,n){let i=this;if(!pn(e)||e==="self")return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));if(!r)return ke(Qe(new Error("PEM encoded key is required"),Xe.ERR_PEM_REQUIRED));let s=Gr(e);if(await i.store.has(s))return ke(Qe(new Error(`Key '${e}' already exists`),Xe.ERR_KEY_ALREADY_EXISTS));let a;try{a=await Ri.keys.import(r,n)}catch(f){return ke(Qe(new Error("Cannot read the key, most likely the password is wrong"),Xe.ERR_CANNOT_READ_KEY))}let c;try{c=await a.id();let f=Yn.get(this).dek;r=await a.export(f)}catch(f){return ke(f)}let u={name:e,id:c},l=i.store.batch();return l.put(s,hn(r)),l.put(Wn(e),hn(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let n=this;if(!pn(e))return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));if(!r||!r.privKey)return ke(Qe(new Error("Peer.privKey is required"),Xe.ERR_MISSING_PRIVATE_KEY));let i=r.privKey,s=Gr(e);if(await n.store.has(s))return ke(Qe(new Error(`Key '${e}' already exists`),Xe.ERR_KEY_ALREADY_EXISTS));try{let a=await i.id(),c=Yn.get(this).dek,u=await i.export(c),l={name:e,id:a},f=n.store.batch();return f.put(s,hn(u)),f.put(Wn(e),hn(JSON.stringify(l))),await f.commit(),l}catch(a){return ke(a)}}async _getPrivateKey(e){if(!pn(e))return ke(Qe(new Error(`Invalid key name '${e}'`),Xe.ERR_INVALID_KEY_NAME));try{let r=Gr(e),n=await this.store.get(r);return Bi(n)}catch(r){return ke(Qe(new Error(`Key '${e}' does not exist. ${r.message}`),Xe.ERR_KEY_NOT_FOUND))}}async rotateKeychainPass(e,r){if(typeof e!="string")return ke(Qe(new Error(`Invalid old pass type '${typeof e}'`),Xe.ERR_INVALID_OLD_PASS_TYPE));if(typeof r!="string")return ke(Qe(new Error(`Invalid new pass type '${typeof r}'`),Xe.ERR_INVALID_NEW_PASS_TYPE));if(r.length<20)return ke(Qe(new Error(`Invalid pass length ${r.length}`),Xe.ERR_INVALID_PASS_LENGTH));W2("recreating keychain");let n=Yn.get(this).dek;this.opts.pass=r;let i=r?Ri.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Yn.set(this,{dek:i});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Gr(o.name)),c=Bi(a),u=await Ri.keys.import(c,n),l=i.toString(),f=await u.export(l),d=this.store.batch(),p={name:o.name,id:o.id};d.put(Gr(o.name),hn(f)),d.put(Wn(o.name),hn(JSON.stringify(p))),await d.commit()}W2("keychain reconstructed")}};J2.exports=Z2});var fu=S((lu,tS)=>{(function(t,e){typeof lu=="object"&&typeof tS!="undefined"?e(lu):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(lu,function(t){"use strict";async function*e(m,w){let A=[];for await(let E of w)A.push(E),A.length===m&&(yield A,A=[]);A.length>0&&(yield A)}function*r(m,w){let A=[];for(let E of w)A.push(E),A.length===m&&(yield A,A=[]);A.length>0&&(yield A)}function n(m,w){return w===void 0?A=>n(m,A):w[Symbol.asyncIterator]?e(m,w):r(m,w)}function i(m){if(typeof m.next=="function")return m;if(typeof m[Symbol.iterator]=="function")return m[Symbol.iterator]();if(typeof m[Symbol.asyncIterator]=="function")return m[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let m,w;return{promise:new Promise((E,C)=>{w=E,m=C}),reject:m,resolve:w}}function o(m,w){let A=i(w),E=[],C=[],N=!1,P=!1;function F(){for(;C.length>0&&E.length>0;){let ie=C.shift(),{error:me,value:le}=E.shift();me?ie.reject(me):ie.resolve({done:!1,value:le})}for(;C.length>0&&P;){let{resolve:ie}=C.shift();ie({done:!0,value:void 0})}}async function Y(){if(!P&&!N&&!(E.length>=m)){N=!0;try{let{done:ie,value:me}=await A.next();ie?P=!0:E.push({value:me})}catch(ie){P=!0,E.push({error:ie})}F(),N=!1,Y()}}async function W(){if(E.length>0){let{error:me,value:le}=E.shift();if(me)throw me;return Y(),{done:!1,value:le}}if(P)return{done:!0,value:void 0};let ie=s();return C.push(ie),Y(),ie.promise}let ae={next:W,[Symbol.asyncIterator]:()=>ae};return ae}function*a(m,w){let A=[],E;try{for(let C of w)A.push(C),!(A.length<=m)&&(yield A.shift())}catch(C){E=C}for(let C of A)yield C;if(E)throw E}function c(m,w){return w===void 0?A=>c(m,A):m===0?w:w[Symbol.asyncIterator]?o(m,w):a(m,w)}async function u(m){let w=[];for await(let A of m)w.push(A);return w}function l(m){return m[Symbol.asyncIterator]?u(m):Array.from(m)}async function*f(m){for await(let w of m)yield*w}function*d(m){for(let w of m)yield*w}function p(...m){return m.find(A=>A[Symbol.asyncIterator]!==void 0)?f(m):d(m)}async function h(m){for await(let w of m);}function g(m){if(m[Symbol.asyncIterator])return h(m);for(let w of m);}async function*v(m,w){for await(let A of w)await m(A)&&(yield A)}function _(m,w){return w===void 0?A=>v(m,A):v(m,w)}async function*B(m){for await(let w of m)w&&typeof w!="string"&&(w[Symbol.iterator]||w[Symbol.asyncIterator])?yield*B(w):yield w}async function*L(m,w){for await(let A of w)yield await m(A)}function z(m,w){return w===void 0?A=>L(m,A):L(m,w)}function q(m,w){return w===void 0?A=>q(m,A):_(A=>A!=null,B(z(m,w)))}function k(m,w,A){let E=i(A),C=[],N=[],P=!1,F=!1,Y=0,W=null;function ae(){for(;N.length>0&&C.length>0;){let{resolve:ve}=N.shift(),Ce=C.shift();ve({done:!1,value:Ce})}for(;N.length>0&&Y===0&&P;){let{resolve:ve,reject:Ce}=N.shift();W?(Ce(W),W=null):ve({done:!0,value:void 0})}}async function ie(){if(P){ae();return}if(!F&&!(Y+C.length>=m)){F=!0,Y++;try{let{done:ve,value:Ce}=await E.next();ve?(P=!0,Y--,ae()):me(Ce)}catch(ve){P=!0,Y--,W=ve,ae()}F=!1,ie()}}async function me(ve){try{let Ce=await w(ve);if(Ce&&Ce[Symbol.asyncIterator])for await(let so of Ce)C.push(so);else C.push(Ce)}catch(Ce){P=!0,W=Ce}Y--,ae(),ie()}async function le(){if(C.length===0){let Ce=s();return N.push(Ce),ie(),Ce.promise}let ve=C.shift();return ie(),{done:!1,value:ve}}let Se={next:le,[Symbol.asyncIterator]:()=>Se};return Se}function te(m,w,A){return w===void 0?(E,C)=>C?te(m,E,C):te(m,E):A===void 0?E=>te(m,w,E):_(E=>E!=null,B(k(m,w,A)))}async function se(m){return new Promise(w=>{m.once("readable",()=>{w()})})}async function*j(m){for(;;){let w=m.read();if(w!==null){yield w;continue}if(m._readableState.ended)break;await se(m)}}function _e(m){return typeof m[Symbol.asyncIterator]=="function"?m:j(m)}async function*ge(...m){let w=new Set(m.map(i));for(;w.size>0;)for(let A of w){let E=await A.next();E.done?w.delete(A):yield E.value}}function pe(m,...w){let A=m();for(let E of w)A=E(A);return A}async function*Je(m,w,A){let E=null,C=Y=>({value:w(Y)}),N=async function*(Y){for await(let W of Y){if(E)return;yield W}},P=pe(()=>A,c(1),N,z(C),c(m-1)),F=i(P);for(;;){let{value:Y,done:W}=await F.next();if(W)break;try{let ae=await Y.value;E||(yield ae)}catch(ae){E=ae}}if(E)throw E}function et(m,w,A){return w===void 0?(E,C)=>et(m,E,C):A===void 0?E=>et(m,w,E):m===1?z(w,A):Je(m,w,A)}function Ae(m,w,A){return w===void 0?(E,C)=>C?Ae(m,E,C):Ae(m,E):A===void 0?E=>Ae(m,w,E):_(E=>E!=null,B(et(m,w,A)))}async function*qe(...m){let w=m.map(i),A=new Set,E=new Map,C=null,N=null,P=null,F=ie=>{C=ie,N&&N(ie)},Y=ie=>{P&&P(ie)},W=()=>new Promise((ie,me)=>{if(C&&me(C),E.size>0)return ie();P=ie,N=me}),ae=ie=>{let me=Promise.resolve(ie.next()).then(async({done:le,value:Se})=>{le||E.set(ie,Se),A.delete(me)});A.add(me),me.then(Y,F)};for(let ie of w)ae(ie);for(;;){if(A.size===0&&E.size===0)return;await W();for(let[ie,me]of E)E.delete(ie),yield me,ae(ie)}}async function re(m,w,A){let E=w;for await(let C of A)E=await m(E,C);return E}function Ht(m,w,A){return w===void 0?(E,C)=>C?re(m,E,C):Ht(m,E):A===void 0?E=>Ht(m,w,E):re(m,w,A)}async function*qt(m,w){let A=0;for await(let E of w)if(yield await E,A++,A>=m)break}function*Wr(m,w){let A=0;for(let E of w)if(yield E,A++,A>=m)break}function Ut(m,w){return w===void 0?A=>Ut(m,A):w[Symbol.asyncIterator]?qt(m,w):Wr(m,w)}async function*$(m,w){for await(let A of w)await m(A),yield A}function ro(m,w){return w===void 0?A=>$(m,A):$(m,w)}function no(m,w){let A=m[0]+w[0],E=m[1]+w[1];if(E>=1e9){let C=E%1e9;A+=(E-C)/1e9,E=C}return[A,E]}async function*io(m,w){let A=w[Symbol.asyncIterator](),E=[0,0];for(;;){let C=process.hrtime(),{value:N,done:P}=await A.next(),F=process.hrtime(C);if(E=no(E,F),m.progress&&m.progress(F,E),P)return m.total&&m.total(E),N;yield N}}function*Mt(m,w){let A=w[Symbol.iterator](),E=[0,0];for(;;){let C=process.hrtime(),{value:N,done:P}=A.next(),F=process.hrtime(C);if(E=no(E,F),m.progress&&m.progress(F,E),P)return m.total&&m.total(E),N;yield N}}function Xt(m={},w){return w===void 0?A=>Xt(m,A):w[Symbol.asyncIterator]!==void 0?io(m,w):Mt(m,w)}function b(m,w,A){let E=i(A),C=[],N=[],P=!1,F=!1,Y=0,W=null;function ae(){for(;N.length>0&&C.length>0;){let{resolve:ve}=N.shift(),Ce=C.shift();ve({done:!1,value:Ce})}for(;N.length>0&&Y===0&&P;){let{resolve:ve,reject:Ce}=N.shift();W?(Ce(W),W=null):ve({done:!0,value:void 0})}}async function ie(){if(P){ae();return}if(!F&&!(Y+C.length>=m)){F=!0,Y++;try{let{done:ve,value:Ce}=await E.next();ve?(P=!0,Y--,ae()):me(Ce)}catch(ve){P=!0,Y--,W=ve,ae()}F=!1,ie()}}async function me(ve){try{let Ce=await w(ve);C.push(Ce)}catch(Ce){P=!0,W=Ce}Y--,ae(),ie()}async function le(){if(C.length===0){let Ce=s();return N.push(Ce),ie(),Ce.promise}let ve=C.shift();return ie(),{done:!1,value:ve}}let Se={next:le,[Symbol.asyncIterator]:()=>Se};return Se}function x(m,w,A){return w===void 0?(E,C)=>C?x(m,E,C):x(m,E):A===void 0?E=>x(m,w,E):b(m,w,A)}async function I(m,w){let A=null,E=null,C=null,N=W=>{A=W,E&&E(W)},P=()=>{C&&C()},F=()=>{m.removeListener("error",N),m.removeListener("drain",P)};m.once("error",N);let Y=()=>new Promise((W,ae)=>{if(A)return ae(A);m.once("drain",P),C=W,E=ae});for await(let W of w)if(m.write(W)===!1&&await Y(),A)break;if(F(),A)throw A}function D(m,w){return w===void 0?A=>I(m,A):I(m,w)}t.batch=n,t.buffer=c,t.collect=l,t.concat=p,t.consume=g,t.filter=_,t.flatMap=q,t.flatTransform=te,t.flatten=B,t.fromStream=_e,t.getIterator=i,t.map=z,t.merge=ge,t.parallelFlatMap=Ae,t.parallelMap=et,t.parallelMerge=qe,t.pipeline=pe,t.reduce=Ht,t.take=Ut,t.tap=ro,t.time=Xt,t.transform=x,t.writeToStream=D,Object.defineProperty(t,"__esModule",{value:!0})})});var nS=S((qU,rS)=>{rS.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),n=Object.create(null);function i(s,o){r[s]=o,e++,e>=t&&(e=0,n=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||n[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),n[s]!==void 0&&(n[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=n[s])!==void 0)return i(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:i(s,o)},clear:function(){r=Object.create(null),n=Object.create(null)}}}});var sS=S((UU,iS)=>{"use strict";var BD=nS();iS.exports=t=>{let e=BD(t);return e.delete=e.remove,e}});var aS=S((oS,du)=>{(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function p(q){var k,te,se,j=$.prototype={constructor:$,toString:null,valueOf:null},_e=new $(1),ge=20,pe=4,Je=-7,et=21,Ae=-1e7,qe=1e7,re=!1,Ht=1,qt=0,Wr={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Ut="0123456789abcdefghijklmnopqrstuvwxyz";function $(b,x){var I,D,m,w,A,E,C,N,P=this;if(!(P instanceof $))return new $(b,x);if(x==null){if(b&&b._isBigNumber===!0){P.s=b.s,!b.c||b.e>qe?P.c=P.e=null:b.e<Ae?P.c=[P.e=0]:(P.e=b.e,P.c=b.c.slice());return}if((E=typeof b=="number")&&b*0==0){if(P.s=1/b<0?(b=-b,-1):1,b===~~b){for(w=0,A=b;A>=10;A/=10,w++);w>qe?P.c=P.e=null:(P.e=w,P.c=[b]);return}N=String(b)}else{if(!r.test(N=String(b)))return se(P,N,E);P.s=N.charCodeAt(0)==45?(N=N.slice(1),-1):1}(w=N.indexOf("."))>-1&&(N=N.replace(".","")),(A=N.search(/e/i))>0?(w<0&&(w=A),w+=+N.slice(A+1),N=N.substring(0,A)):w<0&&(w=N.length)}else{if(_(x,2,Ut.length,"Base"),x==10)return P=new $(b),Mt(P,ge+P.e+1,pe);if(N=String(b),E=typeof b=="number"){if(b*0!=0)return se(P,N,E,x);if(P.s=1/b<0?(N=N.slice(1),-1):1,$.DEBUG&&N.replace(/^0\.0*|\./,"").length>15)throw Error(o+b)}else P.s=N.charCodeAt(0)===45?(N=N.slice(1),-1):1;for(I=Ut.slice(0,x),w=A=0,C=N.length;A<C;A++)if(I.indexOf(D=N.charAt(A))<0){if(D=="."){if(A>w){w=C;continue}}else if(!m&&(N==N.toUpperCase()&&(N=N.toLowerCase())||N==N.toLowerCase()&&(N=N.toUpperCase()))){m=!0,A=-1,w=0;continue}return se(P,String(b),E,x)}E=!1,N=te(N,x,10,P.s),(w=N.indexOf("."))>-1?N=N.replace(".",""):w=N.length}for(A=0;N.charCodeAt(A)===48;A++);for(C=N.length;N.charCodeAt(--C)===48;);if(N=N.slice(A,++C)){if(C-=A,E&&$.DEBUG&&C>15&&(b>u||b!==i(b)))throw Error(o+P.s*b);if((w=w-A-1)>qe)P.c=P.e=null;else if(w<Ae)P.c=[P.e=0];else{if(P.e=w,P.c=[],A=(w+1)%c,w<0&&(A+=c),A<C){for(A&&P.c.push(+N.slice(0,A)),C-=c;A<C;)P.c.push(+N.slice(A,A+=c));A=c-(N=N.slice(A)).length}else A-=C;for(;A--;N+="0");P.c.push(+N)}}else P.c=[P.e=0]}$.clone=p,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.EUCLID=9,$.config=$.set=function(b){var x,I;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(x="DECIMAL_PLACES")&&(I=b[x],_(I,0,d,x),ge=I),b.hasOwnProperty(x="ROUNDING_MODE")&&(I=b[x],_(I,0,8,x),pe=I),b.hasOwnProperty(x="EXPONENTIAL_AT")&&(I=b[x],I&&I.pop?(_(I[0],-d,0,x),_(I[1],0,d,x),Je=I[0],et=I[1]):(_(I,-d,d,x),Je=-(et=I<0?-I:I))),b.hasOwnProperty(x="RANGE"))if(I=b[x],I&&I.pop)_(I[0],-d,-1,x),_(I[1],1,d,x),Ae=I[0],qe=I[1];else if(_(I,-d,d,x),I)Ae=-(qe=I<0?-I:I);else throw Error(s+x+" cannot be zero: "+I);if(b.hasOwnProperty(x="CRYPTO"))if(I=b[x],I===!!I)if(I)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))re=I;else throw re=!I,Error(s+"crypto unavailable");else re=I;else throw Error(s+x+" not true or false: "+I);if(b.hasOwnProperty(x="MODULO_MODE")&&(I=b[x],_(I,0,9,x),Ht=I),b.hasOwnProperty(x="POW_PRECISION")&&(I=b[x],_(I,0,d,x),qt=I),b.hasOwnProperty(x="FORMAT"))if(I=b[x],typeof I=="object")Wr=I;else throw Error(s+x+" not an object: "+I);if(b.hasOwnProperty(x="ALPHABET"))if(I=b[x],typeof I=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(I))Ut=I;else throw Error(s+x+" invalid: "+I)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ge,ROUNDING_MODE:pe,EXPONENTIAL_AT:[Je,et],RANGE:[Ae,qe],CRYPTO:re,MODULO_MODE:Ht,POW_PRECISION:qt,FORMAT:Wr,ALPHABET:Ut}},$.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!$.DEBUG)return!0;var x,I,D=b.c,m=b.e,w=b.s;e:if({}.toString.call(D)=="[object Array]"){if((w===1||w===-1)&&m>=-d&&m<=d&&m===i(m)){if(D[0]===0){if(m===0&&D.length===1)return!0;break e}if(x=(m+1)%c,x<1&&(x+=c),String(D[0]).length==x){for(x=0;x<D.length;x++)if(I=D[x],I<0||I>=a||I!==i(I))break e;if(I!==0)return!0}}}else if(D===null&&m===null&&(w===null||w===1||w===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},$.maximum=$.max=function(){return no(arguments,j.lt)},$.minimum=$.min=function(){return no(arguments,j.gt)},$.random=function(){var b=9007199254740992,x=Math.random()*b&2097151?function(){return i(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(I){var D,m,w,A,E,C=0,N=[],P=new $(_e);if(I==null?I=ge:_(I,0,d),A=n(I/c),re)if(crypto.getRandomValues){for(D=crypto.getRandomValues(new Uint32Array(A*=2));C<A;)E=D[C]*131072+(D[C+1]>>>11),E>=9e15?(m=crypto.getRandomValues(new Uint32Array(2)),D[C]=m[0],D[C+1]=m[1]):(N.push(E%1e14),C+=2);C=A/2}else if(crypto.randomBytes){for(D=crypto.randomBytes(A*=7);C<A;)E=(D[C]&31)*281474976710656+D[C+1]*1099511627776+D[C+2]*4294967296+D[C+3]*16777216+(D[C+4]<<16)+(D[C+5]<<8)+D[C+6],E>=9e15?crypto.randomBytes(7).copy(D,C):(N.push(E%1e14),C+=7);C=A/7}else throw re=!1,Error(s+"crypto unavailable");if(!re)for(;C<A;)E=x(),E<9e15&&(N[C++]=E%1e14);for(A=N[--C],I%=c,A&&I&&(E=l[c-I],N[C]=i(A/E)*E);N[C]===0;N.pop(),C--);if(C<0)N=[w=0];else{for(w=-1;N[0]===0;N.splice(0,1),w-=c);for(C=1,E=N[0];E>=10;E/=10,C++);C<c&&(w-=c-C)}return P.e=w,P.c=N,P}}(),$.sum=function(){for(var b=1,x=arguments,I=new $(x[0]);b<x.length;)I=I.plus(x[b++]);return I},te=function(){var b="0123456789";function x(I,D,m,w){for(var A,E=[0],C,N=0,P=I.length;N<P;){for(C=E.length;C--;E[C]*=D);for(E[0]+=w.indexOf(I.charAt(N++)),A=0;A<E.length;A++)E[A]>m-1&&(E[A+1]==null&&(E[A+1]=0),E[A+1]+=E[A]/m|0,E[A]%=m)}return E.reverse()}return function(I,D,m,w,A){var E,C,N,P,F,Y,W,ae,ie=I.indexOf("."),me=ge,le=pe;for(ie>=0&&(P=qt,qt=0,I=I.replace(".",""),ae=new $(D),Y=ae.pow(I.length-ie),qt=P,ae.c=x(z(g(Y.c),Y.e,"0"),10,m,b),ae.e=ae.c.length),W=x(I,D,m,A?(E=Ut,b):(E=b,Ut)),N=P=W.length;W[--P]==0;W.pop());if(!W[0])return E.charAt(0);if(ie<0?--N:(Y.c=W,Y.e=N,Y.s=w,Y=k(Y,ae,me,le,m),W=Y.c,F=Y.r,N=Y.e),C=N+me+1,ie=W[C],P=m/2,F=F||C<0||W[C+1]!=null,F=le<4?(ie!=null||F)&&(le==0||le==(Y.s<0?3:2)):ie>P||ie==P&&(le==4||F||le==6&&W[C-1]&1||le==(Y.s<0?8:7)),C<1||!W[0])I=F?z(E.charAt(1),-me,E.charAt(0)):E.charAt(0);else{if(W.length=C,F)for(--m;++W[--C]>m;)W[C]=0,C||(++N,W=[1].concat(W));for(P=W.length;!W[--P];);for(ie=0,I="";ie<=P;I+=E.charAt(W[ie++]));I=z(I,N,E.charAt(0))}return I}}(),k=function(){function b(D,m,w){var A,E,C,N,P=0,F=D.length,Y=m%f,W=m/f|0;for(D=D.slice();F--;)C=D[F]%f,N=D[F]/f|0,A=W*C+N*Y,E=Y*C+A%f*f+P,P=(E/w|0)+(A/f|0)+W*N,D[F]=E%w;return P&&(D=[P].concat(D)),D}function x(D,m,w,A){var E,C;if(w!=A)C=w>A?1:-1;else for(E=C=0;E<w;E++)if(D[E]!=m[E]){C=D[E]>m[E]?1:-1;break}return C}function I(D,m,w,A){for(var E=0;w--;)D[w]-=E,E=D[w]<m[w]?1:0,D[w]=E*A+D[w]-m[w];for(;!D[0]&&D.length>1;D.splice(0,1));}return function(D,m,w,A,E){var C,N,P,F,Y,W,ae,ie,me,le,Se,ve,Ce,so,Ru,_r,oo,Zt=D.s==m.s?1:-1,Pt=D.c,rt=m.c;if(!Pt||!Pt[0]||!rt||!rt[0])return new $(!D.s||!m.s||(Pt?rt&&Pt[0]==rt[0]:!rt)?NaN:Pt&&Pt[0]==0||!rt?Zt*0:Zt/0);for(ie=new $(Zt),me=ie.c=[],N=D.e-m.e,Zt=w+N+1,E||(E=a,N=h(D.e/c)-h(m.e/c),Zt=Zt/c|0),P=0;rt[P]==(Pt[P]||0);P++);if(rt[P]>(Pt[P]||0)&&N--,Zt<0)me.push(1),F=!0;else{for(so=Pt.length,_r=rt.length,P=0,Zt+=2,Y=i(E/(rt[0]+1)),Y>1&&(rt=b(rt,Y,E),Pt=b(Pt,Y,E),_r=rt.length,so=Pt.length),Ce=_r,le=Pt.slice(0,_r),Se=le.length;Se<_r;le[Se++]=0);oo=rt.slice(),oo=[0].concat(oo),Ru=rt[0],rt[1]>=E/2&&Ru++;do{if(Y=0,C=x(rt,le,_r,Se),C<0){if(ve=le[0],_r!=Se&&(ve=ve*E+(le[1]||0)),Y=i(ve/Ru),Y>1)for(Y>=E&&(Y=E-1),W=b(rt,Y,E),ae=W.length,Se=le.length;x(W,le,ae,Se)==1;)Y--,I(W,_r<ae?oo:rt,ae,E),ae=W.length,C=1;else Y==0&&(C=Y=1),W=rt.slice(),ae=W.length;if(ae<Se&&(W=[0].concat(W)),I(le,W,Se,E),Se=le.length,C==-1)for(;x(rt,le,_r,Se)<1;)Y++,I(le,_r<Se?oo:rt,Se,E),Se=le.length}else C===0&&(Y++,le=[0]);me[P++]=Y,le[0]?le[Se++]=Pt[Ce]||0:(le=[Pt[Ce]],Se=1)}while((Ce++<so||le[0]!=null)&&Zt--);F=le[0]!=null,me[0]||me.splice(0,1)}if(E==a){for(P=1,Zt=me[0];Zt>=10;Zt/=10,P++);Mt(ie,w+(ie.e=P+N*c-1)+1,A,F)}else ie.e=N,ie.r=+F;return ie}}();function ro(b,x,I,D){var m,w,A,E,C;if(I==null?I=pe:_(I,0,8),!b.c)return b.toString();if(m=b.c[0],A=b.e,x==null)C=g(b.c),C=D==1||D==2&&(A<=Je||A>=et)?L(C,A):z(C,A,"0");else if(b=Mt(new $(b),x,I),w=b.e,C=g(b.c),E=C.length,D==1||D==2&&(x<=w||w<=Je)){for(;E<x;C+="0",E++);C=L(C,w)}else if(x-=A,C=z(C,w,"0"),w+1>E){if(--x>0)for(C+=".";x--;C+="0");}else if(x+=w-E,x>0)for(w+1==E&&(C+=".");x--;C+="0");return b.s<0&&m?"-"+C:C}function no(b,x){for(var I,D=1,m=new $(b[0]);D<b.length;D++)if(I=new $(b[D]),I.s)x.call(m,I)&&(m=I);else{m=I;break}return m}function io(b,x,I){for(var D=1,m=x.length;!x[--m];x.pop());for(m=x[0];m>=10;m/=10,D++);return(I=D+I*c-1)>qe?b.c=b.e=null:I<Ae?b.c=[b.e=0]:(b.e=I,b.c=x),b}se=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,x=/^([^.]+)\.$/,I=/^\.([^.]+)$/,D=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(w,A,E,C){var N,P=E?A:A.replace(m,"");if(D.test(P))w.s=isNaN(P)?null:P<0?-1:1;else{if(!E&&(P=P.replace(b,function(F,Y,W){return N=(W=W.toLowerCase())=="x"?16:W=="b"?2:8,!C||C==N?Y:F}),C&&(N=C,P=P.replace(x,"$1").replace(I,"0.$1")),A!=P))return new $(P,N);if($.DEBUG)throw Error(s+"Not a"+(C?" base "+C:"")+" number: "+A);w.s=null}w.c=w.e=null}}();function Mt(b,x,I,D){var m,w,A,E,C,N,P,F=b.c,Y=l;if(F){e:{for(m=1,E=F[0];E>=10;E/=10,m++);if(w=x-m,w<0)w+=c,A=x,C=F[N=0],P=C/Y[m-A-1]%10|0;else if(N=n((w+1)/c),N>=F.length)if(D){for(;F.length<=N;F.push(0));C=P=0,m=1,w%=c,A=w-c+1}else break e;else{for(C=E=F[N],m=1;E>=10;E/=10,m++);w%=c,A=w-c+m,P=A<0?0:C/Y[m-A-1]%10|0}if(D=D||x<0||F[N+1]!=null||(A<0?C:C%Y[m-A-1]),D=I<4?(P||D)&&(I==0||I==(b.s<0?3:2)):P>5||P==5&&(I==4||D||I==6&&(w>0?A>0?C/Y[m-A]:0:F[N-1])%10&1||I==(b.s<0?8:7)),x<1||!F[0])return F.length=0,D?(x-=b.e+1,F[0]=Y[(c-x%c)%c],b.e=-x||0):F[0]=b.e=0,b;if(w==0?(F.length=N,E=1,N--):(F.length=N+1,E=Y[c-w],F[N]=A>0?i(C/Y[m-A]%Y[A])*E:0),D)for(;;)if(N==0){for(w=1,A=F[0];A>=10;A/=10,w++);for(A=F[0]+=E,E=1;A>=10;A/=10,E++);w!=E&&(b.e++,F[0]==a&&(F[0]=1));break}else{if(F[N]+=E,F[N]!=a)break;F[N--]=0,E=1}for(w=F.length;F[--w]===0;F.pop());}b.e>qe?b.c=b.e=null:b.e<Ae&&(b.c=[b.e=0])}return b}function Xt(b){var x,I=b.e;return I===null?b.toString():(x=g(b.c),x=I<=Je||I>=et?L(x,I):z(x,I,"0"),b.s<0?"-"+x:x)}return j.absoluteValue=j.abs=function(){var b=new $(this);return b.s<0&&(b.s=1),b},j.comparedTo=function(b,x){return v(this,new $(b,x))},j.decimalPlaces=j.dp=function(b,x){var I,D,m,w=this;if(b!=null)return _(b,0,d),x==null?x=pe:_(x,0,8),Mt(new $(w),b+w.e+1,x);if(!(I=w.c))return null;if(D=((m=I.length-1)-h(this.e/c))*c,m=I[m])for(;m%10==0;m/=10,D--);return D<0&&(D=0),D},j.dividedBy=j.div=function(b,x){return k(this,new $(b,x),ge,pe)},j.dividedToIntegerBy=j.idiv=function(b,x){return k(this,new $(b,x),0,1)},j.exponentiatedBy=j.pow=function(b,x){var I,D,m,w,A,E,C,N,P,F=this;if(b=new $(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+Xt(b));if(x!=null&&(x=new $(x)),E=b.e>14,!F.c||!F.c[0]||F.c[0]==1&&!F.e&&F.c.length==1||!b.c||!b.c[0])return P=new $(Math.pow(+Xt(F),E?2-B(b):+Xt(b))),x?P.mod(x):P;if(C=b.s<0,x){if(x.c?!x.c[0]:!x.s)return new $(NaN);D=!C&&F.isInteger()&&x.isInteger(),D&&(F=F.mod(x))}else{if(b.e>9&&(F.e>0||F.e<-1||(F.e==0?F.c[0]>1||E&&F.c[1]>=24e7:F.c[0]<8e13||E&&F.c[0]<=9999975e7)))return w=F.s<0&&B(b)?-0:0,F.e>-1&&(w=1/w),new $(C?1/w:w);qt&&(w=n(qt/c+2))}for(E?(I=new $(.5),C&&(b.s=1),N=B(b)):(m=Math.abs(+Xt(b)),N=m%2),P=new $(_e);;){if(N){if(P=P.times(F),!P.c)break;w?P.c.length>w&&(P.c.length=w):D&&(P=P.mod(x))}if(m){if(m=i(m/2),m===0)break;N=m%2}else if(b=b.times(I),Mt(b,b.e+1,1),b.e>14)N=B(b);else{if(m=+Xt(b),m===0)break;N=m%2}F=F.times(F),w?F.c&&F.c.length>w&&(F.c.length=w):D&&(F=F.mod(x))}return D?P:(C&&(P=_e.div(P)),x?P.mod(x):w?Mt(P,qt,pe,A):P)},j.integerValue=function(b){var x=new $(this);return b==null?b=pe:_(b,0,8),Mt(x,x.e+1,b)},j.isEqualTo=j.eq=function(b,x){return v(this,new $(b,x))===0},j.isFinite=function(){return!!this.c},j.isGreaterThan=j.gt=function(b,x){return v(this,new $(b,x))>0},j.isGreaterThanOrEqualTo=j.gte=function(b,x){return(x=v(this,new $(b,x)))===1||x===0},j.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},j.isLessThan=j.lt=function(b,x){return v(this,new $(b,x))<0},j.isLessThanOrEqualTo=j.lte=function(b,x){return(x=v(this,new $(b,x)))===-1||x===0},j.isNaN=function(){return!this.s},j.isNegative=function(){return this.s<0},j.isPositive=function(){return this.s>0},j.isZero=function(){return!!this.c&&this.c[0]==0},j.minus=function(b,x){var I,D,m,w,A=this,E=A.s;if(b=new $(b,x),x=b.s,!E||!x)return new $(NaN);if(E!=x)return b.s=-x,A.plus(b);var C=A.e/c,N=b.e/c,P=A.c,F=b.c;if(!C||!N){if(!P||!F)return P?(b.s=-x,b):new $(F?A:NaN);if(!P[0]||!F[0])return F[0]?(b.s=-x,b):new $(P[0]?A:pe==3?-0:0)}if(C=h(C),N=h(N),P=P.slice(),E=C-N){for((w=E<0)?(E=-E,m=P):(N=C,m=F),m.reverse(),x=E;x--;m.push(0));m.reverse()}else for(D=(w=(E=P.length)<(x=F.length))?E:x,E=x=0;x<D;x++)if(P[x]!=F[x]){w=P[x]<F[x];break}if(w&&(m=P,P=F,F=m,b.s=-b.s),x=(D=F.length)-(I=P.length),x>0)for(;x--;P[I++]=0);for(x=a-1;D>E;){if(P[--D]<F[D]){for(I=D;I&&!P[--I];P[I]=x);--P[I],P[D]+=a}P[D]-=F[D]}for(;P[0]==0;P.splice(0,1),--N);return P[0]?io(b,P,N):(b.s=pe==3?-1:1,b.c=[b.e=0],b)},j.modulo=j.mod=function(b,x){var I,D,m=this;return b=new $(b,x),!m.c||!b.s||b.c&&!b.c[0]?new $(NaN):!b.c||m.c&&!m.c[0]?new $(m):(Ht==9?(D=b.s,b.s=1,I=k(m,b,0,3),b.s=D,I.s*=D):I=k(m,b,0,Ht),b=m.minus(I.times(b)),!b.c[0]&&Ht==1&&(b.s=m.s),b)},j.multipliedBy=j.times=function(b,x){var I,D,m,w,A,E,C,N,P,F,Y,W,ae,ie,me,le=this,Se=le.c,ve=(b=new $(b,x)).c;if(!Se||!ve||!Se[0]||!ve[0])return!le.s||!b.s||Se&&!Se[0]&&!ve||ve&&!ve[0]&&!Se?b.c=b.e=b.s=null:(b.s*=le.s,!Se||!ve?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(D=h(le.e/c)+h(b.e/c),b.s*=le.s,C=Se.length,F=ve.length,C<F&&(ae=Se,Se=ve,ve=ae,m=C,C=F,F=m),m=C+F,ae=[];m--;ae.push(0));for(ie=a,me=f,m=F;--m>=0;){for(I=0,Y=ve[m]%me,W=ve[m]/me|0,A=C,w=m+A;w>m;)N=Se[--A]%me,P=Se[A]/me|0,E=W*N+P*Y,N=Y*N+E%me*me+ae[w]+I,I=(N/ie|0)+(E/me|0)+W*P,ae[w--]=N%ie;ae[w]=I}return I?++D:ae.splice(0,1),io(b,ae,D)},j.negated=function(){var b=new $(this);return b.s=-b.s||null,b},j.plus=function(b,x){var I,D=this,m=D.s;if(b=new $(b,x),x=b.s,!m||!x)return new $(NaN);if(m!=x)return b.s=-x,D.minus(b);var w=D.e/c,A=b.e/c,E=D.c,C=b.c;if(!w||!A){if(!E||!C)return new $(m/0);if(!E[0]||!C[0])return C[0]?b:new $(E[0]?D:m*0)}if(w=h(w),A=h(A),E=E.slice(),m=w-A){for(m>0?(A=w,I=C):(m=-m,I=E),I.reverse();m--;I.push(0));I.reverse()}for(m=E.length,x=C.length,m-x<0&&(I=C,C=E,E=I,x=m),m=0;x;)m=(E[--x]=E[x]+C[x]+m)/a|0,E[x]=a===E[x]?0:E[x]%a;return m&&(E=[m].concat(E),++A),io(b,E,A)},j.precision=j.sd=function(b,x){var I,D,m,w=this;if(b!=null&&b!==!!b)return _(b,1,d),x==null?x=pe:_(x,0,8),Mt(new $(w),b,x);if(!(I=w.c))return null;if(m=I.length-1,D=m*c+1,m=I[m]){for(;m%10==0;m/=10,D--);for(m=I[0];m>=10;m/=10,D++);}return b&&w.e+1>D&&(D=w.e+1),D},j.shiftedBy=function(b){return _(b,-u,u),this.times("1e"+b)},j.squareRoot=j.sqrt=function(){var b,x,I,D,m,w=this,A=w.c,E=w.s,C=w.e,N=ge+4,P=new $("0.5");if(E!==1||!A||!A[0])return new $(!E||E<0&&(!A||A[0])?NaN:A?w:1/0);if(E=Math.sqrt(+Xt(w)),E==0||E==1/0?(x=g(A),(x.length+C)%2==0&&(x+="0"),E=Math.sqrt(+x),C=h((C+1)/2)-(C<0||C%2),E==1/0?x="5e"+C:(x=E.toExponential(),x=x.slice(0,x.indexOf("e")+1)+C),I=new $(x)):I=new $(E+""),I.c[0]){for(C=I.e,E=C+N,E<3&&(E=0);;)if(m=I,I=P.times(m.plus(k(w,m,N,1))),g(m.c).slice(0,E)===(x=g(I.c)).slice(0,E))if(I.e<C&&--E,x=x.slice(E-3,E+1),x=="9999"||!D&&x=="4999"){if(!D&&(Mt(m,m.e+ge+2,0),m.times(m).eq(w))){I=m;break}N+=4,E+=4,D=1}else{(!+x||!+x.slice(1)&&x.charAt(0)=="5")&&(Mt(I,I.e+ge+2,1),b=!I.times(I).eq(w));break}}return Mt(I,I.e+ge+1,pe,b)},j.toExponential=function(b,x){return b!=null&&(_(b,0,d),b++),ro(this,b,x,1)},j.toFixed=function(b,x){return b!=null&&(_(b,0,d),b=b+this.e+1),ro(this,b,x)},j.toFormat=function(b,x,I){var D,m=this;if(I==null)b!=null&&x&&typeof x=="object"?(I=x,x=null):b&&typeof b=="object"?(I=b,b=x=null):I=Wr;else if(typeof I!="object")throw Error(s+"Argument not an object: "+I);if(D=m.toFixed(b,x),m.c){var w,A=D.split("."),E=+I.groupSize,C=+I.secondaryGroupSize,N=I.groupSeparator||"",P=A[0],F=A[1],Y=m.s<0,W=Y?P.slice(1):P,ae=W.length;if(C&&(w=E,E=C,C=w,ae-=w),E>0&&ae>0){for(w=ae%E||E,P=W.substr(0,w);w<ae;w+=E)P+=N+W.substr(w,E);C>0&&(P+=N+W.slice(w)),Y&&(P="-"+P)}D=F?P+(I.decimalSeparator||"")+((C=+I.fractionGroupSize)?F.replace(new RegExp("\\d{"+C+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):F):P}return(I.prefix||"")+D+(I.suffix||"")},j.toFraction=function(b){var x,I,D,m,w,A,E,C,N,P,F,Y,W=this,ae=W.c;if(b!=null&&(E=new $(b),!E.isInteger()&&(E.c||E.s!==1)||E.lt(_e)))throw Error(s+"Argument "+(E.isInteger()?"out of range: ":"not an integer: ")+Xt(E));if(!ae)return new $(W);for(x=new $(_e),N=I=new $(_e),D=C=new $(_e),Y=g(ae),w=x.e=Y.length-W.e-1,x.c[0]=l[(A=w%c)<0?c+A:A],b=!b||E.comparedTo(x)>0?w>0?x:N:E,A=qe,qe=1/0,E=new $(Y),C.c[0]=0;P=k(E,x,0,1),m=I.plus(P.times(D)),m.comparedTo(b)!=1;)I=D,D=m,N=C.plus(P.times(m=N)),C=m,x=E.minus(P.times(m=x)),E=m;return m=k(b.minus(I),D,0,1),C=C.plus(m.times(N)),I=I.plus(m.times(D)),C.s=N.s=W.s,w=w*2,F=k(N,D,w,pe).minus(W).abs().comparedTo(k(C,I,w,pe).minus(W).abs())<1?[N,D]:[C,I],qe=A,F},j.toNumber=function(){return+Xt(this)},j.toPrecision=function(b,x){return b!=null&&_(b,1,d),ro(this,b,x,2)},j.toString=function(b){var x,I=this,D=I.s,m=I.e;return m===null?D?(x="Infinity",D<0&&(x="-"+x)):x="NaN":(b==null?x=m<=Je||m>=et?L(g(I.c),m):z(g(I.c),m,"0"):b===10?(I=Mt(new $(I),ge+m+1,pe),x=z(g(I.c),I.e,"0")):(_(b,2,Ut.length,"Base"),x=te(z(g(I.c),m,"0"),10,b,D,!0)),D<0&&I.c[0]&&(x="-"+x)),x},j.valueOf=j.toJSON=function(){return Xt(this)},j._isBigNumber=!0,q!=null&&$.set(q),$}function h(q){var k=q|0;return q>0||q===k?k:k-1}function g(q){for(var k,te,se=1,j=q.length,_e=q[0]+"";se<j;){for(k=q[se++]+"",te=c-k.length;te--;k="0"+k);_e+=k}for(j=_e.length;_e.charCodeAt(--j)===48;);return _e.slice(0,j+1||1)}function v(q,k){var te,se,j=q.c,_e=k.c,ge=q.s,pe=k.s,Je=q.e,et=k.e;if(!ge||!pe)return null;if(te=j&&!j[0],se=_e&&!_e[0],te||se)return te?se?0:-pe:ge;if(ge!=pe)return ge;if(te=ge<0,se=Je==et,!j||!_e)return se?0:!j^te?1:-1;if(!se)return Je>et^te?1:-1;for(pe=(Je=j.length)<(et=_e.length)?Je:et,ge=0;ge<pe;ge++)if(j[ge]!=_e[ge])return j[ge]>_e[ge]^te?1:-1;return Je==et?0:Je>et^te?1:-1}function _(q,k,te,se){if(q<k||q>te||q!==i(q))throw Error(s+(se||"Argument")+(typeof q=="number"?q<k||q>te?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function B(q){var k=q.c.length-1;return h(q.e/c)==k&&q.c[k]%2!=0}function L(q,k){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(k<0?"e":"e+")+k}function z(q,k,te){var se,j;if(k<0){for(j=te+".";++k;j+=te);q=j+q}else if(se=q.length,++k>se){for(j=te,k-=se;--k;j+=te);q+=j}else k<se&&(q=q.slice(0,k)+"."+q.slice(k));return q}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof du!="undefined"&&du.exports?du.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(oS)});var lS=S((cS,uS)=>{"use strict";var PD=Math.exp;cS=uS.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,n=0,i=0,s=0,o,a={};function c(u,l){return 1-PD(-(u-l)/e)}return a.push=function(l,f){if(o){let d=c(l,o),p=f-r,h=d*p;r=d*f+(1-d)*r,n=(1-d)*(n+p*h),i=Math.sqrt(n),s=r+d*p}else r=f;o=l},a.movingAverage=function(){return r},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return s},a}});var pS=S((MU,hS)=>{"use strict";var{EventEmitter:ND}=Jt(),{BigNumber:hu}=aS(),fS=lS(),DD=Yo(),dS=class extends ND{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:hu(0),dataSent:hu(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let n=this._options.movingAverageIntervals;for(let i=0;i<e.length;i++){let s=e[i];this._stats[s]=hu(0),this._movingAverages[s]={};for(let o=0;o<n.length;o++){let a=n[o];(this._movingAverages[s][a]=fS(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,n={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},i=Object.keys(r);for(let s of i){n.movingAverages[s]={};for(let o of Object.keys(r[s]))n.movingAverages[s][o]=r[s][o].movingAverage()}return n}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=DD(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=i/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],f=a[l];f||(f=a[l]=fS(l)),f.push(n,o)}}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);let i;Object.prototype.hasOwnProperty.call(this._stats,r)?i=this._stats[r]:i=this._stats[r]=hu(0),this._stats[r]=i.plus(n),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=n}};hS.exports=dS});var mS=S((FU,gS)=>{"use strict";var OD=gs(),{pipe:LD}=jr(),{tap:yS}=fu(),kD=sS(),{METRICS:qD}=Fc(),Kd=pS(),Vd=["dataReceived","dataSent"],UD={in:"dataReceived",out:"dataSent"},pu=class{constructor(e){this._options=OD(qD,e),this._globalStats=new Kd(Vd,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=kD(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._componentMetrics=new Map}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}getComponentMetrics(){return this._componentMetrics}updateComponentMetric(e,r,n){this._componentMetrics.has(e)||this._componentMetrics.set(e,new Map),this._componentMetrics.get(e).set(r,n)}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),n=this._peerStats.get(r);n&&(n.stop(),this._peerStats.delete(r),this._oldPeers.set(r,n))}_onMessage({remotePeer:e,protocol:r,direction:n,dataLength:i}){if(!this._running)return;let s=UD[n],o=this.forPeer(e);if(o||(o=new Kd(Vd,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,i),this._globalStats.push(s,i),r){let a=this.forProtocol(r);a||(a=new Kd(Vd,this._options),this._protocolStats.set(r,a)),a.push(s,i)}}updatePlaceholder(e,r){if(!this._running)return;let n=this.forPeer(e),i=r.toB58String(),s=this.forPeer(r),o=n;s&&(o=pu.mergeStats(s,o),this._oldPeers.delete(i)),this._peerStats.delete(e.toB58String()),this._peerStats.set(i,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:n}){let i=this,s=e.source;e.source=yS(a=>i._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>LD(a,yS(c=>i._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};gS.exports=pu});var yu=S(Ni=>{"use strict";var vS=Ai(),bS=oa(),MD=jr(),FD=he(),{fromString:KD}=(St(),At),VD=Sf(),ES=KD(`
`);Ni.encode=t=>bS.encode.single(new vS([t,ES]));Ni.write=(t,e)=>t.push(Ni.encode(e));Ni.writeAll=(t,e)=>{t.push(e.reduce((r,n)=>r.append(Ni.encode(n)),new vS))};Ni.read=async t=>{let e=1,r={[Symbol.asyncIterator](){return this},next:()=>t.next(e)},n=s=>{e=s},i=await MD(r,bS.decode({onLength:n}),VD);if(i.get(i.length-1)!==ES[0])throw FD(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return i.shallowSlice(0,-1)}});var SS=S((VU,wS)=>{"use strict";var Fs=Ne()("mss:select"),jD=he(),Ks=yu(),$D=aa();wS.exports=async(t,e,r)=>{e=Array.isArray(e)?[...e]:[e];let{reader:n,writer:i,rest:s,stream:o}=$D(t),a=e.shift();r?(Fs('select: write ["%s", "%s"]',r,a),Ks.writeAll(i,[r,a])):(Fs('select: write "%s"',a),Ks.write(i,a));let c=(await Ks.read(n)).toString();if(Fs('select: read "%s"',c),c===r&&(c=(await Ks.read(n)).toString(),Fs('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let u of e){Fs('select: write "%s"',u),Ks.write(i,u);let l=(await Ks.read(n)).toString();if(Fs('select: read "%s" for "%s"',l,u),l===u)return s(),{stream:o,protocol:u}}throw s(),jD(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var jd=S(xS=>{"use strict";xS.PROTOCOL_ID="/multistream/1.0.0"});var AS=S(($U,_S)=>{"use strict";var ha=Ne()("mss:handle"),HD=Ai(),Vs=yu(),zD=aa(),{PROTOCOL_ID:$d}=jd();_S.exports=async(t,e)=>{e=Array.isArray(e)?e:[e];let{writer:r,reader:n,rest:i,stream:s}=zD(t);for(;;){let o=(await Vs.read(n)).toString();if(ha('read "%s"',o),o===$d){ha('respond with "%s" for "%s"',$d,o),Vs.write(r,$d);continue}if(e.includes(o))return Vs.write(r,o),ha('respond with "%s" for "%s"',o,o),i(),{stream:s,protocol:o};if(o==="ls"){Vs.write(r,new HD(e.map(a=>Vs.encode(a)))),ha('respond with "%s" for %s',e,o);continue}Vs.write(r,"na"),ha('respond with "na" for "%s"',o)}}});var TS=S((HU,IS)=>{"use strict";var GD=hd(),YD=Ne()("it-multistream-select:ls"),CS=yu(),WD=aa(),QD=oa(),XD=jr();IS.exports=async t=>{let{reader:e,writer:r,rest:n,stream:i}=WD(t);YD('write "ls"'),CS.write(r,"ls"),n();let s=await CS.read(e),o=GD([s]),a=[];return await XD(o,QD.decode(),async c=>{for await(let u of c)a.push(u.shallowSlice(0,-1).toString())}),{stream:i,protocols:a}}});var NS=S(gu=>{"use strict";var RS=SS(),ZD=AS(),JD=TS(),{PROTOCOL_ID:Hd}=jd();gu.PROTOCOL_ID=Hd;var zd=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await RS(this._stream,Hd);this._stream=e,this._shaken=!0}},BS=class extends zd{select(e){return RS(this._stream,e,this._shaken?null:Hd)}async ls(){await this._handshake();let{stream:e,protocols:r}=await JD(this._stream);return this._stream=e,r}};gu.Dialer=BS;var PS=class extends zd{handle(e){return ZD(this._stream,e)}};gu.Listener=PS});var OS=S((GU,DS)=>{"use strict";var eO={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};DS.exports=eO});var FS=S((YU,MS)=>{"use strict";var LS=ct(),{Multiaddr:tO}=Rt(),Wt=he(),{OPEN:rO,CLOSING:kS,CLOSED:Gd}=OS(),qS=Symbol.for("@libp2p/interface-connection/connection"),US=class{constructor({localAddr:e,remoteAddr:r,localPeer:n,remotePeer:i,newStream:s,close:o,getStreams:a,stat:c}){nO(e,n,i,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=n,this.remotePeer=i,this._stat={...c,status:rO},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[qS](){return!0}static isConnection(e){return Boolean(e&&e[qS])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===kS)throw Wt(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Gd)throw Wt(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:n}=await this._newStream(e);return this.addStream(r,{protocol:n}),{stream:r,protocol:n}}addStream(e,{protocol:r,metadata:n={}}){this.registry.set(e.id,{protocol:r,...n})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==Gd){if(this._closing)return this._closing;this.stat.status=kS,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=Gd}}};MS.exports=US;function nO(t,e,r,n,i,s,o){if(t&&!tO.isMultiaddr(t))throw Wt(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!LS.isPeerId(e))throw Wt(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!LS.isPeerId(r))throw Wt(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Wt(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Wt(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Wt(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Wt(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Wt(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Wt(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Wt(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Wt(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var VS=S(KS=>{"use strict";KS.Connection=FS()});var $S=S((QU,jS)=>{"use strict";function iO(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}jS.exports=function(e){var r=void 0,n=void 0;function i(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');n=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=a}i(function(){}),e&&i(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,f=Array(l),d=0;d<l;d++)f[d]=arguments[d];return r[u].apply(null,[n].concat(iO(f.slice(1))))}}});return{setTarget:i,setHandler:s,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,o)}}});var WS=S((XU,YS)=>{"use strict";var HS=Ne(),dt=Object.assign(HS("libp2p:upgrader"),{error:HS("libp2p:upgrader:err")}),Di=he(),js=NS(),{Connection:sO}=VS(),oO=ct(),{pipe:aO}=jr(),zS=$S(),{codes:Oi}=Fe(),GS=class{constructor({localPeer:e,metrics:r,cryptos:n=new Map,muxers:i=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=r,this.cryptos=n,this.muxers=i,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let r,n,i,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=zS());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}dt("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:r,remotePeer:n,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:i,Muxer:s}=await this._multiplexInbound(r,this.muxers):i=r}catch(l){throw dt.error("Failed to upgrade inbound connection",l),await e.close(l),l}return this.metrics&&(this.metrics.updatePlaceholder(c,n),a(n)),dt("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:i,Muxer:s,remotePeer:n})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw Di(new Error("outbound connection must have a peer id"),Oi.ERR_INVALID_MULTIADDR);let n=oO.createFromB58String(r),i,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=zS());let d=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>d}),e=this.metrics.trackStream({stream:e,remotePeer:l})}dt("Starting the outbound connection upgrade");let f=e;this.protector&&(f=await this.protector.protect(e));try{({conn:i,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,f,n,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(i,this.muxers):o=i}catch(d){throw dt.error("Failed to upgrade outbound connection",d),await e.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),dt("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:n,upgradedConn:i,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async d=>{if(!u)return;let p=new js.Listener(d);try{let{stream:h,protocol:g}=await p.handle(Array.from(this.protocols.keys()));dt("%s: incoming stream opened on %s",r,g),this.metrics&&this.metrics.trackStream({stream:h,remotePeer:o,protocol:g}),u.addStream(d,{protocol:g}),this._onStream({connection:u,stream:{...d,...h},protocol:g})}catch(h){dt.error(h)}},onStreamEnd:d=>{u.removeStream(d.id)}}),c=async d=>{dt("%s: starting new stream on %s",r,d);let p=a.newStream(),h=new js.Dialer(p);try{let{stream:g,protocol:v}=await h.select(d);return this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:v}),{stream:{...p,...g},protocol:v}}catch(g){throw dt.error("could not create new stream",g),Di(g,Oi.ERR_UNSUPPORTED_PROTOCOL)}},aO(i,a,i).catch(dt.error));let l=n.timeline;n.timeline=new Proxy(l,{set:(...d)=>(u&&d[1]==="close"&&d[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){dt.error(p)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...d))}),n.timeline.upgraded=Date.now();let f=()=>{throw Di(new Error("connection is not multiplexed"),Oi.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=new sO({localAddr:n.localAddr,remoteAddr:n.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:n.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||f,getStreams:()=>a?a.streams:f(),close:async()=>{await n.close(),a&&a.streams.map(d=>d.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:n}){this.protocols.get(n)({connection:e,stream:r,protocol:n})}async _encryptInbound(e,r,n){let i=new js.Listener(r),s=Array.from(n.keys());dt("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await i.handle(s),c=n.get(a);if(dt("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Di(o,Oi.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,n,i){let s=new js.Dialer(r),o=Array.from(i.keys());dt("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=i.get(c);if(dt("encrypting outbound connection to %j",n),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,n),protocol:c}}catch(a){throw Di(a,Oi.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let n=new js.Dialer(e),i=Array.from(r.keys());dt("outbound selecting muxer %s",i);try{let{stream:s,protocol:o}=await n.select(i);dt("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw Di(s,Oi.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let n=new js.Listener(e),i=Array.from(r.keys());dt("inbound handling muxers %s",i);try{let{stream:s,protocol:o}=await n.handle(i),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw Di(s,Oi.ERR_MUXER_UNAVAILABLE)}}};YS.exports=GS});var pa=S((ZU,ZS)=>{"use strict";var Yd=he(),QS=ct(),{codes:Wd}=Fe(),cO=t=>t,XS=class{constructor({peerStore:e,eventName:r,eventProperty:n,eventTransformer:i=cO}){this._ps=e,this.eventName=r,this.eventProperty=n,this.eventTransformer=i,this.data=new Map}set(e,r){throw Yd(new Error("set must be implemented by the subclass"),Wd.ERR_NOT_IMPLEMENTED)}_setData(e,r,{emit:n=!0}={}){let i=e.toB58String();this.data.set(i,r),n&&this._emit(e,r)}_emit(e,r){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(r)})}get(e){if(!QS.isPeerId(e))throw Yd(new Error("peerId must be an instance of peer-id"),Wd.ERR_INVALID_PARAMETERS);let r=this.data.get(e.toB58String());return r?[...r]:void 0}delete(e){if(!QS.isPeerId(e))throw Yd(new Error("peerId must be an instance of peer-id"),Wd.ERR_INVALID_PARAMETERS);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};ZS.exports=XS});var rx=S((JU,tx)=>{"use strict";var JS=Ne(),Sr=Object.assign(JS("libp2p:peer-store:address-book"),{error:JS("libp2p:peer-store:address-book:err")}),$s=he(),{Multiaddr:uO}=Rt(),mu=ct(),lO=pa(),fO=zc(),{codes:{ERR_INVALID_PARAMETERS:Hs}}=Fe(),dO=$c(),ex=class extends lO{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:r=>r.addresses?r.addresses.map(n=>n.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let r;try{r=fO.createFromProtobuf(e.payload)}catch(c){return Sr.error("invalid peer record received"),!1}if(!r.peerId.equals(e.peerId))return Sr("signing key does not match PeerId in the PeerRecord"),!1;if(!r.multiaddrs||!r.multiaddrs.length)return!1;let n=r.peerId,i=n.toB58String(),o=(this.data.get(i)||{record:void 0}).record;if(o&&o.seqNumber>=r.seqNumber)return!1;let a=this._toAddresses(r.multiaddrs,!0);return this._setData(n,{addresses:a,record:{raw:e.marshal(),seqNumber:r.seqNumber}}),Sr(`stored provided peer record for ${i}`),!0}getRawEnvelope(e){let r=this.data.get(e.toB58String());if(!(!r||!r.record||!r.record.raw))return r.record.raw}getPeerRecord(e){let r=this.getRawEnvelope(e);if(!!r)return dO.createFromProtobuf(r)}set(e,r){if(!mu.isPeerId(e))throw Sr.error("peerId must be an instance of peer-id to store data"),$s(new Error("peerId must be an instance of peer-id"),Hs);let n=this._toAddresses(r);if(!n.length)return this;let i=e.toB58String(),s=this.data.get(i);return s&&s.addresses&&s.addresses.length===n.length&&s.addresses.filter(a=>n.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(Sr(`the addresses provided to store are equal to the already stored for ${i}`),this):(this._setData(e,{addresses:n,record:s&&s.record}),Sr(`stored provided multiaddrs for ${i}`),s||this._ps.emit("peer",e),this)}add(e,r){if(!mu.isPeerId(e))throw Sr.error("peerId must be an instance of peer-id to store data"),$s(new Error("peerId must be an instance of peer-id"),Hs);let n=this._toAddresses(r),i=e.toB58String();if(!n.length)return this;let s=this.data.get(i);return s&&s.addresses&&(s.addresses.forEach(o=>{n.find(a=>a.multiaddr.equals(o.multiaddr))||n.push(o)}),s.addresses.length===n.length)?(Sr(`the addresses provided to store are already stored for ${i}`),this):(this._setData(e,{addresses:n,record:s&&s.record}),Sr(`added provided multiaddrs for ${i}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!mu.isPeerId(e))throw $s(new Error("peerId must be an instance of peer-id"),Hs);let r=this.data.get(e.toB58String());return r&&r.addresses?[...r.addresses]:void 0}_toAddresses(e,r=!1){if(!e)throw Sr.error("multiaddrs must be provided to store data"),$s(new Error("multiaddrs must be provided"),Hs);let n=[];return e.forEach(i=>{if(!uO.isMultiaddr(i))throw Sr.error(`multiaddr ${i} must be an instance of multiaddr`),$s(new Error(`multiaddr ${i} must be an instance of multiaddr`),Hs);n.find(s=>s.multiaddr.equals(i))||n.push({multiaddr:i,isCertified:r})}),n}getMultiaddrsForPeer(e,r=n=>n){if(!mu.isPeerId(e))throw $s(new Error("peerId must be an instance of peer-id"),Hs);let n=this.data.get(e.toB58String());if(!(!n||!n.addresses))return r(n.addresses||[]).map(i=>{let s=i.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};tx.exports=ex});var lx=S((eM,ux)=>{"use strict";var nx=Ne(),ix=Object.assign(nx("libp2p:peer-store:key-book"),{error:nx("libp2p:peer-store:key-book:err")}),sx=he(),ox=ct(),hO=pa(),{codes:{ERR_INVALID_PARAMETERS:ax}}=Fe(),cx=class extends hO{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:r=>r.pubKey});this.data=new Map}set(e,r){if(!ox.isPeerId(e))throw ix.error("peerId must be an instance of peer-id to store data"),sx(new Error("peerId must be an instance of peer-id"),ax);let n=e.toB58String();return!this.data.get(n)&&r&&(e.pubKey=r,this._setData(e,e),ix(`stored provided public key for ${n}`)),this}get(e){if(!ox.isPeerId(e))throw sx(new Error("peerId must be an instance of peer-id"),ax);let r=this.data.get(e.toB58String());return r?r.pubKey:void 0}};ux.exports=cx});var px=S((tM,hx)=>{"use strict";var fx=Ne(),Qd=Object.assign(fx("libp2p:peer-store:proto-book"),{error:fx("libp2p:peer-store:proto-book:err")}),zs=he(),{equals:pO}=(kr(),Lr),ya=ct(),yO=pa(),{codes:{ERR_INVALID_PARAMETERS:Gs}}=Fe(),dx=class extends yO{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,r,n){if(!ya.isPeerId(e))throw Qd.error("peerId must be an instance of peer-id to store data"),zs(new Error("peerId must be an instance of peer-id"),Gs);if(typeof r!="string"||!(n instanceof Uint8Array))throw Qd.error("valid key and value must be provided to store data"),zs(new Error("valid key and value must be provided"),Gs);return this._setValue(e,r,n),this}_setValue(e,r,n,{emit:i=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(r);if(a&&pO(n,a)){Qd(`the metadata provided to store is equal to the already stored for ${s} on ${r}`);return}o.set(r,n),this.data.set(s,o),i&&this._emit(e,r)}get(e){if(!ya.isPeerId(e))throw zs(new Error("peerId must be an instance of peer-id"),Gs);return this.data.get(e.toB58String())}getValue(e,r){if(!ya.isPeerId(e))throw zs(new Error("peerId must be an instance of peer-id"),Gs);let n=this.data.get(e.toB58String());return n&&n.get(r)}delete(e){if(!ya.isPeerId(e))throw zs(new Error("peerId must be an instance of peer-id"),Gs);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,r){if(!ya.isPeerId(e))throw zs(new Error("peerId must be an instance of peer-id"),Gs);let n=this.data.get(e.toB58String());return!n||!n.delete(r)?!1:(this._emit(e,r),!0)}};hx.exports=dx});var vx=S((rM,mx)=>{"use strict";var yx=Ne(),xr=Object.assign(yx("libp2p:peer-store:proto-book"),{error:yx("libp2p:peer-store:proto-book:err")}),Ys=he(),Xd=ct(),gO=pa(),{codes:{ERR_INVALID_PARAMETERS:Ws}}=Fe(),gx=class extends gO{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:r=>Array.from(r)});this.data=new Map}set(e,r){if(!Xd.isPeerId(e))throw xr.error("peerId must be an instance of peer-id to store data"),Ys(new Error("peerId must be an instance of peer-id"),Ws);if(!r)throw xr.error("protocols must be provided to store data"),Ys(new Error("protocols must be provided"),Ws);let n=e.toB58String(),i=this.data.get(n),s=new Set(r);return i&&((a,c)=>a.size===c.size&&[...a].every(u=>c.has(u)))(i,s)?(xr(`the protocols provided to store are equal to the already stored for ${n}`),this):(this._setData(e,s),xr(`stored provided protocols for ${n}`),this)}add(e,r){if(!Xd.isPeerId(e))throw xr.error("peerId must be an instance of peer-id to store data"),Ys(new Error("peerId must be an instance of peer-id"),Ws);if(!r)throw xr.error("protocols must be provided to store data"),Ys(new Error("protocols must be provided"),Ws);let n=e.toB58String(),i=this.data.get(n)||new Set,s=new Set([...i,...r]);return i.size===s.size?(xr(`the protocols provided to store are already stored for ${n}`),this):(this._setData(e,s),xr(`added provided protocols for ${n}`),this)}remove(e,r){if(!Xd.isPeerId(e))throw xr.error("peerId must be an instance of peer-id to store data"),Ys(new Error("peerId must be an instance of peer-id"),Ws);if(!r)throw xr.error("protocols must be provided to store data"),Ys(new Error("protocols must be provided"),Ws);let n=e.toB58String(),i=this.data.get(n);if(i){let s=new Set([...i].filter(o=>!r.includes(o)));if(i.size===s.size)return this;this._setData(e,s),xr(`removed provided protocols for ${n}`)}return this}};mx.exports=gx});var Zd=S((nM,wx)=>{"use strict";var mO=he(),{EventEmitter:vO}=Jt(),bx=ct(),bO=rx(),EO=lx(),wO=px(),SO=vx(),{codes:{ERR_INVALID_PARAMETERS:xO}}=Fe(),Ex=class extends vO{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new bO(this),this.keyBook=new EO(this),this.metadataBook=new wO(this),this.protoBook=new SO(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let r=new Map;return e.forEach(n=>{r.set(n,this.get(bx.createFromB58String(n)))}),r}delete(e){let r=this.addressBook.delete(e),n=this.keyBook.delete(e),i=this.protoBook.delete(e),s=this.metadataBook.delete(e);return r||n||i||s}get(e){if(!bx.isPeerId(e))throw mO(new Error("peerId must be an instance of peer-id"),xO);let r=this.keyBook.data.get(e.toB58String()),n=this.addressBook.get(e),i=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!r&&!n&&!i&&!s))return{id:r||e,addresses:n||[],protocols:s||[],metadata:i}}};wx.exports=Ex});var xx=S((iM,Sx)=>{"use strict";function _O(t,e,r){let n=new t(e,r);n._subscribeAdapter=n.subscribe,n._unsubscribeAdapter=n.unsubscribe;function i(o,a){a&&n.on(o,a),n._subscribeAdapter(o)}function s(o,a){a?n.removeListener(o,a):n.removeAllListeners(o),n.listenerCount(o)===0&&n._unsubscribeAdapter(o)}return n.subscribe=i,n.unsubscribe=s,n}Sx.exports=_O});var _x=S((sM,Qs)=>{"use strict";Qs.exports.NAMESPACE_COMMON="/peers/";Qs.exports.NAMESPACE_ADDRESS="/peers/addrs/";Qs.exports.NAMESPACE_KEYS="/peers/keys/";Qs.exports.NAMESPACE_METADATA="/peers/metadata/";Qs.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var Cx=S((oM,Ax)=>{"use strict";var Qn=Xr(),Xs=Qn.Reader,Jd=Qn.Writer,ot=Qn.util,ht=Qn.roots["libp2p-address-book"]||(Qn.roots["libp2p-address-book"]={});ht.Addresses=function(){function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.addrs=ot.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,n){if(n||(n=Jd.create()),r.addrs!=null&&r.addrs.length)for(var i=0;i<r.addrs.length;++i)ht.Addresses.Address.encode(r.addrs[i],n.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&ht.Addresses.CertifiedRecord.encode(r.certifiedRecord,n.uint32(18).fork()).ldelim(),n},t.decode=function(r,n){r instanceof Xs||(r=Xs.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ht.Addresses;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(ht.Addresses.Address.decode(r,r.uint32()));break;case 2:s.certifiedRecord=ht.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ht.Addresses)return r;var n=new ht.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var i=0;i<r.addrs.length;++i){if(typeof r.addrs[i]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[i]=ht.Addresses.Address.fromObject(r.addrs[i])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=ht.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addrs=[]),n.defaults&&(i.certifiedRecord=null),r.addrs&&r.addrs.length){i.addrs=[];for(var s=0;s<r.addrs.length;++s)i.addrs[s]=ht.Addresses.Address.toObject(r.addrs[s],n)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(i.certifiedRecord=ht.Addresses.CertifiedRecord.toObject(r.certifiedRecord,n)),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Qn.util.toJSONOptions)},t.Address=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=ot.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(n,i){return i||(i=Jd.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},e.decode=function(n,i){n instanceof Xs||(n=Xs.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new ht.Addresses.Address;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;case 2:o.isCertified=n.bool();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof ht.Addresses.Address)return n;var i=new ht.Addresses.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?ot.base64.decode(n.multiaddr,i.multiaddr=ot.newBuffer(ot.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=ot.newBuffer(s.multiaddr))),s.isCertified=!1),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?ot.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(s.isCertified=n.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Qn.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.seq=ot.Long?ot.Long.fromBits(0,0,!0):0,e.prototype.raw=ot.newBuffer([]),e.encode=function(n,i){return i||(i=Jd.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&i.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&i.uint32(18).bytes(n.raw),i},e.decode=function(n,i){n instanceof Xs||(n=Xs.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new ht.Addresses.CertifiedRecord;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.seq=n.uint64();break;case 2:o.raw=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof ht.Addresses.CertifiedRecord)return n;var i=new ht.Addresses.CertifiedRecord;return n.seq!=null&&(ot.Long?(i.seq=ot.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?i.seq=parseInt(n.seq,10):typeof n.seq=="number"?i.seq=n.seq:typeof n.seq=="object"&&(i.seq=new ot.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?ot.base64.decode(n.raw,i.raw=ot.newBuffer(ot.base64.length(n.raw)),0):n.raw.length&&(i.raw=n.raw)),i},e.toObject=function(n,i){i||(i={});var s={};if(i.defaults){if(ot.Long){var o=new ot.Long(0,0,!0);s.seq=i.longs===String?o.toString():i.longs===Number?o.toNumber():o}else s.seq=i.longs===String?"0":0;i.bytes===String?s.raw="":(s.raw=[],i.bytes!==Array&&(s.raw=ot.newBuffer(s.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?s.seq=i.longs===String?String(n.seq):n.seq:s.seq=i.longs===String?ot.Long.prototype.toString.call(n.seq):i.longs===Number?new ot.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(s.raw=i.bytes===String?ot.base64.encode(n.raw,0,n.raw.length):i.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Qn.util.toJSONOptions)},e}(),t}();Ax.exports=ht});var Rx=S((aM,Tx)=>{"use strict";var Zs=Xr(),Ix=Zs.Reader,AO=Zs.Writer,CO=Zs.util,ga=Zs.roots["libp2p-proto-book"]||(Zs.roots["libp2p-proto-book"]={});ga.Protocols=function(){function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocols=CO.emptyArray,t.encode=function(r,n){if(n||(n=AO.create()),r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(10).string(r.protocols[i]);return n},t.decode=function(r,n){r instanceof Ix||(r=Ix.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ga.Protocols;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ga.Protocols)return r;var n=new ga.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.protocols=[]),r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Zs.util.toJSONOptions)},t}();Tx.exports=ga});var Lx=S((cM,Ox)=>{"use strict";var Bx=Ne(),wt=Object.assign(Bx("libp2p:persistent-peer-store"),{error:Bx("libp2p:persistent-peer-store:err")}),{Key:vu}=(Od(),Dd),{Multiaddr:IO}=Rt(),e0=ct(),{base32:TO}=(Jn(),Zn),RO=Zd(),{NAMESPACE_ADDRESS:BO,NAMESPACE_COMMON:PO,NAMESPACE_KEYS:NO,NAMESPACE_METADATA:DO,NAMESPACE_PROTOCOL:OO}=_x(),{Addresses:Px}=Cx(),{Protocols:Nx}=Rx(),Dx=class extends RO{constructor({peerId:e,datastore:r,threshold:n=5}){super({peerId:e});this._datastore=r,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=n,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){wt("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:PO}))await this._processDatastoreEntry(e);wt("PeerStore started")}async stop(){wt("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),wt("PeerStore stopped")}_addDirtyPeer({peerId:e}){let r=e.toB58String();wt("add dirty peer",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(n=>{wt.error("error committing data",n)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let r=e.toB58String();wt("add dirty peer key",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(n=>{wt.error("error committing data",n)})}_addDirtyPeerMetadata({peerId:e,metadata:r}){let n=e.toB58String();wt("add dirty metadata peer",n),this._dirtyPeers.add(n);let i=this._dirtyMetadata.get(n)||new Set;i.add(r),this._dirtyMetadata.set(n,i),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{wt.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),wt("create batch commit");let r=this._datastore.batch();for(let n of e){let i=this.keyBook.data.get(n)||e0.createFromB58String(n);this._batchAddressBook(i,r),!i.hasInlinePublicKey()&&this._batchKeyBook(i,r),this._batchMetadataBook(i,r),this._batchProtoBook(i,r)}await r.commit(),wt("batch committed")}_batchAddressBook(e,r){let n=e.toString(),i=new vu(`${BO}${n}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){r.delete(i);return}let o=Px.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();r.put(i,o)}catch(o){wt.error(o)}}_batchKeyBook(e,r){let n=e.toString(),i=new vu(`${NO}${n}`);try{if(!e.pubKey){r.delete(i);return}let s=e.marshalPubKey();r.put(i,s)}catch(s){wt.error(s)}}_batchMetadataBook(e,r){let n=e.toString(),i=this._dirtyMetadata.get(e.toB58String())||[];try{i.forEach(s=>{let o=new vu(`${DO}${n}/${s}`),a=this.metadataBook.getValue(e,s);a?r.put(o,a):r.delete(o)})}catch(s){wt.error(s)}}_batchProtoBook(e,r){let n=e.toString(),i=new vu(`${OO}${n}`),s=this.protoBook.get(e);try{if(!s){r.delete(i);return}let o=Nx.encode({protocols:s}).finish();r.put(i,o)}catch(o){wt.error(o)}}async _processDatastoreEntry({key:e,value:r}){try{let n=e.toString().split("/"),i=e0.createFromBytes(TO.decode(n[3])),s;switch(n[2]){case"addrs":s=Px.decode(r),this.addressBook._setData(i,{addresses:s.addrs.map(o=>({multiaddr:new IO(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await e0.createFromPubKey(r),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(i,n[4],r,{emit:!1});break;case"protos":s=Nx.decode(r),this.protoBook._setData(i,new Set(s.protocols),{emit:!1});break;default:wt("invalid data persisted for: ",e.toString())}}catch(n){wt.error(n)}}};Ox.exports=Dx});var Fx=S((uM,Mx)=>{"use strict";var kx=()=>{},qx=Symbol.for("@libp2p/js-interfaces/topology"),Ux=class{constructor({min:e=0,max:r=1/0,handlers:n={}}){this.min=e,this.max=r,this._onConnect=n.onConnect||kx,this._onDisconnect=n.onDisconnect||kx,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[qx](){return!0}static isTopology(e){return Boolean(e&&e[qx])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};Mx.exports=Ux});var $x=S((lM,jx)=>{"use strict";var Kx=Ne(),LO=Object.assign(Kx("libp2p:registrar"),{error:Kx("libp2p:registrar:err")}),kO=he(),{codes:{ERR_INVALID_PARAMETERS:qO}}=Fe(),UO=Fx(),Vx=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!UO.isTopology(e))throw LO.error("topology must be an instance of interfaces/topology"),kO(new Error("topology must be an instance of interfaces/topology"),qO);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),e.registrar=this,r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};jx.exports=Vx});var t0=S((fM,ma)=>{"use strict";var{Buffer:bu}=$n(),Eu=Ai();ma.exports=async function*(t){for await(let e of t)bu.isBuffer(e)?yield e:Eu.isBufferList(e)?yield e.slice():yield bu.from(e)};ma.exports.toBuffer=ma.exports;ma.exports.toList=async function*(t){for await(let e of t)bu.isBuffer(e)?yield new Eu().append(e):Eu.isBufferList(e)?yield e:yield new Eu().append(bu.from(e))}});var zx=S((dM,Hx)=>{"use strict";Hx.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var Qx=S((wu,Wx)=>{"use strict";var Gx=Ne(),MO=Object.assign(Gx("libp2p:ping"),{error:Gx("libp2p:ping:err")}),FO=he(),{codes:KO}=Fe(),VO=Nd(),{pipe:Yx}=jr(),{toBuffer:jO}=t0(),{collect:$O,take:HO}=fu(),{equals:zO}=(kr(),Lr),{PROTOCOL_NAME:r0,PING_LENGTH:GO,PROTOCOL_VERSION:n0}=zx();async function YO(t,e){let r=`/${t._config.protocolPrefix}/${r0}/${n0}`;MO("dialing %s to %s",r,e.toB58String?e.toB58String():e);let n=await t.dial(e),{stream:i}=await n.newStream(r),s=Date.now(),o=VO.randomBytes(GO),[a]=await Yx([o],i,u=>HO(1,u),jO,$O),c=Date.now();if(!zO(o,a))throw FO(new Error("Received wrong ping ack"),KO.ERR_WRONG_PING_ACK);return c-s}function WO(t){t.handle(`/${t._config.protocolPrefix}/${r0}/${n0}`,({stream:e})=>Yx(e,e))}function QO(t){t.unhandle(`/${t._config.protocolPrefix}/${r0}/${n0}`)}wu=Wx.exports=YO;wu.mount=WO;wu.unmount=QO});var Jx=S((hM,Zx)=>{"use strict";var Js=Xr(),Xx=Js.Reader,XO=Js.Writer,Ze=Js.util,va=Js.roots["libp2p-identify"]||(Js.roots["libp2p-identify"]={});va.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=Ze.newBuffer([]),t.prototype.listenAddrs=Ze.emptyArray,t.prototype.observedAddr=Ze.newBuffer([]),t.prototype.protocols=Ze.emptyArray,t.prototype.signedPeerRecord=Ze.newBuffer([]),t.encode=function(r,n){if(n||(n=XO.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var i=0;i<r.listenAddrs.length;++i)n.uint32(18).bytes(r.listenAddrs[i]);if(r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(26).string(r.protocols[i]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&n.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&n.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&n.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&n.uint32(66).bytes(r.signedPeerRecord),n},t.decode=function(r,n){r instanceof Xx||(r=Xx.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new va.Identify;r.pos<i;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof va.Identify)return r;var n=new va.Identify;if(r.protocolVersion!=null&&(n.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(n.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?Ze.base64.decode(r.publicKey,n.publicKey=Ze.newBuffer(Ze.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");n.listenAddrs=[];for(var i=0;i<r.listenAddrs.length;++i)typeof r.listenAddrs[i]=="string"?Ze.base64.decode(r.listenAddrs[i],n.listenAddrs[i]=Ze.newBuffer(Ze.base64.length(r.listenAddrs[i])),0):r.listenAddrs[i].length&&(n.listenAddrs[i]=r.listenAddrs[i])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?Ze.base64.decode(r.observedAddr,n.observedAddr=Ze.newBuffer(Ze.base64.length(r.observedAddr)),0):r.observedAddr.length&&(n.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?Ze.base64.decode(r.signedPeerRecord,n.signedPeerRecord=Ze.newBuffer(Ze.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(n.signedPeerRecord=r.signedPeerRecord)),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.listenAddrs=[],i.protocols=[]),n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=Ze.newBuffer(i.publicKey))),n.bytes===String?i.observedAddr="":(i.observedAddr=[],n.bytes!==Array&&(i.observedAddr=Ze.newBuffer(i.observedAddr))),i.protocolVersion="",i.agentVersion="",n.bytes===String?i.signedPeerRecord="":(i.signedPeerRecord=[],n.bytes!==Array&&(i.signedPeerRecord=Ze.newBuffer(i.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?Ze.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){i.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)i.listenAddrs[s]=n.bytes===String?Ze.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):n.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(i.observedAddr=n.bytes===String?Ze.base64.encode(r.observedAddr,0,r.observedAddr.length):n.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(i.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(i.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(i.signedPeerRecord=n.bytes===String?Ze.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):n.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Js.util.toJSONOptions)},t}();Zx.exports=va});var c_=S((pM,a_)=>{"use strict";var e_=Ne(),Yr=Object.assign(e_("libp2p:identify"),{error:e_("libp2p:identify:err")}),i0=he(),Su=oa(),{pipe:xu}=jr(),{collect:t_,take:r_,consume:n_}=fu(),{fromString:eo}=(St(),At),ZO=ct(),{Multiaddr:s0}=Rt(),{toBuffer:i_}=t0(),ba=Jx(),s_=$c(),o_=zc(),{MULTICODEC_IDENTIFY:JO,MULTICODEC_IDENTIFY_PUSH:e6,IDENTIFY_PROTOCOL_VERSION:t6,MULTICODEC_IDENTIFY_PROTOCOL_NAME:r6,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:n6,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:i6,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:s6}=Tf(),{codes:o0}=Fe(),Li=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${r6}/${i6}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${n6}/${s6}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=Li.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${t6}`,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",eo(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",eo(this._host.protocolVersion)),this.connectionManager.on("peer:connect",n=>{this.identify(n).catch(Yr.error)}),this.peerStore.on("change:multiaddrs",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),n=this._libp2p.multiaddrs.map(o=>o.bytes),i=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await xu([ba.Identify.encode({listenAddrs:n,signedPeerRecord:r,protocols:i}).finish()],Su.encode(),a,n_)}catch(a){Yr.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for(let n of this.peerStore.peers.values())n.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(n.id))&&e.push(r);this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[n]=await xu([],r,Su.decode(),r_(1),i_,t_);if(!n)throw i0(new Error("No data could be retrieved"),o0.ERR_CONNECTION_ENDED);let i;try{i=ba.Identify.decode(n)}catch(d){throw i0(d,o0.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=i,l=await ZO.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw i0(new Error("identified peer does not match the expected peer"),o0.ERR_INVALID_PEER);let f=Li.getCleanMultiaddr(c);try{let d=await s_.openAndCertify(u,o_.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(d)){this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",eo(i.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",eo(i.protocolVersion));return}}catch(d){Yr("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{this.peerStore.addressBook.set(l,o.map(d=>new s0(d)))}catch(d){Yr.error("received invalid addrs",d)}this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",eo(i.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",eo(i.protocolVersion)),Yr("received observed address of %s",f)}handleMessage({connection:e,stream:r,protocol:n}){switch(n){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:Yr.error("cannot handle unknown protocol %s",n)}}async _handleIdentify({connection:e,stream:r}){let n=new Uint8Array(0);this.peerId.pubKey&&(n=this.peerId.pubKey.bytes);let i=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=ba.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:n,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:i,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await xu([o],Su.encode(),r,n_)}catch(a){Yr.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:r}){let n;try{let[s]=await xu([],r,Su.decode(),r_(1),i_,t_);n=ba.Identify.decode(s)}catch(s){return Yr.error("received invalid message",s)}let i=e.remotePeer;try{let s=await s_.openAndCertify(n.signedPeerRecord,o_.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(i,n.protocols);return}}catch(s){Yr("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(i,n.listenAddrs.map(s=>new s0(s)))}catch(s){Yr.error("received invalid addrs",s)}this.peerStore.protoBook.set(i,n.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new s0(e)}catch(r){return null}return null}},o6={IDENTIFY:JO,IDENTIFY_PUSH:e6};Li.multicodecs=o6;Li.Messsage=ba;a_.exports=Li});var u_=S(()=>{});var l_=S(a0=>{"use strict";Object.defineProperty(a0,"__esModule",{value:!0}),a0.promisify=_u;var a6="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function _u(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[a6],r=_u.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var n=this,i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(u){if(u)return c(u);for(var l=arguments.length,f=Array(1<l?l-1:0),d=1;d<l;d++)f[d-1]=arguments[d];if(f.length===1||!e)return a(f[0]);var p={};f.forEach(function(h,g){var v=e[g];v&&(p[v]=h)}),a(p)}),t.apply(n,s)})}}_u.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",_u.Promise=void 0});var d_=S((vM,f_)=>{function c6(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}f_.exports=c6});var p_=S((bM,h_)=>{"use strict";var u6=d_(),Au=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Ea=u6(),l6=Au&&!Ea,f6=Ea&&!Au,d6=Ea&&Au,h6=typeof qi=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!Ea,p6=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,y6=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;h_.exports={isTest:y6,isElectron:Ea,isElectronMain:f6,isElectronRenderer:d6,isNode:h6,isBrowser:l6,isWebWorker:p6,isEnvWithDom:Au}});var g_=S((EM,y_)=>{function pr(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}y_.exports=pr;pr.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};pr.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};pr.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};pr.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};pr.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};pr.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};pr.prototype.start=pr.prototype.try;pr.prototype.errors=function(){return this._errors};pr.prototype.attempts=function(){return this._attempts};pr.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],s=i.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=i,r=o)}return e}});var m_=S(ki=>{var g6=g_();ki.operation=function(t){var e=ki.timeouts(t);return new g6(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};ki.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<e.retries;i++)n.push(this.createTimeout(i,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(i,e)),n.sort(function(s,o){return s-o}),n};ki.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return n=Math.min(n,e.maxTimeout),n};ki.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var n in t)typeof t[n]=="function"&&r.push(n)}for(var i=0;i<r.length;i++){var s=r[i],o=t[s];t[s]=function(c){var u=ki.operation(e),l=Array.prototype.slice.call(arguments,1),f=l.pop();l.push(function(d){u.retry(d)||(d&&(arguments[0]=u.mainError()),f.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,o),t[s].options=e}}});var b_=S((SM,v_)=>{v_.exports=m_()});var w_=S((xM,Cu)=>{"use strict";var m6=b_(),v6=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],c0=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},b6=(t,e,r)=>{let n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},E6=t=>v6.includes(t),E_=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};let i=m6.operation(e);i.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){n(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof c0)i.stop(),n(o.originalError);else if(o instanceof TypeError&&!E6(o.message))i.stop(),n(o);else{b6(o,s,e);try{await e.onFailedAttempt(o)}catch(a){n(a);return}i.retry(o)||n(i.mainError())}}})});Cu.exports=E_;Cu.exports.default=E_;Cu.exports.AbortError=c0});var x_=S((_M,S_)=>{"use strict";function w6(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}S_.exports=w6});var A_=S((AM,__)=>{"use strict";var S6=x_();function x6(t){let{address:e}=t.nodeAddress();return S6(e)}__.exports=x6});var P_=S((CM,B_)=>{"use strict";var _6=u_(),C_=Ne(),{promisify:u0}=l_(),{Multiaddr:A6}=Rt(),to=Object.assign(C_("libp2p:nat"),{error:C_("libp2p:nat:err")}),{isBrowser:I_}=p_(),l0=w_(),C6=Rf(),T_=If(),I6=he(),{codes:{ERR_INVALID_PARAMETERS:T6}}=Fe(),R6=A_(),f0=7200;function B6(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var R_=class{constructor({peerId:e,addressManager:r,transportManager:n,...i}){if(this._peerId=e,this._addressManager=r,this._transportManager=n,this._enabled=i.enabled,this._externalIp=i.externalIp,this._options={description:i.description||`${T_.name}@${T_.version} ${this._peerId}`,ttl:i.ttl||f0,autoUpdate:i.keepAlive||!0,gateway:i.gateway,enablePMP:Boolean(i.pmp&&i.pmp.enabled)},this._options.ttl<f0)throw I6(new Error(`NatManager ttl should be at least ${f0} seconds`),T6)}start(){I_||!this._enabled||this._start().catch(e=>{to.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:n,host:i,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||R6(r)||n!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(C6(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=B6();to(`opening uPnP connection from ${c}:${u} to ${i}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(A6.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new _6(this._options),r=u0(e.map.bind(e)),n=u0(e.destroy.bind(e)),i=u0(e.externalIp.bind(e));return this._client={map:(...s)=>l0(()=>r(...s),{onFailedAttempt:to.error,unref:!0}),destroy:(...s)=>l0(()=>n(...s),{onFailedAttempt:to.error,unref:!0}),externalIp:(...s)=>l0(()=>i(...s),{onFailedAttempt:to.error,unref:!0})},this._client}async stop(){if(!(I_||!this._client))try{await this._client.destroy(),this._client=null}catch(e){to.error(e)}}};B_.exports=R_});var Z6=S((IM,k_)=>{"use strict";var N_=Ne(),Qt=Object.assign(N_("libp2p"),{error:N_("libp2p:err")}),{EventEmitter:P6}=Jt(),d0=he(),N6=ct(),{Multiaddr:D6}=Rt(),O6=D1(),L6=M1(),h0=_f(),{validate:k6}=rb(),{codes:Iu,messages:q6}=Fe(),U6=sb(),M6=vb(),F6=xb(),D_=uw(),K6=Sw(),V6=Zw(),O_=eS(),j6=mS(),$6=Uf(),H6=WS(),z6=Zd(),G6=xx(),Y6=Lx(),W6=$x(),Tu=Qx(),L_=c_(),Q6=P_(),{updateSelfPeerRecord:X6}=kf(),wa=class extends P6{static async create(e){if(e.peerId)return new wa(e);let r=await N6.create();return e.peerId=r,new wa(e)}constructor(e){super();if(this._options=k6(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new Y6({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new z6({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new U6(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{X6(this).catch(n=>{Qt.error("Error updating self peer record",n)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new M6(this,{...this._options.connectionManager}),this._autodialler=new F6(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.metrics.enabled){let n=new j6({...this._options.metrics});this.metrics=n}if(this._options.keychain&&this._options.keychain.datastore){Qt("creating keychain");let n=O_.generateOptions();this.keychain=new O_(this._options.keychain.datastore,{...n,...this._options.keychain}),Qt("keychain constructed")}if(this.upgrader=new H6({localPeer:this.peerId,metrics:this.metrics,onConnection:n=>this.connectionManager.onConnect(n),onConnectionEnd:n=>this.connectionManager.onDisconnect(n)}),this.transportManager=new $6({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new Q6({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new W6({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw d0(new Error(q6.CONN_ENCRYPTION_REQUIRED),Iu.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(n=>{this.upgrader.cryptos.set(n.protocol,n)}),this.dialer=new V6({transportManager:this.transportManager,peerStore:this.peerStore,metrics:this.metrics,...this._options.dialer}),this._modules.transport.forEach(n=>{let i=n.prototype[Symbol.toStringTag],s=this._config.transport[i];this.transportManager.add(i,n,s)}),this._config.relay.enabled&&(this.transportManager.add(D_.prototype[Symbol.toStringTag],D_),this.relay=new K6(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(i=>{this.upgrader.muxers.set(i.multicodec,i)}),this.identifyService=new L_({libp2p:this}),this.handle(Object.values(L_.getProtocolStr(this)),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let n=this._modules.dht;this._dht=n.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let n=this._modules.pubsub;this.pubsub=G6(n,this,this._config.pubsub)}this.peerRouting=new O6(this),this.contentRouting=new L6(this),Tu.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...r){return e==="error"&&!this._events.error?(Qt.error(r),!1):super.emit(e,...r)}async start(){Qt("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),Qt("libp2p has started")}catch(e){throw this.emit("error",e),Qt.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Qt("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop(),this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),Tu.unmount(this),this.dialer.destroy()}catch(e){e&&(Qt.error(e),this.emit("error",e))}Qt("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,n){if(!r||!r.length)throw d0(new Error("no protocols were provided to open a stream"),Iu.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,n)).newStream(r)}async _dial(e,r){let{id:n,multiaddrs:i}=h0(e);if(n.equals(this.peerId))throw d0(new Error("Cannot dial self"),Iu.ERR_DIALED_SELF);let s=this.connectionManager.get(n);return s?i&&this.peerStore.addressBook.add(n,i):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(i=>i.toString());e.length||(e=this.transportManager.getAddrs().map(i=>i.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(i=>i.toString()));let r=this._options.addresses.announceFilter,n=new Set(e);return r(Array.from(n).map(i=>new D6(i)))}async hangUp(e){let{id:r}=h0(e),n=this.connectionManager.connections.get(r.toB58String());!n||await Promise.all(n.map(i=>i.close()))}ping(e){let{id:r,multiaddrs:n}=h0(e);return n?Tu(this,n[0]):Tu(this,r)}handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(n=>{this.upgrader.protocols.set(n,r)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Qt.error(new Error(Iu.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Qt("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(n){Qt.error(`could not connect to discovered peer ${e.toB58String()} with ${n}`)}}}async _setupPeerDiscovery(){let e=r=>{let n={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(n={...n,...this._config.peerDiscovery[r.tag]}),n.enabled&&!this._discovery.has(r.tag)){let i;typeof r=="function"?i=new r(Object.assign({},n,{peerId:this.peerId,libp2p:this})):i=r,i.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,i)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};k_.exports=wa});return Z6();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) Paul Miller (paulmillr.com) */
return Libp2p}));
