(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2p = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2p=(()=>{var id=Object.defineProperty;var AA=t=>id(t,"__esModule",{value:!0});var Di=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Pe=(t,e)=>()=>(t&&(e=t(t=0)),e);var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ht=(t,e)=>{AA(t);for(var r in e)id(t,r,{get:e[r],enumerable:!0})};var _u=x((M6,sd)=>{var ki=1e3,Li=ki*60,qi=Li*60,Qn=qi*24,_A=Qn*7,CA=Qn*365.25;sd.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return IA(t);if(r==="number"&&isFinite(t))return e.long?RA(t):TA(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function IA(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*CA;case"weeks":case"week":case"w":return r*_A;case"days":case"day":case"d":return r*Qn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*qi;case"minutes":case"minute":case"mins":case"min":case"m":return r*Li;case"seconds":case"second":case"secs":case"sec":case"s":return r*ki;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function TA(t){var e=Math.abs(t);return e>=Qn?Math.round(t/Qn)+"d":e>=qi?Math.round(t/qi)+"h":e>=Li?Math.round(t/Li)+"m":e>=ki?Math.round(t/ki)+"s":t+"ms"}function RA(t){var e=Math.abs(t);return e>=Qn?ma(t,e,Qn,"day"):e>=qi?ma(t,e,qi,"hour"):e>=Li?ma(t,e,Li,"minute"):e>=ki?ma(t,e,ki,"second"):t+" ms"}function ma(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var ad=x((F6,od)=>{function BA(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=_u(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let f=0;for(let d=0;d<l.length;d++)f=(f<<5)-f+l.charCodeAt(d),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(l){let f,d=null,p,h;function g(...v){if(!g.enabled)return;let A=g,B=Number(new Date),k=B-(f||B);A.diff=k,A.prev=f,A.curr=B,f=B,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let z=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(L,te)=>{if(L==="%%")return"%";z++;let se=r.formatters[te];if(typeof se=="function"){let j=v[z];L=se.call(A,j),v.splice(z,1),z--}return L}),r.formatArgs.call(A,v),(A.log||r.log).apply(A,v)}return g.namespace=l,g.useColors=r.useColors(),g.color=r.selectColor(l),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==r.namespaces&&(p=r.namespaces,h=r.enabled(l)),h),set:v=>{d=v}}),typeof r.init=="function"&&r.init(g),g}function n(l,f){let d=r(this.namespace+(typeof f=="undefined"?":":f)+l);return d.log=this.log,d}function i(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,d=(typeof l=="string"?l:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)!d[f]||(l=d[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.substr(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let f,d;for(f=0,d=r.skips.length;f<d;f++)if(r.skips[f].test(l))return!1;for(f=0,d=r.names.length;f<d;f++)if(r.names[f].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}od.exports=BA});var Ne=x((Ht,va)=>{Ht.formatArgs=NA;Ht.save=OA;Ht.load=DA;Ht.useColors=PA;Ht.storage=kA();Ht.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ht.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function PA(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function NA(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+va.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}Ht.log=console.debug||console.log||(()=>{});function OA(t){try{t?Ht.storage.setItem("debug",t):Ht.storage.removeItem("debug")}catch(e){}}function DA(){let t;try{t=Ht.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function kA(){try{return localStorage}catch(t){}}va.exports=ad()(Ht);var{formatters:LA}=va.exports;LA.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Wr=x((K6,Cu)=>{"use strict";var Ui=typeof Reflect=="object"?Reflect:null,cd=Ui&&typeof Ui.apply=="function"?Ui.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},ba;Ui&&typeof Ui.ownKeys=="function"?ba=Ui.ownKeys:Object.getOwnPropertySymbols?ba=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:ba=function(e){return Object.getOwnPropertyNames(e)};function qA(t){console&&console.warn&&console.warn(t)}var ud=Number.isNaN||function(e){return e!==e};function Ue(){Ue.init.call(this)}Cu.exports=Ue;Cu.exports.once=KA;Ue.EventEmitter=Ue;Ue.prototype._events=void 0;Ue.prototype._eventsCount=0;Ue.prototype._maxListeners=void 0;var ld=10;function wa(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ue,"defaultMaxListeners",{enumerable:!0,get:function(){return ld},set:function(t){if(typeof t!="number"||t<0||ud(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ld=t}});Ue.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ue.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ud(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function fd(t){return t._maxListeners===void 0?Ue.defaultMaxListeners:t._maxListeners}Ue.prototype.getMaxListeners=function(){return fd(this)};Ue.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")cd(c,this,r);else for(var u=c.length,l=gd(c,u),n=0;n<u;++n)cd(l[n],this,r);return!0};function dd(t,e,r,n){var i,s,o;if(wa(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=fd(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,qA(a)}return t}Ue.prototype.addListener=function(e,r){return dd(this,e,r,!1)};Ue.prototype.on=Ue.prototype.addListener;Ue.prototype.prependListener=function(e,r){return dd(this,e,r,!0)};function UA(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function hd(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=UA.bind(n);return i.listener=r,n.wrapFn=i,i}Ue.prototype.once=function(e,r){return wa(r),this.on(e,hd(this,e,r)),this};Ue.prototype.prependOnceListener=function(e,r){return wa(r),this.prependListener(e,hd(this,e,r)),this};Ue.prototype.removeListener=function(e,r){var n,i,s,o,a;if(wa(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():MA(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Ue.prototype.off=Ue.prototype.removeListener;Ue.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function pd(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?FA(i):gd(i,i.length)}Ue.prototype.listeners=function(e){return pd(this,e,!0)};Ue.prototype.rawListeners=function(e){return pd(this,e,!1)};Ue.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):yd.call(t,e)};Ue.prototype.listenerCount=yd;function yd(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ue.prototype.eventNames=function(){return this._eventsCount>0?ba(this._events):[]};function gd(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function MA(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function FA(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function KA(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}md(t,e,s,{once:!0}),e!=="error"&&VA(t,i,{once:!0})})}function VA(t,e,r){typeof t.on=="function"&&md(t,"error",e,r)}function md(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var he=x((V6,bd)=>{"use strict";function vd(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function jA(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return vd(t,r)}catch(n){r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),vd(new i,r)}}bd.exports=jA});function Ed(t,e,r){e=e||[],r=r||0;for(var n=r;t>=GA;)e[r++]=t&255|wd,t/=128;for(;t&zA;)e[r++]=t&255|wd,t>>>=7;return e[r]=t|0,Ed.bytes=r-n+1,e}function Iu(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o)throw Iu.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&xd)<<n:(s&xd)*Math.pow(2,n),n+=7}while(s>=YA);return Iu.bytes=i-e,r}var $A,wd,HA,zA,GA,WA,YA,xd,QA,XA,ZA,JA,e_,t_,r_,n_,i_,s_,o_,a_,ro,Sd=Pe(()=>{$A=Ed,wd=128,HA=127,zA=~HA,GA=Math.pow(2,31);WA=Iu,YA=128,xd=127;QA=Math.pow(2,7),XA=Math.pow(2,14),ZA=Math.pow(2,21),JA=Math.pow(2,28),e_=Math.pow(2,35),t_=Math.pow(2,42),r_=Math.pow(2,49),n_=Math.pow(2,56),i_=Math.pow(2,63),s_=function(t){return t<QA?1:t<XA?2:t<ZA?3:t<JA?4:t<e_?5:t<t_?6:t<r_?7:t<n_?8:t<i_?9:10},o_={encode:$A,decode:WA,encodingLength:s_},a_=o_,ro=a_});var no,Mi,Fi,Ea=Pe(()=>{Sd();no=t=>[ro.decode(t),ro.decode.bytes],Mi=(t,e,r=0)=>(ro.encode(t,e,r),e),Fi=t=>ro.encodingLength(t)});var H6,_d,Yr,Cd,Id,pn=Pe(()=>{H6=new Uint8Array(0),_d=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Yr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Cd=t=>new TextEncoder().encode(t),Id=t=>new TextDecoder().decode(t)});var so={};ht(so,{Digest:()=>Ki,create:()=>io,decode:()=>Tu,equals:()=>Ru});var io,Tu,Ru,Ki,Vi=Pe(()=>{pn();Ea();io=(t,e)=>{let r=e.byteLength,n=Fi(t),i=n+Fi(r),s=new Uint8Array(i+r);return Mi(t,s,0),Mi(r,s,n),s.set(e,i),new Ki(t,r,e,s)},Tu=t=>{let e=Yr(t),[r,n]=no(e),[i,s]=no(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new Ki(r,i,o,e)},Ru=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&_d(t.bytes,e.bytes),Ki=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});function c_(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,v=0,A=0,B=h.length;A!==B&&h[A]===0;)A++,g++;for(var k=(B-A)*l+1>>>0,z=new Uint8Array(k);A!==B;){for(var q=h[A],L=0,te=k-1;(q!==0||L<v)&&te!==-1;te--,L++)q+=256*z[te]>>>0,z[te]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");v=L,A++}for(var se=k-v;se!==k&&z[se]===0;)se++;for(var j=c.repeat(g);se<k;++se)j+=t.charAt(z[se]);return j}function d(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var v=0,A=0;h[g]===c;)v++,g++;for(var B=(h.length-g)*u+1>>>0,k=new Uint8Array(B);h[g];){var z=r[h.charCodeAt(g)];if(z===255)return;for(var q=0,L=B-1;(z!==0||q<A)&&L!==-1;L--,q++)z+=a*k[L]>>>0,k[L]=z%256>>>0,z=z/256>>>0;if(z!==0)throw new Error("Non-zero carry");A=q,g++}if(h[g]!==" "){for(var te=B-A;te!==B&&k[te]===0;)te++;for(var se=new Uint8Array(v+(B-te)),j=v;te!==B;)se[j++]=k[te++];return se}}}function p(h){var g=d(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:d,decode:p}}var u_,l_,Rd,Bd=Pe(()=>{u_=c_,l_=u_,Rd=l_});var Pd,Nd,Od,Dd,kd,xa,yn,f_,d_,tt,Sr=Pe(()=>{Bd();pn();Pd=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Nd=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return Dd(this,e)}},Od=class{constructor(e){this.decoders=e}or(e){return Dd(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Dd=(t,e)=>new Od({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),kd=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Pd(e,r,n),this.decoder=new Nd(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},xa=({name:t,prefix:e,encode:r,decode:n})=>new kd(t,e,r,n),yn=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Rd(r,e);return xa({prefix:t,name:e,encode:n,decode:s=>Yr(i(s))})},f_=(t,e,r,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},d_=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>xa({prefix:e,name:t,encode(i){return d_(i,n,r)},decode(i){return f_(i,n,r,t)}})});var gn={};ht(gn,{base58btc:()=>Ar,base58flickr:()=>h_});var Ar,h_,mn=Pe(()=>{Sr();Ar=yn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),h_=yn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Xn={};ht(Xn,{base32:()=>ji,base32hex:()=>m_,base32hexpad:()=>b_,base32hexpadupper:()=>w_,base32hexupper:()=>v_,base32pad:()=>y_,base32padupper:()=>g_,base32upper:()=>p_,base32z:()=>E_});var ji,p_,y_,g_,m_,v_,b_,w_,E_,Zn=Pe(()=>{Sr();ji=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),p_=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),y_=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),g_=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),m_=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),v_=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),b_=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),w_=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),E_=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var ao={};ht(ao,{CID:()=>ut});var ut,x_,S_,A_,oo,__,Ld,qd,Sa,Aa,C_,I_,T_,$i=Pe(()=>{Ea();Vi();mn();Zn();pn();ut=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Aa,byteLength:Aa,code:Sa,version:Sa,multihash:Sa,bytes:Sa,_baseCache:Aa,asCID:Aa})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==oo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==__)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ut.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=io(e,r);return ut.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Ru(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return S_(r,i,e||Ar.encoder);default:return A_(r,i,e||ji.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return I_(/^0\.0/,T_),!!(e&&(e[qd]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof ut)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new ut(r,n,i,s||Ld(r,n,i.bytes))}else if(e!=null&&e[qd]===!0){let{version:r,multihash:n,code:i}=e,s=Tu(n);return ut.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==oo)throw new Error(`Version 0 CID must use dag-pb (code: ${oo}) block encoding`);return new ut(e,r,n,n.bytes)}case 1:{let i=Ld(e,r,n.bytes);return new ut(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return ut.create(0,oo,e)}static createV1(e,r){return ut.create(1,e,r)}static decode(e){let[r,n]=ut.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=ut.inspectBytes(e),n=r.size-r.multihashSize,i=Yr(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new Ki(r.multihashCode,r.digestSize,s,i);return[r.version===0?ut.createV0(o):ut.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[f,d]=no(e.subarray(r));return r+=d,f},i=n(),s=oo;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),u=r+c,l=u-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,i]=x_(e,r),s=ut.decode(i);return s._baseCache.set(n,e),s}},x_=(t,e)=>{switch(t[0]){case"Q":{let r=e||Ar;return[Ar.prefix,r.decode(`${Ar.prefix}${t}`)]}case Ar.prefix:{let r=e||Ar;return[Ar.prefix,r.decode(t)]}case ji.prefix:{let r=e||ji;return[ji.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},S_=(t,e,r)=>{let{prefix:n}=r;if(n!==Ar.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},A_=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},oo=112,__=18,Ld=(t,e,r)=>{let n=Fi(t),i=n+Fi(e),s=new Uint8Array(i+r.byteLength);return Mi(t,s,0),Mi(e,s,n),s.set(r,i),s},qd=Symbol.for("@ipld/js-cid/CID"),Sa={writable:!1,configurable:!1,enumerable:!0},Aa={writable:!1,enumerable:!1,configurable:!1},C_="0.0.0-dev",I_=(t,e)=>{if(t.test(C_))console.warn(e);else throw new Error(e)},T_=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var _a={};ht(_a,{base36:()=>R_,base36upper:()=>B_});var R_,B_,Bu=Pe(()=>{Sr();R_=yn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),B_=yn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var Hi={};ht(Hi,{base64:()=>P_,base64pad:()=>N_,base64url:()=>O_,base64urlpad:()=>D_});var P_,N_,O_,D_,co=Pe(()=>{Sr();P_=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),N_=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),O_=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),D_=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Ca={};ht(Ca,{base16:()=>k_,base16upper:()=>L_});var k_,L_,Pu=Pe(()=>{Sr();k_=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),L_=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var Md=x((c5,Ud)=>{"use strict";Ud.exports=q_;function q_(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(l){if(s)if(s=!1,l)c(l);else{for(var f=new Array(arguments.length-1),d=0;d<f.length;)f[d++]=arguments[d];a.apply(null,f)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var jd=x(Vd=>{"use strict";var Ia=Vd;Ia.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var zi=new Array(64),Fd=new Array(123);for(hr=0;hr<64;)Fd[zi[hr]=hr<26?hr+65:hr<52?hr+71:hr<62?hr-4:hr-59|43]=hr++;var hr;Ia.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var u=e[r++];switch(a){case 0:s[o++]=zi[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=zi[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=zi[c|u>>6],s[o++]=zi[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=zi[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Kd="invalid encoding";Ia.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=Fd[c])===void 0)throw Error(Kd);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Kd);return n-i};Ia.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Hd=x((l5,$d)=>{"use strict";$d.exports=Ta;function Ta(){this._listeners={}}Ta.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Ta.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Ta.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Zd=x((f5,Xd)=>{"use strict";Xd.exports=zd(zd);function zd(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,Gd),t.writeFloatBE=e.bind(null,Wd);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,Yd),t.readFloatBE=r.bind(null,Qd)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+s);else{var f=Math.floor(Math.log(o)/Math.LN2);f===1024&&(f=1023),l=o*Math.pow(2,-f),n(l*4503599627370496>>>0,a,c+i),n((u<<31|f+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,Gd,0,4),t.writeDoubleBE=e.bind(null,Wd,4,0);function r(n,i,s,o,a){var c=n(o,a+i),u=n(o,a+s),l=(u>>31)*2+1,f=u>>>20&2047,d=4294967296*(u&1048575)+c;return f===2047?d?NaN:l*(1/0):f===0?l*5e-324*d:l*Math.pow(2,f-1075)*(d+4503599627370496)}t.readDoubleLE=r.bind(null,Yd,0,4),t.readDoubleBE=r.bind(null,Qd,4,0)}(),t}function Gd(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Wd(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Yd(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Qd(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Jd=x((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var th=x(eh=>{"use strict";var Nu=eh;Nu.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(e.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};Nu.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Nu.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var nh=x((h5,rh)=>{"use strict";rh.exports=U_;function U_(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return t(c);o+c>n&&(s=t(n),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var sh=x((p5,ih)=>{"use strict";ih.exports=pt;var uo=bn();function pt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Jn=pt.zero=new pt(0,0);Jn.toNumber=function(){return 0};Jn.zzEncode=Jn.zzDecode=function(){return this};Jn.length=function(){return 1};var M_=pt.zeroHash="\0\0\0\0\0\0\0\0";pt.fromNumber=function(e){if(e===0)return Jn;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new pt(n,i)};pt.from=function(e){if(typeof e=="number")return pt.fromNumber(e);if(uo.isString(e))if(uo.Long)e=uo.Long.fromString(e);else return pt.fromNumber(parseInt(e,10));return e.low||e.high?new pt(e.low>>>0,e.high>>>0):Jn};pt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};pt.prototype.toLong=function(e){return uo.Long?new uo.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var vn=String.prototype.charCodeAt;pt.fromHash=function(e){return e===M_?Jn:new pt((vn.call(e,0)|vn.call(e,1)<<8|vn.call(e,2)<<16|vn.call(e,3)<<24)>>>0,(vn.call(e,4)|vn.call(e,5)<<8|vn.call(e,6)<<16|vn.call(e,7)<<24)>>>0)};pt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};pt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};pt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};pt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var bn=x(Ou=>{"use strict";var oe=Ou;oe.asPromise=Md();oe.base64=jd();oe.EventEmitter=Hd();oe.float=Zd();oe.inquire=Jd();oe.utf8=th();oe.pool=nh();oe.LongBits=sh();oe.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);oe.global=oe.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||Ou;oe.emptyArray=Object.freeze?Object.freeze([]):[];oe.emptyObject=Object.freeze?Object.freeze({}):{};oe.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};oe.isString=function(e){return typeof e=="string"||e instanceof String};oe.isObject=function(e){return e&&typeof e=="object"};oe.isset=oe.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};oe.Buffer=function(){try{var t=oe.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();oe._Buffer_from=null;oe._Buffer_allocUnsafe=null;oe.newBuffer=function(e){return typeof e=="number"?oe.Buffer?oe._Buffer_allocUnsafe(e):new oe.Array(e):oe.Buffer?oe._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};oe.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;oe.Long=oe.global.dcodeIO&&oe.global.dcodeIO.Long||oe.global.Long||oe.inquire("long");oe.key2Re=/^true|false|0|1$/;oe.key32Re=/^-?(?:0|[1-9][0-9]*)$/;oe.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;oe.longToHash=function(e){return e?oe.LongBits.from(e).toHash():oe.LongBits.zeroHash};oe.longFromHash=function(e,r){var n=oe.LongBits.fromHash(e);return oe.Long?oe.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function oh(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}oe.merge=oh;oe.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ah(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&oh(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}oe.newError=ah;oe.ProtocolError=ah("ProtocolError");oe.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};oe.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};oe.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};oe._configure=function(){var t=oe.Buffer;if(!t){oe._Buffer_from=oe._Buffer_allocUnsafe=null;return}oe._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},oe._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Fu=x((g5,fh)=>{"use strict";fh.exports=Ie;var Zt=bn(),Du,Ra=Zt.LongBits,ch=Zt.base64,uh=Zt.utf8;function lo(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function ku(){}function F_(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Ie(){this.len=0,this.head=new lo(ku,0,0),this.tail=this.head,this.states=null}var lh=function(){return Zt.Buffer?function(){return(Ie.create=function(){return new Du})()}:function(){return new Ie}};Ie.create=lh();Ie.alloc=function(e){return new Zt.Array(e)};Zt.Array!==Array&&(Ie.alloc=Zt.pool(Ie.alloc,Zt.Array.prototype.subarray));Ie.prototype._push=function(e,r,n){return this.tail=this.tail.next=new lo(e,r,n),this.len+=r,this};function Lu(t,e,r){e[r]=t&255}function K_(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function qu(t,e){this.len=t,this.next=void 0,this.val=e}qu.prototype=Object.create(lo.prototype);qu.prototype.fn=K_;Ie.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new qu((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Ie.prototype.int32=function(e){return e<0?this._push(Uu,10,Ra.fromNumber(e)):this.uint32(e)};Ie.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Uu(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Ie.prototype.uint64=function(e){var r=Ra.from(e);return this._push(Uu,r.length(),r)};Ie.prototype.int64=Ie.prototype.uint64;Ie.prototype.sint64=function(e){var r=Ra.from(e).zzEncode();return this._push(Uu,r.length(),r)};Ie.prototype.bool=function(e){return this._push(Lu,1,e?1:0)};function Mu(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Ie.prototype.fixed32=function(e){return this._push(Mu,4,e>>>0)};Ie.prototype.sfixed32=Ie.prototype.fixed32;Ie.prototype.fixed64=function(e){var r=Ra.from(e);return this._push(Mu,4,r.lo)._push(Mu,4,r.hi)};Ie.prototype.sfixed64=Ie.prototype.fixed64;Ie.prototype.float=function(e){return this._push(Zt.float.writeFloatLE,4,e)};Ie.prototype.double=function(e){return this._push(Zt.float.writeDoubleLE,8,e)};var V_=Zt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};Ie.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Lu,1,0);if(Zt.isString(e)){var n=Ie.alloc(r=ch.length(e));ch.decode(e,n,0),e=n}return this.uint32(r)._push(V_,r,e)};Ie.prototype.string=function(e){var r=uh.length(e);return r?this.uint32(r)._push(uh.write,r,e):this._push(Lu,1,0)};Ie.prototype.fork=function(){return this.states=new F_(this),this.head=this.tail=new lo(ku,0,0),this.len=0,this};Ie.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new lo(ku,0,0),this.len=0),this};Ie.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};Ie.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};Ie._configure=function(t){Du=t,Ie.create=lh(),Du._configure()}});var ph=x((m5,hh)=>{"use strict";hh.exports=_r;var dh=Fu();(_r.prototype=Object.create(dh.prototype)).constructor=_r;var wn=bn();function _r(){dh.call(this)}_r._configure=function(){_r.alloc=wn._Buffer_allocUnsafe,_r.writeBytesBuffer=wn.Buffer&&wn.Buffer.prototype instanceof Uint8Array&&wn.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};_r.prototype.bytes=function(e){wn.isString(e)&&(e=wn._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(_r.writeBytesBuffer,r,e),this};function j_(t,e,r){t.length<40?wn.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}_r.prototype.string=function(e){var r=wn.Buffer.byteLength(e);return this.uint32(r),r&&this._push(j_,r,e),this};_r._configure()});var ju=x((v5,bh)=>{"use strict";bh.exports=st;var Cr=bn(),Ku,yh=Cr.LongBits,$_=Cr.utf8;function pr(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function st(t){this.buf=t,this.pos=0,this.len=t.length}var gh=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new st(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new st(e);throw Error("illegal buffer")},mh=function(){return Cr.Buffer?function(r){return(st.create=function(i){return Cr.Buffer.isBuffer(i)?new Ku(i):gh(i)})(r)}:gh};st.create=mh();st.prototype._slice=Cr.Array.prototype.subarray||Cr.Array.prototype.slice;st.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,pr(this,10);return e}}();st.prototype.int32=function(){return this.uint32()|0};st.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Vu(){var t=new yh(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw pr(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw pr(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}st.prototype.bool=function(){return this.uint32()!==0};function Ba(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}st.prototype.fixed32=function(){if(this.pos+4>this.len)throw pr(this,4);return Ba(this.buf,this.pos+=4)};st.prototype.sfixed32=function(){if(this.pos+4>this.len)throw pr(this,4);return Ba(this.buf,this.pos+=4)|0};function vh(){if(this.pos+8>this.len)throw pr(this,8);return new yh(Ba(this.buf,this.pos+=4),Ba(this.buf,this.pos+=4))}st.prototype.float=function(){if(this.pos+4>this.len)throw pr(this,4);var e=Cr.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};st.prototype.double=function(){if(this.pos+8>this.len)throw pr(this,4);var e=Cr.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};st.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw pr(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};st.prototype.string=function(){var e=this.bytes();return $_.read(e,0,e.length)};st.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw pr(this,e);this.pos+=e}else do if(this.pos>=this.len)throw pr(this);while(this.buf[this.pos++]&128);return this};st.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};st._configure=function(t){Ku=t,st.create=mh(),Ku._configure();var e=Cr.Long?"toLong":"toNumber";Cr.merge(st.prototype,{int64:function(){return Vu.call(this)[e](!1)},uint64:function(){return Vu.call(this)[e](!0)},sint64:function(){return Vu.call(this).zzDecode()[e](!1)},fixed64:function(){return vh.call(this)[e](!0)},sfixed64:function(){return vh.call(this)[e](!1)}})}});var Sh=x((b5,xh)=>{"use strict";xh.exports=ei;var wh=ju();(ei.prototype=Object.create(wh.prototype)).constructor=ei;var Eh=bn();function ei(t){wh.call(this,t)}ei._configure=function(){Eh.Buffer&&(ei.prototype._slice=Eh.Buffer.prototype.slice)};ei.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};ei._configure()});var _h=x((w5,Ah)=>{"use strict";Ah.exports=fo;var $u=bn();(fo.prototype=Object.create($u.EventEmitter.prototype)).constructor=fo;function fo(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");$u.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}fo.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return $u.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};fo.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Ih=x(Ch=>{"use strict";var H_=Ch;H_.Service=_h()});var Rh=x((x5,Th)=>{"use strict";Th.exports={}});var Nh=x(Ph=>{"use strict";var Mt=Ph;Mt.build="minimal";Mt.Writer=Fu();Mt.BufferWriter=ph();Mt.Reader=ju();Mt.BufferReader=Sh();Mt.util=bn();Mt.rpc=Ih();Mt.roots=Rh();Mt.configure=Bh;function Bh(){Mt.util._configure(),Mt.Writer._configure(Mt.BufferWriter),Mt.Reader._configure(Mt.BufferReader)}Bh()});var Qr=x((A5,Oh)=>{"use strict";Oh.exports=Nh()});var Na=x((_5,kh)=>{"use strict";var ti=Qr(),Pa=ti.Reader,Dh=ti.Writer,St=ti.util,Jt=ti.roots["libp2p-crypto-keys"]||(ti.roots["libp2p-crypto-keys"]={});Jt.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();Jt.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=St.newBuffer([]),t.encode=function(r,n){return n||(n=Dh.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof Pa||(r=Pa.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Jt.PublicKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw St.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw St.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Jt.PublicKey)return r;var n=new Jt.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?St.base64.decode(r.Data,n.Data=St.newBuffer(St.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=St.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Jt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?St.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ti.util.toJSONOptions)},t}();Jt.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=St.newBuffer([]),t.encode=function(r,n){return n||(n=Dh.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof Pa||(r=Pa.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Jt.PrivateKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw St.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw St.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Jt.PrivateKey)return r;var n=new Jt.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?St.base64.decode(r.Data,n.Data=St.newBuffer(St.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=St.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Jt.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?St.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ti.util.toJSONOptions)},t}();kh.exports=Jt});var we=x((C5,Lh)=>{Lh.exports={options:{usePureJavaScript:!1}}});var Mh=x((I5,Uh)=>{var Hu={};Uh.exports=Hu;var qh={};Hu.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=z_(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,u=t[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join(`\r
`)}return n};Hu.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=qh[e];if(!r){r=qh[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*i,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function z_(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Fe=x((T5,jh)=>{var Fh=we(),Kh=Mh(),R=jh.exports=Fh.util=Fh.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){R.nextTick=process.nextTick,typeof setImmediate=="function"?R.setImmediate=setImmediate:R.setImmediate=R.nextTick;return}if(typeof setImmediate=="function"){R.setImmediate=function(){return setImmediate.apply(void 0,arguments)},R.nextTick=function(a){return setImmediate(a)};return}if(R.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,t="forge.setImmediate",e=[];R.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=R.setImmediate;R.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}R.nextTick=R.setImmediate})();R.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;R.globalScope=function(){return R.isNodejs?globalThis:typeof self=="undefined"?window:self}();R.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};R.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};R.isArrayBufferView=function(t){return t&&R.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function ho(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}R.ByteBuffer=zu;function zu(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(R.isArrayBuffer(t)||R.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(n){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof zu||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}R.ByteStringBuffer=zu;var G_=4096;R.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>G_&&(this.data.substr(0,1),this._constructedStringLength=0)};R.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};R.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};R.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};R.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};R.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};R.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(R.encodeUtf8(t))};R.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};R.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};R.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};R.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};R.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};R.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};R.ByteStringBuffer.prototype.putInt=function(t,e){ho(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};R.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};R.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};R.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};R.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};R.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};R.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};R.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};R.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};R.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};R.ByteStringBuffer.prototype.getInt=function(t){ho(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};R.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};R.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};R.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};R.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};R.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};R.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};R.ByteStringBuffer.prototype.copy=function(){var t=R.createBuffer(this.data);return t.read=this.read,t};R.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};R.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};R.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};R.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};R.ByteStringBuffer.prototype.toString=function(){return R.decodeUtf8(this.bytes())};function W_(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=R.isArrayBuffer(t),n=R.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}R.DataBuffer=W_;R.DataBuffer.prototype.length=function(){return this.write-this.read};R.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};R.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};R.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};R.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};R.DataBuffer.prototype.putBytes=function(t,e){if(R.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(R.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof R.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&R.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof R.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=R.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=R.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};R.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};R.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};R.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};R.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};R.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};R.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};R.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};R.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};R.DataBuffer.prototype.putInt=function(t,e){ho(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};R.DataBuffer.prototype.putSignedInt=function(t,e){return ho(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};R.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};R.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};R.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};R.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};R.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};R.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};R.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};R.DataBuffer.prototype.getInt=function(t){ho(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};R.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};R.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};R.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};R.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};R.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};R.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};R.DataBuffer.prototype.copy=function(){return new R.DataBuffer(this)};R.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};R.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};R.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};R.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};R.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return R.binary.raw.encode(e);if(t==="hex")return R.binary.hex.encode(e);if(t==="base64")return R.binary.base64.encode(e);if(t==="utf8")return R.text.utf8.decode(e);if(t==="utf16")return R.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};R.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=R.encodeUtf8(t)),new R.ByteBuffer(t)};R.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};R.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};R.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};R.bytesToHex=function(t){return R.createBuffer(t).toHex()};R.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var En="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",xn=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Vh="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";R.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=En.charAt(i>>2),r+=En.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=En.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":En.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};R.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=xn[t.charCodeAt(o++)-43],n=xn[t.charCodeAt(o++)-43],i=xn[t.charCodeAt(o++)-43],s=xn[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};R.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};R.decodeUtf8=function(t){return decodeURIComponent(escape(t))};R.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Kh.encode,decode:Kh.decode}};R.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};R.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};R.binary.hex.encode=R.bytesToHex;R.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};R.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=En.charAt(i>>2),r+=En.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=En.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":En.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};R.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,u=r;c<t.length;)i=xn[t.charCodeAt(c++)-43],s=xn[t.charCodeAt(c++)-43],o=xn[t.charCodeAt(c++)-43],a=xn[t.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};R.binary.base58.encode=function(t,e){return R.binary.baseN.encode(t,Vh,e)};R.binary.base58.decode=function(t,e){return R.binary.baseN.decode(t,Vh,e)};R.text={utf8:{},utf16:{}};R.text.utf8.encode=function(t,e,r){t=R.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};R.text.utf8.decode=function(t){return R.decodeUtf8(String.fromCharCode.apply(null,t))};R.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};R.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};R.deflate=function(t,e,r){if(e=R.decode64(t.deflate(R.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};R.inflate=function(t,e,r){var n=t.inflate(R.encode64(e)).rval;return n===null?null:R.decode64(n)};var Gu=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=R.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Wu=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(R.decode64(r))),r},Y_=function(t,e,r,n){var i=Wu(t,e);i===null&&(i={}),i[r]=n,Gu(t,e,i)},Q_=function(t,e,r){var n=Wu(t,e);return n!==null&&(n=r in n?n[r]:null),n},X_=function(t,e,r){var n=Wu(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Gu(t,e,n)}},Z_=function(t,e){Gu(t,e,null)},Oa=function(t,e,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};R.setItem=function(t,e,r,n,i){Oa(Y_,arguments,i)};R.getItem=function(t,e,r,n){return Oa(Q_,arguments,n)};R.removeItem=function(t,e,r,n){Oa(X_,arguments,n)};R.clearItems=function(t,e,r){Oa(Z_,arguments,r)};R.parseUrl=function(t){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var r=e.exec(t),n=r===null?null:{full:t,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(n.port!==80&&n.scheme==="http"||n.port!==443&&n.scheme==="https")&&(n.fullHost+=":"+n.port):n.scheme==="http"?n.port=80:n.scheme==="https"&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var Da=null;R.getQueryVariables=function(t){var e=function(n){for(var i={},s=n.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,u;a>0?(c=s[o].substring(0,a),u=s[o].substring(a+1)):(c=s[o],u=null),c in i||(i[c]=[]),!(c in Object.prototype)&&u!==null&&i[c].push(unescape(u))}return i},r;return typeof t=="undefined"?(Da===null&&(typeof window!="undefined"&&window.location&&window.location.search?Da=e(window.location.search.substring(1)):Da={}),r=Da):r=e(t),r};R.parseFragment=function(t){var e=t,r="",n=t.indexOf("?");n>0&&(e=t.substring(0,n),r=t.substring(n+1));var i=e.split("/");i.length>0&&i[0]===""&&i.shift();var s=r===""?{}:R.getQueryVariables(r);return{pathString:e,queryString:r,path:i,query:s}};R.makeRequest=function(t){var e=R.parseFragment(t),r={path:e.pathString,query:e.queryString,getPath:function(n){return typeof n=="undefined"?e.path:e.path[n]},getQuery:function(n,i){var s;return typeof n=="undefined"?s=e.query:(s=e.query[n],s&&typeof i!="undefined"&&(s=s[i])),s},getQueryLast:function(n,i){var s,o=r.getQuery(n);return o?s=o[o.length-1]:s=i,s}};return r};R.makeLink=function(t,e,r){t=jQuery.isArray(t)?t.join("/"):t;var n=jQuery.param(e||{});return r=r||"",t+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")};R.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};R.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};R.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};R.formatSize=function(t){return t>=1073741824?t=R.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=R.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=R.formatNumber(t/1024,0)+" KiB":t=R.formatNumber(t,0)+" bytes",t};R.bytesFromIP=function(t){return t.indexOf(".")!==-1?R.bytesFromIPv4(t):t.indexOf(":")!==-1?R.bytesFromIPv6(t):null};R.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=R.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};R.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=R.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=R.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};R.bytesToIP=function(t){return t.length===4?R.bytesToIPv4(t):t.length===16?R.bytesToIPv6(t):null};R.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};R.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=R.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};R.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in R&&!t.update)return e(null,R.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return R.cores=navigator.hardwareConcurrency,e(null,R.cores);if(typeof Worker=="undefined")return R.cores=1,e(null,R.cores);if(typeof Blob=="undefined")return R.cores=2,e(null,R.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,f){return l+f},0)/o.length);return R.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,R.cores)}i(c,function(l,f){o.push(s(c,f)),n(o,a-1,c)})}function i(o,a){for(var c=[],u=[],l=0;l<o;++l){var f=new Worker(r);f.addEventListener("message",function(d){if(u.push(d.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(f)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],f=c[u]=[],d=0;d<o;++d)if(u!==d){var p=a[d];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&f.push(d)}return c.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var Gi=x((R5,$h)=>{var po=we();po.pki=po.pki||{};var Yu=$h.exports=po.pki.oids=po.oids=po.oids||{};function H(t,e){Yu[t]=e,Yu[e]=t}function Oe(t,e){Yu[t]=e}H("1.2.840.113549.1.1.1","rsaEncryption");H("1.2.840.113549.1.1.4","md5WithRSAEncryption");H("1.2.840.113549.1.1.5","sha1WithRSAEncryption");H("1.2.840.113549.1.1.7","RSAES-OAEP");H("1.2.840.113549.1.1.8","mgf1");H("1.2.840.113549.1.1.9","pSpecified");H("1.2.840.113549.1.1.10","RSASSA-PSS");H("1.2.840.113549.1.1.11","sha256WithRSAEncryption");H("1.2.840.113549.1.1.12","sha384WithRSAEncryption");H("1.2.840.113549.1.1.13","sha512WithRSAEncryption");H("1.3.101.112","EdDSA25519");H("1.2.840.10040.4.3","dsa-with-sha1");H("1.3.14.3.2.7","desCBC");H("1.3.14.3.2.26","sha1");H("2.16.840.1.101.3.4.2.1","sha256");H("2.16.840.1.101.3.4.2.2","sha384");H("2.16.840.1.101.3.4.2.3","sha512");H("1.2.840.113549.2.5","md5");H("1.2.840.113549.1.7.1","data");H("1.2.840.113549.1.7.2","signedData");H("1.2.840.113549.1.7.3","envelopedData");H("1.2.840.113549.1.7.4","signedAndEnvelopedData");H("1.2.840.113549.1.7.5","digestedData");H("1.2.840.113549.1.7.6","encryptedData");H("1.2.840.113549.1.9.1","emailAddress");H("1.2.840.113549.1.9.2","unstructuredName");H("1.2.840.113549.1.9.3","contentType");H("1.2.840.113549.1.9.4","messageDigest");H("1.2.840.113549.1.9.5","signingTime");H("1.2.840.113549.1.9.6","counterSignature");H("1.2.840.113549.1.9.7","challengePassword");H("1.2.840.113549.1.9.8","unstructuredAddress");H("1.2.840.113549.1.9.14","extensionRequest");H("1.2.840.113549.1.9.20","friendlyName");H("1.2.840.113549.1.9.21","localKeyId");H("1.2.840.113549.1.9.22.1","x509Certificate");H("1.2.840.113549.1.12.10.1.1","keyBag");H("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");H("1.2.840.113549.1.12.10.1.3","certBag");H("1.2.840.113549.1.12.10.1.4","crlBag");H("1.2.840.113549.1.12.10.1.5","secretBag");H("1.2.840.113549.1.12.10.1.6","safeContentsBag");H("1.2.840.113549.1.5.13","pkcs5PBES2");H("1.2.840.113549.1.5.12","pkcs5PBKDF2");H("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");H("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");H("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");H("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");H("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");H("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");H("1.2.840.113549.2.7","hmacWithSHA1");H("1.2.840.113549.2.8","hmacWithSHA224");H("1.2.840.113549.2.9","hmacWithSHA256");H("1.2.840.113549.2.10","hmacWithSHA384");H("1.2.840.113549.2.11","hmacWithSHA512");H("1.2.840.113549.3.7","des-EDE3-CBC");H("2.16.840.1.101.3.4.1.2","aes128-CBC");H("2.16.840.1.101.3.4.1.22","aes192-CBC");H("2.16.840.1.101.3.4.1.42","aes256-CBC");H("2.5.4.3","commonName");H("2.5.4.5","serialName");H("2.5.4.6","countryName");H("2.5.4.7","localityName");H("2.5.4.8","stateOrProvinceName");H("2.5.4.9","streetAddress");H("2.5.4.10","organizationName");H("2.5.4.11","organizationalUnitName");H("2.5.4.13","description");H("2.5.4.15","businessCategory");H("2.5.4.17","postalCode");H("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");H("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");H("2.16.840.1.113730.1.1","nsCertType");H("2.16.840.1.113730.1.13","nsComment");Oe("2.5.29.1","authorityKeyIdentifier");Oe("2.5.29.2","keyAttributes");Oe("2.5.29.3","certificatePolicies");Oe("2.5.29.4","keyUsageRestriction");Oe("2.5.29.5","policyMapping");Oe("2.5.29.6","subtreesConstraint");Oe("2.5.29.7","subjectAltName");Oe("2.5.29.8","issuerAltName");Oe("2.5.29.9","subjectDirectoryAttributes");Oe("2.5.29.10","basicConstraints");Oe("2.5.29.11","nameConstraints");Oe("2.5.29.12","policyConstraints");Oe("2.5.29.13","basicConstraints");H("2.5.29.14","subjectKeyIdentifier");H("2.5.29.15","keyUsage");Oe("2.5.29.16","privateKeyUsagePeriod");H("2.5.29.17","subjectAltName");H("2.5.29.18","issuerAltName");H("2.5.29.19","basicConstraints");Oe("2.5.29.20","cRLNumber");Oe("2.5.29.21","cRLReason");Oe("2.5.29.22","expirationDate");Oe("2.5.29.23","instructionCode");Oe("2.5.29.24","invalidityDate");Oe("2.5.29.25","cRLDistributionPoints");Oe("2.5.29.26","issuingDistributionPoint");Oe("2.5.29.27","deltaCRLIndicator");Oe("2.5.29.28","issuingDistributionPoint");Oe("2.5.29.29","certificateIssuer");Oe("2.5.29.30","nameConstraints");H("2.5.29.31","cRLDistributionPoints");H("2.5.29.32","certificatePolicies");Oe("2.5.29.33","policyMappings");Oe("2.5.29.34","policyConstraints");H("2.5.29.35","authorityKeyIdentifier");Oe("2.5.29.36","policyConstraints");H("2.5.29.37","extKeyUsage");Oe("2.5.29.46","freshestCRL");Oe("2.5.29.54","inhibitAnyPolicy");H("1.3.6.1.4.1.11129.2.4.2","timestampList");H("1.3.6.1.5.5.7.1.1","authorityInfoAccess");H("1.3.6.1.5.5.7.3.1","serverAuth");H("1.3.6.1.5.5.7.3.2","clientAuth");H("1.3.6.1.5.5.7.3.3","codeSigning");H("1.3.6.1.5.5.7.3.4","emailProtection");H("1.3.6.1.5.5.7.3.8","timeStamping")});var Sn=x((B5,zh)=>{var $e=we();Fe();Gi();var Z=zh.exports=$e.asn1=$e.asn1||{};Z.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Z.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Z.create=function(t,e,r,n,i){if($e.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||$e.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=Z.copy(a)),a};Z.copy=function(t,e){var r;if($e.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(Z.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Z.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Z.equals=function(t,e,r){if($e.util.isArray(t)){if(!$e.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Z.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Z.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};Z.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function yo(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var J_=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;yo(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};Z.fromDer=function(t,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=$e.util.createBuffer(t)),ka(t,t.length(),0,e)};function ka(t,e,r,n){var i;yo(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=J_(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,f,d=(s&32)==32;if(d)if(l=[],c===void 0)for(;;){if(yo(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),l.push(ka(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),l.push(ka(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(l===void 0&&o===Z.Class.UNIVERSAL&&a===Z.Type.BITSTRING&&(f=t.bytes(c)),l===void 0&&n.decodeBitStrings&&o===Z.Class.UNIVERSAL&&a===Z.Type.BITSTRING&&c>1){var p=t.read,h=e,g=0;if(a===Z.Type.BITSTRING&&(yo(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={verbose:n.verbose,strict:!0,decodeBitStrings:!0},A=ka(t,e,r+1,v),B=i-t.length();e-=B,a==Z.Type.BITSTRING&&B++;var k=A.tagClass;B===c&&(k===Z.Class.UNIVERSAL||k===Z.Class.CONTEXT_SPECIFIC)&&(l=[A])}catch(q){}l===void 0&&(t.read=p,e=h)}if(l===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Z.Type.BMPSTRING)for(l="";c>0;c-=2)yo(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c)}var z=f===void 0?null:{bitStringContents:f};return Z.create(o,a,d,l,z)}Z.toDer=function(t){var e=$e.util.createBuffer(),r=t.tagClass|t.type,n=$e.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=Z.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(Z.toDer(t.value[s]))}else if(t.type===Z.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===Z.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};Z.oidToDer=function(t){var e=t.split("."),r=$e.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};Z.derToOid=function(t){var e;typeof t=="string"&&(t=$e.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};Z.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),f=parseInt(t.substr(u+4,2),10),d=l*60+f;d*=6e4,c==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};Z.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var f=t.length-5,d=t.charAt(f);if(d==="+"||d==="-"){var p=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10);u=p*60+h,u*=6e4,d==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};Z.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Z.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Z.integerToDer=function(t){var e=$e.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Z.derToInteger=function(t){typeof t=="string"&&(t=$e.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Z.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(i=!0,e.value&&$e.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=Z.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Hh=/[^\\u0000-\\u00ff]/;Z.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case Z.Class.UNIVERSAL:n+="Universal:";break;case Z.Class.APPLICATION:n+="Application:";break;case Z.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case Z.Class.PRIVATE:n+="Private:";break}if(t.tagClass===Z.Class.UNIVERSAL)switch(n+=t.type,t.type){case Z.Type.NONE:n+=" (None)";break;case Z.Type.BOOLEAN:n+=" (Boolean)";break;case Z.Type.INTEGER:n+=" (Integer)";break;case Z.Type.BITSTRING:n+=" (Bit string)";break;case Z.Type.OCTETSTRING:n+=" (Octet string)";break;case Z.Type.NULL:n+=" (Null)";break;case Z.Type.OID:n+=" (Object Identifier)";break;case Z.Type.ODESC:n+=" (Object Descriptor)";break;case Z.Type.EXTERNAL:n+=" (External or Instance of)";break;case Z.Type.REAL:n+=" (Real)";break;case Z.Type.ENUMERATED:n+=" (Enumerated)";break;case Z.Type.EMBEDDED:n+=" (Embedded PDV)";break;case Z.Type.UTF8:n+=" (UTF8)";break;case Z.Type.ROID:n+=" (Relative Object Identifier)";break;case Z.Type.SEQUENCE:n+=" (Sequence)";break;case Z.Type.SET:n+=" (Set)";break;case Z.Type.PRINTABLESTRING:n+=" (Printable String)";break;case Z.Type.IA5String:n+=" (IA5String (ASCII))";break;case Z.Type.UTCTIME:n+=" (UTC time)";break;case Z.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case Z.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=Z.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===Z.Type.OID){var c=Z.derToOid(t.value);n+=c,$e.pki&&$e.pki.oids&&c in $e.pki.oids&&(n+=" ("+$e.pki.oids[c]+") ")}if(t.type===Z.Type.INTEGER)try{n+=Z.derToInteger(t.value)}catch(l){n+="0x"+$e.util.bytesToHex(t.value)}else if(t.type===Z.Type.BITSTRING){if(t.value.length>1?n+="0x"+$e.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else t.type===Z.Type.OCTETSTRING?(Hh.test(t.value)||(n+="("+t.value+") "),n+="0x"+$e.util.bytesToHex(t.value)):t.type===Z.Type.UTF8?n+=$e.util.decodeUtf8(t.value):t.type===Z.Type.PRINTABLESTRING||t.type===Z.Type.IA5String?n+=t.value:Hh.test(t.value)?n+="0x"+$e.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Xu=x((P5,Gh)=>{var yt=we();Fe();Gh.exports=yt.cipher=yt.cipher||{};yt.cipher.algorithms=yt.cipher.algorithms||{};yt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=yt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new yt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};yt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=yt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new yt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};yt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),yt.cipher.algorithms[t]=e};yt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in yt.cipher.algorithms?yt.cipher.algorithms[t]:null};var Qu=yt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Qu.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=yt.util.createBuffer(),this.output=t.output||yt.util.createBuffer(),this.mode.start(e)};Qu.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Qu.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Ju=x((N5,Wh)=>{var gt=we();Fe();gt.cipher=gt.cipher||{};var Ee=Wh.exports=gt.cipher.modes=gt.cipher.modes||{};Ee.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ee.ecb.prototype.start=function(t){};Ee.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Ee.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Ee.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ee.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Ee.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Ee.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=La(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Ee.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Ee.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Ee.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Ee.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Ee.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0};Ee.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=La(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ee.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ee.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ee.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0};Ee.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=La(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ee.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Ee.ofb.prototype.decrypt=Ee.ofb.prototype.encrypt;Ee.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0};Ee.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=La(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Ee.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}qa(this._inBlock)};Ee.ctr.prototype.decrypt=Ee.ctr.prototype.encrypt;Ee.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=gt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Ee.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=gt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=gt.util.createBuffer(t.additionalData):r=gt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=gt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Zu(n*8)))}this._inBlock=this._j0.slice(0),qa(this._inBlock),this._partialBytes=0,r=gt.util.createBuffer(r),this._aDataLength=Zu(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Ee.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),qa(this._inBlock)};Ee.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),qa(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Ee.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=gt.util.createBuffer();var n=this._aDataLength.concat(Zu(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Ee.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Ee.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Ee.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Ee.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Ee.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,u=(n-1-o%n)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};Ee.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function La(t,e){if(typeof t=="string"&&(t=gt.util.createBuffer(t)),gt.util.isArray(t)&&t.length>4){var r=t;t=gt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!gt.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function qa(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Zu(t){return[t/4294967296|0,t&4294967295]}});var Qi=x((O5,Zh)=>{var Ke=we();Xu();Ju();Fe();Zh.exports=Ke.aes=Ke.aes||{};Ke.aes.startEncrypting=function(t,e,r,n){var i=Ua({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};Ke.aes.createEncryptionCipher=function(t,e){return Ua({key:t,output:null,decrypt:!1,mode:e})};Ke.aes.startDecrypting=function(t,e,r,n){var i=Ua({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};Ke.aes.createDecryptionCipher=function(t,e){return Ua({key:t,output:null,decrypt:!0,mode:e})};Ke.aes.Algorithm=function(t,e){el||Qh();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return rl(r._w,n,i,!1)},decrypt:function(n,i){return rl(r._w,n,i,!0)}}}),r._init=!1};Ke.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Ke.util.createBuffer(e);else if(Ke.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Ke.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Ke.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!Ke.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Xh(e,t.decrypt&&!o),this._init=!0}};Ke.aes._expandKey=function(t,e){return el||Qh(),Xh(t,e)};Ke.aes._updateBlock=rl;Wi("AES-ECB",Ke.cipher.modes.ecb);Wi("AES-CBC",Ke.cipher.modes.cbc);Wi("AES-CFB",Ke.cipher.modes.cfb);Wi("AES-OFB",Ke.cipher.modes.ofb);Wi("AES-CTR",Ke.cipher.modes.ctr);Wi("AES-GCM",Ke.cipher.modes.gcm);function Wi(t,e){var r=function(){return new Ke.aes.Algorithm(t,e)};Ke.cipher.registerAlgorithm(t,r)}var el=!1,Yi=4,Pt,tl,Yh,ri,yr;function Qh(){el=!0,Yh=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Pt=new Array(256),tl=new Array(256),ri=new Array(4),yr=new Array(4);for(var e=0;e<4;++e)ri[e]=new Array(256),yr[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,u,l,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Pt[r]=a,tl[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var f=0;f<4;++f)ri[f][r]=u,yr[f][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function Xh(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=Yi*o,c=s;c<a;++c)n=r[c-1],c%s==0?(n=Pt[n>>>16&255]<<24^Pt[n>>>8&255]<<16^Pt[n&255]<<8^Pt[n>>>24]^Yh[i]<<24,i++):s>6&&c%s==4&&(n=Pt[n>>>24]<<24^Pt[n>>>16&255]<<16^Pt[n>>>8&255]<<8^Pt[n&255]),r[c]=r[c-s]^n;if(e){var u,l=yr[0],f=yr[1],d=yr[2],p=yr[3],h=r.slice(0);a=r.length;for(var c=0,g=a-Yi;c<a;c+=Yi,g-=Yi)if(c===0||c===a-Yi)h[c]=r[g],h[c+1]=r[g+3],h[c+2]=r[g+2],h[c+3]=r[g+1];else for(var v=0;v<Yi;++v)u=r[g+v],h[c+(3&-v)]=l[Pt[u>>>24]]^f[Pt[u>>>16&255]]^d[Pt[u>>>8&255]]^p[Pt[u&255]];r=h}return r}function rl(t,e,r,n){var i=t.length/4-1,s,o,a,c,u;n?(s=yr[0],o=yr[1],a=yr[2],c=yr[3],u=tl):(s=ri[0],o=ri[1],a=ri[2],c=ri[3],u=Pt);var l,f,d,p,h,g,v;l=e[0]^t[0],f=e[n?3:1]^t[1],d=e[2]^t[2],p=e[n?1:3]^t[3];for(var A=3,B=1;B<i;++B)h=s[l>>>24]^o[f>>>16&255]^a[d>>>8&255]^c[p&255]^t[++A],g=s[f>>>24]^o[d>>>16&255]^a[p>>>8&255]^c[l&255]^t[++A],v=s[d>>>24]^o[p>>>16&255]^a[l>>>8&255]^c[f&255]^t[++A],p=s[p>>>24]^o[l>>>16&255]^a[f>>>8&255]^c[d&255]^t[++A],l=h,f=g,d=v;r[0]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[d>>>8&255]<<8^u[p&255]^t[++A],r[n?3:1]=u[f>>>24]<<24^u[d>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^t[++A],r[2]=u[d>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[f&255]^t[++A],r[n?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[d&255]^t[++A]}function Ua(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Ke.cipher.createDecipher(r,t.key):n=Ke.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof Ke.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Fa=x((D5,ep)=>{var He=we();Xu();Ju();Fe();ep.exports=He.des=He.des||{};He.des.startEncrypting=function(t,e,r,n){var i=Ma({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};He.des.createEncryptionCipher=function(t,e){return Ma({key:t,output:null,decrypt:!1,mode:e})};He.des.startDecrypting=function(t,e,r,n){var i=Ma({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};He.des.createDecryptionCipher=function(t,e){return Ma({key:t,output:null,decrypt:!0,mode:e})};He.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Jh(r._keys,n,i,!1)},decrypt:function(n,i){return Jh(r._keys,n,i,!0)}}}),r._init=!1};He.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=He.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=cC(e),this._init=!0}};Ir("DES-ECB",He.cipher.modes.ecb);Ir("DES-CBC",He.cipher.modes.cbc);Ir("DES-CFB",He.cipher.modes.cfb);Ir("DES-OFB",He.cipher.modes.ofb);Ir("DES-CTR",He.cipher.modes.ctr);Ir("3DES-ECB",He.cipher.modes.ecb);Ir("3DES-CBC",He.cipher.modes.cbc);Ir("3DES-CFB",He.cipher.modes.cfb);Ir("3DES-OFB",He.cipher.modes.ofb);Ir("3DES-CTR",He.cipher.modes.ctr);function Ir(t,e){var r=function(){return new He.des.Algorithm(t,e)};He.cipher.registerAlgorithm(t,r)}var eC=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],tC=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],rC=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],nC=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],iC=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],sC=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],oC=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],aC=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function cC(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],A=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],B=0,k,z=0;z<g;z++){var q=t.getInt32(),L=t.getInt32();k=(q>>>4^L)&252645135,L^=k,q^=k<<4,k=(L>>>-16^q)&65535,q^=k,L^=k<<-16,k=(q>>>2^L)&858993459,L^=k,q^=k<<2,k=(L>>>-16^q)&65535,q^=k,L^=k<<-16,k=(q>>>1^L)&1431655765,L^=k,q^=k<<1,k=(L>>>8^q)&16711935,q^=k,L^=k<<8,k=(q>>>1^L)&1431655765,L^=k,q^=k<<1,k=q<<8|L>>>20&240,q=L<<24|L<<8&16711680|L>>>8&65280|L>>>24&240,L=k;for(var te=0;te<A.length;++te){A[te]?(q=q<<2|q>>>26,L=L<<2|L>>>26):(q=q<<1|q>>>27,L=L<<1|L>>>27),q&=-15,L&=-15;var se=e[q>>>28]|r[q>>>24&15]|n[q>>>20&15]|i[q>>>16&15]|s[q>>>12&15]|o[q>>>8&15]|a[q>>>4&15],j=c[L>>>28]|u[L>>>24&15]|l[L>>>20&15]|f[L>>>16&15]|d[L>>>12&15]|p[L>>>8&15]|h[L>>>4&15];k=(j>>>16^se)&65535,v[B++]=se^k,v[B++]=j^k<<16}}return v}function Jh(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var l=s[u+1],f=s[u+2],d=s[u];d!=l;d+=f){var p=c^t[d],h=(c>>>4|c<<28)^t[d+1];o=a,a=c,c=o^(tC[p>>>24&63]|nC[p>>>16&63]|sC[p>>>8&63]|aC[p&63]|eC[h>>>24&63]|rC[h>>>16&63]|iC[h>>>8&63]|oC[h&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function Ma(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=He.cipher.createDecipher(r,t.key):n=He.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof He.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var An=x((k5,tp)=>{var Ka=we();tp.exports=Ka.md=Ka.md||{};Ka.md.algorithms=Ka.md.algorithms||{}});var np=x((L5,rp)=>{var Xr=we();An();Fe();var uC=rp.exports=Xr.hmac=Xr.hmac||{};uC.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Xr.md.algorithms)e=Xr.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=Xr.util.createBuffer(o);else if(Xr.util.isArray(o)){var a=o;o=Xr.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Xr.util.createBuffer(),n=Xr.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Xi=x(()=>{});var nl=x((M5,ip)=>{var Nt=we();np();An();Fe();var lC=Nt.pkcs5=Nt.pkcs5||{},Zr;Nt.util.isNodejs&&!Nt.options.usePureJavaScript&&(Zr=Xi());ip.exports=Nt.pbkdf2=lC.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Nt.util.isNodejs&&!Nt.options.usePureJavaScript&&Zr.pbkdf2&&(i===null||typeof i!="object")&&(Zr.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Zr.pbkdf2Sync.length===4?Zr.pbkdf2(t,e,r,n,function(k,z){if(k)return s(k);s(null,z.toString("binary"))}):Zr.pbkdf2(t,e,r,n,i,function(k,z){if(k)return s(k);s(null,z.toString("binary"))}):Zr.pbkdf2Sync.length===4?Zr.pbkdf2Sync(t,e,r,n).toString("binary"):Zr.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Nt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Nt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),u=n-(c-1)*o,l=Nt.hmac.create();l.start(i,t);var f="",d,p,h;if(!s){for(var g=1;g<=c;++g){l.start(null,null),l.update(e),l.update(Nt.util.int32ToBytes(g)),d=h=l.digest().getBytes();for(var v=2;v<=r;++v)l.start(null,null),l.update(h),p=l.digest().getBytes(),d=Nt.util.xorBytes(d,p,o),h=p;f+=g<c?d:d.substr(0,u)}return f}var g=1,v;function A(){if(g>c)return s(null,f);l.start(null,null),l.update(e),l.update(Nt.util.int32ToBytes(g)),d=h=l.digest().getBytes(),v=2,B()}function B(){if(v<=r)return l.start(null,null),l.update(h),p=l.digest().getBytes(),d=Nt.util.xorBytes(d,p,o),h=p,++v,Nt.util.setImmediate(B);f+=g<c?d:d.substr(0,u),++g,A()}A()}});var $a=x((F5,op)=>{var Va=we();Fe();var sp=op.exports=Va.pem=Va.pem||{};sp.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=ja(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=ja(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=ja(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=ja(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Va.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};sp.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:Va.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(i),c=0;s&&c<a.length;){for(var u=a[c].replace(/\s+$/,""),l=c+1;l<a.length;++l){var f=a[l];if(!/\s/.test(f[0]))break;u+=f,c=l}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),h=0;h<p.length;++h)d.values.push(fC(p[h]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function ja(t){for(var e=t.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function fC(t){return t.replace(/^\s+/,"")}});var dp=x((K5,fp)=>{var Tr=we();An();Fe();var ap=fp.exports=Tr.sha256=Tr.sha256||{};Tr.md.sha256=Tr.md.algorithms.sha256=ap;ap.create=function(){cp||dC();var t=null,e=Tr.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Tr.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Tr.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),lp(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Tr.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(il.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};lp(f,r,i);var d=Tr.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},n};var il=null,cp=!1,up=null;function dC(){il=String.fromCharCode(128),il+=Tr.util.fillString(String.fromCharCode(0),64),up=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],cp=!0}function lp(t,e,r){for(var n,i,s,o,a,c,u,l,f,d,p,h,g,v,A,B=r.length();B>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(l=t.h0,f=t.h1,d=t.h2,p=t.h3,h=t.h4,g=t.h5,v=t.h6,A=t.h7,u=0;u<64;++u)o=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),a=v^h&(g^v),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|d&(l^f),n=A+o+a+up[u]+e[u],i=s+c,A=v,v=g,g=h,h=p+n>>>0,p=d,d=f,f=l,l=n+i>>>0;t.h0=t.h0+l|0,t.h1=t.h1+f|0,t.h2=t.h2+d|0,t.h3=t.h3+p|0,t.h4=t.h4+h|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+A|0,B-=64}}});var pp=x((V5,hp)=>{var Rr=we();Fe();var Ha=null;Rr.util.isNodejs&&!Rr.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ha=Xi());var hC=hp.exports=Rr.prng=Rr.prng||{};hC.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var f=e.plugin.cipher,d=e.plugin.increment,p=e.plugin.formatKey,h=e.plugin.formatSeed,g=Rr.util.createBuffer();e.key=null,v();function v(A){if(A)return l(A);if(g.length()>=u)return l(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Rr.util.nextTick(function(){s(v)});var B=f(e.key,e.seed);e.generated+=B.length,g.putBytes(B),e.key=p(f(e.key,d(e.seed))),e.seed=h(f(e.key,e.seed)),Rr.util.setImmediate(v)}},e.generateSync=function(u){var l=e.plugin.cipher,f=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var h=Rr.util.createBuffer();h.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=l(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=d(l(e.key,f(e.seed))),e.seed=p(l(e.key,e.seed))}return h.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(f,d){if(f)return u(f);e.collect(d),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,f=0;f<32;++f)e.reseeds%l==0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var d=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function c(u){var l=null,f=Rr.util.globalScope,d=f.crypto||f.msCrypto;d&&d.getRandomValues&&(l=function(q){return d.getRandomValues(q)});var p=Rr.util.createBuffer();if(l)for(;p.length()<u;){var h=Math.max(1,Math.min(u-p.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{l(g);for(var v=0;v<g.length;++v)p.putInt32(g[v])}catch(q){if(!(typeof QuotaExceededError!="undefined"&&q instanceof QuotaExceededError))throw q}}if(p.length()<u)for(var A,B,k,z=Math.floor(Math.random()*65536);p.length()<u;){B=16807*(z&65535),A=16807*(z>>16),B+=(A&32767)<<16,B+=A>>15,B=(B&2147483647)+(B>>31),z=B&4294967295;for(var v=0;v<3;++v)k=z>>>(v<<3),k^=Math.floor(Math.random()*256),p.putByte(String.fromCharCode(k&255))}return p.getBytes(u)}return Ha?(e.seedFile=function(u,l){Ha.randomBytes(u,function(f,d){if(f)return l(f);l(null,d.toString())})},e.seedFileSync=function(u){return Ha.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(f){l(f)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,f=0;f<l;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var f="",d=0;d<l;d+=8)f+=String.fromCharCode(u>>d&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,d){function p(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",p),d(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var d=f.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(p,h){u.postMessage({forge:{prng:{err:p,bytes:h}}})})};u.addEventListener("message",l)}},e}});var ni=x((j5,sl)=>{var mt=we();Qi();dp();pp();Fe();(function(){if(mt.random&&mt.random.getBytes){sl.exports=mt.random;return}(function(t){var e={},r=new Array(4),n=mt.util.createBuffer();e.formatKey=function(f){var d=mt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),mt.aes._expandKey(f,!1)},e.formatSeed=function(f){var d=mt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),f},e.cipher=function(f,d){return mt.aes._updateBlock(f,d,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(f){return++f[3],f},e.md=mt.md.sha256;function i(){var f=mt.prng.create(e);return f.getBytes=function(d,p){return f.generate(d,p)},f.getBytesSync=function(d){return f.generate(d)},f}var s=i(),o=null,a=mt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(f){return c.getRandomValues(f)}),mt.options.usePureJavaScript||!mt.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(f){}s.collect(u),u=null}t&&(t().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),t().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!mt.random)mt.random=s;else for(var l in s)mt.random[l]=s[l];mt.random.createInstance=i,sl.exports=mt.random})(typeof jQuery!="undefined"?jQuery:null)})()});var vp=x(($5,mp)=>{var Ft=we();Fe();var ol=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],yp=[1,2,3,5],pC=function(t,e){return t<<e&65535|(t&65535)>>16-e},yC=function(t,e){return(t&65535)>>e|t<<16-e&65535};mp.exports=Ft.rc2=Ft.rc2||{};Ft.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Ft.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(ol[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,ol[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,ol[r.at(a+1)^r.at(a+s)]);return r};var gp=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,u,l,f=[];for(t=Ft.rc2.expandKey(t,e),u=0;u<64;u++)f.push(t.getInt16Le());r?(a=function(h){for(u=0;u<4;u++)h[u]+=f[l]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),h[u]=pC(h[u],yp[u]),l++},c=function(h){for(u=0;u<4;u++)h[u]+=f[h[(u+3)%4]&63]}):(a=function(h){for(u=3;u>=0;u--)h[u]=yC(h[u],yp[u]),h[u]-=f[l]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),l--},c=function(h){for(u=3;u>=0;u--)h[u]-=f[h[(u+3)%4]&63]});var d=function(h){var g=[];for(u=0;u<4;u++){var v=i.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),g.push(v&65535)}l=r?0:63;for(var A=0;A<h.length;A++)for(var B=0;B<h[A][0];B++)h[A][1](g);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},p=null;return p={start:function(h,g){h&&typeof h=="string"&&(h=Ft.util.createBuffer(h)),n=!1,i=Ft.util.createBuffer(),s=g||new Ft.util.createBuffer,o=h,p.output=s},update:function(h){for(n||i.putBuffer(h);i.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(h){var g=!0;if(r)if(h)g=h(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,p.update()),!r&&(g=i.length()===0,g))if(h)g=h(8,s,!r);else{var A=s.length(),B=s.at(A-1);B>A?g=!1:s.truncate(B)}return g}},p};Ft.rc2.startEncrypting=function(t,e,r){var n=Ft.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Ft.rc2.createEncryptionCipher=function(t,e){return gp(t,e,!0)};Ft.rc2.startDecrypting=function(t,e,r){var n=Ft.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Ft.rc2.createDecryptionCipher=function(t,e){return gp(t,e,!1)}});var Wa=x((H5,Cp)=>{var al=we();Cp.exports=al.jsbn=al.jsbn||{};var Jr,gC=244837814094590,bp=(gC&16777215)==15715070;function K(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}al.jsbn.BigInteger=K;function Te(){return new K(null)}function mC(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function vC(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=c&1073741823}return i}function wp(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+r.data[n]+i,i=(c>>28)+(l>>14)+a*u,r.data[n++]=c&268435455}return i}typeof navigator=="undefined"?(K.prototype.am=wp,Jr=28):bp&&navigator.appName=="Microsoft Internet Explorer"?(K.prototype.am=vC,Jr=30):bp&&navigator.appName!="Netscape"?(K.prototype.am=mC,Jr=26):(K.prototype.am=wp,Jr=28);K.prototype.DB=Jr;K.prototype.DM=(1<<Jr)-1;K.prototype.DV=1<<Jr;var cl=52;K.prototype.FV=Math.pow(2,cl);K.prototype.F1=cl-Jr;K.prototype.F2=2*Jr-cl;var bC="0123456789abcdefghijklmnopqrstuvwxyz",za=new Array,Zi,er;Zi="0".charCodeAt(0);for(er=0;er<=9;++er)za[Zi++]=er;Zi="a".charCodeAt(0);for(er=10;er<36;++er)za[Zi++]=er;Zi="A".charCodeAt(0);for(er=10;er<36;++er)za[Zi++]=er;function Ep(t){return bC.charAt(t)}function xp(t,e){var r=za[t.charCodeAt(e)];return r??-1}function wC(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function EC(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function _n(t){var e=Te();return e.fromInt(t),e}function xC(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:xp(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&K.ZERO.subTo(this,this)}function SC(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function AC(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Ep(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Ep(n));return i?s:"0"}function _C(){var t=Te();return K.ZERO.subTo(this,t),t}function CC(){return this.s<0?this.negate():this}function IC(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Ga(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function TC(){return this.t<=0?0:this.DB*(this.t-1)+Ga(this.data[this.t-1]^this.s&this.DM)}function RC(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function BC(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function PC(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function NC(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function OC(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function DC(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&K.ZERO.subTo(e,e)}function kC(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function LC(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Te());var s=Te(),o=this.s,a=t.s,c=this.DB-Ga(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var f=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),d=this.FV/f,p=(1<<this.F1)/f,h=1<<this.F2,g=r.t,v=g-u,A=e??Te();for(s.dlShiftTo(v,A),r.compareTo(A)>=0&&(r.data[r.t++]=1,r.subTo(A,r)),K.ONE.dlShiftTo(u,A),A.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--v>=0;){var B=r.data[--g]==l?this.DM:Math.floor(r.data[g]*d+(r.data[g-1]+h)*p);if((r.data[g]+=s.am(0,B,r,v,0,u))<B)for(s.dlShiftTo(v,A),r.subTo(A,r);r.data[g]<--B;)r.subTo(A,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&K.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&K.ZERO.subTo(r,r)}}}function qC(t){var e=Te();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(K.ZERO)>0&&t.subTo(e,e),e}function ii(t){this.m=t}function UC(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function MC(t){return t}function FC(t){t.divRemTo(this.m,null,t)}function KC(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function VC(t,e){t.squareTo(e),this.reduce(e)}ii.prototype.convert=UC;ii.prototype.revert=MC;ii.prototype.reduce=FC;ii.prototype.mulTo=KC;ii.prototype.sqrTo=VC;function jC(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function si(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function $C(t){var e=Te();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(K.ZERO)>0&&this.m.subTo(e,e),e}function HC(t){var e=Te();return t.copyTo(e),this.reduce(e),e}function zC(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function GC(t,e){t.squareTo(e),this.reduce(e)}function WC(t,e,r){t.multiplyTo(e,r),this.reduce(r)}si.prototype.convert=$C;si.prototype.revert=HC;si.prototype.reduce=zC;si.prototype.mulTo=WC;si.prototype.sqrTo=GC;function YC(){return(this.t>0?this.data[0]&1:this.s)==0}function QC(t,e){if(t>4294967295||t<1)return K.ONE;var r=Te(),n=Te(),i=e.convert(this),s=Ga(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function XC(t,e){var r;return t<256||e.isEven()?r=new ii(e):r=new si(e),this.exp(t,r)}K.prototype.copyTo=wC;K.prototype.fromInt=EC;K.prototype.fromString=xC;K.prototype.clamp=SC;K.prototype.dlShiftTo=RC;K.prototype.drShiftTo=BC;K.prototype.lShiftTo=PC;K.prototype.rShiftTo=NC;K.prototype.subTo=OC;K.prototype.multiplyTo=DC;K.prototype.squareTo=kC;K.prototype.divRemTo=LC;K.prototype.invDigit=jC;K.prototype.isEven=YC;K.prototype.exp=QC;K.prototype.toString=AC;K.prototype.negate=_C;K.prototype.abs=CC;K.prototype.compareTo=IC;K.prototype.bitLength=TC;K.prototype.mod=qC;K.prototype.modPowInt=XC;K.ZERO=_n(0);K.ONE=_n(1);function ZC(){var t=Te();return this.copyTo(t),t}function JC(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function eI(){return this.t==0?this.s:this.data[0]<<24>>24}function tI(){return this.t==0?this.s:this.data[0]<<16>>16}function rI(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function nI(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function iI(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=_n(r),i=Te(),s=Te(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function sI(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=xp(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&K.ZERO.subTo(this,this)}function oI(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(K.ONE.shiftLeft(t-1),ul,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(K.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function aI(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function cI(t){return this.compareTo(t)==0}function uI(t){return this.compareTo(t)<0?this:t}function lI(t){return this.compareTo(t)>0?this:t}function fI(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function dI(t,e){return t&e}function hI(t){var e=Te();return this.bitwiseTo(t,dI,e),e}function ul(t,e){return t|e}function pI(t){var e=Te();return this.bitwiseTo(t,ul,e),e}function Sp(t,e){return t^e}function yI(t){var e=Te();return this.bitwiseTo(t,Sp,e),e}function Ap(t,e){return t&~e}function gI(t){var e=Te();return this.bitwiseTo(t,Ap,e),e}function mI(){for(var t=Te(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function vI(t){var e=Te();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bI(t){var e=Te();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function wI(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function EI(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+wI(this.data[t]);return this.s<0?this.t*this.DB:-1}function xI(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function SI(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=xI(this.data[r]^e);return t}function AI(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function _I(t,e){var r=K.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function CI(t){return this.changeBit(t,ul)}function II(t){return this.changeBit(t,Ap)}function TI(t){return this.changeBit(t,Sp)}function RI(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function BI(t){var e=Te();return this.addTo(t,e),e}function PI(t){var e=Te();return this.subTo(t,e),e}function NI(t){var e=Te();return this.multiplyTo(t,e),e}function OI(t){var e=Te();return this.divRemTo(t,e,null),e}function DI(t){var e=Te();return this.divRemTo(t,null,e),e}function kI(t){var e=Te(),r=Te();return this.divRemTo(t,e,r),new Array(e,r)}function LI(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function qI(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function go(){}function _p(t){return t}function UI(t,e,r){t.multiplyTo(e,r)}function MI(t,e){t.squareTo(e)}go.prototype.convert=_p;go.prototype.revert=_p;go.prototype.mulTo=UI;go.prototype.sqrTo=MI;function FI(t){return this.exp(t,new go)}function KI(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function VI(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Ji(t){this.r2=Te(),this.q3=Te(),K.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function jI(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Te();return t.copyTo(e),this.reduce(e),e}function $I(t){return t}function HI(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function zI(t,e){t.squareTo(e),this.reduce(e)}function GI(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ji.prototype.convert=jI;Ji.prototype.revert=$I;Ji.prototype.reduce=HI;Ji.prototype.mulTo=GI;Ji.prototype.sqrTo=zI;function WI(t,e){var r=t.bitLength(),n,i=_n(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new ii(e):e.isEven()?s=new Ji(e):s=new si(e);var o=new Array,a=3,c=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var l=Te();for(s.sqrTo(o[1],l);a<=u;)o[a]=Te(),s.mulTo(l,o[a-2],o[a]),a+=2}var f=t.t-1,d,p=!0,h=Te(),g;for(r=Ga(t.data[f])-1;f>=0;){for(r>=c?d=t.data[f]>>r-c&u:(d=(t.data[f]&(1<<r+1)-1)<<c-r,f>0&&(d|=t.data[f-1]>>this.DB+r-c)),a=n;(d&1)==0;)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--f),p)o[d].copyTo(i),p=!1;else{for(;a>1;)s.sqrTo(i,h),s.sqrTo(h,i),a-=2;a>0?s.sqrTo(i,h):(g=i,i=h,h=g),s.mulTo(h,o[d],i)}for(;f>=0&&(t.data[f]&1<<r)==0;)s.sqrTo(i,h),g=i,i=h,h=g,--r<0&&(r=this.DB-1,--f)}return s.revert(i)}function YI(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function QI(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function XI(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return K.ZERO;for(var r=t.clone(),n=this.clone(),i=_n(1),s=_n(0),o=_n(0),a=_n(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo(K.ONE)!=0)return K.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var gr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],ZI=(1<<26)/gr[gr.length-1];function JI(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=gr[gr.length-1]){for(e=0;e<gr.length;++e)if(r.data[0]==gr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<gr.length;){for(var n=gr[e],i=e+1;i<gr.length&&n<ZI;)n*=gr[i++];for(n=r.modInt(n);e<i;)if(n%gr[e++]==0)return!1}return r.millerRabin(t)}function eT(t){var e=this.subtract(K.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=tT(),s,o=0;o<t;++o){do s=new K(this.bitLength(),i);while(s.compareTo(K.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo(K.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(K.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function tT(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}K.prototype.chunkSize=rI;K.prototype.toRadix=iI;K.prototype.fromRadix=sI;K.prototype.fromNumber=oI;K.prototype.bitwiseTo=fI;K.prototype.changeBit=_I;K.prototype.addTo=RI;K.prototype.dMultiply=LI;K.prototype.dAddOffset=qI;K.prototype.multiplyLowerTo=KI;K.prototype.multiplyUpperTo=VI;K.prototype.modInt=QI;K.prototype.millerRabin=eT;K.prototype.clone=ZC;K.prototype.intValue=JC;K.prototype.byteValue=eI;K.prototype.shortValue=tI;K.prototype.signum=nI;K.prototype.toByteArray=aI;K.prototype.equals=cI;K.prototype.min=uI;K.prototype.max=lI;K.prototype.and=hI;K.prototype.or=pI;K.prototype.xor=yI;K.prototype.andNot=gI;K.prototype.not=mI;K.prototype.shiftLeft=vI;K.prototype.shiftRight=bI;K.prototype.getLowestSetBit=EI;K.prototype.bitCount=SI;K.prototype.testBit=AI;K.prototype.setBit=CI;K.prototype.clearBit=II;K.prototype.flipBit=TI;K.prototype.add=BI;K.prototype.subtract=PI;K.prototype.multiply=NI;K.prototype.divide=OI;K.prototype.remainder=DI;K.prototype.divideAndRemainder=kI;K.prototype.modPow=WI;K.prototype.modInverse=XI;K.prototype.pow=FI;K.prototype.gcd=YI;K.prototype.isProbablePrime=JI});var Pp=x((z5,Bp)=>{var Br=we();An();Fe();var Ip=Bp.exports=Br.sha1=Br.sha1||{};Br.md.sha1=Br.md.algorithms.sha1=Ip;Ip.create=function(){Tp||rT();var t=null,e=Br.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=Br.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Br.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),Rp(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Br.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(ll.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Rp(f,r,i);var d=Br.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},n};var ll=null,Tp=!1;function rT(){ll=String.fromCharCode(128),ll+=Br.util.fillString(String.fromCharCode(0),64),Tp=!0}function Rp(t,e,r){for(var n,i,s,o,a,c,u,l,f=r.length();f>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)n=r.getInt32(),e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<20;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<32;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<40;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<60;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<80;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,f-=64}}});var Dp=x((G5,Op)=>{var Pr=we();Fe();ni();Pp();var Np=Op.exports=Pr.pkcs1=Pr.pkcs1||{};Np.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=Pr.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var l=s.digest(),f="",d=c-e.length,p=0;p<d;p++)f+="\0";var h=l.getBytes()+f+""+e;if(!i)i=Pr.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var g=Ya(i,a-s.digestLength-1,o),v=Pr.util.xorBytes(h,g,h.length),A=Ya(v,s.digestLength,o),B=Pr.util.xorBytes(i,A,i.length);return"\0"+B+v};Np.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=o,v}if(i===void 0?i=Pr.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),u=e.substring(1,i.digestLength+1),l=e.substring(1+i.digestLength),f=Ya(l,i.digestLength,s),d=Pr.util.xorBytes(u,f,u.length),p=Ya(d,o-i.digestLength-1,s),h=Pr.util.xorBytes(l,p,l.length),g=h.substring(0,i.digestLength),v=c!=="\0",A=0;A<i.digestLength;++A)v|=a.charAt(A)!==g.charAt(A);for(var B=1,k=i.digestLength,z=i.digestLength;z<h.length;z++){var q=h.charCodeAt(z),L=q&1^1,te=B?65534:0;v|=q&te,B=B&L,k+=B}if(v||h.charCodeAt(k)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(k+1)};function Ya(t,e,r){r||(r=Pr.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var kp=x((W5,fl)=>{var Cn=we();Fe();Wa();ni();(function(){if(Cn.prime){fl.exports=Cn.prime;return}var t=fl.exports=Cn.prime=Cn.prime||{},e=Cn.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(f,d){return f|d};t.generateProbablePrime=function(f,d,p){typeof d=="function"&&(p=d,d={}),d=d||{};var h=d.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=d.prng||Cn.random,v={nextBytes:function(A){for(var B=g.getBytesSync(A.length),k=0;k<A.length;++k)A[k]=B.charCodeAt(k)}};if(h.name==="PRIMEINC")return s(f,v,h.options,p);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(f,d,p,h){return"workers"in p?c(f,d,p,h):o(f,d,p,h)}function o(f,d,p,h){var g=u(f,d),v=0,A=l(g.bitLength());"millerRabinTests"in p&&(A=p.millerRabinTests);var B=10;"maxBlockTime"in p&&(B=p.maxBlockTime),a(g,f,d,v,A,B,h)}function a(f,d,p,h,g,v,A){var B=+new Date;do{if(f.bitLength()>d&&(f=u(d,p)),f.isProbablePrime(g))return A(null,f);f.dAddOffset(r[h++%8],0)}while(v<0||+new Date-B<v);Cn.util.setImmediate(function(){a(f,d,p,h,g,v,A)})}function c(f,d,p,h){if(typeof Worker=="undefined")return o(f,d,p,h);var g=u(f,d),v=p.workers,A=p.workLoad||100,B=A*30/8,k=p.workerScript||"forge/prime.worker.js";if(v===-1)return Cn.util.estimateCores(function(q,L){q&&(L=2),v=L-1,z()});z();function z(){v=Math.max(1,v);for(var q=[],L=0;L<v;++L)q[L]=new Worker(k);for(var te=v,L=0;L<v;++L)q[L].addEventListener("message",j);var se=!1;function j(Ae){if(!se){--te;var ge=Ae.data;if(ge.found){for(var pe=0;pe<q.length;++pe)q[pe].terminate();return se=!0,h(null,new e(ge.prime,16))}g.bitLength()>f&&(g=u(f,d));var Xe=g.toString(16);Ae.target.postMessage({hex:Xe,workLoad:A}),g.dAddOffset(B,0)}}}}function u(f,d){var p=new e(f,d),h=f-1;return p.testBit(h)||p.bitwiseTo(e.ONE.shiftLeft(h),i,p),p.dAddOffset(31-p.mod(n).byteValue(),0),p}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})()});var mo=x((Y5,Vp)=>{var fe=we();Sn();Wa();Gi();Dp();kp();ni();Fe();typeof Se=="undefined"&&(Se=fe.jsbn.BigInteger);var Se,dl=fe.util.isNodejs?Xi():null,D=fe.asn1,tr=fe.util;fe.pki=fe.pki||{};Vp.exports=fe.pki.rsa=fe.rsa=fe.rsa||{};var de=fe.pki,nT=[6,4,2,4,2,4,6,2],iT={name:"PrivateKeyInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},sT={name:"RSAPrivateKey",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},oT={name:"RSAPublicKey",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},aT=fe.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:D.Class.UNIVERSAL,type:D.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},cT=function(t){var e;if(t.algorithm in de.oids)e=de.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=D.oidToDer(e).getBytes(),i=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]),s=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[]);s.value.push(D.create(D.Class.UNIVERSAL,D.Type.OID,!1,n)),s.value.push(D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,""));var o=D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),D.toDer(i).getBytes()},Lp=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Se.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Se.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Se(fe.util.bytesToHex(fe.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Se.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};de.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=qp(t,e,r)):(i=fe.util.createBuffer(),i.putBytes(t));for(var o=new Se(i.toHex(),16),a=Lp(o,e,n),c=a.toString(16),u=fe.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(fe.util.hexToBytes(c)),u.getBytes()};de.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new Se(fe.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Lp(o,e,r),c=a.toString(16),u=fe.util.createBuffer(),l=i-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(fe.util.hexToBytes(c)),n!==!1?Qa(u.getBytes(),e,r):u.getBytes()};de.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||fe.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new Se(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};de.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Se(null);r.fromInt(30);for(var n=0,i=function(f,d){return f|d},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new Se(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Se.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(lT(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(nT[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Se.ONE).gcd(t.e).compareTo(Se.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Se.ONE),t.q1=t.q.subtract(Se.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Se.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:de.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:de.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};de.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!fe.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Up("generateKeyPair"))return dl.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:de.privateKeyFromPem(u),publicKey:de.publicKeyFromPem(c)})});if(Mp("generateKey")&&Mp("exportKey"))return tr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Kp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return tr.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=de.privateKeyFromAsn1(D.fromDer(fe.util.createBuffer(a)));n(null,{privateKey:c,publicKey:de.setRsaPublicKey(c.n,c.e)})}});if(Fp("generateKey")&&Fp("exportKey")){var i=tr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Kp(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,u=tr.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var f=l.target.result,d=de.privateKeyFromAsn1(D.fromDer(fe.util.createBuffer(f)));n(null,{privateKey:d,publicKey:de.setRsaPublicKey(d.n,d.e)})},u.onerror=function(l){n(l)}},i.onerror=function(a){n(a)};return}}else if(Up("generateKeyPairSync")){var s=dl.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:de.privateKeyFromPem(s.privateKey),publicKey:de.publicKeyFromPem(s.publicKey)}}}var o=de.rsa.createKeyPairGenerationState(t,e,r);if(!n)return de.rsa.stepKeyPairGenerationState(o,0),o.keys;uT(o,r,n)};de.setRsaPublicKey=de.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,u){return qp(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return fe.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return de.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=Qa(c,r,!0);var u=D.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=Qa(c,r,!0),a===c}});var o=de.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};de.setRsaPrivateKey=de.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var d=de.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:Qa};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,h){return fe.pkcs1.decode_rsa_oaep(h,p,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(d,c,!1)},c.sign=function(u,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:cT},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},f=1);var d=l.encode(u,c.n.bitLength());return de.rsa.encrypt(d,c,f)},c};de.wrapRsaPrivateKey=function(t){return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(0).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(de.oids.rsaEncryption).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")]),D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(t).getBytes())])};de.privateKeyFromAsn1=function(t){var e={},r=[];if(D.validate(t,iT,e,r)&&(t=D.fromDer(fe.util.createBuffer(e.privateKey))),e={},r=[],!D.validate(t,sT,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,u,l,f;return i=fe.util.createBuffer(e.privateKeyModulus).toHex(),s=fe.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=fe.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=fe.util.createBuffer(e.privateKeyPrime1).toHex(),c=fe.util.createBuffer(e.privateKeyPrime2).toHex(),u=fe.util.createBuffer(e.privateKeyExponent1).toHex(),l=fe.util.createBuffer(e.privateKeyExponent2).toHex(),f=fe.util.createBuffer(e.privateKeyCoefficient).toHex(),de.setRsaPrivateKey(new Se(i,16),new Se(s,16),new Se(o,16),new Se(a,16),new Se(c,16),new Se(u,16),new Se(l,16),new Se(f,16))};de.privateKeyToAsn1=de.privateKeyToRSAPrivateKey=function(t){return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(0).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.n)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.e)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.d)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.p)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.q)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.dP)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.dQ)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.qInv))])};de.publicKeyFromAsn1=function(t){var e={},r=[];if(D.validate(t,aT,e,r)){var n=D.derToOid(e.publicKeyOid);if(n!==de.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!D.validate(t,oT,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=fe.util.createBuffer(e.publicKeyModulus).toHex(),o=fe.util.createBuffer(e.publicKeyExponent).toHex();return de.setRsaPublicKey(new Se(s,16),new Se(o,16))};de.publicKeyToAsn1=de.publicKeyToSubjectPublicKeyInfo=function(t){return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(de.oids.rsaEncryption).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")]),D.create(D.Class.UNIVERSAL,D.Type.BITSTRING,!1,[de.publicKeyToRSAPublicKey(t)])])};de.publicKeyToRSAPublicKey=function(t){return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.n)),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,Nr(t.e))])};function qp(t,e,r){var n=fe.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var u=0,l=fe.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function Qa(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=fe.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function uT(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){fe.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Se.ONE).gcd(t.e).compareTo(Se.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Se.ONE).gcd(t.e).compareTo(Se.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Se.ONE),t.q1=t.q.subtract(Se.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Se.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:de.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:de.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Nr(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=fe.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function lT(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Up(t){return fe.util.isNodejs&&typeof dl[t]=="function"}function Mp(t){return typeof tr.globalScope!="undefined"&&typeof tr.globalScope.crypto=="object"&&typeof tr.globalScope.crypto.subtle=="object"&&typeof tr.globalScope.crypto.subtle[t]=="function"}function Fp(t){return typeof tr.globalScope!="undefined"&&typeof tr.globalScope.msCrypto=="object"&&typeof tr.globalScope.msCrypto.subtle=="object"&&typeof tr.globalScope.msCrypto.subtle[t]=="function"}function Kp(t){for(var e=fe.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var hl=x((Q5,Gp)=>{var ee=we();Qi();Sn();Fa();An();Gi();nl();$a();ni();vp();mo();Fe();typeof jp=="undefined"&&(jp=ee.jsbn.BigInteger);var jp,U=ee.asn1,ye=ee.pki=ee.pki||{};Gp.exports=ye.pbe=ee.pbe=ee.pbe||{};var oi=ye.oids,fT={name:"EncryptedPrivateKeyInfo",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},dT={name:"PBES2Algorithms",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:U.Class.UNIVERSAL,type:U.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},hT={name:"pkcs-12PbeParams",tagClass:U.Class.UNIVERSAL,type:U.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:U.Class.UNIVERSAL,type:U.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:U.Class.UNIVERSAL,type:U.Type.INTEGER,constructed:!1,capture:"iterations"}]};ye.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=ee.random.getBytesSync(r.saltSize),i=r.count,s=U.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,f;switch(r.algorithm){case"aes128":o=16,u=16,l=oi["aes128-CBC"],f=ee.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=oi["aes192-CBC"],f=ee.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=oi["aes256-CBC"],f=ee.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=oi.desCBC,f=ee.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),h=zp(p),g=ee.pkcs5.pbkdf2(e,n,i,o,h),v=ee.random.getBytesSync(u),A=f(g);A.start(v),A.update(U.toDer(t)),A.finish(),c=A.output.getBytes();var B=pT(n,s,o,p);a=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(oi.pkcs5PBES2).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(oi.pkcs5PBKDF2).getBytes()),B]),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(l).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var k=new ee.util.ByteBuffer(n),g=ye.pbe.generatePkcs12Key(e,k,1,i,o),v=ye.pbe.generatePkcs12Key(e,k,2,i,o),A=ee.des.createEncryptionCipher(g);A.start(v),A.update(U.toDer(t)),A.finish(),c=A.output.getBytes(),a=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(oi["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,n),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var z=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[a,U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,c)]);return z};ye.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!U.validate(t,fT,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=U.derToOid(n.encryptionOid),a=ye.pbe.getCipher(o,n.encryptionParams,e),c=ee.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=U.fromDer(a.output)),r};ye.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:U.toDer(t).getBytes()};return ee.pem.encode(r,{maxline:e})};ye.encryptedPrivateKeyFromPem=function(t){var e=ee.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return U.fromDer(e.body)};ye.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=ye.wrapRsaPrivateKey(ye.privateKeyToAsn1(t));return n=ye.encryptPrivateKeyInfo(n,e,r),ye.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=ee.random.getBytesSync(16),a=ee.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=ee.random.getBytesSync(8),a=ee.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=ee.random.getBytesSync(8),a=ee.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=ee.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(U.toDer(ye.privateKeyToAsn1(t))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:ee.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return ee.pem.encode(f)};ye.decryptRsaPrivateKey=function(t,e){var r=null,n=ee.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=ee.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=ee.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=ee.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=ee.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=ee.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(f){return ee.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,o=function(f){return ee.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,o=function(f){return ee.rc2.createDecryptionCipher(f,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=ee.util.hexToBytes(n.dekInfo.parameters),c=ee.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(ee.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=ye.decryptPrivateKeyInfo(U.fromDer(r),e):r=U.fromDer(r),r!==null&&(r=ye.privateKeyFromAsn1(r)),r};ye.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in ee.md))throw new Error('"sha1" hash algorithm unavailable.');s=ee.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new ee.util.ByteBuffer,f=new ee.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)f.putInt16(t.charCodeAt(a));f.putInt16(0)}var d=f.length(),p=e.length(),h=new ee.util.ByteBuffer;h.fillWithByte(r,u);var g=u*Math.ceil(p/u),v=new ee.util.ByteBuffer;for(a=0;a<g;a++)v.putByte(e.at(a%p));var A=u*Math.ceil(d/u),B=new ee.util.ByteBuffer;for(a=0;a<A;a++)B.putByte(f.at(a%d));var k=v;k.putBuffer(B);for(var z=Math.ceil(i/c),q=1;q<=z;q++){var L=new ee.util.ByteBuffer;L.putBytes(h.bytes()),L.putBytes(k.bytes());for(var te=0;te<n;te++)s.start(),s.update(L.getBytes()),L=s.digest();var se=new ee.util.ByteBuffer;for(a=0;a<u;a++)se.putByte(L.at(a%c));var j=Math.ceil(p/u)+Math.ceil(d/u),Ae=new ee.util.ByteBuffer;for(o=0;o<j;o++){var ge=new ee.util.ByteBuffer(k.getBytes(u)),pe=511;for(a=se.length()-1;a>=0;a--)pe=pe>>8,pe+=se.at(a)+ge.at(a),ge.setAt(a,pe&255);Ae.putBuffer(ge)}k=Ae,l.putBuffer(L)}return l.truncate(l.length()-i),l};ye.pbe.getCipher=function(t,e,r){switch(t){case ye.oids.pkcs5PBES2:return ye.pbe.getCipherForPBES2(t,e,r);case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:return ye.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};ye.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!U.validate(e,dT,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=U.derToOid(n.kdfOid),t!==ye.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=U.derToOid(n.encOid),t!==ye.oids["aes128-CBC"]&&t!==ye.oids["aes192-CBC"]&&t!==ye.oids["aes256-CBC"]&&t!==ye.oids["des-EDE3-CBC"]&&t!==ye.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=ee.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(ye.oids[t]){case"aes128-CBC":c=16,u=ee.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=ee.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=ee.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=ee.des.createDecryptionCipher;break;case"desCBC":c=8,u=ee.des.createDecryptionCipher;break}var l=Hp(n.prfOid),f=ee.pkcs5.pbkdf2(r,o,a,c,l),d=n.encIv,p=u(f);return p.start(d),p};ye.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!U.validate(e,hT,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=ee.util.createBuffer(n.salt),a=ee.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case ye.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=ee.des.startDecrypting;break;case ye.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(g,v){var A=ee.rc2.createDecryptionCipher(g,40);return A.start(v,null),A};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var f=Hp(n.prfOid),d=ye.pbe.generatePkcs12Key(r,o,1,a,c,f);f.start();var p=ye.pbe.generatePkcs12Key(r,o,2,a,u,f);return l(d,p)};ye.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in ee.md))throw new Error('"md5" hash algorithm unavailable.');n=ee.md.md5.create()}e===null&&(e="");for(var i=[$p(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push($p(n,i[o-1]+t+e));return i.join("").substr(0,r)};function $p(t,e){return t.start().update(e).digest().getBytes()}function Hp(t){var e;if(!t)e="hmacWithSHA1";else if(e=ye.oids[U.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return zp(e)}function zp(t){var e=ee.md;switch(t){case"hmacWithSHA224":e=ee.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function pT(t,e,r,n){var i=U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OCTETSTRING,!1,t),U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(U.create(U.Class.UNIVERSAL,U.Type.INTEGER,!1,ee.util.hexToBytes(r.toString(16))),U.create(U.Class.UNIVERSAL,U.Type.SEQUENCE,!0,[U.create(U.Class.UNIVERSAL,U.Type.OID,!1,U.oidToDer(ye.oids[n]).getBytes()),U.create(U.Class.UNIVERSAL,U.Type.NULL,!1,"")])),i}});var pl={};ht(pl,{identity:()=>yT});var yT,Wp=Pe(()=>{Sr();pn();yT=xa({prefix:"\0",name:"identity",encode:t=>Id(t),decode:t=>Cd(t)})});var yl={};ht(yl,{base2:()=>gT});var gT,Yp=Pe(()=>{Sr();gT=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var gl={};ht(gl,{base8:()=>mT});var mT,Qp=Pe(()=>{Sr();mT=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var ml={};ht(ml,{base10:()=>vT});var vT,Xp=Pe(()=>{Sr();vT=yn({prefix:"9",name:"base10",alphabet:"0123456789"})});var vo,Zp,Xa=Pe(()=>{Vi();vo=({name:t,code:e,encode:r})=>new Zp(t,e,r),Zp=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}async digest(e){if(e instanceof Uint8Array){let r=await this.encode(e);return io(this.code,r)}else throw Error("Unknown type, must be binary type")}}});var In={};ht(In,{sha256:()=>bT,sha512:()=>wT});var ey,bT,wT,ai=Pe(()=>{Xa();ey=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),bT=vo({name:"sha2-256",code:18,encode:ey("SHA-256")}),wT=vo({name:"sha2-512",code:19,encode:ey("SHA-512")})});var bo={};ht(bo,{identity:()=>ET});var ET,Za=Pe(()=>{Xa();pn();ET=vo({name:"identity",code:0,encode:t=>Yr(t)})});var ty=Pe(()=>{pn()});var ak,ck,ry=Pe(()=>{ak=new TextEncoder,ck=new TextDecoder});var ny=Pe(()=>{$i();Ea();pn();Xa();Vi()});var vl,dk,iy=Pe(()=>{Wp();Yp();Qp();Xp();Pu();Zn();Bu();mn();co();ai();Za();ty();ry();ny();vl={...pl,...yl,...gl,...ml,...Ca,...Xn,..._a,...gn,...Hi},dk={...In,...bo}});function sy(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var oy,bl,AT,Ja,wl=Pe(()=>{iy();oy=sy("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),bl=sy("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),AT={utf8:oy,"utf-8":oy,hex:vl.base16,latin1:bl,ascii:bl,binary:bl,...vl},Ja=AT});var At={};ht(At,{fromString:()=>El});function El(t,e="utf8"){let r=Ja[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var Et=Pe(()=>{wl()});var Tn={};ht(Tn,{concat:()=>_T});function _T(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var Rn=Pe(()=>{});var wo=x(ay=>{"use strict";ay.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var xl=x((vk,uy)=>{"use strict";var{concat:CT}=(Rn(),Tn),{fromString:cy}=(Et(),At),IT=wo();function TT({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:s=32767}={}){let o=IT.get();r*=8;async function a(u,l){let f=o.getRandomValues(new Uint8Array(i)),d=o.getRandomValues(new Uint8Array(e)),p={name:t,iv:d},h={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},g=await o.subtle.importKey("raw",cy(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(h,g,{name:t,length:r},!0,["encrypt"]),A=await o.subtle.encrypt(p,v,u);return CT([f,p.iv,new Uint8Array(A)])}async function c(u,l){let f=u.slice(0,i),d=u.slice(i,i+e),p=u.slice(i+e),h={name:t,iv:d},g={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},v=await o.subtle.importKey("raw",cy(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),A=await o.subtle.deriveKey(g,v,{name:t,length:r},!0,["decrypt"]),B=await o.subtle.decrypt(h,A,p);return new Uint8Array(B)}return{encrypt:a,decrypt:c}}uy.exports={create:TT}});var fy=x((bk,ly)=>{"use strict";var{base64:RT}=(co(),Hi),BT=xl();ly.exports={import:async function(t,e){let r=RT.decode(t);return await BT.create().decrypt(r,e)}}});var Or={};ht(Or,{equals:()=>PT});function PT(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Dr=Pe(()=>{});var _t={};ht(_t,{toString:()=>Sl});function Sl(t,e="utf8"){let r=Ja[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var xt=Pe(()=>{wl()});var Cl=x((Ek,yy)=>{var je=we();An();Fe();var Eo=yy.exports=je.sha512=je.sha512||{};je.md.sha512=je.md.algorithms.sha512=Eo;var dy=je.sha384=je.sha512.sha384=je.sha512.sha384||{};dy.create=function(){return Eo.create("SHA-384")};je.md.sha384=je.md.algorithms.sha384=dy;je.sha512.sha256=je.sha512.sha256||{create:function(){return Eo.create("SHA-512/256")}};je.md["sha512/256"]=je.md.algorithms["sha512/256"]=je.sha512.sha256;je.sha512.sha224=je.sha512.sha224||{create:function(){return Eo.create("SHA-512/224")}};je.md["sha512/224"]=je.md.algorithms["sha512/224"]=je.sha512.sha224;Eo.create=function(t){if(hy||NT(),typeof t=="undefined"&&(t="SHA-512"),!(t in ci))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=ci[t],r=null,n=je.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=je.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=je.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=a.fullMessageLength.length-1;f>=0;--f)a.fullMessageLength[f]+=l[1],l[1]=l[0]+(a.fullMessageLength[f]/4294967296>>>0),a.fullMessageLength[f]=a.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return n.putBytes(c),py(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=je.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(Al.substr(0,a.blockLength-l));for(var f,d,p=a.fullMessageLength[0]*8,h=0;h<a.fullMessageLength.length-1;++h)f=a.fullMessageLength[h+1]*8,d=f/4294967296>>>0,p+=d,c.putInt32(p>>>0),p=f>>>0;c.putInt32(p);for(var g=new Array(r.length),h=0;h<r.length;++h)g[h]=r[h].slice(0);py(g,i,c);var v=je.util.createBuffer(),A;t==="SHA-512"?A=g.length:t==="SHA-384"?A=g.length-2:A=g.length-4;for(var h=0;h<A;++h)v.putInt32(g[h][0]),(h!==A-1||t!=="SHA-512/224")&&v.putInt32(g[h][1]);return v},a};var Al=null,hy=!1,_l=null,ci=null;function NT(){Al=String.fromCharCode(128),Al+=je.util.fillString(String.fromCharCode(0),128),_l=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],ci={},ci["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],ci["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],ci["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],ci["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],hy=!0}function py(t,e,r){for(var n,i,s,o,a,c,u,l,f,d,p,h,g,v,A,B,k,z,q,L,te,se,j,Ae,ge,pe,Xe,Ze,_e,qe,re,$t,Lt,Gr,qt,$=r.length();$>=128;){for(_e=0;_e<16;++_e)e[_e][0]=r.getInt32()>>>0,e[_e][1]=r.getInt32()>>>0;for(;_e<80;++_e)$t=e[_e-2],qe=$t[0],re=$t[1],n=((qe>>>19|re<<13)^(re>>>29|qe<<3)^qe>>>6)>>>0,i=((qe<<13|re>>>19)^(re<<3|qe>>>29)^(qe<<26|re>>>6))>>>0,Gr=e[_e-15],qe=Gr[0],re=Gr[1],s=((qe>>>1|re<<31)^(qe>>>8|re<<24)^qe>>>7)>>>0,o=((qe<<31|re>>>1)^(qe<<24|re>>>8)^(qe<<25|re>>>7))>>>0,Lt=e[_e-7],qt=e[_e-16],re=i+Lt[1]+o+qt[1],e[_e][0]=n+Lt[0]+s+qt[0]+(re/4294967296>>>0)>>>0,e[_e][1]=re>>>0;for(g=t[0][0],v=t[0][1],A=t[1][0],B=t[1][1],k=t[2][0],z=t[2][1],q=t[3][0],L=t[3][1],te=t[4][0],se=t[4][1],j=t[5][0],Ae=t[5][1],ge=t[6][0],pe=t[6][1],Xe=t[7][0],Ze=t[7][1],_e=0;_e<80;++_e)u=((te>>>14|se<<18)^(te>>>18|se<<14)^(se>>>9|te<<23))>>>0,l=((te<<18|se>>>14)^(te<<14|se>>>18)^(se<<23|te>>>9))>>>0,f=(ge^te&(j^ge))>>>0,d=(pe^se&(Ae^pe))>>>0,a=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,c=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,p=(g&A|k&(g^A))>>>0,h=(v&B|z&(v^B))>>>0,re=Ze+l+d+_l[_e][1]+e[_e][1],n=Xe+u+f+_l[_e][0]+e[_e][0]+(re/4294967296>>>0)>>>0,i=re>>>0,re=c+h,s=a+p+(re/4294967296>>>0)>>>0,o=re>>>0,Xe=ge,Ze=pe,ge=j,pe=Ae,j=te,Ae=se,re=L+i,te=q+n+(re/4294967296>>>0)>>>0,se=re>>>0,q=k,L=z,k=A,z=B,A=g,B=v,re=i+o,g=n+s+(re/4294967296>>>0)>>>0,v=re>>>0;re=t[0][1]+v,t[0][0]=t[0][0]+g+(re/4294967296>>>0)>>>0,t[0][1]=re>>>0,re=t[1][1]+B,t[1][0]=t[1][0]+A+(re/4294967296>>>0)>>>0,t[1][1]=re>>>0,re=t[2][1]+z,t[2][0]=t[2][0]+k+(re/4294967296>>>0)>>>0,t[2][1]=re>>>0,re=t[3][1]+L,t[3][0]=t[3][0]+q+(re/4294967296>>>0)>>>0,t[3][1]=re>>>0,re=t[4][1]+se,t[4][0]=t[4][0]+te+(re/4294967296>>>0)>>>0,t[4][1]=re>>>0,re=t[5][1]+Ae,t[5][0]=t[5][0]+j+(re/4294967296>>>0)>>>0,t[5][1]=re>>>0,re=t[6][1]+pe,t[6][0]=t[6][0]+ge+(re/4294967296>>>0)>>>0,t[6][1]=re>>>0,re=t[7][1]+Ze,t[7][0]=t[7][0]+Xe+(re/4294967296>>>0)>>>0,t[7][1]=re>>>0,$-=128}}});var my=x((xk,gy)=>{"use strict";var ec=65536;function OT(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>ec)for(;r<t;)r+ec>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+ec)),r+=ec);else crypto.getRandomValues(e);return e}gy.exports=OT});var tc=x((Sk,vy)=>{"use strict";var DT=my(),kT=he();vy.exports=function(t){if(isNaN(t)||t<=0)throw kT(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return DT(t)}});var rc=x(xo=>{"use strict";Fe();Wa();var LT=we(),{fromString:qT}=(Et(),At),{toString:by}=(xt(),_t),{concat:wy}=(Rn(),Tn);xo.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=wy([new Uint8Array(e-r.length),r])}return by(r,"base64url")};xo.base64urlToBigInteger=t=>{let e=xo.base64urlToBuffer(t);return new LT.jsbn.BigInteger(by(e,"base16"),16)};xo.base64urlToBuffer=(t,e)=>{let r=qT(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=wy([new Uint8Array(e-r.length),r])}return r}});var Sy=x(So=>{"use strict";Sn();mo();var Bn=we(),{bigIntegerToUintBase64url:kr,base64urlToBigInteger:Lr}=rc(),{fromString:Ey}=(Et(),At),{toString:xy}=(xt(),_t);So.pkcs1ToJwk=function(t){let e=Bn.asn1.fromDer(xy(t,"ascii")),r=Bn.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:kr(r.n),e:kr(r.e),d:kr(r.d),p:kr(r.p),q:kr(r.q),dp:kr(r.dP),dq:kr(r.dQ),qi:kr(r.qInv),alg:"RS256",kid:"2011-04-29"}};So.jwkToPkcs1=function(t){let e=Bn.pki.privateKeyToAsn1({n:Lr(t.n),e:Lr(t.e),d:Lr(t.d),p:Lr(t.p),q:Lr(t.q),dP:Lr(t.dp),dQ:Lr(t.dq),qInv:Lr(t.qi)});return Ey(Bn.asn1.toDer(e).getBytes(),"ascii")};So.pkixToJwk=function(t){let e=Bn.asn1.fromDer(xy(t,"ascii")),r=Bn.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:kr(r.n),e:kr(r.e),alg:"RS256",kid:"2011-04-29"}};So.jwkToPkix=function(t){let e=Bn.pki.publicKeyToAsn1({n:Lr(t.n),e:Lr(t.e)});return Ey(Bn.asn1.toDer(e).getBytes(),"ascii")}});var Iy=x((Ck,Cy)=>{"use strict";mo();var Ay=we(),{base64urlToBigInteger:UT}=rc();function _y(t,e){return e.map(r=>UT(t[r]))}function MT(t){return Ay.pki.setRsaPrivateKey(..._y(t,["n","e","d","p","q","dp","dq","qi"]))}function FT(t){return Ay.pki.setRsaPublicKey(..._y(t,["n","e"]))}Cy.exports={jwk2pub:FT,jwk2priv:MT}});var By=x(tn=>{"use strict";var en=wo(),KT=tc(),{toString:VT}=(xt(),_t),{fromString:jT}=(Et(),At);tn.utils=Sy();tn.generateKey=async function(t){let e=await en.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Ty(e);return{privateKey:r[0],publicKey:r[1]}};tn.unmarshalPrivateKey=async function(t){let r=[await en.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await $T(t)],n=await Ty({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};tn.getRandomValues=KT;tn.hashAndSign=async function(t,e){let r=await en.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await en.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};tn.hashAndVerify=async function(t,e,r){let n=await en.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return en.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function Ty(t){return Promise.all([en.get().subtle.exportKey("jwk",t.privateKey),en.get().subtle.exportKey("jwk",t.publicKey)])}function $T(t){return en.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:HT,jwk2priv:zT}=Iy();function Ry(t,e,r,n){let i=e?HT(t):zT(t),s=VT(Uint8Array.from(r),"ascii"),o=n(s,i);return jT(o,"ascii")}tn.encrypt=function(t,e){return Ry(t,!0,e,(r,n)=>n.encrypt(r))};tn.decrypt=function(t,e){return Ry(t,!1,e,(r,n)=>n.decrypt(r))}});var nc=x((Tk,Py)=>{"use strict";var{base64:GT}=(co(),Hi),WT=xl();Py.exports={export:async function(t,e){let n=await WT.create().encrypt(t,e);return GT.encode(n)}}});var Ly=x((Rk,ky)=>{"use strict";var{sha256:Ny}=(ai(),In),Oy=he(),{equals:Dy}=(Dr(),Or),{toString:YT}=(xt(),_t);Cl();var ic=we(),rr=By(),sc=Na(),QT=nc(),oc=class{constructor(e){this._key=e}async verify(e,r){return rr.hashAndVerify(this._key,r,e)}marshal(){return rr.utils.jwkToPkix(this._key)}get bytes(){return sc.PublicKey.encode({Type:sc.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return rr.encrypt(this._key,e)}equals(e){return Dy(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ny.digest(this.bytes);return e}},Ao=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return rr.getRandomValues(16)}async sign(e){return rr.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw Oy(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new oc(this._publicKey)}decrypt(e){return rr.decrypt(this._key,e)}marshal(){return rr.utils.jwkToPkcs1(this._key)}get bytes(){return sc.PrivateKey.encode({Type:sc.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return Dy(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Ny.digest(this.bytes);return e}async id(){let e=await this.public.hash();return YT(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new ic.util.ByteBuffer(this.marshal()),i=ic.asn1.fromDer(n),s=ic.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return ic.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return QT.export(this.bytes,e);throw Oy(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function XT(t){let e=rr.utils.pkcs1ToJwk(t),r=await rr.unmarshalPrivateKey(e);return new Ao(r.privateKey,r.publicKey)}function ZT(t){let e=rr.utils.pkixToJwk(t);return new oc(e)}async function JT(t){let e=await rr.unmarshalPrivateKey(t);return new Ao(e.privateKey,e.publicKey)}async function eR(t){let e=await rr.generateKey(t);return new Ao(e.privateKey,e.publicKey)}ky.exports={RsaPublicKey:oc,RsaPrivateKey:Ao,unmarshalRsaPublicKey:ZT,unmarshalRsaPrivateKey:XT,generateKeyPair:eR,fromJwk:JT}});var $y=x((Ge,jy)=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.utils=Ge.verify=Ge.sign=Ge.getPublicKey=Ge.SignResult=Ge.Signature=Ge.Point=Ge.ExtendedPoint=Ge.CURVE=void 0;var Je={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,P:2n**255n-19n,n:2n**252n+27742317777372353535851937790883648493n,h:8n,Gx:15112221349535400772501151409588531511454012693041857206046113283949847762202n,Gy:46316835694926478169428394003475163141307993866256225615783033603165251855960n};Ge.CURVE=Je;var Ot=32,_o=19681161376707505956807079304988542015446066515923890162744021073123829784752n,tR=25063068953384623474111414158702152701244531502492656460079210482610430750235n,rR=54469307008909316920995813868745141605393597292927456921205312896311721017578n,nR=1159843021668779879193775521855586647937357759715417654439879720876111806838n,iR=40440834346308536858101042469323190826248399146238708352240133220865137265952n,Me=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof ze))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ze.ZERO)?Me.ZERO:new Me(e.x,e.y,1n,V(e.x*e.y))}static toAffineBatch(e){let r=oR(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}static fromRistrettoHash(e){let r=Rl(e.slice(0,Ot)),n=this.calcElligatorRistrettoMap(r),i=Rl(e.slice(Ot,Ot*2)),s=this.calcElligatorRistrettoMap(i);return n.add(s)}static calcElligatorRistrettoMap(e){let{d:r}=Je,n=V(_o*e*e),i=V((n+1n)*nR),s=-1n,o=V((s-r*n)*V(n+r)),{isValid:a,value:c}=Pl(i,o),u=V(c*e);Nn(u)||(u=V(-u)),a||(c=u),a||(s=n);let l=V(s*(n-1n)*iR-o),f=c*c,d=V((c+c)*o),p=V(l*tR),h=V(1n-f),g=V(1n+f);return new Me(V(d*g),V(h*p),V(p*g),V(d*h))}static fromRistrettoBytes(e){let{a:r,d:n}=Je,i="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",s=Rl(e);if(!uR(Uy(s,Ot),e)||Nn(s))throw new Error(i);let o=V(s*s),a=V(1n+r*o),c=V(1n-r*o),u=V(a*a),l=V(c*c),f=V(r*n*u-l),{isValid:d,value:p}=Fy(V(f*l)),h=V(p*c),g=V(p*h*f),v=V((s+s)*h);Nn(v)&&(v=V(-v));let A=V(a*g),B=V(v*A);if(!d||Nn(B)||A===0n)throw new Error(i);return new Me(v,A,1n,B)}toRistrettoBytes(){let{x:e,y:r,z:n,t:i}=this,s=V((n+r)*(n-r)),o=V(e*r),{value:a}=Fy(V(s*o**2n)),c=V(a*s),u=V(a*o),l=V(c*u*i),f;Nn(i*l)?([e,r]=[V(r*_o),V(e*_o)],f=V(c*rR)):f=u,Nn(e*l)&&(r=V(-r));let d=V((n-r)*f);return Nn(d)&&(d=V(-d)),Uy(d,Ot)}equals(e){let r=this,n=e,[i,s,o,a]=[r.t,n.t,r.z,n.z];return V(i*a)===V(s*o)}negate(){return new Me(V(-this.x),this.y,this.z,V(-this.t))}double(){let e=this.x,r=this.y,n=this.z,{a:i}=Je,s=V(e**2n),o=V(r**2n),a=V(2n*n**2n),c=V(i*s),u=V((e+r)**2n-s-o),l=V(c+o),f=V(l-a),d=V(c-o),p=V(u*f),h=V(l*d),g=V(u*d),v=V(f*l);return new Me(p,h,v,g)}add(e){let r=this.x,n=this.y,i=this.z,s=this.t,o=e.x,a=e.y,c=e.z,u=e.t,l=V((n-r)*(a+o)),f=V((n+r)*(a-o)),d=V(f-l);if(d===0n)return this.double();let p=V(i*2n*u),h=V(s*2n*c),g=V(h+p),v=V(f+l),A=V(h-p),B=V(g*d),k=V(v*A),z=V(g*A),q=V(d*v);return new Me(B,k,q,z)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){if(!My(e))throw new TypeError("Point#multiply: expected number or bigint");let r=V(BigInt(e),Je.n);if(r===1n)return this;let n=Me.ZERO,i=this;for(;r>0n;)r&1n&&(n=n.add(i)),i=i.double(),r>>=1n;return n}precomputeWindow(e){let r=256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Me.BASE)&&(r=ze.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Il.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Me.normalizeZ(i),Il.set(r,i)));let s=Me.ZERO,o=Me.ZERO,a=256/n+1,c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let d=0;d<a;d++){let p=d*c,h=Number(e&u);if(e>>=f,h>c&&(h-=l,e+=1n),h===0)o=o.add(d%2?i[p].negate():i[p]);else{let g=i[p+Math.abs(h)-1];s=s.add(h<0?g.negate():g)}}return[s,o]}multiply(e,r){if(!My(e))throw new TypeError("Point#multiply: expected number or bigint");let n=V(BigInt(e),Je.n);return Me.normalizeZ(this.wNAF(n,r))[0]}toAffine(e=Bl(this.z)){let r=V(this.x*e),n=V(this.y*e);return new ze(r,n)}};Ge.ExtendedPoint=Me;Me.BASE=new Me(Je.Gx,Je.Gy,1n,V(Je.Gx*Je.Gy));Me.ZERO=new Me(0n,1n,1n,0n);var Il=new WeakMap,ze=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Il.delete(this)}static fromHex(e){let{d:r,P:n}=Je,i=e instanceof Uint8Array?e:Co(e);if(i.length!==32)throw new Error("Point.fromHex: expected 32 bytes");let s=i[31],o=s&~128,a=(s&128)!=0,c=Uint8Array.from(Array.from(i.slice(0,31)).concat(o)),u=es(c);if(u>=n)throw new Error("Point.fromHex expects hex <= Fp");let l=V(u*u),f=V(l-1n),d=V(r*l+1n),{isValid:p,value:h}=Pl(f,d);if(!p)throw new Error("Point.fromHex: invalid y coordinate");let g=(h&1n)===1n;return a!==g&&(h=V(-h)),new ze(h,u)}static async fromPrivateKey(e){let r=await Ge.utils.sha512(Vy(e));return ze.BASE.multiply(Ky(r))}toRawBytes(){let e=Tl(this.y),r=new Uint8Array(Ot);for(let i=e.length-2,s=0;s<Ot&&i>=0;i-=2,s++)r[s]=Number.parseInt(e[i]+e[i+1],16);let n=this.x&1n?128:0;return r[Ot-1]|=n,r}toHex(){return qy(this.toRawBytes())}toX25519(){return V((1n+this.y)*Bl(1n-this.y))}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ze(V(-this.x),this.y)}add(e){return Me.fromAffine(this).add(Me.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Me.fromAffine(this).multiply(e,this).toAffine()}};Ge.Point=ze;ze.BASE=new ze(Je.Gx,Je.Gy);ze.ZERO=new ze(0n,1n);var Pn=class{constructor(e,r){this.r=e,this.s=r}static fromHex(e){e=Ol(e);let r=ze.fromHex(e.slice(0,32)),n=es(e.slice(32));if(!lR(n))throw new Error("Signature.fromHex expects s <= CURVE.n");return new Pn(r,n)}toRawBytes(){let e=Co(Tl(this.s)).reverse(),r=new Uint8Array(Ot);r.set(e);let n=new Uint8Array(Ot*2);return n.set(this.r.toRawBytes()),n.set(r,32),n}toHex(){return qy(this.toRawBytes())}};Ge.Signature=Pn;Ge.SignResult=Pn;function sR(...t){if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function qy(t){let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e}function Co(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2;e[r]=Number.parseInt(t.slice(n,n+2),16)}return e}function Tl(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Uy(t,e=Ot){let r=Tl(t).padStart(e*2,"0");return Co(r).reverse()}function Nn(t){return(V(t)&1n)===1n}function My(t){return!!(typeof t=="bigint"&&t>0n||typeof t=="number"&&t>0&&Number.isSafeInteger(t))}function es(t){let e=0n;for(let r=0;r<t.length;r++)e+=BigInt(t[r])<<8n*BigInt(r);return e}function Rl(t){return V(es(t)&2n**255n-1n)}function V(t,e=Je.P){let r=t%e;return r>=0n?r:e+r}function Bl(t,e=Je.P){if(t===0n||e<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=V(t,e),n=e,[i,s,o,a]=[0n,1n,1n,0n];for(;r!==0n;){let u=n/r,l=n%r,f=i-o*u,d=s-a*u;[n,r]=[r,l],[i,s]=[o,a],[o,a]=[f,d]}if(n!==1n)throw new Error("invert: does not exist");return V(i,e)}function oR(t,e=Je.P){let r=t.length,n=new Array(r),i=1n;for(let s=0;s<r;s++)t[s]!==0n&&(n[s]=i,i=V(i*t[s],e));i=Bl(i,e);for(let s=r-1;s>=0;s--){if(t[s]===0n)continue;let o=V(i*t[s],e);t[s]=V(i*n[s],e),i=o}return t}function qr(t,e){let{P:r}=Je,n=t;for(;e-- >0n;)n*=n,n%=r;return n}function aR(t){let{P:e}=Je,n=t*t%e*t%e,i=qr(n,2n)*n%e,s=qr(i,1n)*t%e,o=qr(s,5n)*s%e,a=qr(o,10n)*o%e,c=qr(a,20n)*a%e,u=qr(c,40n)*c%e,l=qr(u,80n)*u%e,f=qr(l,80n)*u%e,d=qr(f,10n)*o%e;return qr(d,2n)*t%e}function Pl(t,e){let r=V(e*e*e),n=V(r*r*e),i=V(t*r*aR(t*n)),s=V(e*i*i),o=i,a=V(i*_o),c=s===t,u=s===V(-t),l=s===V(-t*_o);return c&&(i=o),(u||l)&&(i=a),Nn(i)&&(i=V(-i)),{isValid:c||u,value:i}}function Fy(t){return Pl(1n,t)}async function Nl(...t){let e=sR(...t),r=await Ge.utils.sha512(e),n=es(r);return V(n,Je.n)}function cR(t){return t.slice(Ot)}function Ky(t){let e=Ot-1,r=t.slice(0,Ot);return r[0]&=248,r[e]&=127,r[e]|=64,V(es(r),Je.n)}function uR(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ol(t){return t instanceof Uint8Array?t:Co(t)}function lR(t){return 0<t&&t<Je.n}function Vy(t){let e;if(typeof t=="bigint"||typeof t=="number"&&Number.isSafeInteger(t)){if(e=BigInt(t),e<0n||e>2n**256n)throw new Error("Expected 32 bytes of private key");t=e.toString(16).padStart(Ot*2,"0")}if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");return Co(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");return t}else throw new TypeError("Expected valid private key")}async function fR(t){let e=await ze.fromPrivateKey(t);return typeof t=="string"?e.toHex():e.toRawBytes()}Ge.getPublicKey=fR;async function dR(t,e){let r=await Ge.utils.sha512(Vy(e)),n=Ky(r),i=ze.BASE.multiply(n),s=Ol(t),o=await Nl(cR(r),s),a=ze.BASE.multiply(o),c=await Nl(a.toRawBytes(),i.toRawBytes(),s),u=V(o+c*n,Je.n),l=new Pn(a,u);return typeof t=="string"?l.toHex():l.toRawBytes()}Ge.sign=dR;async function hR(t,e,r){e=Ol(e),r instanceof ze||(r=ze.fromHex(r)),t instanceof Pn||(t=Pn.fromHex(t));let n=await Nl(t.r.toRawBytes(),r.toRawBytes(),e),i=Me.fromAffine(r).multiplyUnsafe(n),s=Me.BASE.multiply(t.s);return Me.fromAffine(t.r).add(i).subtract(s).multiplyUnsafe(8n).equals(Me.ZERO)}Ge.verify=hR;ze.BASE._setWindowSize(8);var On=(()=>{let t=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof jy!="undefined"&&typeof Di=="function"&&!t?Xi():void 0,web:t}})();Ge.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],randomBytes:(t=32)=>{if(On.web)return On.web.getRandomValues(new Uint8Array(t));if(On.node){let{randomBytes:e}=On.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=1024;for(;t--;){let e=Ge.utils.randomBytes(32),r=es(e);if(r>1n&&r<Je.n)return e}throw new Error("Valid private key was not found in 1024 iterations. PRNG is broken")},sha512:async t=>{if(On.web){let e=await On.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(On.node)return Uint8Array.from(On.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ze.BASE){let r=e.equals(ze.BASE)?e:new ze(e.x,e.y);return r._setWindowSize(t),r.multiply(1n),r}}});var zy=x(Dn=>{"use strict";var Io=$y(),pR=32,yR=64,ac=32;Dn.publicKeyLength=pR;Dn.privateKeyLength=yR;Dn.generateKey=async function(){let t=Io.utils.randomPrivateKey(),e=await Io.getPublicKey(t);return{privateKey:Hy(t,e),publicKey:e}};Dn.generateKeyFromSeed=async function(t){if(t.length!==ac)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Io.getPublicKey(e);return{privateKey:Hy(e,r),publicKey:r}};Dn.hashAndSign=function(t,e){let r=t.slice(0,ac);return Io.sign(e,r)};Dn.hashAndVerify=function(t,e,r){return Io.verify(e,r,t)};function Hy(t,e){let r=new Uint8Array(Dn.privateKeyLength);for(let n=0;n<ac;n++)r[n]=t[n],r[ac+n]=e[n];return r}});var Xy=x((Pk,Qy)=>{"use strict";var Gy=he(),{equals:Wy}=(Dr(),Or),{sha256:Yy}=(ai(),In),{base58btc:gR}=(mn(),gn),{identity:mR}=(Za(),bo),Ct=zy(),cc=Na(),vR=nc(),uc=class{constructor(e){this._key=rs(e,Ct.publicKeyLength)}async verify(e,r){return Ct.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return cc.PublicKey.encode({Type:cc.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Wy(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yy.digest(this.bytes);return e}},ts=class{constructor(e,r){this._key=rs(e,Ct.privateKeyLength),this._publicKey=rs(r,Ct.publicKeyLength)}async sign(e){return Ct.hashAndSign(this._key,e)}get public(){return new uc(this._publicKey)}marshal(){return this._key}get bytes(){return cc.PrivateKey.encode({Type:cc.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return Wy(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Yy.digest(this.bytes);return e}async id(){let e=await mR.digest(this.public.bytes);return gR.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return vR.export(this.bytes,e);throw Gy(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function bR(t){if(t.length>Ct.privateKeyLength){t=rs(t,Ct.privateKeyLength+Ct.publicKeyLength);let n=t.slice(0,Ct.privateKeyLength),i=t.slice(Ct.privateKeyLength,t.length);return new ts(n,i)}t=rs(t,Ct.privateKeyLength);let e=t.slice(0,Ct.privateKeyLength),r=t.slice(Ct.publicKeyLength);return new ts(e,r)}function wR(t){return t=rs(t,Ct.publicKeyLength),new uc(t)}async function ER(){let{privateKey:t,publicKey:e}=await Ct.generateKey();return new ts(t,e)}async function xR(t){let{privateKey:e,publicKey:r}=await Ct.generateKeyFromSeed(t);return new ts(e,r)}function rs(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw Gy(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}Qy.exports={Ed25519PublicKey:uc,Ed25519PrivateKey:ts,unmarshalEd25519PrivateKey:bR,unmarshalEd25519PublicKey:wR,generateKeyPair:ER,generateKeyPairFromSeed:xR}});var dg=x((Be,fg)=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.utils=Be.schnorr=Be.verify=Be.signSync=Be.sign=Be.getSharedSecret=Be.recoverPublicKey=Be.getPublicKey=Be.SignResult=Be.Signature=Be.Point=Be.CURVE=void 0;var De={a:0n,b:7n,P:2n**256n-2n**32n-977n,n:2n**256n-432420386565659656852420866394968145599n,h:1n,Gx:55066263022277343669578718895168534326250603453777594175500187360389116729240n,Gy:32670510020758816978083085130507043184471273380659243275938904335757337482424n,beta:0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501een};Be.CURVE=De;function Zy(t){let{a:e,b:r}=De;return ne(t**3n+e*t+r)}var lc=De.a===0n,Re=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof ke))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Re(e.x,e.y,1n)}static toAffineBatch(e){let r=AR(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Re.toAffineBatch(e).map(Re.fromAffine)}equals(e){let r=this,n=e,i=ne(r.z*r.z),s=ne(r.z*i),o=ne(n.z*n.z),a=ne(n.z*o);return ne(r.x*o)===ne(i*n.x)&&ne(r.y*a)===ne(s*n.y)}negate(){return new Re(this.x,ne(-this.y),this.z)}double(){let e=this.x,r=this.y,n=this.z,i=ne(e**2n),s=ne(r**2n),o=ne(s**2n),a=ne(2n*(ne(ne((e+s)**2n))-i-o)),c=ne(3n*i),u=ne(c**2n),l=ne(u-2n*a),f=ne(c*(a-l)-8n*o),d=ne(2n*r*n);return new Re(l,f,d)}add(e){if(!(e instanceof Re))throw new TypeError("JacobianPoint#add: expected JacobianPoint");let r=this.x,n=this.y,i=this.z,s=e.x,o=e.y,a=e.z;if(s===0n||o===0n)return this;if(r===0n||n===0n)return e;let c=ne(i**2n),u=ne(a**2n),l=ne(r*u),f=ne(s*c),d=ne(n*a*u),p=ne(ne(o*i)*c),h=ne(f-l),g=ne(p-d);if(h===0n)return g===0n?this.double():Re.ZERO;let v=ne(h**2n),A=ne(h*v),B=ne(l*v),k=ne(g**2n-A-2n*B),z=ne(g*(B-k)-d*A),q=ne(i*a*h);return new Re(k,z,q)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){if(!tg(e))throw new TypeError("Point#multiply: expected valid scalar");let r=ne(BigInt(e),De.n);if(!lc){let l=Re.ZERO,f=this;for(;r>0n;)r&1n&&(l=l.add(f)),f=f.double(),r>>=1n;return l}let[n,i,s,o]=ng(r),a=Re.ZERO,c=Re.ZERO,u=this;for(;i>0n||o>0n;)i&1n&&(a=a.add(u)),o&1n&&(c=c.add(u)),u=u.double(),i>>=1n,o>>=1n;return n&&(a=a.negate()),s&&(c=c.negate()),c=new Re(ne(c.x*De.beta),c.y,c.z),a.add(c)}precomputeWindow(e){let r=lc?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Re.BASE)&&(r=ke.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Dl.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Re.normalizeZ(i),Dl.set(r,i)));let s=Re.ZERO,o=Re.ZERO,a=lc?128/n+1:256/n+1,c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let d=0;d<a;d++){let p=d*c,h=Number(e&u);if(e>>=f,h>c&&(h-=l,e+=1n),h===0)o=o.add(d%2?i[p].negate():i[p]);else{let g=i[p+Math.abs(h)-1];s=s.add(h<0?g.negate():g)}}return[s,o]}multiply(e,r){if(!tg(e))throw new TypeError("Point#multiply: expected valid scalar");let n=ne(BigInt(e),De.n),i,s;if(lc){let[o,a,c,u]=ng(n),l,f,d,p;[l,d]=this.wNAF(a,r),[f,p]=this.wNAF(u,r),o&&(l=l.negate()),c&&(f=f.negate()),f=new Re(ne(f.x*De.beta),f.y,f.z),[i,s]=[l.add(f),d.add(p)]}else[i,s]=this.wNAF(n,r);return Re.normalizeZ([i,s])[0]}toAffine(e=Bo(this.z)){let r=e**2n,n=ne(this.x*r),i=ne(this.y*r*e);return new ke(n,i)}};Re.BASE=new Re(De.Gx,De.Gy,1n);Re.ZERO=new Re(0n,1n,0n);var Dl=new WeakMap,ke=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Dl.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=nr(r?e:e.slice(1)),i=Zy(n),s=SR(i),o=(s&1n)===1n;r?o&&(s=ne(-s)):(e[0]&1)==1!==o&&(s=ne(-s));let a=new ke(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=nr(e.slice(1,33)),n=nr(e.slice(33)),i=new ke(r,n);return i.assertValidity(),i}static fromHex(e){let r=hc(e),n=r[0];if(r.length===32||r.length===33&&(n===2||n===3))return this.fromCompressedHex(r);if(r.length===65&&n===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r.length}`)}static fromPrivateKey(e){return ke.BASE.multiply(ns(e))}static fromSignature(e,r,n){let i=e instanceof Uint8Array?nr(e):nn(e),s=og(r),{r:o,s:a}=s;if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid yParity bit");let c=2+(n&1),u=ke.fromHex(`0${c}${kn(o)}`),l=Re.fromAffine(u).multiplyUnsafe(a),f=Re.BASE.multiply(i),d=Bo(o,De.n),h=l.subtract(f).multiplyUnsafe(d).toAffine();return h.assertValidity(),h}toRawBytes(e=!1){return Ln(this.toHex(e))}toHex(e=!1){let r=kn(this.x);return e?`${this.y&1n?"03":"02"}${r}`:`04${r}${kn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{P:r}=De,{x:n,y:i}=this;if(n===0n||i===0n||n>=r||i>=r)throw new Error(e);let s=ne(i*i),o=Zy(n);if((s-o)%r!==0n)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ke(this.x,ne(-this.y))}double(){return Re.fromAffine(this).double().toAffine()}add(e){return Re.fromAffine(this).add(Re.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Re.fromAffine(this).multiply(e,this).toAffine()}};Be.Point=ke;ke.BASE=new ke(De.Gx,De.Gy);ke.ZERO=new ke(0n,0n);function Jy(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}var rn=class{constructor(e,r){this.r=e,this.s=r}static fromCompact(e){if(typeof e!="string"&&!(e instanceof Uint8Array))throw new TypeError("Signature.fromCompact: Expected string or Uint8Array");let r=e instanceof Uint8Array?fc(e):e;if(r.length!==128)throw new Error("Signature.fromCompact: Expected 64-byte hex");let n=new rn(nn(r.slice(0,64)),nn(r.slice(64,128)));return n.assertValidity(),n}static fromDER(e){let r="Signature.fromDER";if(typeof e!="string"&&!(e instanceof Uint8Array))throw new TypeError(`${r}: Expected string or Uint8Array`);let n=e instanceof Uint8Array?fc(e):e,i=Ro(n.slice(2,4));if(n.slice(0,2)!=="30"||i!==n.length-4||n.slice(4,6)!=="02")throw new Error(`${r}: Invalid signature ${n}`);let s=Ro(n.slice(6,8)),o=8+s,a=n.slice(8,o);if(a.startsWith("00")&&Ro(a.slice(2,4))<=127)throw new Error(`${r}: Invalid r with trailing length`);let c=nn(a);if(n.slice(o,o+2)!=="02")throw new Error(`${r}: Invalid r-s separator`);let l=Ro(n.slice(o+2,o+4)),f=i-l-s-10;if(f>0||f===-4)throw new Error(`${r}: Invalid total length`);if(l>i-s-4)throw new Error(`${r}: Invalid s`);let d=o+4,p=n.slice(d,d+l);if(p.startsWith("00")&&Ro(p.slice(2,4))<=127)throw new Error(`${r}: Invalid s with trailing length`);let h=nn(p),g=new rn(c,h);return g.assertValidity(),g}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Po(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Po(r))throw new Error("Invalid Signature: s must be 0 < s < n")}toDERRawBytes(e=!1){return Ln(this.toDERHex(e))}toDERHex(e=!1){let r=Jy(To(this.s));if(e)return r;let n=Jy(To(this.r)),i=To(n.length/2),s=To(r.length/2);return`30${To(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Ln(this.toCompactHex())}toCompactHex(){return kn(this.r)+kn(this.s)}};Be.Signature=rn;Be.SignResult=rn;function eg(...t){if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function fc(t){let e="";for(let r=0;r<t.length;r++)e+=t[r].toString(16).padStart(2,"0");return e}function kn(t){return t.toString(16).padStart(64,"0")}function dc(t){return Ln(kn(t))}function To(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function nn(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Ln(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2;e[r]=Number.parseInt(t.slice(n,n+2),16)}return e}function hc(t){return t instanceof Uint8Array?t:Ln(t)}function nr(t){return nn(fc(t))}function Ro(t){return Number.parseInt(t,16)*2}function tg(t){return!!(typeof t=="bigint"&&t>0n||typeof t=="number"&&t>0&&Number.isSafeInteger(t))}function ne(t,e=De.P){let r=t%e;return r>=0?r:e+r}function ir(t,e){let{P:r}=De,n=t;for(;e-- >0n;)n*=n,n%=r;return n}function SR(t){let{P:e}=De,r=t*t*t%e,n=r*r*t%e,i=ir(n,3n)*n%e,s=ir(i,3n)*n%e,o=ir(s,2n)*r%e,a=ir(o,11n)*o%e,c=ir(a,22n)*a%e,u=ir(c,44n)*c%e,l=ir(u,88n)*u%e,f=ir(l,44n)*c%e,d=ir(f,3n)*n%e,p=ir(d,23n)*a%e,h=ir(p,6n)*r%e;return ir(h,2n)}function Bo(t,e=De.P){if(t===0n||e<=0n)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ne(t,e),n=e,[i,s,o,a]=[0n,1n,1n,0n];for(;r!==0n;){let u=n/r,l=n%r,f=i-o*u,d=s-a*u;[n,r]=[r,l],[i,s]=[o,a],[o,a]=[f,d]}if(n!==1n)throw new Error("invert: does not exist");return ne(i,e)}function AR(t,e=De.P){let r=t.length,n=new Array(r),i=1n;for(let s=0;s<r;s++)t[s]!==0n&&(n[s]=i,i=ne(i*t[s],e));i=Bo(i,e);for(let s=r-1;s>=0;s--){if(t[s]===0n)continue;let o=ne(i*t[s],e);t[s]=ne(i*n[s],e),i=o}return t}var rg=(t,e)=>(t+e/2n)/e,pc=2n**128n;function ng(t){let{n:e}=De,r=0x3086d221a7d46bcde86c90e49284eb15n,n=-0xe4437ed6010e88286f547fa90abfe4c3n,i=0x114ca50f7a8e2f3f657c1108d9d44cfd8n,s=r,o=rg(s*t,e),a=rg(-n*t,e),c=ne(t-o*r-a*i,e),u=ne(-o*n-a*s,e),l=c>pc,f=u>pc;if(l&&(c=e-c),f&&(u=e-u),c>pc||u>pc)throw new Error("splitScalarEndo: Endomorphism failed");return[l,c,f,u]}function _R(t){typeof t!="string"&&(t=fc(t));let e=nn(t||"0"),n=t.length/2*8-256;return n>0&&(e=e>>BigInt(n)),e>=De.n&&(e-=De.n),e}function ig(t,e){if(t==null)throw new Error(`sign: expected valid msgHash, not "${t}"`);let r=typeof t=="string"?nn(t):nr(t),n=dc(r),i=nr(n),s=dc(e),o=new Uint8Array(32).fill(1),a=new Uint8Array(32).fill(0),c=Uint8Array.from([0]),u=Uint8Array.from([1]);return[n,i,s,o,a,c,u]}async function CR(t,e){let r=ns(e),[n,i,s,o,a,c,u]=ig(t,r),l=Be.utils.hmacSha256;a=await l(a,o,c,s,n),o=await l(a,o),a=await l(a,o,u,s,n),o=await l(a,o);for(let f=0;f<1e3;f++){o=await l(a,o);let d=sg(o,i,r);if(d)return d;a=await l(a,o,c),o=await l(a,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function IR(t,e){let r=ns(e),[n,i,s,o,a,c,u]=ig(t,r),l=Be.utils.hmacSha256Sync;if(!l)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");if(a=l(a,o,c,s,n),a instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");o=l(a,o),a=l(a,o,u,s,n),o=l(a,o);for(let f=0;f<1e3;f++){o=l(a,o);let d=sg(o,i,r);if(d)return d;a=l(a,o,c),o=l(a,o)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function Po(t){return 0<t&&t<De.n}function sg(t,e,r){let n=nr(t);if(!Po(n))return;let i=De.n,s=ke.BASE.multiply(n),o=ne(s.x,i),a=ne(Bo(n,i)*(e+o*r),i);if(!(o===0n||a===0n))return[s,o,a]}function ns(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=nn(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=nr(t)}else throw new TypeError("Expected valid private key");if(!Po(e))throw new Error("Expected private key: 0 < key < n");return e}function kl(t){return t instanceof ke?(t.assertValidity(),t):ke.fromHex(t)}function og(t){return t instanceof rn?(t.assertValidity(),t):rn.fromDER(t)}function TR(t,e=!1){let r=ke.fromPrivateKey(t);return typeof t=="string"?r.toHex(e):r.toRawBytes(e)}Be.getPublicKey=TR;function RR(t,e,r){let n=ke.fromSignature(t,e,r);return typeof t=="string"?n.toHex():n.toRawBytes()}Be.recoverPublicKey=RR;function ag(t){let e=t instanceof Uint8Array,r=typeof t=="string",n=(e||r)&&t.length;return e?n===33||n===65:r?n===66||n===130:t instanceof ke}function BR(t,e,r=!1){if(ag(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!ag(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=kl(e);n.assertValidity();let i=n.multiply(ns(t));return typeof t=="string"?i.toHex(r):i.toRawBytes(r)}Be.getSharedSecret=BR;function cg(t,e,r=!1){let[n,i,s]=t,{canonical:o,der:a,recovered:c}=e,u=(n.x===i?0:2)|Number(n.y&1n),l=s,f=De.n>>1n;s>f&&o&&(l=De.n-s,u^=1);let d=new rn(i,l);d.assertValidity();let p=a===!1?d.toCompactHex():d.toDERHex(),h=r?p:Ln(p);return c?[h,u]:h}async function PR(t,e,r={}){return cg(await CR(t,e),r,typeof t=="string")}Be.sign=PR;function NR(t,e,r={}){return cg(IR(t,e),r,typeof t=="string")}Be.signSync=NR;function OR(t,e,r){let{n}=De,i;try{i=og(t)}catch(v){return!1}let{r:s,s:o}=i,a=_R(e);if(a===0n)return!1;let c=Re.fromAffine(kl(r)),u=Bo(o,n),l=ne(a*u,n),f=ne(s*u,n),d=Re.BASE.multiply(l),p=c.multiplyUnsafe(f),h=d.add(p).toAffine();return ne(h.x,n)===s}Be.verify=OR;async function Ll(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),n=await Be.utils.sha256(r),i=await Be.utils.sha256(eg(n,n,...e));return nr(i)}async function ug(t,e,r){let n=dc(t),i=await Ll("BIP0340/challenge",n,e.toRawX(),r);return ne(i,De.n)}function ql(t){return ne(t.y,2n)===0n}var ui=class{constructor(e,r){if(this.r=e,this.s=r,e<=0n||r<=0n||e>=De.P||r>=De.n)throw new Error("Invalid signature")}static fromHex(e){let r=hc(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=nr(r.slice(0,32)),i=nr(r.slice(32));return new ui(n,i)}toHex(){return kn(this.r)+kn(this.s)}toRawBytes(){return Ln(this.toHex())}};function DR(t){let e=ke.fromPrivateKey(t);return typeof t=="string"?e.toHexX():e.toRawX()}async function kR(t,e,r=Be.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);e||(e=0n);let{n}=De,i=hc(t),s=ns(e),o=hc(r);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let a=ke.fromPrivateKey(s),c=ql(a)?s:n-s,u=await Ll("BIP0340/aux",o),l=c^u,f=await Ll("BIP0340/nonce",dc(l),a.toRawX(),i),d=ne(f,n);if(d===0n)throw new Error("sign: Creation of signature failed. k is zero");let p=ke.fromPrivateKey(d),h=ql(p)?d:n-d,g=await ug(p.x,a,i),v=new ui(p.x,ne(h+g*c,n));if(!await lg(v.toRawBytes(),i,a.toRawX()))throw new Error("sign: Invalid signature produced");return typeof t=="string"?v.toHex():v.toRawBytes()}async function lg(t,e,r){let n=t instanceof ui?t:ui.fromHex(t),i=typeof e=="string"?Ln(e):e,s=kl(r),o=await ug(n.r,s,i),a=ke.fromPrivateKey(n.s),c=s.multiply(o),u=a.subtract(c);return!(u.equals(ke.BASE)||!ql(u)||u.x!==n.r)}Be.schnorr={Signature:ui,getPublicKey:DR,sign:kR,verify:lg};ke.BASE._setWindowSize(8);var zt=(()=>{let t=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof fg!="undefined"&&typeof Di=="function"&&!t?Xi():void 0,web:t}})();Be.utils={isValidPrivateKey(t){try{return ns(t),!0}catch(e){return!1}},randomBytes:(t=32)=>{if(zt.web)return zt.web.getRandomValues(new Uint8Array(t));if(zt.node){let{randomBytes:e}=zt.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let t=8;for(;t--;){let e=Be.utils.randomBytes(32),r=nr(e);if(Po(r)&&r!==1n)return e}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async t=>{if(zt.web){let e=await zt.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(zt.node){let{createHash:e}=zt.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(zt.web){let r=await zt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=eg(...e),i=await zt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(zt.node){let{createHmac:r}=zt.node,n=r("sha256",t);for(let i of e)n.update(i);return Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=ke.BASE){let r=e===ke.BASE?e:new ke(e.x,e.y);return r._setWindowSize(t),r.multiply(3n),r}}});var yg=x((Nk,pg)=>{"use strict";var No=he(),qn=dg(),{sha256:hg}=(ai(),In);pg.exports=()=>{let t=32;function e(){return qn.utils.randomPrivateKey()}async function r(u,l){let{digest:f}=await hg.digest(l);try{return await qn.sign(f,u)}catch(d){throw No(d,"ERR_INVALID_INPUT")}}async function n(u,l,f){try{let{digest:d}=await hg.digest(f);return qn.verify(l,d,u)}catch(d){throw No(d,"ERR_INVALID_INPUT")}}function i(u){return qn.Point.fromHex(u).toRawBytes(!0)}function s(u){return qn.Point.fromHex(u).toRawBytes(!1)}function o(u){try{qn.getPublicKey(u,!0)}catch(l){throw No(l,"ERR_INVALID_PRIVATE_KEY")}}function a(u){try{qn.Point.fromHex(u)}catch(l){throw No(l,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return qn.getPublicKey(u,!0)}catch(l){throw No(l,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:a,computePublicKey:c}}});var bg=x((Ok,vg)=>{"use strict";var{sha256:gg}=(ai(),In),LR=he(),{equals:mg}=(Dr(),Or),{toString:qR}=(xt(),_t),UR=nc();vg.exports=(t,e,r)=>{r=r||yg()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return mg(this.bytes,u.bytes)}async hash(){let{bytes:u}=await gg.digest(this.bytes);return u}}class i{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return mg(this.bytes,u.bytes)}async hash(){let{bytes:u}=await gg.digest(this.bytes);return u}async id(){let u=await this.public.hash();return qR(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return UR.export(this.bytes,u);throw LR(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new i(c)}function o(c){return new n(c)}async function a(){let c=await r.generateKey();return new i(c)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var Eg=x((Dk,wg)=>{"use strict";wg.exports={SHA1:20,SHA256:32,SHA512:64}});var Ul=x(Sg=>{"use strict";var xg=wo(),MR=Eg(),FR={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},KR=async(t,e)=>{let r=await xg.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};Sg.create=async function(t,e){let r=FR[t],n=await xg.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return KR(n,i)},length:MR[t]}}});var Tg=x((Lk,Ig)=>{"use strict";var Ag=he(),{concat:_g}=(Rn(),Tn),{fromString:VR}=(Et(),At),jR=Ul(),Cg={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Ig.exports=async(t,e,r)=>{let n=Cg[t];if(!n){let B=Object.keys(Cg).join(" / ");throw Ag(new Error(`unknown cipher type '${t}'. Must be ${B}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw Ag(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,a=VR("key expansion"),c=2*(s+i+o),u=await jR.create(e,r),l=await u.digest(a),f=[],d=0;for(;d<c;){let B=await u.digest(_g([l,a])),k=B.length;d+k>c&&(k=c-d),f.push(B),d+=k,l=await u.digest(l)}let p=c/2,h=_g(f),g=h.slice(0,p),v=h.slice(p,c),A=B=>({iv:B.slice(0,s),cipherKey:B.slice(s,s+i),macKey:B.slice(s+i)});return{k1:A(g),k2:A(v)}}});var Bg=x((qk,Rg)=>{"use strict";var $R=he();Rg.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw $R(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var Lg=x(kg=>{"use strict";var HR=he(),Oo=wo(),{base64urlToBuffer:Pg}=rc(),zR=Bg(),{toString:Ml}=(xt(),_t),{concat:GR}=(Rn(),Tn),{equals:WR}=(Dr(),Or),Ng={"P-256":256,"P-384":384,"P-521":521};kg.generateEphmeralKeyPair=async function(t){zR(Object.keys(Ng),t);let e=await Oo.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,s)=>{let o;s?o=await Oo.get().subtle.importKey("jwk",QR(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await Oo.get().subtle.importKey("jwk",Dg(t,i),{name:"ECDH",namedCurve:t},!1,[]),o],c=await Oo.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],Ng[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},n=await Oo.get().subtle.exportKey("jwk",e.publicKey);return{key:YR(n),genSharedKey:r}};var Og={"P-256":32,"P-384":48,"P-521":66};function YR(t){let e=Og[t.crv];return GR([Uint8Array.from([4]),Pg(t.x,e),Pg(t.y,e)],1+e*2)}function Dg(t,e){let r=Og[t];if(WR(!e.slice(0,1),Uint8Array.from([4])))throw HR(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:Ml(e.slice(1,r+1),"base64url"),y:Ml(e.slice(1+r),"base64url"),ext:!0}}var QR=(t,e)=>({...Dg(t,e.public),d:Ml(e.private,"base64url")})});var Ug=x((Mk,qg)=>{"use strict";var XR=Lg();qg.exports=async t=>XR.generateEphmeralKeyPair(t)});var gc=x((Fk,Fg)=>{"use strict";var Ur=Na();Sn();hl();var Fl=we(),Do=he(),{fromString:ZR}=(Et(),At),JR=fy(),sr={rsa:Ly(),ed25519:Xy(),secp256k1:bg()(Ur,tc())},yc={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function is(t){let e=sr[t.toLowerCase()];if(!e){let r=Object.keys(sr).join(" / ");throw Do(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var e8=async(t,e)=>is(t).generateKeyPair(e),t8=async(t,e,r)=>{let n=is(t);if(t.toLowerCase()!=="ed25519")throw Do(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},r8=t=>{let e=Ur.PublicKey.decode(t),r=e.Data;switch(e.Type){case Ur.KeyType.RSA:return sr.rsa.unmarshalRsaPublicKey(r);case Ur.KeyType.Ed25519:return sr.ed25519.unmarshalEd25519PublicKey(r);case Ur.KeyType.Secp256k1:if(sr.secp256k1)return sr.secp256k1.unmarshalSecp256k1PublicKey(r);throw Do(new Error(yc.message),yc.code);default:is(e.Type)}},n8=(t,e)=>(e=(e||"rsa").toLowerCase(),is(e),t.bytes),Mg=async t=>{let e=Ur.PrivateKey.decode(t),r=e.Data;switch(e.Type){case Ur.KeyType.RSA:return sr.rsa.unmarshalRsaPrivateKey(r);case Ur.KeyType.Ed25519:return sr.ed25519.unmarshalEd25519PrivateKey(r);case Ur.KeyType.Secp256k1:if(sr.secp256k1)return sr.secp256k1.unmarshalSecp256k1PrivateKey(r);throw Do(new Error(yc.message),yc.code);default:is(e.Type)}},i8=(t,e)=>(e=(e||"rsa").toLowerCase(),is(e),t.bytes),s8=async(t,e)=>{try{let i=await JR.import(t,e);return Mg(i)}catch(i){}let r=Fl.pki.decryptRsaPrivateKey(t,e);if(r===null)throw Do(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=Fl.asn1.toDer(Fl.pki.privateKeyToAsn1(r));return n=ZR(n.getBytes(),"ascii"),sr.rsa.unmarshalRsaPrivateKey(n)};Fg.exports={supportedKeys:sr,keysPBM:Ur,keyStretcher:Tg(),generateEphemeralKeyPair:Ug(),generateKeyPair:e8,generateKeyPairFromSeed:t8,unmarshalPublicKey:r8,marshalPublicKey:n8,unmarshalPrivateKey:Mg,marshalPrivateKey:i8,import:s8}});var Kg=x((Kk,Kl)=>{"use strict";function o8(t,{className:e,symbolName:r}){let n=Symbol.for(r),i={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=s=>!!(s&&s[n]),i}function a8(t,{className:e,symbolName:r,withoutNew:n}){let i=Symbol.for(r),s={[e]:function(...o){if(n&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[i]&&Object.defineProperty(a,i,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[i]),s}Kl.exports=o8;Kl.exports.proto=a8});var $g=x((Vk,jg)=>{"use strict";var ss=Qr(),Vg=ss.Reader,c8=ss.Writer,lt=ss.util,ko=ss.roots["libp2p-peer-id"]||(ss.roots["libp2p-peer-id"]={});ko.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.id=lt.newBuffer([]),t.prototype.pubKey=lt.newBuffer([]),t.prototype.privKey=lt.newBuffer([]),t.encode=function(r,n){return n||(n=c8.create()),n.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&n.uint32(26).bytes(r.privKey),n},t.decode=function(r,n){r instanceof Vg||(r=Vg.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ko.PeerIdProto;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw lt.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ko.PeerIdProto)return r;var n=new ko.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?lt.base64.decode(r.id,n.id=lt.newBuffer(lt.base64.length(r.id)),0):r.id.length&&(n.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?lt.base64.decode(r.pubKey,n.pubKey=lt.newBuffer(lt.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?lt.base64.decode(r.privKey,n.privKey=lt.newBuffer(lt.base64.length(r.privKey)),0):r.privKey.length&&(n.privKey=r.privKey)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.id="":(i.id=[],n.bytes!==Array&&(i.id=lt.newBuffer(i.id))),n.bytes===String?i.pubKey="":(i.pubKey=[],n.bytes!==Array&&(i.pubKey=lt.newBuffer(i.pubKey))),n.bytes===String?i.privKey="":(i.privKey=[],n.bytes!==Array&&(i.privKey=lt.newBuffer(i.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(i.id=n.bytes===String?lt.base64.encode(r.id,0,r.id.length):n.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?lt.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(i.privKey=n.bytes===String?lt.base64.encode(r.privKey,0,r.privKey.length):n.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ss.util.toJSONOptions)},t}();jg.exports=ko});var at=x((It,Zg)=>{"use strict";var{CID:Vl}=($i(),ao),u8=(Zn(),Xn),l8=(Bu(),_a),f8=(mn(),gn),d8=(co(),Hi),{base58btc:jl}=(mn(),gn),{base32:h8}=(Zn(),Xn),{base16:Hg}=(Pu(),Ca),Lo=(Vi(),so),Mr=gc(),p8=Kg(),{PeerIdProto:zg}=$g(),{equals:li}=(Dr(),Or),{fromString:qo}=(Et(),At),{toString:y8}=(xt(),_t),{identity:mc}=(Za(),bo),Gg={...u8,...l8,...f8,...d8},g8=Object.keys(Gg).reduce((t,e)=>t.or(Gg[e]),h8.decoder),m8=112,Wg=114,Yg=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&n&&!li(r.public.bytes,n.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=jl.encode(this.id).substring(1),this._privKey=r,this._pubKey=n}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Lo.decode(this.id);e.code===mc.code&&(this._pubKey=Mr.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return Mr.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return Mr.marshalPrivateKey(this.privKey)}marshal(e){return zg.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:Xg(this.marshalPrivKey()),pubKey:Xg(this.marshalPubKey())}}toHexString(){return Hg.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=Vl.createV1(Wg,Lo.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return li(this.id,e);if(e.id)return li(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&li(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Lo.decode(this.id).code===mc.code)return!0}catch(e){}return!1}},Fr=p8(Yg,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});It=Zg.exports=Fr;var Uo=t=>t.bytes.length<=42?Lo.create(mc.code,t.bytes).bytes:t.hash(),$l=async(t,e)=>{let r=await Uo(e);return new Fr(r,t,e)};It.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await Mr.generateKeyPair(t.keyType,t.bits);return $l(e,e.public)};It.createFromHexString=t=>new Fr(Hg.decode("f"+t));It.createFromBytes=t=>{try{let e=Vl.decode(t);if(!Qg(e))throw new Error("Supplied PeerID CID is invalid");return It.createFromCID(e)}catch{if(Lo.decode(t).code!==mc.code)throw new Error("Supplied PeerID CID is invalid");return new Fr(t)}};It.createFromB58String=t=>It.createFromBytes(jl.decode("z"+t));var Qg=t=>t.code===Wg||t.code===m8;It.createFromCID=t=>{if(t=Vl.asCID(t),!t||!Qg(t))throw new Error("Supplied PeerID CID is invalid");return new Fr(t.multihash.bytes)};It.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=qo(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await Mr.unmarshalPublicKey(e);return $l(void 0,r)};It.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=qo(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await Mr.unmarshalPrivateKey(t);return $l(e,e.public)};It.createFromJSON=async t=>{let e=jl.decode("z"+t.id),r=t.privKey&&qo(t.privKey,"base64pad"),n=t.pubKey&&qo(t.pubKey,"base64pad"),i=n&&await Mr.unmarshalPublicKey(n);if(!r)return new Fr(e,void 0,i);let s=await Mr.unmarshalPrivateKey(r),o=await Uo(s.public),a;if(i&&(a=await Uo(i)),i&&!li(o,a))throw new Error("Public and private key do not match");if(e&&!li(o,e))throw new Error("Id and private key do not match");return new Fr(e,s,i)};It.createFromProtobuf=async t=>{typeof t=="string"&&(t=qo(t,"base16"));let{id:e,privKey:r,pubKey:n}=zg.decode(t);r=r?await Mr.unmarshalPrivateKey(r):!1,n=n?await Mr.unmarshalPublicKey(n):!1;let i,s;if(r&&(s=await Uo(r.public)),n&&(i=await Uo(n)),r){if(n&&!li(s,i))throw new Error("Public and private key do not match");return new Fr(s,r,r.public)}if(n)return new Fr(i,void 0,n);if(e)return new Fr(e);throw new Error("Protobuf did not contain any usable key material")};It.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),It.createFromBytes(g8.decode(t)));It.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function Xg(t){if(t)return y8(t,"base64pad")}});var zl=x((jk,em)=>{"use strict";var Jg="[a-fA-F\\d:]",Un=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${Jg})|(?<=${Jg})(?=\\s|$))`:"",mr="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",ct="[a-fA-F\\d]{1,4}",vc=`
(?:
(?:${ct}:){7}(?:${ct}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${ct}:){6}(?:${mr}|:${ct}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${ct}:){5}(?::${mr}|(?::${ct}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${ct}:){4}(?:(?::${ct}){0,1}:${mr}|(?::${ct}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${ct}:){3}(?:(?::${ct}){0,2}:${mr}|(?::${ct}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${ct}:){2}(?:(?::${ct}){0,3}:${mr}|(?::${ct}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${ct}:){1}(?:(?::${ct}){0,4}:${mr}|(?::${ct}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${ct}){0,5}:${mr}|(?::${ct}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),v8=new RegExp(`(?:^${mr}$)|(?:^${vc}$)`),b8=new RegExp(`^${mr}$`),w8=new RegExp(`^${vc}$`),Hl=t=>t&&t.exact?v8:new RegExp(`(?:${Un(t)}${mr}${Un(t)})|(?:${Un(t)}${vc}${Un(t)})`,"g");Hl.v4=t=>t&&t.exact?b8:new RegExp(`${Un(t)}${mr}${Un(t)}`,"g");Hl.v6=t=>t&&t.exact?w8:new RegExp(`${Un(t)}${vc}${Un(t)}`,"g");em.exports=Hl});var Wl=x(($k,tm)=>{"use strict";var Gl=zl(),os=t=>Gl({exact:!0}).test(t);os.v4=t=>Gl.v4({exact:!0}).test(t);os.v6=t=>Gl.v6({exact:!0}).test(t);os.version=t=>os(t)?os.v4(t)?4:6:void 0;tm.exports=os});var om=x((Hk,sm)=>{"use strict";var Yl=Wl(),{toString:rm}=(xt(),_t),E8=Yl,Ql=Yl.v4,nm=Yl.v6,im=function(t,e,r){r=~~r;let n;if(Ql(t))n=e||new Uint8Array(r+4),t.split(/\./g).map(function(i){n[r++]=parseInt(i,10)&255});else if(nm(t)){let i=t.split(":",8),s;for(s=0;s<i.length;s++){let o=Ql(i[s]),a;o&&(a=im(i[s]),i[s]=rm(a.slice(0,2),"base16")),a&&++s<8&&i.splice(s,0,rm(a.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(s=0;s<i.length&&i[s]!=="";s++);let o=[s,"1"];for(s=9-i.length;s>0;s--)o.push("0");i.splice.apply(i,o)}for(n=e||new Uint8Array(r+16),s=0;s<i.length;s++){let o=parseInt(i[s],16);n[r++]=o>>8&255,n[r++]=o&255}}if(!n)throw Error("Invalid ip address: "+t);return n},x8=function(t,e,r){e=~~e,r=r||t.length-e;let n=[],i,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)n.push(t[e+o]);i=n.join(".")}else if(r===16){for(let o=0;o<r;o+=2)n.push(s.getUint16(e+o).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};sm.exports={isIP:E8,isV4:Ql,isV6:nm,toBytes:im,toString:x8}});var Mo=x((zk,cm)=>{"use strict";function Kt(t){if(typeof t=="number"){if(Kt.codes[t])return Kt.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(Kt.names[t])return Kt.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var or=-1;Kt.lengthPrefixedVarSize=or;Kt.V=or;Kt.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,or,"ip6zone"],[53,or,"dns","resolvable"],[54,or,"dns4","resolvable"],[55,or,"dns6","resolvable"],[56,or,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,or,"unix",!1,"path"],[421,or,"ipfs"],[421,or,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,or,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,or,"memory"]];Kt.names={};Kt.codes={};Kt.table.map(t=>{let e=am.apply(null,t);return Kt.codes[e.code]=e,Kt.names[e.name]=e,null});Kt.object=am;function am(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}cm.exports=Kt});var fm=x((Gk,lm)=>{lm.exports=Xl;var um=128,S8=127,A8=~S8,_8=Math.pow(2,31);function Xl(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Xl.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=_8;)e[r++]=t&255|um,t/=128;for(;t&A8;)e[r++]=t&255|um,t>>>=7;return e[r]=t|0,Xl.bytes=r-n+1,e}});var pm=x((Wk,hm)=>{hm.exports=Zl;var C8=128,dm=127;function Zl(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o||n>49)throw Zl.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&dm)<<n:(s&dm)*Math.pow(2,n),n+=7}while(s>=C8);return Zl.bytes=i-e,r}});var gm=x((Yk,ym)=>{var I8=Math.pow(2,7),T8=Math.pow(2,14),R8=Math.pow(2,21),B8=Math.pow(2,28),P8=Math.pow(2,35),N8=Math.pow(2,42),O8=Math.pow(2,49),D8=Math.pow(2,56),k8=Math.pow(2,63);ym.exports=function(t){return t<I8?1:t<T8?2:t<R8?3:t<B8?4:t<P8?5:t<N8?6:t<O8?7:t<D8?8:t<k8?9:10}});var fi=x((Qk,mm)=>{mm.exports={encode:fm(),decode:pm(),encodingLength:gm()}});var _m=x((Xk,Am)=>{"use strict";var bc=om(),vm=Mo(),{CID:L8}=($i(),ao),{base32:bm}=(Zn(),Xn),{base58btc:q8}=(mn(),gn),U8=(Vi(),so),as=fi(),{toString:wc}=(xt(),_t),{fromString:wm}=(Et(),At),{concat:Ec}=(Rn(),Tn);Am.exports=Fo;function Fo(t,e){return e instanceof Uint8Array?Fo.toString(t,e):Fo.toBytes(t,e)}Fo.toString=function(e,r){switch(vm(e).code){case 4:case 41:return M8(r);case 6:case 273:case 33:case 132:return xm(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return K8(r);case 421:return j8(r);case 444:return Sm(r);case 445:return Sm(r);default:return wc(r,"base16")}};Fo.toBytes=function(e,r){switch(vm(e).code){case 4:return Em(r);case 41:return Em(r);case 6:case 273:case 33:case 132:return Jl(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return F8(r);case 421:return V8(r);case 444:return $8(r);case 445:return H8(r);default:return wm(r,"base16")}};function Em(t){if(!bc.isIP(t))throw new Error("invalid ip address");return bc.toBytes(t)}function M8(t){let e=bc.toString(t);if(!e||!bc.isIP(e))throw new Error("invalid ip address");return e}function Jl(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function xm(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function F8(t){let e=wm(t),r=Uint8Array.from(as.encode(e.length));return Ec([r,e],r.length+e.length)}function K8(t){let e=as.decode(t);if(t=t.slice(as.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return wc(t)}function V8(t){let e;t[0]==="Q"||t[0]==="1"?e=U8.decode(q8.decode(`z${t}`)).bytes:e=L8.parse(t).multihash.bytes;let r=Uint8Array.from(as.encode(e.length));return Ec([r,e],r.length+e.length)}function j8(t){let e=as.decode(t),r=t.slice(as.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return wc(r,"base58btc")}function $8(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=bm.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Jl(n);return Ec([r,i],r.length+i.length)}function H8(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=bm.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Jl(n);return Ec([r,i],r.length+i.length)}function Sm(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=wc(e,"base32"),i=xm(r);return n+":"+i}});var qm=x((Zk,Lm)=>{"use strict";var Cm=_m(),ef=Mo(),Ko=fi(),{concat:Im}=(Rn(),Tn),{toString:z8}=(xt(),_t);Lm.exports={stringToStringTuples:Tm,stringTuplesToString:Rm,tuplesToStringTuples:Pm,stringTuplesToTuples:Bm,bytesToTuples:tf,tuplesToBytes:Nm,bytesToString:G8,stringToBytes:Dm,fromString:W8,fromBytes:km,validateBytes:rf,isValidBytes:Y8,cleanPath:xc,ParseError:nf,protoFromTuple:Vo,sizeForAddr:Om};function Tm(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=ef(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw nf("invalid address: "+t);if(s.path){e.push([i,xc(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function Rm(t){let e=[];return t.map(r=>{let n=Vo(r);return e.push(n.name),r.length>1&&e.push(r[1]),null}),xc(e.join("/"))}function Bm(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=Vo(e);return e.length>1?[r.code,Cm.toBytes(r.code,e[1])]:[r.code]})}function Pm(t){return t.map(e=>{let r=Vo(e);return e[1]?[r.code,Cm.toString(r.code,e[1])]:[r.code]})}function Nm(t){return km(Im(t.map(e=>{let r=Vo(e),n=Uint8Array.from(Ko.encode(r.code));return e.length>1&&(n=Im([n,e[1]])),n})))}function Om(t,e){return t.size>0?t.size/8:t.size===0?0:Ko.decode(e)+Ko.decode.bytes}function tf(t){let e=[],r=0;for(;r<t.length;){let n=Ko.decode(t,r),i=Ko.decode.bytes,s=ef(n),o=Om(s,t.slice(r+i));if(o===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+o);if(r+=o+i,r>t.length)throw nf("Invalid address Uint8Array: "+z8(t,"base16"));e.push([n,a])}return e}function G8(t){let e=tf(t),r=Pm(e);return Rm(r)}function Dm(t){t=xc(t);let e=Tm(t),r=Bm(e);return Nm(r)}function W8(t){return Dm(t)}function km(t){let e=rf(t);if(e)throw e;return Uint8Array.from(t)}function rf(t){try{tf(t)}catch(e){return e}}function Y8(t){return rf(t)===void 0}function xc(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function nf(t){return new Error("Error parsing address: "+t)}function Vo(t){return ef(t[0])}});var Tt=x((Jk,Fm)=>{"use strict";var vr=qm(),cs=Mo(),Um=fi(),{CID:Q8}=($i(),ao),{base58btc:X8}=(mn(),gn),Z8=he(),J8=Symbol.for("nodejs.util.inspect.custom"),{toString:Sc}=(xt(),_t),{equals:e4}=(Dr(),Or),sf=new Map,Mm=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Dt=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,Mm,{value:!0}),e instanceof Uint8Array)this.bytes=vr.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=vr.fromString(e)}else if(Dt.isMultiaddr(e))this.bytes=vr.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return vr.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},cs(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=Um.decode(r,n),s=Um.decode.bytes,o=cs(i);n+=vr.sizeForAddr(o,r.slice(n+s))+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return vr.bytesToTuples(this.bytes)}stringTuples(){let e=vr.bytesToTuples(this.bytes);return vr.tuplesToStringTuples(e)}encapsulate(e){return e=new Dt(e),new Dt(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new Dt(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Dt(vr.tuplesToBytes(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===cs.names.ipfs.code).pop();if(r&&r[1]){let n=r[1];return n[0]==="Q"||n[0]==="1"?Sc(X8.decode(`z${n}`),"base58btc"):Sc(Q8.parse(n).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!cs(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return e4(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(!e)return[this];let r=sf.get(e.name);if(!r)throw Z8(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(i=>new Dt(i))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new Dt("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return Dt.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof Dt||Boolean(e&&e[Mm])}[J8](){return"<Multiaddr "+Sc(this.bytes,"base16")+" - "+vr.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+Sc(this.bytes,"base16")+" - "+vr.bytesToString(this.bytes)+">"}};Dt.protocols=cs;Dt.resolvers=sf;function t4(t){return new Dt(t)}Fm.exports={Multiaddr:Dt,multiaddr:t4,protocols:cs,resolvers:sf}});var of=x((eL,Km)=>{"use strict";var r4=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};Km.exports=r4});var jm=x((tL,Vm)=>{"use strict";var n4=async function*(t,e){for await(let r of t)yield e(r)};Vm.exports=n4});var Hm=x((rL,$m)=>{"use strict";var i4=async function*(t,e){let r=0;if(!(e<1)){for await(let n of t)if(yield n,r++,r===e)return}};$m.exports=i4});var af=x((nL,zm)=>{"use strict";var s4=he(),o4=of(),a4=jm(),c4=Hm();function u4(t,e){return a4(t,r=>(e.addressBook.add(r.id,r.multiaddrs),r))}function l4(t){let e=new Set;return o4(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*f4(t,e=1){let r=0;for await(let n of t)r++,yield n;if(r<e)throw s4(new Error("not found"),"NOT_FOUND")}function d4(t,e){return e?c4(t,e):t}zm.exports={storeAddresses:u4,uniquePeers:l4,requirePeers:f4,maybeLimitSource:d4}});var Wm=x((sL,Gm)=>{Gm.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var cf=x((aL,Qm)=>{var Ym=Wm();Qm.exports=class{constructor(e){this.hwm=e||16,this.head=new Ym(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new Ym(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var lf=x((cL,Xm)=>{var uf=cf();Xm.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new uf,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let g,v=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;v.push(g.value)}return{done:g.done,value:v}}let h=r.shift();if(h.error)throw h.error;return h}return s?{done:!0}:new Promise((h,g)=>{i=v=>(i=null,v.error?g(v.error):t.writev&&!v.done?h({done:v.done,value:[v.value]}):h(v),n)})},a=h=>i?i(h):(r.push(h),n),c=h=>(r=new uf,i?i({error:h}):(r.push({error:h}),n)),u=h=>s?n:a({done:!1,value:h}),l=h=>s?n:(s=!0,h?c(h):a({done:!0})),f=()=>(r=new uf,l(),{done:!0}),d=h=>(l(h),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:f,throw:d,push:u,end:l},!e)return n;let p=n;return n={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(h){return p.throw(h),e&&(e(h),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(h){return p.end(h),e&&(e(h),e=null),n}},n}});var ff=x((uL,Zm)=>{"use strict";var h4=lf(),p4=async function*(...t){let e=h4();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};Zm.exports=p4});var Kr=x((lL,us)=>{var Jm=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},df=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),Ac=t=>t&&typeof t.sink=="function"&&df(t.source),y4=t=>e=>(t.sink(e),t.source),e1=(...t)=>{if(Ac(t[0])){let e=t[0];t[0]=()=>e.source}else if(df(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&Ac(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)Ac(t[e])&&(t[e]=y4(t[e]));return Jm(...t)};us.exports=e1;us.exports.pipe=e1;us.exports.rawPipe=Jm;us.exports.isIterable=df;us.exports.isDuplex=Ac});var hf=x((fL,t1)=>{"use strict";var g4=async t=>{for await(let e of t)return e};t1.exports=g4});var _c=x((dL,r1)=>{"use strict";var m4=async t=>{for await(let e of t);};r1.exports=m4});var pf=x((hL,n1)=>{"use strict";var ls=new Map,v4=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function b4(t,e,r){for(;ls.get(r);){try{await t()}catch(n){setTimeout(()=>{throw n},1);break}if(!ls.get(r))break;await new Promise(n=>{let i=setTimeout(n,e);ls.set(r,i)})}}function w4(t,e,r){r=r||e;let n=v4(),i=setTimeout(()=>{b4(t,e,n)},r);return ls.set(n,i),n}function E4(t){let e=ls.get(t);e&&(clearTimeout(e),ls.delete(t))}n1.exports={setDelayedInterval:w4,clearDelayedInterval:E4}});var ot=x(yf=>{"use strict";yf.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};yf.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var o1=x((yL,s1)=>{"use strict";var x4=he(),{messages:S4,codes:A4}=ot(),i1=class{constructor(e){this._dht=e}async findPeer(e,r={}){for await(let n of this._dht.findPeer(e,r))if(n.name==="FINAL_PEER")return n.peer;throw x4(new Error(S4.NOT_FOUND),A4.ERR_NOT_FOUND)}async*getClosestPeers(e,r={}){for await(let n of this._dht.getClosestPeers(e,r))n.name==="PEER_RESPONSE"&&(yield*n.closer)}};s1.exports={DHTPeerRouting:i1}});var h1=x((gL,d1)=>{"use strict";var a1=Ne(),_4=Object.assign(a1("libp2p:peer-routing"),{error:a1("libp2p:peer-routing:err")}),Cc=he(),{storeAddresses:c1,uniquePeers:C4,requirePeers:I4}=af(),u1=ff(),{pipe:l1}=Kr(),T4=hf(),R4=_c(),B4=of(),{setDelayedInterval:P4,clearDelayedInterval:N4}=pf(),{DHTPeerRouting:O4}=o1(),f1=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new O4(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=P4(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await R4(this.getClosestPeers(this._peerId.id))}catch(e){_4.error(e)}}stop(){N4(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw Cc(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw Cc(new Error("Should not try to find self"),"ERR_FIND_SELF");let n=await l1(u1(...this._routers.map(i=>async function*(){try{yield await i.findPeer(e,r)}catch(s){yield}}())),i=>B4(i,Boolean),i=>c1(i,this._peerStore),i=>T4(i));if(n)return n;throw Cc(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw Cc(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*l1(u1(...this._routers.map(n=>n.getClosestPeers(e,r))),n=>c1(n,this._peerStore),n=>C4(n),n=>I4(n))}};d1.exports=f1});var g1=x((mL,y1)=>{"use strict";var D4=_c(),p1=class{constructor(e){this._dht=e}async provide(e){await D4(this._dht.provide(e))}async*findProviders(e,r){for await(let n of this._dht.findProviders(e,r))n.name==="PROVIDER"&&(yield*n.providers)}};y1.exports={DHTContentRouting:p1}});var b1=x((vL,v1)=>{"use strict";var di=he(),{messages:jo,codes:$o}=ot(),{storeAddresses:k4,uniquePeers:L4,requirePeers:q4,maybeLimitSource:U4}=af(),M4=_c(),F4=ff(),{pipe:K4}=Kr(),{DHTContentRouting:V4}=g1(),m1=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new V4(this.dht))}async*findProviders(e,r={}){if(!this.routers.length)throw di(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*K4(F4(...this.routers.map(n=>n.findProviders(e,r))),n=>k4(n,this.libp2p.peerStore),n=>L4(n),n=>U4(n,r.maxNumProviders),n=>q4(n))}async provide(e){if(!this.routers.length)throw di(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(r=>r.provide(e)))}async put(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw di(new Error(jo.NOT_STARTED_YET),$o.DHT_NOT_STARTED);await M4(this.dht.put(e,r,n))}async get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw di(new Error(jo.NOT_STARTED_YET),$o.DHT_NOT_STARTED);for await(let n of this.dht.get(e,r))if(n.name==="VALUE")return{from:n.peerId,val:n.value};throw di(new Error(jo.NOT_FOUND),$o.ERR_NOT_FOUND)}async*getMany(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw di(new Error(jo.NOT_STARTED_YET),$o.DHT_NOT_STARTED);if(!r)return;let i=0;for await(let s of this.dht.get(e,n))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},i++,i===r))break;if(i===0)throw di(new Error(jo.NOT_FOUND),$o.ERR_NOT_FOUND)}};v1.exports=m1});var gf=x((bL,S1)=>{"use strict";var j4=at(),{Multiaddr:w1}=Tt(),E1=he(),{codes:x1}=ot();function $4(t){typeof t=="string"&&(t=new w1(t));let e;if(w1.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw E1(new Error(`${t} does not have a valid peer type`),x1.ERR_INVALID_MULTIADDR);try{t=j4.createFromB58String(r)}catch(n){throw E1(new Error(`${t} is not a valid peer type`),x1.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}S1.exports=$4});var _1=x((wL,A1)=>{"use strict";A1.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var hs=x((R1,B1)=>{"use strict";var Ic=_1(),{hasOwnProperty:C1}=Object.prototype,{propertyIsEnumerable:H4}=Object,fs=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),z4=R1,I1={concatArrays:!1,ignoreUndefined:!1},Tc=t=>{let e=[];for(let r in t)C1.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)H4.call(t,n)&&e.push(n)}return e};function ds(t){return Array.isArray(t)?G4(t):Ic(t)?W4(t):t}function G4(t){let e=t.slice(0,0);return Tc(t).forEach(r=>{fs(e,r,ds(t[r]))}),e}function W4(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Tc(t).forEach(r=>{fs(e,r,ds(t[r]))}),e}var T1=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]=="undefined"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?fs(t,i,mf(t[i],e[i],n)):fs(t,i,ds(e[i])))}),t),Y4=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!C1.call(s,a)||(o.push(String(a)),s===t?fs(n,i++,s[a]):fs(n,i++,ds(s[a])));n=T1(n,s,Tc(s).filter(a=>!o.includes(a)),r)}),n};function mf(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?Y4(t,e,r):!Ic(e)||!Ic(t)?ds(e):T1(t,e,Tc(e),r)}B1.exports=function(...t){let e=mf(ds(I1),this!==z4&&this||{},I1),r={_:{}};for(let n of t)if(n!==void 0){if(!Ic(n))throw new TypeError("`"+n+"` is not an Option Object");r=mf(r,{_:n},e)}return r._}});var O1=x((EL,N1)=>{"use strict";N1.exports=P1;var Q4=_u(),Mn=P1.prototype,X4=new Date%1e9;function Z4(){return(Math.random()*1e9>>>0)+X4++}function P1(t){t=t||{},this.id=t.id||Z4(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}Mn.has=function(t){return t in this._lookup};Mn.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};Mn.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};Mn.set=function(t,e,r){var n=this._lookup[t],i=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this};Mn.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};Mn.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=Q4(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this};Mn.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};Mn.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var Ho=x((ps,D1)=>{"use strict";var J4=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof sn!="undefined")return sn;throw new Error("unable to locate global object")},sn=J4();D1.exports=ps=sn.fetch;sn.fetch&&(ps.default=sn.fetch.bind(sn));ps.Headers=sn.Headers;ps.Request=sn.Request;ps.Response=sn.Response});var k1=x((xL,vf)=>{"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?vf.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:vf.exports={default:Ho().default,Headers:Ho().Headers,Request:Ho().Request,Response:Ho().Response}});var q1=x((SL,L1)=>{"use strict";var{default:eB,Headers:tB}=k1();function rB({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function nB(t){return eB(t,{headers:new tB({accept:"application/dns-json"})})}function iB(t,e){return`${e}_${t}`}L1.exports={buildResource:rB,fetch:nB,getCacheKey:iB}});var F1=x((AL,M1)=>{"use strict";var U1=Ne(),Rc=U1("dns-over-http-resolver");Rc.error=U1("dns-over-http-resolver:error");var sB=O1(),ar=q1(),Bc=class{constructor({maxCache:e=100}={}){this._cache=new sB({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let n=Math.floor(Math.random()*r),i=e[r];e[r]=e[n],e[n]=i}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",n=this._cache.get(ar.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await ar.fetch(ar.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(ar.getCacheKey(e,r),a,{ttl:c}),a}catch(s){Rc.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",n=this._cache.get(ar.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await ar.fetch(ar.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(ar.getCacheKey(e,r),a,{ttl:c}),a}catch(s){Rc.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",n=this._cache.get(ar.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await ar.fetch(ar.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(ar.getCacheKey(e,r),a,{ttl:c}),a}catch(s){Rc.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};Bc.Resolver=Bc;M1.exports=Bc});var V1=x((_L,K1)=>{"use strict";var oB=F1();K1.exports=oB});var $1=x((CL,j1)=>{"use strict";var aB=Mo(),{code:cB}=aB("dnsaddr");async function uB(t){let e=V1(),r=new e,n=t.getPeerId(),[,i]=t.stringTuples().find(([a])=>a===cB)||[],o=(await r.resolveTxt(`_dnsaddr.${i}`)).flat().map(a=>a.split("=")[1]);return n&&(o=o.filter(a=>a.includes(n))),o}j1.exports={dnsaddrResolver:uB}});var Pc=x((IL,H1)=>{"use strict";H1.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var bf=x((TL,lB)=>{lB.exports={name:"libp2p",version:"0.35.0",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"@motrix/nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.21.0","libp2p-interfaces":"^2.0.1","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^2.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^4.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3","datastore-core":"^6.0.7",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.0","libp2p-interfaces-compliance-tests":"^2.0.1","libp2p-interop":"^0.5.0","libp2p-kad-dht":"^0.27.1","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.1","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","Volker Mische <volker.mische@gmail.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Richard Littauer <richard.littauer@gmail.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Franck Royer <franck@royer.one>","Elven <mon.samuel@qq.com>","Robert Kiel <robert.kiel@hoprnet.org>","Andrew Nesbitt <andrewnez@gmail.com>","Samlior <samlior@foxmail.com>","Thomas Eizinger <thomas@eizinger.io>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","greenSnot <greenSnot@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>"]}});var wf=x((RL,Vr)=>{"use strict";var fB=bf().version;Vr.exports.PROTOCOL_VERSION="ipfs/0.1.0";Vr.exports.AGENT_VERSION=`js-libp2p/${fB}`;Vr.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";Vr.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";Vr.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";Vr.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";Vr.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";Vr.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";Vr.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var Nc=x((BL,G1)=>{"use strict";var z1=60*1e3;G1.exports={ADVERTISE_BOOT_DELAY:15*z1,ADVERTISE_TTL:30*z1,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var W1=x(zo=>{(function(){var t,e,r,n,i,s,o,a;a=function(c){var u,l,f,d;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,f=(c&255<<8)>>>8,d=c&255,[u,l,f,d].join(".")},o=function(c){var u,l,f,d,p,h;for(u=[],f=d=0;d<=3&&c.length!==0;f=++d){if(f>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}h=e(c),p=h[0],l=h[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},n=r("0"),s=r("a"),i=r("A"),e=function(c){var u,l,f,d,p;for(d=0,u=10,l="9",f=0,c.length>1&&c[f]==="0"&&(c[f+1]==="x"||c[f+1]==="X"?(f+=2,u=16):"0"<=c[f+1]&&c[f+1]<="9"&&(f++,u=8,l="7")),p=f;f<c.length;){if("0"<=c[f]&&c[f]<=l)d=d*u+(r(c[f])-n)>>>0;else if(u===16)if("a"<=c[f]&&c[f]<="f")d=d*u+(10+r(c[f])-s)>>>0;else if("A"<=c[f]&&c[f]<="F")d=d*u+(10+r(c[f])-i)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");f++}if(f===p)throw new Error("empty octet");return[d,f]},t=function(){function c(u,l){var f,d,p,h;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(h=u.split("/",2),u=h[0],l=h[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(g){throw f=g,new Error("Invalid mask: "+l)}for(d=p=32;p>=0;d=--p)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(g){throw f=g,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,f,d;for(d=o(this.first),f=o(this.last),l=0;d<=f;)u(a(d),d,l),l++,d++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),zo.ip2long=o,zo.long2ip=a,zo.Netmask=t}).call(zo)});var Q1=x((Y1,Oc)=>{(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},n=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(p,h){if(p.indexOf("::")!==p.lastIndexOf("::"))return null;let g=0,v=-1,A=(p.match(a.zoneIndex)||[])[0],B,k;for(A&&(A=A.substring(1),p=p.replace(/%.+$/,""));(v=p.indexOf(":",v+1))>=0;)g++;if(p.substr(0,2)==="::"&&g--,p.substr(-2,2)==="::"&&g--,g>h)return null;for(k=h-g,B=":";k--;)B+="0:";return p=p.replace("::",B),p[0]===":"&&(p=p.slice(1)),p[p.length-1]===":"&&(p=p.slice(0,-1)),h=function(){let z=p.split(":"),q=[];for(let L=0;L<z.length;L++)q.push(parseInt(z[L],16));return q}(),{parts:h,zoneId:A}}function u(p,h,g,v){if(p.length!==h.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let A=0,B;for(;v>0;){if(B=g-v,B<0&&(B=0),p[A]>>B!=h[A]>>B)return!1;v-=g,A+=1}return!0}function l(p){if(i.test(p))return parseInt(p,16);if(p[0]==="0"&&!isNaN(parseInt(p[1],10))){if(n.test(p))return parseInt(p,8);throw new Error(`ipaddr: cannot parse ${p} as octal`)}return parseInt(p,10)}function f(p,h){for(;p.length<h;)p=`0${p}`;return p}let d={};d.IPv4=function(){function p(h){if(h.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let g,v;for(g=0;g<h.length;g++)if(v=h[g],!(0<=v&&v<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=h}return p.prototype.SpecialRanges={unspecified:[[new p([0,0,0,0]),8]],broadcast:[[new p([255,255,255,255]),32]],multicast:[[new p([224,0,0,0]),4]],linkLocal:[[new p([169,254,0,0]),16]],loopback:[[new p([127,0,0,0]),8]],carrierGradeNat:[[new p([100,64,0,0]),10]],private:[[new p([10,0,0,0]),8],[new p([172,16,0,0]),12],[new p([192,168,0,0]),16]],reserved:[[new p([192,0,0,0]),24],[new p([192,0,2,0]),24],[new p([192,88,99,0]),24],[new p([198,51,100,0]),24],[new p([203,0,113,0]),24],[new p([240,0,0,0]),4]]},p.prototype.kind=function(){return"ipv4"},p.prototype.match=function(h,g){let v;if(g===void 0&&(v=h,h=v[0],g=v[1]),h.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,h.octets,8,g)},p.prototype.prefixLengthFromSubnetMask=function(){let h=0,g=!1,v={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},A,B,k;for(A=3;A>=0;A-=1)if(B=this.octets[A],B in v){if(k=v[B],g&&k!==0)return null;k!==8&&(g=!0),h+=k}else return null;return 32-h},p.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){return this.octets.slice(0)},p.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)},p.prototype.toNormalizedString=function(){return this.toString()},p.prototype.toString=function(){return this.octets.join(".")},p}(),d.IPv4.broadcastAddressFromCIDR=function(p){try{let h=this.parseCIDR(p),g=h[0].toByteArray(),v=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),A=[],B=0;for(;B<4;)A.push(parseInt(g[B],10)|parseInt(v[B],10)^255),B++;return new this(A)}catch(h){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(p){return this.parser(p)!==null},d.IPv4.isValid=function(p){try{return new this(this.parser(p)),!0}catch(h){return!1}},d.IPv4.isValidFourPartDecimal=function(p){return!!(d.IPv4.isValid(p)&&p.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},d.IPv4.networkAddressFromCIDR=function(p){let h,g,v,A,B;try{for(h=this.parseCIDR(p),v=h[0].toByteArray(),B=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),A=[],g=0;g<4;)A.push(parseInt(v[g],10)&parseInt(B[g],10)),g++;return new this(A)}catch(k){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(p){let h=this.parser(p);if(h===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(h)},d.IPv4.parseCIDR=function(p){let h;if(h=p.match(/^(.+)\/(\d+)$/)){let g=parseInt(h[2]);if(g>=0&&g<=32){let v=[this.parse(h[1]),g];return Object.defineProperty(v,"toString",{value:function(){return this.join("/")}}),v}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(p){let h,g,v;if(h=p.match(r.fourOctet))return function(){let A=h.slice(1,6),B=[];for(let k=0;k<A.length;k++)g=A[k],B.push(l(g));return B}();if(h=p.match(r.longValue)){if(v=l(h[1]),v>4294967295||v<0)throw new Error("ipaddr: address outside defined range");return function(){let A=[],B;for(B=0;B<=24;B+=8)A.push(v>>B&255);return A}().reverse()}else return(h=p.match(r.twoOctet))?function(){let A=h.slice(1,4),B=[];if(v=l(A[1]),v>16777215||v<0)throw new Error("ipaddr: address outside defined range");return B.push(l(A[0])),B.push(v>>16&255),B.push(v>>8&255),B.push(v&255),B}():(h=p.match(r.threeOctet))?function(){let A=h.slice(1,5),B=[];if(v=l(A[2]),v>65535||v<0)throw new Error("ipaddr: address outside defined range");return B.push(l(A[0])),B.push(l(A[1])),B.push(v>>8&255),B.push(v&255),B}():null},d.IPv4.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>32)throw new Error("ipaddr: invalid IPv4 prefix length");let h=[0,0,0,0],g=0,v=Math.floor(p/8);for(;g<v;)h[g]=255,g++;return v<4&&(h[v]=Math.pow(2,p%8)-1<<8-p%8),new this(h)},d.IPv6=function(){function p(h,g){let v,A;if(h.length===16)for(this.parts=[],v=0;v<=14;v+=2)this.parts.push(h[v]<<8|h[v+1]);else if(h.length===8)this.parts=h;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(v=0;v<this.parts.length;v++)if(A=this.parts[v],!(0<=A&&A<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");g&&(this.zoneId=g)}return p.prototype.SpecialRanges={unspecified:[new p([0,0,0,0,0,0,0,0]),128],linkLocal:[new p([65152,0,0,0,0,0,0,0]),10],multicast:[new p([65280,0,0,0,0,0,0,0]),8],loopback:[new p([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new p([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new p([0,0,0,0,0,65535,0,0]),96],rfc6145:[new p([0,0,0,0,65535,0,0,0]),96],rfc6052:[new p([100,65435,0,0,0,0,0,0]),96],"6to4":[new p([8194,0,0,0,0,0,0,0]),16],teredo:[new p([8193,0,0,0,0,0,0,0]),32],reserved:[[new p([8193,3512,0,0,0,0,0,0]),32]]},p.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},p.prototype.kind=function(){return"ipv6"},p.prototype.match=function(h,g){let v;if(g===void 0&&(v=h,h=v[0],g=v[1]),h.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,h.parts,16,g)},p.prototype.prefixLengthFromSubnetMask=function(){let h=0,g=!1,v={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},A,B;for(let k=7;k>=0;k-=1)if(A=this.parts[k],A in v){if(B=v[A],g&&B!==0)return null;B!==16&&(g=!0),h+=B}else return null;return 128-h},p.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){let h,g=[],v=this.parts;for(let A=0;A<v.length;A++)h=v[A],g.push(h>>8),g.push(h&255);return g},p.prototype.toFixedLengthString=function(){let h=function(){let v=[];for(let A=0;A<this.parts.length;A++)v.push(f(this.parts[A].toString(16),4));return v}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),h+g},p.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let h=this.parts.slice(-2),g=h[0],v=h[1];return new d.IPv4([g>>8,g&255,v>>8,v&255])},p.prototype.toNormalizedString=function(){let h=function(){let v=[];for(let A=0;A<this.parts.length;A++)v.push(this.parts[A].toString(16));return v}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),h+g},p.prototype.toRFC5952String=function(){let h=/((^|:)(0(:|$)){2,})/g,g=this.toNormalizedString(),v=0,A=-1,B;for(;B=h.exec(g);)B[0].length>A&&(v=B.index,A=B[0].length);return A<0?g:`${g.substring(0,v)}::${g.substring(v+A)}`},p.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},p}(),d.IPv6.broadcastAddressFromCIDR=function(p){try{let h=this.parseCIDR(p),g=h[0].toByteArray(),v=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),A=[],B=0;for(;B<16;)A.push(parseInt(g[B],10)|parseInt(v[B],10)^255),B++;return new this(A)}catch(h){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${h})`)}},d.IPv6.isIPv6=function(p){return this.parser(p)!==null},d.IPv6.isValid=function(p){if(typeof p=="string"&&p.indexOf(":")===-1)return!1;try{let h=this.parser(p);return new this(h.parts,h.zoneId),!0}catch(h){return!1}},d.IPv6.networkAddressFromCIDR=function(p){let h,g,v,A,B;try{for(h=this.parseCIDR(p),v=h[0].toByteArray(),B=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),A=[],g=0;g<16;)A.push(parseInt(v[g],10)&parseInt(B[g],10)),g++;return new this(A)}catch(k){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${k})`)}},d.IPv6.parse=function(p){let h=this.parser(p);if(h.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(h.parts,h.zoneId)},d.IPv6.parseCIDR=function(p){let h,g,v;if((g=p.match(/^(.+)\/(\d+)$/))&&(h=parseInt(g[2]),h>=0&&h<=128))return v=[this.parse(g[1]),h],Object.defineProperty(v,"toString",{value:function(){return this.join("/")}}),v;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(p){let h,g,v,A,B,k;if(v=p.match(a.deprecatedTransitional))return this.parser(`::ffff:${v[1]}`);if(a.native.test(p))return c(p,8);if((v=p.match(a.transitional))&&(k=v[6]||"",h=c(v[1].slice(0,-1)+k,6),h.parts)){for(B=[parseInt(v[2]),parseInt(v[3]),parseInt(v[4]),parseInt(v[5])],g=0;g<B.length;g++)if(A=B[g],!(0<=A&&A<=255))return null;return h.parts.push(B[0]<<8|B[1]),h.parts.push(B[2]<<8|B[3]),{parts:h.parts,zoneId:h.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>128)throw new Error("ipaddr: invalid IPv6 prefix length");let h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,v=Math.floor(p/8);for(;g<v;)h[g]=255,g++;return v<16&&(h[v]=Math.pow(2,p%8)-1<<8-p%8),new this(h)},d.fromByteArray=function(p){let h=p.length;if(h===4)return new d.IPv4(p);if(h===16)return new d.IPv6(p);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(p){return d.IPv6.isValid(p)||d.IPv4.isValid(p)},d.parse=function(p){if(d.IPv6.isValid(p))return d.IPv6.parse(p);if(d.IPv4.isValid(p))return d.IPv4.parse(p);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(p){try{return d.IPv6.parseCIDR(p)}catch(h){try{return d.IPv4.parseCIDR(p)}catch(g){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(p){let h=this.parse(p);return h.kind()==="ipv6"&&h.isIPv4MappedAddress()?h.toIPv4Address():h},d.subnetMatch=function(p,h,g){let v,A,B,k;g==null&&(g="unicast");for(A in h)if(Object.prototype.hasOwnProperty.call(h,A)){for(B=h[A],B[0]&&!(B[0]instanceof Array)&&(B=[B]),v=0;v<B.length;v++)if(k=B[v],p.kind()===k[0].kind()&&p.match.apply(p,k))return A}return g},typeof Oc!="undefined"&&Oc.exports?Oc.exports=d:t.ipaddr=d})(Y1)});var ev=x(Go=>{"use strict";var X1=Go&&Go.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Go,"__esModule",{value:!0});var dB=W1(),hB=X1(zl()),pB=X1(Wl()),Z1=Q1(),yB=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],gB=yB.map(t=>new dB.Netmask(t));function mB(t){for(let e of gB)if(e.contains(t))return!0;return!1}function J1(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}Go.default=t=>{if(Z1.isValid(t)){let e=Z1.parse(t);if(e.kind()==="ipv4")return mB(e.toNormalizedString());if(e.kind()==="ipv6")return J1(t)}else if(pB.default(t)&&hB.default.v6().test(t))return J1(t)}});var Ef=x((OL,tv)=>{"use strict";tv.exports=ev().default});var nv=x((DL,rv)=>{"use strict";var vB=Ef();function bB(t){let{address:e}=t.nodeAddress();return vB(e)}rv.exports=bB});var xf=x((kL,sv)=>{"use strict";var iv=nv();function wB(t,e){let r=iv(t.multiaddr),n=iv(e.multiaddr);return r&&!n?1:!r&&n||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function EB(t){return[...t].sort(wB)}sv.exports.publicAddressesFirst=EB});var av=x((LL,Sf)=>{"use strict";var ov=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};Sf.exports=ov;Sf.exports.default=ov});var uv=x((qL,Af)=>{"use strict";var cv=(t,...e)=>new Promise(r=>{r(t(...e))});Af.exports=cv;Af.exports.default=cv});var fv=x((UL,_f)=>{"use strict";var xB=uv(),lv=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,n=()=>{r--,e.length>0&&e.shift()()},i=(a,c,...u)=>{r++;let l=xB(a,...u);c(l),l.then(n,n)},s=(a,c,...u)=>{r<t?i(a,c,...u):e.push(i.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};_f.exports=lv;_f.exports.default=lv});var hv=x((ML,dv)=>{"use strict";var Cf=av(),SB=fv();dv.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,n=SB(r);return Promise.all(t.map(i=>i&&typeof i.then=="function"?Cf(i):Cf(typeof i=="function"?n(()=>i()):Promise.resolve(i))))}});var gv=x((FL,yv)=>{"use strict";var ys=Qr(),pv=ys.Reader,AB=ys.Writer,We=ys.util,Wo=ys.roots["libp2p-envelope"]||(ys.roots["libp2p-envelope"]={});Wo.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=We.newBuffer([]),t.prototype.payloadType=We.newBuffer([]),t.prototype.payload=We.newBuffer([]),t.prototype.signature=We.newBuffer([]),t.encode=function(r,n){return n||(n=AB.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof pv||(r=pv.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Wo.Envelope;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Wo.Envelope)return r;var n=new Wo.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?We.base64.decode(r.publicKey,n.publicKey=We.newBuffer(We.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?We.base64.decode(r.payloadType,n.payloadType=We.newBuffer(We.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?We.base64.decode(r.payload,n.payload=We.newBuffer(We.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?We.base64.decode(r.signature,n.signature=We.newBuffer(We.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=We.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=We.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=We.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=We.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?We.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?We.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?We.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?We.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ys.util.toJSONOptions)},t}();yv.exports=Wo});var kc=x((KL,bv)=>{"use strict";var _B=he(),{concat:CB}=(Rn(),Tn),{fromString:IB}=(Et(),At),TB=gc(),RB=at(),If=fi(),{equals:Dc}=(Dr(),Or),{codes:BB}=ot(),{Envelope:mv}=gv(),Fn=class{constructor({peerId:e,payloadType:r,payload:n,signature:i}){this.peerId=e,this.payloadType=r,this.payload=n,this.signature=i,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=TB.marshalPublicKey(this.peerId.pubKey);return this._marshal=mv.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return Dc(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&Dc(this.payloadType,e.payloadType)&&Dc(this.payload,e.payload)&&Dc(this.signature,e.signature)}validate(e){let r=vv(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},vv=(t,e,r)=>{let n=IB(t),i=If.encode(n.byteLength),s=If.encode(e.length),o=If.encode(r.length);return CB([new Uint8Array(i),n,new Uint8Array(s),e,new Uint8Array(o),r])};Fn.createFromProtobuf=async t=>{let e=mv.decode(t),r=await RB.createFromPubKey(e.publicKey);return new Fn({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Fn.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),s=vv(r,n,i),o=await e.privKey.sign(s);return new Fn({peerId:e,payloadType:n,payload:i,signature:o})};Fn.openAndCertify=async(t,e)=>{let r=await Fn.createFromProtobuf(t);if(!await r.validate(e))throw _B(new Error("envelope signature is not valid for the given domain"),BB.ERR_SIGNATURE_NOT_VALID);return r};bv.exports=Fn});var Ev=x((VL,wv)=>{"use strict";function PB(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,n)=>e[n].equals(r))}wv.exports=PB});var Av=x((jL,Sv)=>{"use strict";var hi=Qr(),Lc=hi.Reader,xv=hi.Writer,rt=hi.util,cr=hi.roots["libp2p-peer-record"]||(hi.roots["libp2p-peer-record"]={});cr.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.peerId=rt.newBuffer([]),t.prototype.seq=rt.Long?rt.Long.fromBits(0,0,!0):0,t.prototype.addresses=rt.emptyArray,t.encode=function(r,n){if(n||(n=xv.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&n.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)cr.PeerRecord.AddressInfo.encode(r.addresses[i],n.uint32(26).fork()).ldelim();return n},t.decode=function(r,n){r instanceof Lc||(r=Lc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new cr.PeerRecord;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(cr.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof cr.PeerRecord)return r;var n=new cr.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?rt.base64.decode(r.peerId,n.peerId=rt.newBuffer(rt.base64.length(r.peerId)),0):r.peerId.length&&(n.peerId=r.peerId)),r.seq!=null&&(rt.Long?(n.seq=rt.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new rt.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=cr.PeerRecord.AddressInfo.fromObject(r.addresses[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=rt.newBuffer(i.peerId))),rt.Long){var s=new rt.Long(0,0,!0);i.seq=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.seq=n.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?rt.base64.encode(r.peerId,0,r.peerId.length):n.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?rt.Long.prototype.toString.call(r.seq):n.longs===Number?new rt.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){i.addresses=[];for(var o=0;o<r.addresses.length;++o)i.addresses[o]=cr.PeerRecord.AddressInfo.toObject(r.addresses[o],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,hi.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=rt.newBuffer([]),e.encode=function(n,i){return i||(i=xv.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof Lc||(n=Lc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new cr.PeerRecord.AddressInfo;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof cr.PeerRecord.AddressInfo)return n;var i=new cr.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?rt.base64.decode(n.multiaddr,i.multiaddr=rt.newBuffer(rt.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=rt.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?rt.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,hi.util.toJSONOptions)},e}(),t}();Sv.exports=cr});var Cv=x(($L,_v)=>{"use strict";var NB="libp2p-peer-record",OB=Uint8Array.from([3,1]);_v.exports={ENVELOPE_DOMAIN_PEER_RECORD:NB,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:OB}});var qc=x((HL,Rv)=>{"use strict";var{Multiaddr:DB}=Tt(),kB=at(),LB=Ev(),{PeerRecord:Iv}=Av(),{ENVELOPE_DOMAIN_PEER_RECORD:Tv,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:qB}=Cv(),pi=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:n=Date.now()}){this.domain=Tv,this.codec=qB,this.peerId=e,this.multiaddrs=r,this.seqNumber=n,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=Iv.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof pi)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!LB(this.multiaddrs,e.multiaddrs))}};pi.createFromProtobuf=t=>{let e=Iv.decode(t),r=kB.createFromBytes(e.peerId),n=(e.addresses||[]).map(s=>new DB(s.multiaddr)),i=Number(e.seq);return new pi({peerId:r,multiaddrs:n,seqNumber:i})};pi.DOMAIN=Tv;Rv.exports=pi});var Tf=x((zL,Bv)=>{"use strict";var UB=kc(),MB=qc();async function FB(t){let e=new MB({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await UB.seal(e,t.peerId);t.peerStore.addressBook.consumePeerRecord(r)}Bv.exports.updateSelfPeerRecord=FB});var Bf=x((GL,Ov)=>{"use strict";var Pv=Ne(),yi=Object.assign(Pv("libp2p:transports"),{error:Pv("libp2p:transports:err")}),KB=hv(),{codes:gs}=ot(),Yo=he(),{updateSelfPeerRecord:Nv}=Tf(),Rf=class{constructor({libp2p:e,upgrader:r,faultTolerance:n=Uc.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=n}add(e,r,n={}){if(yi("adding %s",e),!e)throw Yo(new Error(`Transport must have a valid key, was given '${e}'`),gs.ERR_INVALID_KEY);if(this._transports.has(e))throw Yo(new Error("There is already a transport with this key"),gs.ERR_DUPLICATE_TRANSPORT);let i=new r({...n,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,i),this._listenerOptions.set(e,n.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,n]of this._listeners)for(yi("closing listeners for %s",r);n.length;){let i=n.pop();i.removeAllListeners("listening"),i.removeAllListeners("close"),e.push(i.close())}await Promise.all(e),yi("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let n=this.transportForMultiaddr(e);if(!n)throw Yo(new Error(`No transport available for address ${String(e)}`),gs.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,r)}catch(i){throw i.code||(i.code=gs.ERR_TRANSPORT_DIAL_FAILED),i}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let n of r)e=[...e,...n.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){yi("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[n,i]of this._transports.entries()){let s=i.filter(e),o=[];for(let u of s){yi("creating listener for %s on %s",n,u);let l=i.createListener(this._listenerOptions.get(n));this._listeners.get(n).push(l),l.on("listening",()=>Nv(this.libp2p)),l.on("close",()=>Nv(this.libp2p)),o.push(l.listen(u))}if(o.length===0){r.push(n);continue}if(!(await KB(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==Uc.NO_FATAL)throw Yo(new Error(`Transport (${n}) could not listen on any available address`),gs.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let n=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===Uc.FATAL_ALL)throw Yo(new Error(n),gs.ERR_NO_VALID_ADDRESSES);yi(`libp2p in dial mode only: ${n}`)}}async remove(e){if(yi("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},Uc={FATAL_ALL:0,NO_FATAL:1};Rf.FaultTolerance=Uc;Ov.exports=Rf});var Lv=x((WL,kv)=>{"use strict";var VB=hs(),{dnsaddrResolver:jB}=$1(),Pf=Pc(),{AGENT_VERSION:$B}=wf(),Dv=Nc(),{publicAddressesFirst:HB}=xf(),{FaultTolerance:zB}=Bf(),GB={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},transportManager:{faultTolerance:zB.FATAL_ALL},dialer:{maxParallelDials:Pf.MAX_PARALLEL_DIALS,maxDialsPerPeer:Pf.MAX_PER_PEER_DIALS,dialTimeout:Pf.DIAL_TIMEOUT,resolvers:{dnsaddr:jB},addressSorter:HB},host:{agentVersion:$B},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:Dv.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:Dv.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};kv.exports.validate=t=>{let e=VB(GB,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var Mv=x((YL,Uv)=>{"use strict";var{EventEmitter:WB}=Wr(),{Multiaddr:Qo}=Tt(),YB=at(),qv=class extends WB{constructor(e,{listen:r=[],announce:n=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(i=>i.toString())),this.announce=new Set(n.map(i=>i.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new Qo(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new Qo(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new Qo(e))}addObservedAddr(e){let r=new Qo(e),n=r.getPeerId();n&&YB.createFromB58String(n).equals(this.peerId)&&(r=r.decapsulate(new Qo(`/p2p/${this.peerId}`)));let i=r.toString();this.observed.has(i)||(this.observed.add(i),this.emit("change:addresses"))}};Uv.exports=qv});var Vv=x((QL,Kv)=>{"use strict";var{EventEmitter:QB}=Wr(),Nf=Ne()("latency-monitor:VisibilityChangeEmitter"),Fv=class extends QB{constructor(){super();if(typeof document=="undefined"){Nf('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?Nf("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];Nf(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};Kv.exports=Fv});var Hv=x((XL,$v)=>{"use strict";var{EventEmitter:XB}=Wr(),ZB=Vv(),on=Ne()("latency-monitor:LatencyMonitor"),jv=class extends XB{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:i}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=i||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,on("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?on("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):on("Not emitting summaries"),s.asyncTestFn=n}start(){globalThis.process&&globalThis.process.hrtime?(on("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(on("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(on("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),JB()&&(this._visibilityChangeEmitter=new ZB,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),on("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,n={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},i=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(n.startTime)-n.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,on("MS: %s Data: %O",s,e._latencyData)};on("localData: %O",n),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(n.deltaOffset=0,n.startTime=e.now(),e.asyncTestFn(i)):(n.deltaOffset-=1,i())},n.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function JB(){return typeof window!="undefined"}$v.exports=jv});var Gv=x((ZL,zv)=>{"use strict";zv.exports=function(){return Date.now()}});var Xo=x((JL,Yv)=>{"use strict";var Mc=Gv(),Wv=class{constructor(e,r,n){let i=this;this._started=Mc(),this._rescheduled=0,this._scheduled=r,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(Mc()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=Mc();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=Mc(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function e3(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new Wv(arguments[0],arguments[1],t)}Yv.exports=e3});var rb=x((eq,tb)=>{"use strict";var Qv=Ne(),an=Object.assign(Qv("libp2p:connection-manager"),{error:Qv("libp2p:connection-manager:err")}),Xv=he(),t3=hs(),r3=Hv(),Zv=Xo(),{EventEmitter:n3}=Wr(),i3=at(),{codes:{ERR_INVALID_PARAMETERS:Jv}}=ot(),s3={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},eb=class extends n3{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=t3.call({ignoreUndefined:!0},s3,r),this._options.maxConnections<this._options.minConnections)throw Xv(new Error("Connection Manager maxConnections must be greater than minConnections"),Jv);an("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new r3({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||Zv(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,an("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),an("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let n of r)e.push(n.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",r);let n=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",n);let i=r+n;this._checkMaxLimit("maxData",i),an("metrics update",i),this._timer=Zv(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let r=e.remotePeer,n=r.toB58String(),i=this.connections.get(n);this.emit("peer:connect",e),i?i.push(e):this.connections.set(n,[e]),this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(n)||this._peerValues.set(n,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let r=e.remotePeer.toB58String(),n=this.connections.get(r);n&&n.length>1?(n=n.filter(i=>i.id!==e.id),this.connections.set(r,n)):n&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!i3.isPeerId(e))throw Xv(new Error("peerId must be an instance of peer-id"),Jv);let r=e.toB58String(),n=this.connections.get(r);return n?n.filter(i=>i.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,r){let n=this._options[e];an("checking limit of %s. current value: %d of %d",e,r,n),r>n&&(an("%s: limit exceeded: %s, %d",this._peerId,e,r),this._maybeDisconnectOne())}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((n,i)=>n[1]-i[1])));an("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let n=r[0];an("%s: lowest value peer is %s",this._peerId,n),an("%s: closing a connection to %j",this._peerId,n);for(let i of this.connections.values())if(i[0].remotePeer.toB58String()===n){i[0].close();break}}}}};tb.exports=eb});var ab=x((tq,ob)=>{"use strict";var nb=Ne(),o3=hs(),ib=Xo(),gi=Object.assign(nb("libp2p:connection-manager:auto-dialler"),{error:nb("libp2p:connection-manager:auto-dialler:err")}),a3={enabled:!0,minConnections:0,autoDialInterval:1e4},sb=class{constructor(e,r={}){this._options=o3.call({ignoreUndefined:!0},a3,r),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),gi("options: %j",this._options)}start(){if(!this._options.enabled){gi("not enabled");return}this._running=!0,this._autoDial(),gi("started")}async stop(){if(!this._options.enabled){gi("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),gi("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=ib(this._autoDial,this._options.autoDialInterval);return}let r=Array.from(this._libp2p.peerStore.peers.values()).sort((n,i)=>i.protocols&&i.protocols.length&&(!n.protocols||!n.protocols.length)||i.id.pubKey&&!n.id.pubKey?1:-1);for(let n=0;this._running&&n<r.length&&this._libp2p.connections.size<e;n++)if(!this._libp2p.connectionManager.get(r[n].id)){gi("connecting to a peerStore stored peer %s",r[n].id.toB58String());try{await this._libp2p.dialer.connectToPeer(r[n].id)}catch(i){gi.error("could not connect to peerStore stored peer",i)}}!this._running||(this._autoDialTimeout=ib(this._autoDial,this._options.autoDialInterval))}};ob.exports=sb});var vb=x((rq,mb)=>{"use strict";var{Multiaddr:Of}=Tt(),cb=ce("dns4"),ub=ce("dns6"),lb=ce("dnsaddr"),mi=Rt(ce("dns"),lb,cb,ub),Zo=Rt(ce("ip4"),ce("ip6")),ms=Rt(be(Zo,ce("tcp")),be(mi,ce("tcp"))),Df=be(Zo,ce("udp")),fb=be(Df,ce("utp")),db=be(Df,ce("quic")),vs=Rt(be(ms,ce("ws")),be(mi,ce("ws"))),bs=Rt(be(ms,ce("wss")),be(mi,ce("wss"))),Fc=Rt(be(ms,ce("http")),be(Zo,ce("http")),be(mi,ce("http"))),Kc=Rt(be(ms,ce("https")),be(Zo,ce("https")),be(mi,ce("https"))),kf=Rt(be(vs,ce("p2p-webrtc-star"),ce("p2p")),be(bs,ce("p2p-webrtc-star"),ce("p2p")),be(vs,ce("p2p-webrtc-star")),be(bs,ce("p2p-webrtc-star"))),c3=Rt(be(vs,ce("p2p-websocket-star"),ce("p2p")),be(bs,ce("p2p-websocket-star"),ce("p2p")),be(vs,ce("p2p-websocket-star")),be(bs,ce("p2p-websocket-star"))),Lf=Rt(be(Fc,ce("p2p-webrtc-direct"),ce("p2p")),be(Kc,ce("p2p-webrtc-direct"),ce("p2p")),be(Fc,ce("p2p-webrtc-direct")),be(Kc,ce("p2p-webrtc-direct"))),ws=Rt(vs,bs,Fc,Kc,kf,Lf,ms,fb,db,mi),u3=Rt(be(ws,ce("p2p-stardust"),ce("p2p")),be(ws,ce("p2p-stardust"))),Kn=Rt(be(ws,ce("p2p")),kf,Lf,ce("p2p")),hb=Rt(be(Kn,ce("p2p-circuit"),Kn),be(Kn,ce("p2p-circuit")),be(ce("p2p-circuit"),Kn),be(ws,ce("p2p-circuit")),be(ce("p2p-circuit"),ws),ce("p2p-circuit")),pb=()=>Rt(be(hb,pb),hb),Es=pb(),yb=Rt(be(Es,Kn,Es),be(Kn,Es),be(Es,Kn),Es,Kn);mb.exports={DNS:mi,DNS4:cb,DNS6:ub,DNSADDR:lb,IP:Zo,TCP:ms,UDP:Df,QUIC:db,UTP:fb,HTTP:Fc,HTTPS:Kc,WebSockets:vs,WebSocketsSecure:bs,WebSocketStar:c3,WebRTCStar:kf,WebRTCDirect:Lf,Reliable:ws,Stardust:u3,Circuit:Es,P2P:yb,IPFS:yb};function gb(t){function e(r){if(!Of.isMultiaddr(r))try{r=new Of(r)}catch(i){return!1}let n=t(r.protoNames());return n===null?!1:n===!0||n===!1?n:n.length===0}return e}function be(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:gb(e),partialMatch:e}}function Rt(...t){function e(n){let i=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(n):s.partialMatch(n);return o?(i=o,!0):!1}),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:gb(e),partialMatch:e}}function ce(t){let e=t;function r(i){let s;if(typeof i=="string"||i instanceof Uint8Array)try{s=new Of(i)}catch(a){return!1}else s=i;let o=s.protoNames();return o.length===1&&o[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}});var xs=x((nq,wb)=>{"use strict";var vi=Qr(),Vc=vi.Reader,bb=vi.Writer,ur=vi.util,vt=vi.roots["libp2p-circuit"]||(vi.roots["libp2p-circuit"]={});vt.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,n){return n||(n=bb.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&n.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&vt.CircuitRelay.Peer.encode(r.srcPeer,n.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&vt.CircuitRelay.Peer.encode(r.dstPeer,n.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&n.uint32(32).int32(r.code),n},t.decode=function(r,n){r instanceof Vc||(r=Vc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new vt.CircuitRelay;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=vt.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=vt.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof vt.CircuitRelay)return r;var n=new vt.CircuitRelay;switch(r.type){case"HOP":case 1:n.type=1;break;case"STOP":case 2:n.type=2;break;case"STATUS":case 3:n.type=3;break;case"CAN_HOP":case 4:n.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");n.srcPeer=vt.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");n.dstPeer=vt.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:n.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:n.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:n.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:n.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:n.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:n.code=260;break;case"HOP_CANT_DIAL_DST":case 261:n.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:n.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:n.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:n.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:n.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:n.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:n.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:n.code=351;break;case"STOP_RELAY_REFUSED":case 390:n.code=390;break;case"MALFORMED_MESSAGE":case 400:n.code=400;break}return n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.type=n.enums===String?"HOP":1,i.srcPeer=null,i.dstPeer=null,i.code=n.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(i.type=n.enums===String?vt.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(i.srcPeer=vt.CircuitRelay.Peer.toObject(r.srcPeer,n)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(i.dstPeer=vt.CircuitRelay.Peer.toObject(r.dstPeer,n)),r.code!=null&&r.hasOwnProperty("code")&&(i.code=n.enums===String?vt.CircuitRelay.Status[r.code]:r.code),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,vi.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.id=ur.newBuffer([]),e.prototype.addrs=ur.emptyArray,e.encode=function(n,i){if(i||(i=bb.create()),i.uint32(10).bytes(n.id),n.addrs!=null&&n.addrs.length)for(var s=0;s<n.addrs.length;++s)i.uint32(18).bytes(n.addrs[s]);return i},e.decode=function(n,i){n instanceof Vc||(n=Vc.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new vt.CircuitRelay.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(n.bytes());break;default:n.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw ur.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(n){if(n instanceof vt.CircuitRelay.Peer)return n;var i=new vt.CircuitRelay.Peer;if(n.id!=null&&(typeof n.id=="string"?ur.base64.decode(n.id,i.id=ur.newBuffer(ur.base64.length(n.id)),0):n.id.length&&(i.id=n.id)),n.addrs){if(!Array.isArray(n.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");i.addrs=[];for(var s=0;s<n.addrs.length;++s)typeof n.addrs[s]=="string"?ur.base64.decode(n.addrs[s],i.addrs[s]=ur.newBuffer(ur.base64.length(n.addrs[s])),0):n.addrs[s].length&&(i.addrs[s]=n.addrs[s])}return i},e.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addrs=[]),i.defaults&&(i.bytes===String?s.id="":(s.id=[],i.bytes!==Array&&(s.id=ur.newBuffer(s.id)))),n.id!=null&&n.hasOwnProperty("id")&&(s.id=i.bytes===String?ur.base64.encode(n.id,0,n.id.length):i.bytes===Array?Array.prototype.slice.call(n.id):n.id),n.addrs&&n.addrs.length){s.addrs=[];for(var o=0;o<n.addrs.length;++o)s.addrs[o]=i.bytes===String?ur.base64.encode(n.addrs[o],0,n.addrs[o].length):i.bytes===Array?Array.prototype.slice.call(n.addrs[o]):n.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,vi.util.toJSONOptions)},e}(),t}();wb.exports=vt});var xb=x((iq,Eb)=>{Eb.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var Ab=x((oq,Sb)=>{Sb.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var Mf=x((aq,bi)=>{var l3=xb(),qf=Ab(),_b=(t,e,r)=>Uf(t,Array.isArray(e)?e:[{signal:e,options:r}]),Uf=(t,e)=>{t=l3(t),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*r(){let n,i=()=>{n&&n()};for(let{signal:s}of e)s.addEventListener("abort",i);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new qf(u,l)}let o=new Promise((a,c)=>{n=()=>{let{options:u}=e.find(({signal:d})=>d.aborted),{abortMessage:l,abortCode:f}=u;c(new qf(l,f))}});s=await Promise.race([o,t.next()]),n=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",i);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function"&&await t.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",i)}return r()},Cb=(t,e,r)=>Ib(t,Array.isArray(e)?e:[{signal:e,options:r}]),Ib=(t,e)=>r=>t(Uf(r,e)),f3=(t,e,r)=>d3(t,Array.isArray(e)?e:[{signal:e,options:r}]),d3=(t,e)=>({sink:Ib(t.sink,e),source:Uf(t.source,e)});bi.exports=_b;bi.exports.AbortError=qf;bi.exports.source=_b;bi.exports.sink=Cb;bi.exports.transform=Cb;bi.exports.duplex=f3});var Bb=x((cq,Rb)=>{"use strict";var{source:Tb}=Mf(),h3=Ne(),p3=h3("libp2p:stream:converter");function y3({stream:t,remoteAddr:e,localAddr:r},n={}){let{sink:i,source:s}=t,o={async sink(c){n.signal&&(c=Tb(c,n.signal));try{await i(c)}catch(u){u.type!=="aborted"&&p3(u)}a()},source:n.signal?Tb(s,n.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return i(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Rb.exports=y3});var Jo=x((uq,Pb)=>{"use strict";Pb.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var Ob=x((lq,Nb)=>{"use strict";var{EventEmitter:g3}=Wr(),{Multiaddr:m3}=Tt();Nb.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await t.dial(new m3(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),i.emit("listening")}function n(){let s=[];for(let o of e.values())s.push(o);return s}let i=Object.assign(new g3,{close:()=>Promise.resolve(),listen:r,getAddrs:n});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&i.emit("close")}),i}});var Ff=x((fq,Lb)=>{"use strict";var{Multiaddr:Db}=Tt(),{CircuitRelay:wi}=xs();function kb(t,e){t.write({type:wi.Type.STATUS,code:e})}function v3(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new Db(r))}catch(r){throw kb(e,t.type===wi.Type.HOP?wi.Status.HOP_DST_MULTIADDR_INVALID:wi.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new Db(r))}catch(r){throw kb(e,t.type===wi.Type.HOP?wi.Status.HOP_SRC_MULTIADDR_INVALID:wi.Status.STOP_SRC_MULTIADDR_INVALID),r}}Lb.exports={validateAddrs:v3}});var Mb=x(jc=>{"use strict";jc.byteLength=w3;jc.toByteArray=x3;jc.fromByteArray=_3;var jr=[],lr=[],b3=typeof Uint8Array!="undefined"?Uint8Array:Array,Kf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Ei=0,qb=Kf.length;Ei<qb;++Ei)jr[Ei]=Kf[Ei],lr[Kf.charCodeAt(Ei)]=Ei;var Ei,qb;lr["-".charCodeAt(0)]=62;lr["_".charCodeAt(0)]=63;function Ub(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function w3(t){var e=Ub(t),r=e[0],n=e[1];return(r+n)*3/4-n}function E3(t,e,r){return(e+r)*3/4-r}function x3(t){var e,r=Ub(t),n=r[0],i=r[1],s=new b3(E3(t,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=lr[t.charCodeAt(c)]<<18|lr[t.charCodeAt(c+1)]<<12|lr[t.charCodeAt(c+2)]<<6|lr[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=lr[t.charCodeAt(c)]<<2|lr[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=lr[t.charCodeAt(c)]<<10|lr[t.charCodeAt(c+1)]<<4|lr[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function S3(t){return jr[t>>18&63]+jr[t>>12&63]+jr[t>>6&63]+jr[t&63]}function A3(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(S3(n));return i.join("")}function _3(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(A3(t,o,o+s>a?a:o+s));return n===1?(e=t[r-1],i.push(jr[e>>2]+jr[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(jr[e>>10]+jr[e>>4&63]+jr[e<<2&63]+"=")),i.join("")}});var Fb=x(Vf=>{Vf.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=t[e+f];for(f+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=s*256+t[e+f],f+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=o*256+t[e+f],f+=d,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(p?-1:1)*o*Math.pow(2,s-n)};Vf.write=function(t,e,r,n,i,s){var o,a,c,u=s*8-i-1,l=(1<<u)-1,f=l>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=d/c:e+=d*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=a&255,p+=h,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+p]=o&255,p+=h,o/=256,u-=8);t[r+p-h]|=g*128}});var jn=x(Cs=>{"use strict";var jf=Mb(),Ss=Fb(),Kb=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Cs.Buffer=M;Cs.SlowBuffer=P3;Cs.INSPECT_MAX_BYTES=50;var $c=2147483647;Cs.kMaxLength=$c;M.TYPED_ARRAY_SUPPORT=C3();!M.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function C3(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(M.prototype,"parent",{enumerable:!0,get:function(){if(!!M.isBuffer(this))return this.buffer}});Object.defineProperty(M.prototype,"offset",{enumerable:!0,get:function(){if(!!M.isBuffer(this))return this.byteOffset}});function cn(t){if(t>$c)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,M.prototype),e}function M(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return $f(t)}return Vb(t,e,r)}M.poolSize=8192;function Vb(t,e,r){if(typeof t=="string")return T3(t,e);if(ArrayBuffer.isView(t))return R3(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if($r(t,ArrayBuffer)||t&&$r(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&($r(t,SharedArrayBuffer)||t&&$r(t.buffer,SharedArrayBuffer)))return zf(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return M.from(n,e,r);let i=B3(t);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return M.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}M.from=function(t,e,r){return Vb(t,e,r)};Object.setPrototypeOf(M.prototype,Uint8Array.prototype);Object.setPrototypeOf(M,Uint8Array);function jb(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function I3(t,e,r){return jb(t),t<=0?cn(t):e!==void 0?typeof r=="string"?cn(t).fill(e,r):cn(t).fill(e):cn(t)}M.alloc=function(t,e,r){return I3(t,e,r)};function $f(t){return jb(t),cn(t<0?0:Gf(t)|0)}M.allocUnsafe=function(t){return $f(t)};M.allocUnsafeSlow=function(t){return $f(t)};function T3(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!M.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=$b(t,e)|0,n=cn(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function Hf(t){let e=t.length<0?0:Gf(t.length)|0,r=cn(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function R3(t){if($r(t,Uint8Array)){let e=new Uint8Array(t);return zf(e.buffer,e.byteOffset,e.byteLength)}return Hf(t)}function zf(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,M.prototype),n}function B3(t){if(M.isBuffer(t)){let e=Gf(t.length)|0,r=cn(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||Qf(t.length)?cn(0):Hf(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Hf(t.data)}function Gf(t){if(t>=$c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+$c.toString(16)+" bytes");return t|0}function P3(t){return+t!=t&&(t=0),M.alloc(+t)}M.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==M.prototype};M.compare=function(e,r){if($r(e,Uint8Array)&&(e=M.from(e,e.offset,e.byteLength)),$r(r,Uint8Array)&&(r=M.from(r,r.offset,r.byteLength)),!M.isBuffer(e)||!M.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0};M.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};M.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return M.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=M.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){let o=e[n];if($r(o,Uint8Array))s+o.length>i.length?(M.isBuffer(o)||(o=M.from(o)),o.copy(i,s)):Uint8Array.prototype.set.call(i,o,s);else if(M.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function $b(t,e){if(M.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||$r(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Yf(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return rw(t).length;default:if(i)return n?-1:Yf(t).length;e=(""+e).toLowerCase(),i=!0}}M.byteLength=$b;function N3(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return V3(this,e,r);case"utf8":case"utf-8":return Gb(this,e,r);case"ascii":return F3(this,e,r);case"latin1":case"binary":return K3(this,e,r);case"base64":return U3(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j3(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}M.prototype._isBuffer=!0;function xi(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}M.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)xi(this,r,r+1);return this};M.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)xi(this,r,r+3),xi(this,r+1,r+2);return this};M.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)xi(this,r,r+7),xi(this,r+1,r+6),xi(this,r+2,r+5),xi(this,r+3,r+4);return this};M.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Gb(this,0,e):N3.apply(this,arguments)};M.prototype.toLocaleString=M.prototype.toString;M.prototype.equals=function(e){if(!M.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:M.compare(this,e)===0};M.prototype.inspect=function(){let e="",r=Cs.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Kb&&(M.prototype[Kb]=M.prototype.inspect);M.prototype.compare=function(e,r,n,i,s){if($r(e,Uint8Array)&&(e=M.from(e,e.offset,e.byteLength)),!M.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let o=s-i,a=n-r,c=Math.min(o,a),u=this.slice(i,s),l=e.slice(r,n);for(let f=0;f<c;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0};function Hb(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Qf(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=M.from(e,n)),M.isBuffer(e))return e.length===0?-1:zb(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):zb(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function zb(t,e,r,n,i){let s=1,o=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}let u;if(i){let l=-1;for(u=r;u<o;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){let l=!0;for(let f=0;f<a;f++)if(c(t,u+f)!==c(e,f)){l=!1;break}if(l)return u}return-1}M.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};M.prototype.indexOf=function(e,r,n){return Hb(this,e,r,n,!0)};M.prototype.lastIndexOf=function(e,r,n){return Hb(this,e,r,n,!1)};function O3(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let o;for(o=0;o<n;++o){let a=parseInt(e.substr(o*2,2),16);if(Qf(a))return o;t[r+o]=a}return o}function D3(t,e,r,n){return Hc(Yf(e,t.length-r),t,r,n)}function k3(t,e,r,n){return Hc(G3(e),t,r,n)}function L3(t,e,r,n){return Hc(rw(e),t,r,n)}function q3(t,e,r,n){return Hc(W3(e,t.length-r),t,r,n)}M.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return O3(this,e,r,n);case"utf8":case"utf-8":return D3(this,e,r,n);case"ascii":case"latin1":case"binary":return k3(this,e,r,n);case"base64":return L3(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q3(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};M.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U3(t,e,r){return e===0&&r===t.length?jf.fromByteArray(t):jf.fromByteArray(t.slice(e,r))}function Gb(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=r){let c,u,l,f;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[i+1],(c&192)==128&&(f=(s&31)<<6|c&63,f>127&&(o=f));break;case 3:c=t[i+1],u=t[i+2],(c&192)==128&&(u&192)==128&&(f=(s&15)<<12|(c&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:c=t[i+1],u=t[i+2],l=t[i+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(f=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=a}return M3(n)}var Wb=4096;function M3(t){let e=t.length;if(e<=Wb)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Wb));return r}function F3(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function K3(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function V3(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let s=e;s<r;++s)i+=Y3[t[s]];return i}function j3(t,e,r){let n=t.slice(e,r),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}M.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,M.prototype),i};function bt(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}M.prototype.readUintLE=M.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||bt(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return i};M.prototype.readUintBE=M.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||bt(e,r,this.length);let i=this[e+--r],s=1;for(;r>0&&(s*=256);)i+=this[e+--r]*s;return i};M.prototype.readUint8=M.prototype.readUInt8=function(e,r){return e=e>>>0,r||bt(e,1,this.length),this[e]};M.prototype.readUint16LE=M.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||bt(e,2,this.length),this[e]|this[e+1]<<8};M.prototype.readUint16BE=M.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||bt(e,2,this.length),this[e]<<8|this[e+1]};M.prototype.readUint32LE=M.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||bt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};M.prototype.readUint32BE=M.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||bt(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};M.prototype.readBigUInt64LE=Vn(function(e){e=e>>>0,_s(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ea(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))});M.prototype.readBigUInt64BE=Vn(function(e){e=e>>>0,_s(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ea(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)});M.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||bt(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*r)),i};M.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||bt(e,r,this.length);let i=r,s=1,o=this[e+--i];for(;i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};M.prototype.readInt8=function(e,r){return e=e>>>0,r||bt(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};M.prototype.readInt16LE=function(e,r){e=e>>>0,r||bt(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};M.prototype.readInt16BE=function(e,r){e=e>>>0,r||bt(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};M.prototype.readInt32LE=function(e,r){return e=e>>>0,r||bt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};M.prototype.readInt32BE=function(e,r){return e=e>>>0,r||bt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};M.prototype.readBigInt64LE=Vn(function(e){e=e>>>0,_s(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ea(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});M.prototype.readBigInt64BE=Vn(function(e){e=e>>>0,_s(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&ea(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});M.prototype.readFloatLE=function(e,r){return e=e>>>0,r||bt(e,4,this.length),Ss.read(this,e,!0,23,4)};M.prototype.readFloatBE=function(e,r){return e=e>>>0,r||bt(e,4,this.length),Ss.read(this,e,!1,23,4)};M.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||bt(e,8,this.length),Ss.read(this,e,!0,52,8)};M.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||bt(e,8,this.length),Ss.read(this,e,!1,52,8)};function Vt(t,e,r,n,i,s){if(!M.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}M.prototype.writeUintLE=M.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;Vt(this,e,r,n,a,0)}let s=1,o=0;for(this[r]=e&255;++o<n&&(s*=256);)this[r+o]=e/s&255;return r+n};M.prototype.writeUintBE=M.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;Vt(this,e,r,n,a,0)}let s=n-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+n};M.prototype.writeUint8=M.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,1,255,0),this[r]=e&255,r+1};M.prototype.writeUint16LE=M.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};M.prototype.writeUint16BE=M.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};M.prototype.writeUint32LE=M.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};M.prototype.writeUint32BE=M.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Yb(t,e,r,n,i){tw(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function Qb(t,e,r,n,i){tw(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}M.prototype.writeBigUInt64LE=Vn(function(e,r=0){return Yb(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});M.prototype.writeBigUInt64BE=Vn(function(e,r=0){return Qb(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});M.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);Vt(this,e,r,n,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<n&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};M.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);Vt(this,e,r,n,c-1,-c)}let s=n-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};M.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};M.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};M.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};M.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};M.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||Vt(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};M.prototype.writeBigInt64LE=Vn(function(e,r=0){return Yb(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});M.prototype.writeBigInt64BE=Vn(function(e,r=0){return Qb(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Xb(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Zb(t,e,r,n,i){return e=+e,r=r>>>0,i||Xb(t,e,r,4,34028234663852886e22,-34028234663852886e22),Ss.write(t,e,r,n,23,4),r+4}M.prototype.writeFloatLE=function(e,r,n){return Zb(this,e,r,!0,n)};M.prototype.writeFloatBE=function(e,r,n){return Zb(this,e,r,!1,n)};function Jb(t,e,r,n,i){return e=+e,r=r>>>0,i||Xb(t,e,r,8,17976931348623157e292,-17976931348623157e292),Ss.write(t,e,r,n,52,8),r+8}M.prototype.writeDoubleLE=function(e,r,n){return Jb(this,e,r,!0,n)};M.prototype.writeDoubleBE=function(e,r,n){return Jb(this,e,r,!1,n)};M.prototype.copy=function(e,r,n,i){if(!M.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),s};M.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!M.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{let o=M.isBuffer(e)?e:M.from(e,i),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=o[s%a]}return this};var As={};function Wf(t,e,r){As[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Wf("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Wf("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);Wf("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=ew(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=ew(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function ew(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function $3(t,e,r){_s(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&ea(e,t.length-(r+1))}function tw(t,e,r,n,i,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new As.ERR_OUT_OF_RANGE("value",a,t)}$3(n,i,s)}function _s(t,e){if(typeof t!="number")throw new As.ERR_INVALID_ARG_TYPE(e,"number",t)}function ea(t,e,r){throw Math.floor(t)!==t?(_s(t,r),new As.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new As.ERR_BUFFER_OUT_OF_BOUNDS:new As.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var H3=/[^+/0-9A-Za-z-_]/g;function z3(t){if(t=t.split("=")[0],t=t.trim().replace(H3,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function Yf(t,e){e=e||1/0;let r,n=t.length,i=null,s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function G3(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function W3(t,e){let r,n,i,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}function rw(t){return jf.toByteArray(z3(t))}function Hc(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function $r(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function Qf(t){return t!==t}var Y3=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Vn(t){return typeof BigInt=="undefined"?Q3:t}function Q3(){throw new Error("BigInt not supported")}});var Si=x((gq,iw)=>{"use strict";var{Buffer:br}=jn(),nw=Symbol.for("BufferList");function Ve(t){if(!(this instanceof Ve))return new Ve(t);Ve._init.call(this,t)}Ve._init=function(e){Object.defineProperty(this,nw,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Ve.prototype._new=function(e){return new Ve(e)};Ve.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){let i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}};Ve.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r};Ve.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};Ve.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};Ve.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||br.alloc(0);let s=!!e,o=this._offset(n),a=i-n,c=a,u=s&&r||0,l=o[1];if(n===0&&i===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:br.concat(this._bufs,this.length);for(let f=0;f<this._bufs.length;f++)this._bufs[f].copy(e,u),u+=this._bufs[f].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,r,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=br.allocUnsafe(a));for(let f=o[0];f<this._bufs.length;f++){let d=this._bufs[f].length-l;if(c>d)this._bufs[f].copy(e,u,l),u+=d;else{this._bufs[f].copy(e,u,l,l+c),u+=d;break}c-=d,l&&(l=0)}return e.length>u?e.slice(0,u):e};Ve.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let n=this._offset(e),i=this._offset(r),s=this._bufs.slice(n[0],i[0]+1);return i[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,i[1]),n[1]!==0&&(s[0]=s[0].slice(n[1])),this._new(s)};Ve.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)};Ve.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Ve.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};Ve.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(br.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(br.from(e));return this};Ve.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Ve.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=br.from([t]):typeof t=="string"?t=br.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=br.from(t.buffer,t.byteOffset,t.byteLength):br.isBuffer(t)||(t=br.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],s=n[1];for(;i<this._bufs.length;i++){let o=this._bufs[i];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([i,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([i,s]);if(this._match(c,t))return c;s++}s=0}return-1};Ve.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?Ve.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:Ve.prototype[r]=function(n=0){return this.slice(n,n+t[r])[r](0)}})(e)})();Ve.prototype._isBufferList=function(e){return e instanceof Ve||Ve.isBufferList(e)};Ve.isBufferList=function(e){return e!=null&&e[nw]};iw.exports=Ve});var Xf=x((mq,aw)=>{"use strict";var sw=fi(),{Buffer:X3}=jn(),ow=(t,e,r)=>{let n=sw.encode(t,e,r);return ow.bytes=sw.encode.bytes,e||X3.from(n)};aw.exports=ow});var hw=x((vq,zc)=>{"use strict";var{Buffer:cw}=jn(),uw=Si(),lw=Xf(),Zf=8,fw=10*1024;function dw(t){t=t||{};let e=Math.max(t.poolSize||fw,t.minPoolSize||Zf),r=t.lengthEncoder||lw;return async function*(i){let s=cw.alloc(e),o=0;for await(let a of i){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<Zf&&(s=cw.alloc(e),o=0),yield new uw().append(c).append(a)}}}dw.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||lw;return new uw([r(t.length),t.slice()])};zc.exports=dw;zc.exports.MIN_POOL_SIZE=Zf;zc.exports.DEFAULT_POOL_SIZE=fw});var Jf=x((bq,gw)=>{"use strict";var pw=fi(),{Buffer:Z3}=jn(),J3=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),yw=t=>{let e=pw.decode(Z3.isBuffer(t)?t:J3(t));return yw.bytes=pw.decode.bytes,e};gw.exports=yw});var ww=x((wq,Gc)=>{"use strict";var{Buffer:eP}=jn(),e0=Si(),tP=Jf(),mw=8,vw=1024*1024*4,bw=eP.alloc(0),$n={LENGTH:"readLength",DATA:"readData"},rP={[$n.LENGTH]:(t,e,r,n)=>{e=e.append(t);let i;try{i=n.lengthDecoder(e)}catch(s){if(e.length>n.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:$n.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(i>n.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(n.lengthDecoder.bytes),e=new e0,n.onLength&&n.onLength(i),i<=0?(n.onData&&n.onData(bw),{mode:$n.LENGTH,chunk:t,buffer:e,data:bw}):{mode:$n.DATA,chunk:t,buffer:e,state:{dataLength:i},data:void 0}},[$n.DATA]:(t,e,r,n)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:$n.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=e.shallowSlice(0,i),o=e.length>i?e.shallowSlice(i):void 0;return e=new e0,n.onData&&n.onData(s),{mode:$n.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function t0(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||tP,maxLengthLength:t.maxLengthLength||mw,maxDataLength:t.maxDataLength||vw,onLength:t.onLength,onData:t.onData};return async function*(n){let i=new e0,s=$n.LENGTH,o;for await(let a of n){let c=a;for(;c;){let u=rP[s](c,i,o,e);s=u.mode,c=u.chunk,i=u.buffer,o=u.state,u.data&&(yield u.data)}}if(i.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}t0.fromReader=(t,e)=>{let r=1,n={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return t0({...e||{},onLength:s=>{r=s}})(n)};Gc.exports=t0;Gc.exports.MAX_LENGTH_LENGTH=mw;Gc.exports.MAX_DATA_LENGTH=vw});var Sw=x((Eq,xw)=>{"use strict";var{Buffer:nP}=jn(),Ew=(t,e,r)=>(e=e||nP.allocUnsafe(4),e.writeInt32BE(t,r),e);Ew.bytes=4;xw.exports=Ew});var Cw=x((xq,_w)=>{"use strict";var Aw=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};Aw.bytes=4;_w.exports=Aw});var ta=x(Ai=>{"use strict";Ai.encode=hw();Ai.decode=ww();Ai.varintEncode=Xf();Ai.varintDecode=Jf();Ai.int32BEEncode=Sw();Ai.int32BEDecode=Cw()});var n0=x((Aq,Iw)=>{var r0=Si();Iw.exports=t=>{let e=async function*(){let r=yield,n=new r0;for await(let i of t){if(!r){r=yield n.append(i),n=new r0;continue}for(n.append(i);n.length>=r;){let s=n.shallowSlice(0,r);if(n.consume(r),r=yield s,!r){n.length&&(r=yield n,n=new r0);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e}});var i0=x((_q,Tw)=>{"use strict";var iP=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};Tw.exports=iP});var ra=x((Cq,Rw)=>{"use strict";var sP=n0(),oP=lf(),aP=i0();Rw.exports=t=>{let e=oP(),r=sP(t.source),n=aP(),i,s=t.sink(async function*(){yield*e,yield*await n.promise}());return s.catch(a=>{i=a}),{reader:r,writer:e,stream:{sink:a=>i?Promise.reject(i):(n.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var Yc=x((Iq,Dw)=>{"use strict";var Bw=Ne(),Wc=Object.assign(Bw("libp2p:circuit:stream-handler"),{error:Bw("libp2p:circuit:stream-handler:err")}),Pw=ta(),cP=ra(),{CircuitRelay:Nw}=xs(),Ow=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=cP(this.stream),this.decoder=Pw.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=Nw.decode(e.value.slice());return Wc("read message type",r.type),r}Wc("read received no value, closing stream"),this.close()}write(e){Wc("write message type %s",e.type),this.shake.write(Pw.encode.single(Nw.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){Wc("closing the stream"),this.rest().sink([])}};Dw.exports=Ow});var a0=x((Tq,o0)=>{"use strict";var kw=Ne(),na=Object.assign(kw("libp2p:circuit:stop"),{error:kw("libp2p:circuit:stop:err")}),{CircuitRelay:s0}=xs(),uP=Jo(),lP=Yc(),{validateAddrs:fP}=Ff();o0.exports.handleStop=function({connection:e,request:r,streamHandler:n}){try{fP(r,n)}catch(i){return na.error("invalid stop request via peer %s",e.remotePeer.toB58String(),i)}return na("stop request is valid"),n.write({type:s0.Type.STATUS,code:s0.Status.SUCCESS}),n.rest()};o0.exports.stop=async function({connection:e,request:r}){let{stream:n}=await e.newStream([uP.relay]);na("starting stop request to %s",e.remotePeer.toB58String());let i=new lP({stream:n});i.write(r);let s=await i.read();if(!s)return i.close();if(s.code===s0.Status.SUCCESS)return na("stop request to %s was successful",e.remotePeer.toB58String()),i.rest();na("stop request failed with code %d",s.code),i.close()}});var c0=x((Rq,Kw)=>{"use strict";var Lw=Ne(),un=Object.assign(Lw("libp2p:circuit:hop"),{error:Lw("libp2p:circuit:hop:err")}),qw=he(),dP=at(),{validateAddrs:hP}=Ff(),Uw=Yc(),{CircuitRelay:Gt}=xs(),{pipe:pP}=Kr(),{codes:Mw}=ot(),{stop:yP}=a0(),Fw=Jo();async function gP({connection:t,request:e,streamHandler:r,circuit:n}){if(!n._options.hop.enabled)return un("HOP request received but we are not acting as a relay"),r.end({type:Gt.Type.STATUS,code:Gt.Status.HOP_CANT_SPEAK_RELAY});try{hP(e,r)}catch(u){return un.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){un("HOP request received but we do not receive a dstPeer");return}let i=new dP(e.dstPeer.id),s=n._connectionManager.get(i);if(!s&&!n._options.hop.active)return un("HOP request received but we are not connected to the destination peer"),r.end({type:Gt.Type.STATUS,code:Gt.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:Gt.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await yP({connection:s,request:o})}catch(u){return un.error(u)}un("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:Gt.Type.STATUS,code:Gt.Status.SUCCESS});let c=r.rest();return pP(c,a,c)}async function mP({connection:t,request:e}){let{stream:r}=await t.newStream([Fw.relay]),n=new Uw({stream:r});n.write(e);let i=await n.read();if(!i)throw qw(new Error("HOP request had no response"),Mw.ERR_HOP_REQUEST_FAILED);if(i.code===Gt.Status.SUCCESS)return un("hop request was successful"),n.rest();throw un("hop request failed with code %d, closing stream",i.code),n.close(),qw(new Error(`HOP request failed with code ${i.code}`),Mw.ERR_HOP_REQUEST_FAILED)}async function vP({connection:t}){let{stream:e}=await t.newStream([Fw.relay]),r=new Uw({stream:e});r.write({type:Gt.Type.CAN_HOP});let n=await r.read();return await r.close(),!(!n||n.code!==Gt.Status.SUCCESS)}function bP({connection:t,streamHandler:e,circuit:r}){let n=r._options.hop.enabled;un("can hop (%s) request from %s",n,t.remotePeer.toB58String()),e.end({type:Gt.Type.STATUS,code:n?Gt.Status.SUCCESS:Gt.Status.HOP_CANT_SPEAK_RELAY})}Kw.exports={handleHop:gP,hop:mP,canHop:vP,handleCanHop:bP}});var Gw=x((Bq,zw)=>{"use strict";var Vw=Ne(),ln=Object.assign(Vw("libp2p:circuit"),{error:Vw("libp2p:circuit:err")}),wP=he(),EP=vb(),{Multiaddr:ia}=Tt(),jw=at(),{CircuitRelay:sa}=xs(),{codes:xP}=ot(),$w=Bb(),{relay:SP}=Jo(),AP=Ob(),{handleCanHop:_P,handleHop:CP,hop:IP}=c0(),{handleStop:TP}=a0(),RP=Yc(),BP=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),Hw=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(SP,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let n=new RP({stream:r}),i=await n.read();if(!i)return;let s=this,o;switch(i.type){case sa.Type.CAN_HOP:{ln("received CAN_HOP request from %s",e.remotePeer.toB58String()),await _P({circuit:s,connection:e,streamHandler:n});break}case sa.Type.HOP:{ln("received HOP request from %s",e.remotePeer.toB58String()),o=await CP({connection:e,request:i,streamHandler:n,circuit:s});break}case sa.Type.STOP:{ln("received STOP request from %s",e.remotePeer.toB58String()),o=await TP({connection:e,request:i,streamHandler:n});break}default:ln("Request of type %s not supported",i.type)}if(o){let a=new ia(i.dstPeer.addrs[0]),c=new ia(i.srcPeer.addrs[0]),u=$w({stream:o,remoteAddr:a,localAddr:c}),l=i.type===sa.Type.HOP?"relay":"inbound";ln("new %s connection %s",l,u.remoteAddr);let f=await this._upgrader.upgradeInbound(u);ln("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(f)}}async dial(e,r){let n=e.toString().split("/p2p-circuit"),i=new ia(n[0]),s=new ia(n[n.length-1]),o=i.getPeerId(),a=s.getPeerId();if(!o||!a){let d="Circuit relay dial failed as addresses did not have peer id";throw ln.error(d),wP(new Error(d),xP.ERR_RELAYED_DIAL)}let c=jw.createFromB58String(o),u=jw.createFromB58String(a),l=!1,f=this._connectionManager.get(c);f||(f=await this._dialer.connectToPeer(i,r),l=!0);try{let d=await IP({connection:f,request:{type:sa.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(g=>g.bytes)},dstPeer:{id:u.toBytes(),addrs:[new ia(s).bytes]}}}),p=i.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),h=$w({stream:d,remoteAddr:e,localAddr:p});return ln("new outbound connection %s",h.remoteAddr),this._upgrader.upgradeOutbound(h)}catch(d){throw ln.error("Circuit relay dial failed",d),l&&await f.close(),d}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,AP(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>EP.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[BP])}};zw.exports=Hw});var u0=x((Pq,Ww)=>{"use strict";var{CID:PP}=($i(),ao),{sha256:NP}=(ai(),In);Ww.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await NP.digest(e);return PP.createV0(r)}});var tE=x((Nq,eE)=>{"use strict";var Yw=Ne(),Qw=Object.assign(Yw("libp2p:auto-relay"),{error:Yw("libp2p:auto-relay:err")}),{fromString:OP}=(Et(),At),{toString:DP}=(xt(),_t),{Multiaddr:kP}=Tt(),LP=at(),{relay:qP}=Jo(),{canHop:UP}=c0(),{namespaceToCid:MP}=u0(),{CIRCUIT_PROTO_CODE:FP,HOP_METADATA_KEY:Xw,HOP_METADATA_VALUE:Zw,RELAY_RENDEZVOUS_NS:KP}=Nc(),Jw=class{constructor({libp2p:e,maxListeners:r=1,onError:n}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(i,s)=>{Qw.error(s||i),n&&n(i,s)}}async _onProtocolChange({peerId:e,protocols:r}){let n=e.toB58String(),i=r.find(s=>s===qP);if(!i&&this._listenRelays.has(n)){this._removeListenRelay(n);return}else if(!i||this._listenRelays.has(n))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(FP)){Qw(`relayed connection to ${n} will not be used to hop on`);return}await UP({connection:s})&&(this._peerStore.metadataBook.set(e,Xw,OP(Zw)),await this._addListenRelay(s,n))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let n=e.remotePeer.toB58String();!this._listenRelays.has(n)||this._removeListenRelay(n)}async _addListenRelay(e,r){if(this._listenRelays.size>=this.maxListeners)return;let n=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!n||!n.length)return;let i=`${n[0].toString()}/p2p-circuit`;this._listenRelays.add(r);try{await this._transportManager.listen([new kP(i)])}catch(s){this._onError(s),this._listenRelays.delete(r)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[];for(let[n,i]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(n)||e.includes(n))continue;let s=i.get(Xw);if(!s||DP(s)!==Zw)continue;let o=LP.createFromB58String(n),a=this._connectionManager.get(o);if(!a){r.push(o);continue}if(await this._addListenRelay(a,n),this._listenRelays.size>=this.maxListeners)return}for(let n of r)if(await this._tryToListenOnRelay(n),this._listenRelays.size>=this.maxListeners)return;try{let n=await MP(KP);for await(let i of this._libp2p.contentRouting.findProviders(n)){if(!i.multiaddrs.length)continue;let s=i.id;if(this._peerStore.addressBook.add(s,i.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(n){this._onError(n)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};eE.exports=Jw});var oE=x((Oq,sE)=>{"use strict";var rE=Ne(),nE=Object.assign(rE("libp2p:relay"),{error:rE("libp2p:relay:err")}),{setDelayedInterval:VP,clearDelayedInterval:jP}=pf(),$P=tE(),{namespaceToCid:HP}=u0(),{RELAY_RENDEZVOUS_NS:zP}=Nc(),iE=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new $P({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=VP(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){jP(this._timeout)}async _advertiseService(){try{let e=await HP(zP);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?(nE.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):nE.error(e)}}};sE.exports=iE});var l0=x((Dq,Qc)=>{"use strict";var{AbortController:aE,AbortSignal:GP}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;Qc.exports=aE;Qc.exports.AbortSignal=GP;Qc.exports.default=aE});var d0=x((kq,f0)=>{"use strict";var Xc;globalThis.AbortController&&globalThis.AbortSignal?Xc=globalThis:Xc=l0();f0.exports.AbortSignal=Xc.AbortSignal;f0.exports.AbortController=Xc.AbortController});var lE=x((Lq,uE)=>{"use strict";var{AbortController:WP}=d0(),cE=Xo(),Zc=class extends WP{constructor(e){super();this._ms=e,this._timer=cE(()=>this.abort(),e),Object.setPrototypeOf(this,Zc.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=cE(()=>this.abort(),this._ms)}};uE.exports={TimeoutController:Zc}});var p0=x((qq,h0)=>{var{AbortController:YP}=d0();function fE(t){let e=new YP;function r(){e.abort();for(let n of t)!n||!n.removeEventListener||n.removeEventListener("abort",r)}for(let n of t)if(!(!n||!n.addEventListener)){if(n.aborted){r();break}n.addEventListener("abort",r)}return e.signal}h0.exports=fE;h0.exports.anySignal=fE});var yE=x((Mq,pE)=>{var dE=cf(),hE=i0();pE.exports=class{constructor(){this._buffer=new dE,this._waitingConsumers=new dE}push(e){let{promise:r,resolve:n}=hE();return this._buffer.push({chunk:e,resolve:n}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=hE();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var mE=x((Fq,gE)=>{"use strict";gE.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(n,r.indent.repeat(e))}});var vE=x(()=>{});var xE=x((jq,EE)=>{"use strict";var bE=vE(),wE=/\s+at.*(?:\(|\s)(.*)\)?/,QP=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,XP=typeof bE.homedir=="undefined"?"":bE.homedir();EE.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let n=r.match(wE);if(n===null||!n[1])return!0;let i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!QP.test(i)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(wE,(n,i)=>n.replace(i,i.replace(XP,"~"))):r).join(`
`))});var _E=x(($q,AE)=>{"use strict";var ZP=mE(),JP=xE(),eN=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),SE=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=e.map(n=>typeof n.stack=="string"?eN(JP(n.stack)):String(n)).join(`
`);r=`
`+ZP(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};AE.exports=SE});var CE=x((Hq,g0)=>{"use strict";var y0=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},oa=class{static fn(e){return(...r)=>new oa((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new y0(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(oa.prototype,Promise.prototype);g0.exports=oa;g0.exports.CancelError=y0});var TE=x((zq,Jc)=>{"use strict";var IE=_E(),tN=CE(),m0=class extends Error{},rN=(t,e)=>new tN((r,n,i)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){n(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,f=new Set,d=()=>(a.length===s&&(r(a),l=!0),u-c.length<s&&(n(new IE(c)),l=!0),l),p=()=>{for(let h of t)!f.has(h)&&typeof h.cancel=="function"&&h.cancel()};i(p);for(let h of t)u++,(async()=>{try{let g=await h;if(l)return;if(!o(g))throw new m0("Value does not satisfy filter");a.push(g)}catch(g){c.push(g)}finally{f.add(h),!l&&d()&&p()}})();s>u&&(n(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});Jc.exports=rN;Jc.exports.AggregateError=IE;Jc.exports.FilterError=m0});var RE=x((Gq,b0)=>{"use strict";var v0=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},aa=class{static fn(e){return(...r)=>new aa((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new v0(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(aa.prototype,Promise.prototype);b0.exports=aa;b0.exports.CancelError=v0});var PE=x((Wq,w0)=>{"use strict";var BE=TE(),nN=RE();w0.exports=(t,e)=>{let r=BE(t,{...e,count:1});return nN.fn(async n=>{n(()=>{r.cancel()});let[i]=await r;return i})()};w0.exports.AggregateError=BE.AggregateError});var DE=x((Yq,OE)=>{"use strict";var iN=he(),sN=l0().default,{anySignal:oN}=p0(),aN=yE(),cN=PE(),NE=class{constructor({addrs:e,dialAction:r,dialer:n}){this.addrs=e,this.dialer=n,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw iN(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let n=new aN;r.forEach(o=>n.push(o));let i=this.addrs.map(()=>new sN),s=0;try{return await cN(this.addrs.map(async(o,a)=>{let c=await n.shift(),u;try{let l=i[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?oN([l,e.signal]):l}),i.splice(a,1)}finally{s++,this.addrs.length-s>=r.length?n.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{i.map(o=>o.abort()),r.forEach(o=>this.dialer.releaseToken(o))}}};OE.exports=NE});var UE=x((Qq,qE)=>{"use strict";var kE=Ne(),Is=Object.assign(kE("libp2p:dialer"),{error:kE("libp2p:dialer:err")}),E0=he(),{Multiaddr:x0}=Tt(),{TimeoutController:uN}=lE(),{AbortError:lN}=Mf(),{anySignal:fN}=p0(),dN=DE(),{publicAddressesFirst:hN}=xf(),pN=gf(),{codes:eu}=ot(),{DIAL_TIMEOUT:yN,MAX_PARALLEL_DIALS:gN,MAX_PER_PEER_DIALS:mN,MAX_ADDRS_TO_DIAL:vN}=Pc(),LE=class{constructor({transportManager:e,peerStore:r,addressSorter:n=hN,maxParallelDials:i=gN,maxAddrsToDial:s=vN,dialTimeout:o=yN,maxDialsPerPeer:a=mN,resolvers:c={}}){this.transportManager=e,this.peerStore=r,this.addressSorter=n,this.maxParallelDials=i,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(i)].map((u,l)=>l),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[u,l]of Object.entries(c))x0.resolvers.set(u,l)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){Is.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new lN("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let n=await this._createCancellableDialTarget(e);if(!n.addrs.length)throw E0(new Error("The dial request has no valid addresses"),eu.ERR_NO_VALID_ADDRESSES);let i=this._pendingDials.get(n.id)||this._createPendingDial(n,r);try{let s=await i.promise;return Is("dial succeeded to %s",n.id),s}catch(s){throw i.controller.signal.aborted&&(s.code=eu.ERR_TIMEOUT),Is.error(s),s}finally{i.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,n=new Promise((s,o)=>{this._pendingDialTargets.set(r,{resolve:s,reject:o})}),i=await Promise.race([this._createDialTarget(e),n]);return this._pendingDialTargets.delete(r),i}async _createDialTarget(e){let{id:r,multiaddrs:n}=pN(e);n&&this.peerStore.addressBook.add(r,n);let i=this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter)||[];x0.isMultiaddr(e)&&(i=i.filter(a=>!e.equals(a)),i.unshift(e));let s=[];for(let a of i)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(r),E0(new Error("dial with more addresses than allowed"),eu.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let n=(u,l)=>{if(l.signal.aborted)throw E0(new Error("already aborted"),eu.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},i=new dN({addrs:e.addrs,dialAction:n,dialer:this}),s=new uN(this.timeout),o=[s.signal];r.signal&&o.push(r.signal);let a=fN(o),c={dialRequest:i,controller:s,promise:i.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,r);return Is("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),n}releaseToken(e){this.tokens.indexOf(e)>-1||(Is("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let n=await this._resolveRecord(e);return(await Promise.all(n.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new x0(e.toString()),await e.resolve()}catch(r){return Is.error(`multiaddr ${e} could not be resolved`),[]}}};qE.exports=LE});var FE=x((Xq,ME)=>{"use strict";function bN(t){return t>=55296&&t<=56319}function wN(t){return t>=56320&&t<=57343}ME.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,s=0,o,a,c=0;c<i;c+=1){if(o=r.charCodeAt(c),a=r[c],bN(o)&&wN(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===n)return r.slice(0,c+1);if(s>n)return r.slice(0,c-a.length+1)}return r}});var VE=x((Zq,KE)=>{"use strict";function EN(t){return t>=55296&&t<=56319}function xN(t){return t>=56320&&t<=57343}KE.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,s=null,o=0;o<r;o++)i=e.charCodeAt(o),xN(i)?s!=null&&EN(s)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),s=i;return n}});var $E=x((Jq,jE)=>{"use strict";var SN=FE(),AN=VE();jE.exports=SN.bind(null,AN)});var GE=x((eU,zE)=>{"use strict";var _N=$E(),CN=/[\/\?<>\\:\*\|"]/g,IN=/[\x00-\x1f\x80-\x9f]/g,TN=/^\.+$/,RN=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,BN=/[\. ]+$/;function HE(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(CN,e).replace(IN,e).replace(TN,e).replace(RN,e).replace(BN,e);return _N(r,255)}zE.exports=function(t,e){var r=e&&e.replacement||"",n=HE(t,r);return r===""?n:HE(n,"")}});var QE=x((tU,YE)=>{"use strict";Qi();var tu=we(),{toString:Ts}=(xt(),_t),{fromString:WE}=(Et(),At);YE.exports={createCipheriv:(t,e,r)=>{let n=tu.cipher.createCipher("AES-CTR",Ts(e,"ascii"));return n.start({iv:Ts(r,"ascii")}),{update:i=>(n.update(tu.util.createBuffer(Ts(i,"ascii"))),WE(n.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let n=tu.cipher.createDecipher("AES-CTR",Ts(e,"ascii"));return n.start({iv:Ts(r,"ascii")}),{update:i=>(n.update(tu.util.createBuffer(Ts(i,"ascii"))),WE(n.output.getBytes(),"ascii"))}}}});var JE=x((rU,ZE)=>{"use strict";var PN=he(),XE={16:"aes-128-ctr",32:"aes-256-ctr"};ZE.exports=function(t){let e=XE[t.length];if(!e){let r=Object.entries(XE).map(([n,i])=>`${n} (${i})`).join(" / ");throw PN(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var r2=x(t2=>{"use strict";var e2=QE(),NN=JE();t2.create=async function(t,e){let r=NN(t),n=e2.createCipheriv(r,t,e),i=e2.createDecipheriv(r,t,e);return{async encrypt(o){return n.update(o)},async decrypt(o){return i.update(o)}}}});var s2=x((iU,i2)=>{"use strict";var ON=nl(),DN=Fe(),kN=he(),n2={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function LN(t,e,r,n,i){let s=n2[i];if(!s){let a=Object.keys(n2).join(" / ");throw kN(new Error(`Hash '${i}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=ON(t,e,r,n,s);return DN.encode64(o)}i2.exports=LN});var S0=x(Rs=>{"use strict";var qN=Ul(),UN=r2(),MN=gc();Rs.aes=UN;Rs.hmac=qN;Rs.keys=MN;Rs.randomBytes=tc();Rs.pbkdf2=s2()});var o2=Pe(()=>{});var a2,c2=Pe(()=>{o2();a2=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=r[t]&63;n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n<63?e+="_":e+="-"}return e}});var A0={};ht(A0,{Key:()=>jt});function FN(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function KN(t){let e=t.split(":");return e[e.length-1]}function VN(t){return[].concat(...t)}var fn,u2,ru,jt,_0=Pe(()=>{c2();xt();Et();fn="/",u2=new TextEncoder().encode(fn),ru=u2[0],jt=class{constructor(e,r){if(typeof e=="string")this._buf=El(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==ru)throw new Error("Invalid key")}toString(e="utf8"){return Sl(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new jt(e.join(fn))}static random(){return new jt(a2().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new jt(e):e.uint8Array?new jt(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=u2),this._buf[0]!==ru){let e=new Uint8Array(this._buf.byteLength+1);e.fill(ru,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ru;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],o=n[i];if(s<o)return!0;if(s>o)return!1}return r.length<n.length}reverse(){return jt.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(fn).slice(1)}type(){return FN(this.baseNamespace())}name(){return KN(this.baseNamespace())}instance(e){return new jt(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(fn)||(e+=fn),e+=this.type(),new jt(e)}parent(){let e=this.list();return e.length===1?new jt(fn):new jt(e.slice(0,-1).join(fn))}child(e){return this.toString()===fn?e:e.toString()===fn?this:new jt(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return jt.withNamespaces([...this.namespaces(),...VN(e.map(r=>r.namespaces()))])}}});var h2=x((hU,d2)=>{var Bs=we();Sn();Fe();var J=Bs.asn1,Ps=d2.exports=Bs.pkcs7asn1=Bs.pkcs7asn1||{};Bs.pkcs7=Bs.pkcs7||{};Bs.pkcs7.asn1=Ps;var l2={name:"ContentInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};Ps.contentInfoValidator=l2;var f2={name:"EncryptedContentInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};Ps.envelopedDataValidator={name:"EnvelopedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(f2)};Ps.encryptedDataValidator={name:"EncryptedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"}].concat(f2)};var jN={name:"SignerInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:J.Class.UNIVERSAL,type:J.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:J.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};Ps.signedDataValidator={name:"SignedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},l2,{name:"SignedData.Certificates",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:J.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,capture:"signerInfos",optional:!0,value:[jN]}]};Ps.recipientInfoValidator={name:"RecipientInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:J.Class.UNIVERSAL,type:J.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var y2=x((pU,p2)=>{var _i=we();Fe();_i.mgf=_i.mgf||{};var $N=p2.exports=_i.mgf.mgf1=_i.mgf1=_i.mgf1||{};$N.create=function(t){var e={generate:function(r,n){for(var i=new _i.util.ByteBuffer,s=Math.ceil(n/t.digestLength),o=0;o<s;o++){var a=new _i.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return e}});var m2=x((yU,g2)=>{var nu=we();y2();g2.exports=nu.mgf=nu.mgf||{};nu.mgf.mgf1=nu.mgf1});var b2=x((gU,v2)=>{var Ci=we();ni();Fe();var HN=v2.exports=Ci.pss=Ci.pss||{};HN.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=Ci.util.createBuffer(i));var s;if("saltLength"in t)s=t.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||Ci.random,a={};return a.encode=function(c,u){var l,f=u-1,d=Math.ceil(f/8),p=c.digest().getBytes();if(d<n+s+2)throw new Error("Message is too long to encrypt.");var h;i===null?h=o.getBytesSync(s):h=i.bytes();var g=new Ci.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(p),g.putBytes(h),e.start(),e.update(g.getBytes());var v=e.digest().getBytes(),A=new Ci.util.ByteBuffer;A.fillWithByte(0,d-s-n-2),A.putByte(1),A.putBytes(h);var B=A.getBytes(),k=d-n-1,z=r.generate(v,k),q="";for(l=0;l<k;l++)q+=String.fromCharCode(B.charCodeAt(l)^z.charCodeAt(l));var L=65280>>8*d-f&255;return q=String.fromCharCode(q.charCodeAt(0)&~L)+q.substr(1),q+v+String.fromCharCode(188)},a.verify=function(c,u,l){var f,d=l-1,p=Math.ceil(d/8);if(u=u.substr(-p),p<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=p-n-1,g=u.substr(0,h),v=u.substr(h,n),A=65280>>8*p-d&255;if((g.charCodeAt(0)&A)!=0)throw new Error("Bits beyond keysize not zero as expected.");var B=r.generate(v,h),k="";for(f=0;f<h;f++)k+=String.fromCharCode(g.charCodeAt(f)^B.charCodeAt(f));k=String.fromCharCode(k.charCodeAt(0)&~A)+k.substr(1);var z=p-n-s-2;for(f=0;f<z;f++)if(k.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(k.charCodeAt(z)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var q=k.substr(-s),L=new Ci.util.ByteBuffer;L.fillWithByte(0,8),L.putBytes(c),L.putBytes(q),e.start(),e.update(L.getBytes());var te=e.digest().getBytes();return v===te},a}});var I0=x((mU,S2)=>{var Q=we();Qi();Sn();Fa();An();m2();Gi();$a();b2();mo();Fe();var y=Q.asn1,G=S2.exports=Q.pki=Q.pki||{},ue=G.oids,nt={};nt.CN=ue.commonName;nt.commonName="CN";nt.C=ue.countryName;nt.countryName="C";nt.L=ue.localityName;nt.localityName="L";nt.ST=ue.stateOrProvinceName;nt.stateOrProvinceName="ST";nt.O=ue.organizationName;nt.organizationName="O";nt.OU=ue.organizationalUnitName;nt.organizationalUnitName="OU";nt.E=ue.emailAddress;nt.emailAddress="E";var w2=Q.pki.rsa.publicKeyValidator,zN={name:"Certificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},w2,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},GN={name:"rsapss",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},WN={name:"CertificationRequestInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},w2,{name:"CertificationRequestInfo.attributes",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0}]}]}]},YN={name:"CertificationRequest",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[WN,{name:"CertificationRequest.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};G.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,s,o=0;o<t.value.length;++o){n=t.value[o];for(var a=0;a<n.value.length;++a)s={},i=n.value[a],s.type=y.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in ue&&(s.name=ue[s.type],s.name in nt&&(s.shortName=nt[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};G.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=y.derToOid(n.value[0].value),s=n.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=i,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in ue&&(a.name=ue[a.type],a.name in nt&&(a.shortName=nt[a.name])),a.type===ue.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(G.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Hn(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var iu=function(t,e,r){var n={};if(t!==ue["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:ue.sha1},mgf:{algorithmOid:ue.mgf1,hash:{algorithmOid:ue.sha1}},saltLength:20});var i={},s=[];if(!y.validate(e,GN,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=y.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=y.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=y.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n};G.certificateFromPem=function(t,e,r){var n=Q.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=y.fromDer(n.body,r);return G.certificateFromAsn1(s,e)};G.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:y.toDer(G.certificateToAsn1(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.publicKeyFromPem=function(t){var e=Q.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=y.fromDer(e.body);return G.publicKeyFromAsn1(n)};G.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:y.toDer(G.publicKeyToAsn1(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:y.toDer(G.publicKeyToRSAPublicKey(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||Q.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=y.toDer(G.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=y.toDer(G.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};G.certificationRequestFromPem=function(t,e,r){var n=Q.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=y.fromDer(n.body,r);return G.certificationRequestFromAsn1(s,e)};G.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:y.toDer(G.certificationRequestToAsn1(t)).getBytes()};return Q.pem.encode(r,{maxline:e})};G.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Hn(t.issuer,e)},t.issuer.addField=function(e){fr([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Hn(t.subject,e)},t.subject.addField=function(e){fr([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){fr(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){fr(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)E2(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||Q.md.sha1.create();var n=ue[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=G.getTBSCertificate(t);var s=y.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=n.attributes,s.actualIssuer=i.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in ue){var a=ue[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=Q.md.sha1.create();break;case"md5WithRSAEncryption":o=Q.md.md5.create();break;case"sha256WithRSAEncryption":o=Q.md.sha256.create();break;case"sha384WithRSAEncryption":o=Q.md.sha384.create();break;case"sha512WithRSAEncryption":o=Q.md.sha512.create();break;case"RSASSA-PSS":o=Q.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||G.getTBSCertificate(e),u=y.toDer(c);o.update(u.getBytes())}if(o!==null){var l;switch(e.signatureOid){case ue.sha1WithRSAEncryption:l=void 0;break;case ue["RSASSA-PSS"]:var f,d;if(f=ue[e.signatureParameters.mgf.hash.algorithmOid],f===void 0||Q.md[f]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=f,s}if(d=ue[e.signatureParameters.mgf.algorithmOid],d===void 0||Q.mgf[d]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=d,s}if(d=Q.mgf[d].create(Q.md[f].create()),f=ue[e.signatureParameters.hash.algorithmOid],f===void 0||Q.md[f]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:f};l=Q.pss.create(Q.md[f].create(),d,e.signatureParameters.saltLength);break}r=t.publicKey.verify(o.digest().getBytes(),e.signature,l)}return r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,o,a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return G.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=ue.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return Q.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};G.certificateFromAsn1=function(t,e){var r={},n=[];if(!y.validate(t,zN,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=y.derToOid(r.publicKeyOid);if(s!==G.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=G.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=Q.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=Q.asn1.derToOid(r.certSignatureOid),o.signatureParameters=iu(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=Q.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=iu(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(y.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(y.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){if(o.md=null,o.signatureOid in ue){var s=ue[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Q.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Q.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Q.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Q.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Q.md.sha512.create();break;case"RSASSA-PSS":o.md=Q.md.sha256.create();break}}if(o.md===null){var i=new Error("Could not compute certificate digest. Unknown signature OID.");throw i.signatureOid=o.signatureOid,i}var u=y.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=Q.md.sha1.create();o.issuer.getField=function(d){return Hn(o.issuer,d)},o.issuer.addField=function(d){fr([d]),o.issuer.attributes.push(d)},o.issuer.attributes=G.RDNAttributesAsArray(r.certIssuer,l),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var f=Q.md.sha1.create();return o.subject.getField=function(d){return Hn(o.subject,d)},o.subject.addField=function(d){fr([d]),o.subject.attributes.push(d)},o.subject.attributes=G.RDNAttributesAsArray(r.certSubject,f),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=f.digest().toHex(),r.certExtensions?o.extensions=G.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=G.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};G.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(G.certificateExtensionFromAsn1(n.value[i]));return e};G.certificateExtensionFromAsn1=function(t){var e={};if(e.id=y.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===y.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in ue){if(e.name=ue[e.id],e.name==="keyUsage"){var r=y.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)==128,e.nonRepudiation=(n&64)==64,e.keyEncipherment=(n&32)==32,e.dataEncipherment=(n&16)==16,e.keyAgreement=(n&8)==8,e.keyCertSign=(n&4)==4,e.cRLSign=(n&2)==2,e.encipherOnly=(n&1)==1,e.decipherOnly=(i&128)==128}else if(e.name==="basicConstraints"){var r=y.fromDer(e.value);r.value.length>0&&r.value[0].type===y.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===y.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=y.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=y.fromDer(e.value),o=0;o<r.value.length;++o){var a=y.derToOid(r.value[o].value);a in ue?e[ue[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=y.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)==128,e.server=(n&64)==64,e.email=(n&32)==32,e.objsign=(n&16)==16,e.reserved=(n&8)==8,e.sslCA=(n&4)==4,e.emailCA=(n&2)==2,e.objCA=(n&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=y.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=Q.util.bytesToIP(c.value);break;case 8:l.oid=y.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=y.fromDer(e.value);e.subjectKeyIdentifier=Q.util.bytesToHex(r.value)}}return e};G.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!y.validate(t,YN,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=y.derToOid(r.publicKeyOid);if(s!==G.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=G.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=Q.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=iu(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=Q.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=iu(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){if(o.md=null,o.signatureOid in ue){var s=ue[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=Q.md.sha1.create();break;case"md5WithRSAEncryption":o.md=Q.md.md5.create();break;case"sha256WithRSAEncryption":o.md=Q.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=Q.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=Q.md.sha512.create();break;case"RSASSA-PSS":o.md=Q.md.sha256.create();break}}if(o.md===null){var i=new Error("Could not compute certification request digest. Unknown signature OID.");throw i.signatureOid=o.signatureOid,i}var a=y.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=Q.md.sha1.create();return o.subject.getField=function(u){return Hn(o.subject,u)},o.subject.addField=function(u){fr([u]),o.subject.attributes.push(u)},o.subject.attributes=G.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=G.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(u){return Hn(o,u)},o.addAttribute=function(u){fr([u]),o.attributes.push(u)},o.attributes=G.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};G.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Hn(t.subject,e)},t.subject.addField=function(e){fr([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Hn(t,e)},t.addAttribute=function(e){fr([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){fr(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){fr(e),t.attributes=e},t.sign=function(e,r){t.md=r||Q.md.sha1.create();var n=ue[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=G.getCertificationRequestInfo(t);var s=y.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){if(t.signatureOid in ue){var n=ue[t.signatureOid];switch(n){case"sha1WithRSAEncryption":r=Q.md.sha1.create();break;case"md5WithRSAEncryption":r=Q.md.md5.create();break;case"sha256WithRSAEncryption":r=Q.md.sha256.create();break;case"sha384WithRSAEncryption":r=Q.md.sha384.create();break;case"sha512WithRSAEncryption":r=Q.md.sha512.create();break;case"RSASSA-PSS":r=Q.md.sha256.create();break}}if(r===null){var i=new Error("Could not compute certification request digest. Unknown signature OID.");throw i.signatureOid=t.signatureOid,i}var s=t.certificationRequestInfo||G.getCertificationRequestInfo(t),o=y.toDer(s);r.update(o.getBytes())}if(r!==null){var a;switch(t.signatureOid){case ue.sha1WithRSAEncryption:break;case ue["RSASSA-PSS"]:var c,u;if(c=ue[t.signatureParameters.mgf.hash.algorithmOid],c===void 0||Q.md[c]===void 0){var i=new Error("Unsupported MGF hash function.");throw i.oid=t.signatureParameters.mgf.hash.algorithmOid,i.name=c,i}if(u=ue[t.signatureParameters.mgf.algorithmOid],u===void 0||Q.mgf[u]===void 0){var i=new Error("Unsupported MGF function.");throw i.oid=t.signatureParameters.mgf.algorithmOid,i.name=u,i}if(u=Q.mgf[u].create(Q.md[c].create()),c=ue[t.signatureParameters.hash.algorithmOid],c===void 0||Q.md[c]===void 0){var i=new Error("Unsupported RSASSA-PSS hash function.");throw i.oid=t.signatureParameters.hash.algorithmOid,i.name=c,i}a=Q.pss.create(Q.md[c].create(),u,t.signatureParameters.saltLength);break}e=t.publicKey.verify(r.digest().getBytes(),t.signature,a)}return e},t};function Ns(t){for(var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,s=0;s<i.length;++s){r=i[s];var o=r.value,a=y.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===y.Type.UTF8&&(o=Q.util.encodeUtf8(o))),n=y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(r.type).getBytes()),y.create(y.Class.UNIVERSAL,a,!1,o)])]),e.value.push(n)}return e}function fr(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in G.oids?e.name=G.oids[e.type]:e.shortName&&e.shortName in nt&&(e.name=G.oids[nt[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in G.oids)e.type=G.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName=="undefined"&&e.name&&e.name in nt&&(e.shortName=nt[e.name]),e.type===ue.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=y.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(G.certificateExtensionToAsn1(E2(e.extensions[i])))}if(typeof e.value=="undefined"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function E2(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in G.oids&&(t.name=G.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in G.oids)t.id=G.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var n=0,i=0,s=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);s!==0?o+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(o+=String.fromCharCode(i)),t.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in ue?a.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(ue[c]).getBytes())):c.indexOf(".")!==-1&&a.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);i!==0&&(o+=String.fromCharCode(i)),t.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Q.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=y.oidToDer(y.oidToDer(u.oid)):o=y.oidToDer(o));t.value.value.push(y.create(y.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=y.create(y.Class.UNIVERSAL,y.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var f=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=f.toHex(),t.value=y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,f.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var d=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!1,d))}if(t.authorityCertIssuer){var p=[y.create(y.Class.CONTEXT_SPECIFIC,4,!0,[Ns(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,p))}if(t.serialNumber){var h=Q.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(t.name==="cRLDistributionPoints"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var a=t.value.value,g=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),v=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=Q.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=y.oidToDer(y.oidToDer(u.oid)):o=y.oidToDer(o));v.value.push(y.create(y.Class.CONTEXT_SPECIFIC,u.type,!1,o))}g.value.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[v])),a.push(g)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function C0(t,e){switch(t){case ue["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.mgf.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.mgf.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.saltLength).getBytes())])),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,r);default:return y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")}}function QN(t){var e=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,o=y.Type.UTF8;"valueTagClass"in i&&(o=i.valueTagClass),o===y.Type.UTF8&&(s=Q.util.encodeUtf8(s));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var c=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(i.type).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var XN=new Date("1950-01-01T00:00:00Z"),ZN=new Date("2050-01-01T00:00:00Z");function x2(t){return t>=XN&&t<ZN?y.create(y.Class.UNIVERSAL,y.Type.UTCTIME,!1,y.dateToUtcTime(t)):y.create(y.Class.UNIVERSAL,y.Type.GENERALIZEDTIME,!1,y.dateToGeneralizedTime(t))}G.getTBSCertificate=function(t){var e=x2(t.validity.notBefore),r=x2(t.validity.notAfter),n=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.version).getBytes())]),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,Q.util.hexToBytes(t.serialNumber)),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.siginfo.algorithmOid).getBytes()),C0(t.siginfo.algorithmOid,t.siginfo.parameters)]),Ns(t.issuer),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,r]),Ns(t.subject),G.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(G.certificateExtensionsToAsn1(t.extensions)),n};G.getCertificationRequestInfo=function(t){var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.version).getBytes()),Ns(t.subject),G.publicKeyToAsn1(t.publicKey),QN(t)]);return e};G.distinguishedNameToAsn1=function(t){return Ns(t)};G.certificateToAsn1=function(t){var e=t.tbsCertificate||G.getTBSCertificate(t);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.signatureOid).getBytes()),C0(t.signatureOid,t.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};G.certificateExtensionsToAsn1=function(t){var e=y.create(y.Class.CONTEXT_SPECIFIC,3,!0,[]),r=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(G.certificateExtensionToAsn1(t[n]));return e};G.certificateExtensionToAsn1=function(t){var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);e.value.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.id).getBytes())),t.critical&&e.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=y.toDer(r).getBytes()),e.value.push(y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,r)),e};G.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||G.getCertificationRequestInfo(t);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.signatureOid).getBytes()),C0(t.signatureOid,t.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};G.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=Q.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];Q.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=Q.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;Q.util.isArray(a)||(a=[a]);for(var c=y.toDer(G.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=y.toDer(G.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!Q.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=Q.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!Q.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=y.toDer(G.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var f=y.toDer(G.certificateToAsn1(c[l])).getBytes();u===f&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return n(o),e.certs[o.hash]||null}function n(o){if(!o.hash){var a=Q.md.sha1.create();o.attributes=G.RDNAttributesAsArray(Ns(o),a),o.hash=a.digest().toHex()}}if(t)for(var i=0;i<t.length;++i){var s=t[i];e.addCertificate(s)}return e};G.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};G.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i=="undefined"&&(i=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(i&&(i<c.validity.notBefore||i>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:G.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:i}),o===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var f=u;Q.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){u=f.shift();try{d=u.verify(c)}catch(q){}}d||(o={message:"Certificate signature is invalid.",error:G.certificateError.bad_certificate})}o===null&&(!u||l)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:G.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:G.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},h=0;o===null&&h<c.extensions.length;++h){var g=c.extensions[h];g.critical&&!(g.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:G.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var v=c.getExtension("basicConstraints"),A=c.getExtension("keyUsage");if(A!==null&&(!A.keyCertSign||v===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:G.certificateError.bad_certificate}),o===null&&v!==null&&!v.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:G.certificateError.bad_certificate}),o===null&&A!==null&&"pathLenConstraint"in v){var B=a-1;B>v.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:G.certificateError.bad_certificate})}}var k=o===null?!0:o.error,z=r.verify?r.verify(k,a,n):k;if(z===!0)o=null;else throw k===!0&&(o={message:"The application rejected the certificate.",error:G.certificateError.bad_certificate}),(z||z===0)&&(typeof z=="object"&&!Q.util.isArray(z)?(z.message&&(o.message=z.message),z.error&&(o.error=z.error)):typeof z=="string"&&(o.error=z)),o;s=!1,++a}while(e.length>0);return!0}});var C2=x((vU,_2)=>{var X=we();Qi();Sn();Fa();Gi();$a();h2();ni();Fe();I0();var T=X.asn1,kt=_2.exports=X.pkcs7=X.pkcs7||{};kt.messageFromPem=function(t){var e=X.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=T.fromDer(e.body);return kt.messageFromAsn1(n)};kt.messageToPem=function(t,e){var r={type:"PKCS7",body:T.toDer(t.toAsn1()).getBytes()};return X.pem.encode(r,{maxline:e})};kt.messageFromAsn1=function(t){var e={},r=[];if(!T.validate(t,kt.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=T.derToOid(e.contentType),s;switch(i){case X.pki.oids.envelopedData:s=kt.createEnvelopedData();break;case X.pki.oids.encryptedData:s=kt.createEncryptedData();break;case X.pki.oids.signedData:s=kt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};kt.createSignedData=function(){var t=null;return t={type:X.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(R0(t,n,kt.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,s=0;s<i.length;++s)t.certificates.push(X.pki.certificateFromAsn1(i[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(X.pki.certificateToAsn1(t.certificates[i]));var s=[],o=T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&o.value[0].value.push(T.create(T.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&o.value[0].value.push(T.create(T.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(T.create(T.Class.UNIVERSAL,T.Type.SET,!0,t.signerInfos)),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.type).getBytes()),o])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var o=n.certificate;typeof o=="string"&&(o=X.pki.certificateFromPem(o)),i=o.issuer.attributes,s=o.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=X.pki.privateKeyFromPem(a));var c=n.digestAlgorithm||X.pki.oids.sha1;switch(c){case X.pki.oids.sha1:case X.pki.oids.sha256:case X.pki.oids.sha384:case X.pki.oids.sha512:case X.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var l=!1,f=!1,d=0;d<u.length;++d){var p=u[d];if(!l&&p.type===X.pki.oids.contentType){if(l=!0,f)break;continue}if(!f&&p.type===X.pki.oids.messageDigest){if(f=!0,l)break;continue}}if(!l||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:i,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:X.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(X.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof X.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=X.util.encodeUtf8(t.content)),n.detached?t.detachedContent=T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=X.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var s=t.signers[i],o=s.digestAlgorithm;o in n||(n[o]=X.md[X.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=n[o]:s.md=X.md[X.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in n)t.digestAlgorithmIdentifiers.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(o).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]));return n}function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=T.derToOid(t.contentInfo.value[0].value),o=T.toDer(i);o.getByte(),T.getBerValueLength(o),o=o.getBytes();for(var a in n)n[a].start().update(o);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==X.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[]),d=0;d<l.authenticatedAttributes.length;++d){var p=l.authenticatedAttributes[d];p.type===X.pki.oids.messageDigest?p.value=n[l.digestAlgorithm].digest():p.type===X.pki.oids.signingTime&&(p.value||(p.value=c)),f.value.push(T0(p)),l.authenticatedAttributesAsn1.value.push(T0(p))}o=T.toDer(f).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=iO(t.signers)}};kt.createEncryptedData=function(){var t=null;return t={type:X.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:X.pki.oids["aes256-CBC"]},fromAsn1:function(e){R0(t,e,kt.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),A2(t)}},t};kt.createEnvelopedData=function(){var t=null;return t={type:X.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:X.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=R0(t,e,kt.asn1.envelopedDataValidator);t.recipients=tO(r.recipientInfos.value)},toAsn1:function(){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.type).getBytes()),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,rO(t.recipients)),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,sO(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],s=i.issuer;if(i.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case X.pki.oids.rsaEncryption:case X.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=X.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}A2(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:X.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,s;switch(r){case X.pki.oids["aes128-CBC"]:n=16,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["aes192-CBC"]:n=24,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["aes256-CBC"]:n=32,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=X.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=X.util.createBuffer(X.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=X.util.createBuffer(X.random.getBytes(i));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case X.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function JN(t){var e={},r=[];if(!T.validate(t,kt.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:X.pki.RDNAttributesAsArray(e.issuer),serialNumber:X.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:T.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function eO(t){return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[X.pki.distinguishedNameToAsn1({attributes:t.issuer}),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,X.util.hexToBytes(t.serialNumber))]),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.encryptedContent.algorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")]),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function tO(t){for(var e=[],r=0;r<t.length;++r)e.push(JN(t[r]));return e}function rO(t){for(var e=[],r=0;r<t.length;++r)e.push(eO(t[r]));return e}function nO(t){var e=T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,T.integerToDer(t.version).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[X.pki.distinguishedNameToAsn1({attributes:t.issuer}),T.create(T.Class.UNIVERSAL,T.Type.INTEGER,!1,X.util.hexToBytes(t.serialNumber))]),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.digestAlgorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.signatureAlgorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.NULL,!1,"")])),e.value.push(T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=T.create(T.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(T0(i))}e.value.push(r)}return e}function iO(t){for(var e=[],r=0;r<t.length;++r)e.push(nO(t[r]));return e}function T0(t){var e;if(t.type===X.pki.oids.contentType)e=T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.value).getBytes());else if(t.type===X.pki.oids.messageDigest)e=T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===X.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=T.utcTimeToDate(i):i=T.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?e=T.create(T.Class.UNIVERSAL,T.Type.UTCTIME,!1,T.dateToUtcTime(i)):e=T.create(T.Class.UNIVERSAL,T.Type.GENERALIZEDTIME,!1,T.dateToGeneralizedTime(i))}return T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.type).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SET,!0,[e])])}function sO(t){return[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(X.pki.oids.data).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.SEQUENCE,!0,[T.create(T.Class.UNIVERSAL,T.Type.OID,!1,T.oidToDer(t.algorithm).getBytes()),T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.parameter.getBytes())]),T.create(T.Class.CONTEXT_SPECIFIC,0,!0,[T.create(T.Class.UNIVERSAL,T.Type.OCTETSTRING,!1,t.content.getBytes())])]}function R0(t,e,r){var n={},i=[];if(!T.validate(e,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=T.derToOid(n.contentType);if(o!==X.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(X.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==T.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[c].value}else a=n.encryptedContent;t.encryptedContent={algorithm:T.derToOid(n.encAlgorithm),parameter:X.util.createBuffer(n.encParameter.value),content:X.util.createBuffer(a)}}if(n.content){var a="";if(X.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==T.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[c].value}else a=n.content;t.content=X.util.createBuffer(a)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function A2(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case X.pki.oids["aes128-CBC"]:case X.pki.oids["aes192-CBC"]:case X.pki.oids["aes256-CBC"]:e=X.aes.createDecryptionCipher(t.encryptedContent.key);break;case X.pki.oids.desCBC:case X.pki.oids["des-EDE3-CBC"]:e=X.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var R2=x((bU,T2)=>{"use strict";I0();var oO=we(),I2=oO.pki,aO=(t,e)=>{let r=I2.setRsaPublicKey(e.n,e.e),n=I2.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);let i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e),n};async function cO(t,e){let r=t.map(e),i=(await Promise.all(r)).findIndex(s=>s);return t[i]}T2.exports={certificateForKey:aO,findAsync:cO}});var O2=x((wU,N2)=>{"use strict";C2();hl();var zn=we(),{certificateForKey:uO,findAsync:lO}=R2(),Os=he(),{fromString:B2}=(Et(),At),{toString:fO}=(xt(),_t),B0=new WeakMap,P2=class{constructor(e,r){if(!e)throw Os(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,B0.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw Os(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let n=await this.keychain.findKeyByName(e),i=await this.keychain._getPrivateKey(e),s=B0.get(this).dek,o=zn.pki.decryptRsaPrivateKey(i,s),a=await uO(n,o),c=zn.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=zn.util.createBuffer(r),c.encrypt();let u=zn.asn1.toDer(c.toAsn1()).getBytes();return B2(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw Os(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let r;try{let u=zn.util.createBuffer(fO(e,"ascii")),l=zn.asn1.fromDer(u);r=zn.pkcs7.messageFromAsn1(l)}catch(u){throw Os(new Error("Invalid CMS: "+u.message),"ERR_INVALID_CMS")}let n=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),i=await lO(n,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!i){let u=n.map(l=>l.keyId);throw Os(new Error("Decryption needs one of the key(s): "+u.join(", ")),"ERR_MISSING_KEYS",{missingKeys:u})}let s=await this.keychain.findKeyById(i.keyId);if(!s)throw Os(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=B0.get(this).dek,c=zn.pki.decryptRsaPrivateKey(o,a);return r.decrypt(i.recipient,c),B2(r.content.getBytes(),"ascii")}};N2.exports=P2});var F2=x((EU,M2)=>{"use strict";var D2=Ne(),k2=Object.assign(D2("libp2p:keychain"),{error:D2("libp2p:keychain:err")}),dO=GE(),hO=hs(),Ii=S0(),{Key:L2}=(_0(),A0),pO=O2(),Ye=he(),{toString:Ti}=(xt(),_t),{fromString:dn}=(Et(),At);Cl();var yO="/pkcs8/",q2="/info/",Gn=new WeakMap,Ri={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},P0={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function hn(t){return!t||typeof t!="string"?!1:t===dO(t.trim())}async function Le(t){let e=200,r=1e3,n=Math.random()*(r-e)+e;throw await new Promise(i=>setTimeout(i,n)),t}function Hr(t){return new L2(yO+t)}function Wn(t){return new L2(q2+t)}var U2=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=hO(P0,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Ri.minKeyLength)throw new Error(`dek.keyLength must be least ${Ri.minKeyLength} bytes`);if(this.opts.dek.salt.length<Ri.minSaltLength)throw new Error(`dek.saltLength must be least ${Ri.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Ri.minIterationCount)throw new Error(`dek.iterationCount must be least ${Ri.minIterationCount}`);let n=this.opts.pass?Ii.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Gn.set(this,{dek:n})}get cms(){return new pO(this,Gn.get(this).dek)}static generateOptions(){let e=Object.assign({},P0),r=Math.ceil(Ri.minSaltLength/3)*3;return e.dek.salt=Ti(Ii.randomBytes(r),"base64"),e}static get options(){return P0}async createKey(e,r,n=2048){let i=this;if(!hn(e)||e==="self")return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof r!="string")return Le(Ye(new Error(`Invalid key type '${r}'`),"ERR_INVALID_KEY_TYPE"));let s=Hr(e);if(await i.store.has(s))return Le(Ye(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)return Le(Ye(new Error(`Invalid RSA key size ${n}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await Ii.keys.generateKeyPair(r,n),u=await c.id(),l=Gn.get(this).dek,f=await c.export(l);a={name:e,id:u};let d=i.store.batch();d.put(s,dn(f)),d.put(Wn(e),dn(JSON.stringify(a))),await d.commit()}catch(c){return Le(c)}return a}async listKeys(){let e=this,r={prefix:q2},n=[];for await(let i of e.store.query(r))n.push(JSON.parse(Ti(i.value)));return n}async findKeyById(e){try{return(await this.listKeys()).find(n=>n.id===e)}catch(r){return Le(r)}}async findKeyByName(e){if(!hn(e))return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let r=Wn(e);try{let n=await this.store.get(r);return JSON.parse(Ti(n))}catch(n){return Le(Ye(new Error(`Key '${e}' does not exist. ${n.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let r=this;if(!hn(e)||e==="self")return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let n=Hr(e),i=await r.findKeyByName(e),s=r.store.batch();return s.delete(n),s.delete(Wn(e)),await s.commit(),i}async renameKey(e,r){let n=this;if(!hn(e)||e==="self")return Le(Ye(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!hn(r)||r==="self")return Le(Ye(new Error(`Invalid new key name '${r}'`),"ERR_NEW_KEY_NAME_INVALID"));let i=Hr(e),s=Hr(r),o=Wn(e),a=Wn(r);if(await n.store.has(s))return Le(Ye(new Error(`Key '${r}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let u=await n.store.get(i),l=await n.store.get(o),f=JSON.parse(Ti(l));f.name=r;let d=n.store.batch();return d.put(s,u),d.put(a,dn(JSON.stringify(f))),d.delete(i),d.delete(o),await d.commit(),f}catch(u){return Le(u)}}async exportKey(e,r){if(!hn(e))return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return Le(Ye(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let n=Hr(e);try{let i=await this.store.get(n),s=Ti(i),o=Gn.get(this).dek;return(await Ii.keys.import(s,o)).export(r)}catch(i){return Le(i)}}async importKey(e,r,n){let i=this;if(!hn(e)||e==="self")return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r)return Le(Ye(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=Hr(e);if(await i.store.has(s))return Le(Ye(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await Ii.keys.import(r,n)}catch(f){return Le(Ye(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let f=Gn.get(this).dek;r=await a.export(f)}catch(f){return Le(f)}let u={name:e,id:c},l=i.store.batch();return l.put(s,dn(r)),l.put(Wn(e),dn(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let n=this;if(!hn(e))return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!r||!r.privKey)return Le(Ye(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let i=r.privKey,s=Hr(e);if(await n.store.has(s))return Le(Ye(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await i.id(),c=Gn.get(this).dek,u=await i.export(c),l={name:e,id:a},f=n.store.batch();return f.put(s,dn(u)),f.put(Wn(e),dn(JSON.stringify(l))),await f.commit(),l}catch(a){return Le(a)}}async _getPrivateKey(e){if(!hn(e))return Le(Ye(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let r=Hr(e),n=await this.store.get(r);return Ti(n)}catch(r){return Le(Ye(new Error(`Key '${e}' does not exist. ${r.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,r){if(typeof e!="string")return Le(Ye(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof r!="string")return Le(Ye(new Error(`Invalid new pass type '${typeof r}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(r.length<20)return Le(Ye(new Error(`Invalid pass length ${r.length}`),"ERR_INVALID_PASS_LENGTH"));k2("recreating keychain");let n=Gn.get(this).dek;this.opts.pass=r;let i=r?Ii.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Gn.set(this,{dek:i});let s=await this.listKeys();for(let o of s){let a=await this.store.get(Hr(o.name)),c=Ti(a),u=await Ii.keys.import(c,n),l=i.toString(),f=await u.export(l),d=this.store.batch(),p={name:o.name,id:o.id};d.put(Hr(o.name),dn(f)),d.put(Wn(o.name),dn(JSON.stringify(p))),await d.commit()}k2("keychain reconstructed")}};M2.exports=U2});var ou=x((su,K2)=>{(function(t,e){typeof su=="object"&&typeof K2!="undefined"?e(su):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(su,function(t){"use strict";async function*e(m,E){let _=[];for await(let w of E)_.push(w),_.length===m&&(yield _,_=[]);_.length>0&&(yield _)}function*r(m,E){let _=[];for(let w of E)_.push(w),_.length===m&&(yield _,_=[]);_.length>0&&(yield _)}function n(m,E){return E===void 0?_=>n(m,_):E[Symbol.asyncIterator]?e(m,E):r(m,E)}function i(m){if(typeof m.next=="function")return m;if(typeof m[Symbol.iterator]=="function")return m[Symbol.iterator]();if(typeof m[Symbol.asyncIterator]=="function")return m[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let m,E;return{promise:new Promise((w,C)=>{E=w,m=C}),reject:m,resolve:E}}function o(m,E){let _=i(E),w=[],C=[],N=!1,P=!1;function F(){for(;C.length>0&&w.length>0;){let ie=C.shift(),{error:me,value:le}=w.shift();me?ie.reject(me):ie.resolve({done:!1,value:le})}for(;C.length>0&&P;){let{resolve:ie}=C.shift();ie({done:!0,value:void 0})}}async function W(){if(!P&&!N&&!(w.length>=m)){N=!0;try{let{done:ie,value:me}=await _.next();ie?P=!0:w.push({value:me})}catch(ie){P=!0,w.push({error:ie})}F(),N=!1,W()}}async function Y(){if(w.length>0){let{error:me,value:le}=w.shift();if(me)throw me;return W(),{done:!1,value:le}}if(P)return{done:!0,value:void 0};let ie=s();return C.push(ie),W(),ie.promise}let ae={next:Y,[Symbol.asyncIterator]:()=>ae};return ae}function*a(m,E){let _=[],w;try{for(let C of E)_.push(C),!(_.length<=m)&&(yield _.shift())}catch(C){w=C}for(let C of _)yield C;if(w)throw w}function c(m,E){return E===void 0?_=>c(m,_):m===0?E:E[Symbol.asyncIterator]?o(m,E):a(m,E)}async function u(m){let E=[];for await(let _ of m)E.push(_);return E}function l(m){return m[Symbol.asyncIterator]?u(m):Array.from(m)}async function*f(m){for await(let E of m)yield*E}function*d(m){for(let E of m)yield*E}function p(...m){return m.find(_=>_[Symbol.asyncIterator]!==void 0)?f(m):d(m)}async function h(m){for await(let E of m);}function g(m){if(m[Symbol.asyncIterator])return h(m);for(let E of m);}async function*v(m,E){for await(let _ of E)await m(_)&&(yield _)}function A(m,E){return E===void 0?_=>v(m,_):v(m,E)}async function*B(m){for await(let E of m)E&&typeof E!="string"&&(E[Symbol.iterator]||E[Symbol.asyncIterator])?yield*B(E):yield E}async function*k(m,E){for await(let _ of E)yield await m(_)}function z(m,E){return E===void 0?_=>k(m,_):k(m,E)}function q(m,E){return E===void 0?_=>q(m,_):A(_=>_!=null,B(z(m,E)))}function L(m,E,_){let w=i(_),C=[],N=[],P=!1,F=!1,W=0,Y=null;function ae(){for(;N.length>0&&C.length>0;){let{resolve:ve}=N.shift(),Ce=C.shift();ve({done:!1,value:Ce})}for(;N.length>0&&W===0&&P;){let{resolve:ve,reject:Ce}=N.shift();Y?(Ce(Y),Y=null):ve({done:!0,value:void 0})}}async function ie(){if(P){ae();return}if(!F&&!(W+C.length>=m)){F=!0,W++;try{let{done:ve,value:Ce}=await w.next();ve?(P=!0,W--,ae()):me(Ce)}catch(ve){P=!0,W--,Y=ve,ae()}F=!1,ie()}}async function me(ve){try{let Ce=await E(ve);if(Ce&&Ce[Symbol.asyncIterator])for await(let eo of Ce)C.push(eo);else C.push(Ce)}catch(Ce){P=!0,Y=Ce}W--,ae(),ie()}async function le(){if(C.length===0){let Ce=s();return N.push(Ce),ie(),Ce.promise}let ve=C.shift();return ie(),{done:!1,value:ve}}let xe={next:le,[Symbol.asyncIterator]:()=>xe};return xe}function te(m,E,_){return E===void 0?(w,C)=>C?te(m,w,C):te(m,w):_===void 0?w=>te(m,E,w):A(w=>w!=null,B(L(m,E,_)))}async function se(m){return new Promise(E=>{m.once("readable",()=>{E()})})}async function*j(m){for(;;){let E=m.read();if(E!==null){yield E;continue}if(m._readableState.ended)break;await se(m)}}function Ae(m){return typeof m[Symbol.asyncIterator]=="function"?m:j(m)}async function*ge(...m){let E=new Set(m.map(i));for(;E.size>0;)for(let _ of E){let w=await _.next();w.done?E.delete(_):yield w.value}}function pe(m,...E){let _=m();for(let w of E)_=w(_);return _}async function*Xe(m,E,_){let w=null,C=W=>({value:E(W)}),N=async function*(W){for await(let Y of W){if(w)return;yield Y}},P=pe(()=>_,c(1),N,z(C),c(m-1)),F=i(P);for(;;){let{value:W,done:Y}=await F.next();if(Y)break;try{let ae=await W.value;w||(yield ae)}catch(ae){w=ae}}if(w)throw w}function Ze(m,E,_){return E===void 0?(w,C)=>Ze(m,w,C):_===void 0?w=>Ze(m,E,w):m===1?z(E,_):Xe(m,E,_)}function _e(m,E,_){return E===void 0?(w,C)=>C?_e(m,w,C):_e(m,w):_===void 0?w=>_e(m,E,w):A(w=>w!=null,B(Ze(m,E,_)))}async function*qe(...m){let E=m.map(i),_=new Set,w=new Map,C=null,N=null,P=null,F=ie=>{C=ie,N&&N(ie)},W=ie=>{P&&P(ie)},Y=()=>new Promise((ie,me)=>{if(C&&me(C),w.size>0)return ie();P=ie,N=me}),ae=ie=>{let me=Promise.resolve(ie.next()).then(async({done:le,value:xe})=>{le||w.set(ie,xe),_.delete(me)});_.add(me),me.then(W,F)};for(let ie of E)ae(ie);for(;;){if(_.size===0&&w.size===0)return;await Y();for(let[ie,me]of w)w.delete(ie),yield me,ae(ie)}}async function re(m,E,_){let w=E;for await(let C of _)w=await m(w,C);return w}function $t(m,E,_){return E===void 0?(w,C)=>C?re(m,w,C):$t(m,w):_===void 0?w=>$t(m,E,w):re(m,E,_)}async function*Lt(m,E){let _=0;for await(let w of E)if(yield await w,_++,_>=m)break}function*Gr(m,E){let _=0;for(let w of E)if(yield w,_++,_>=m)break}function qt(m,E){return E===void 0?_=>qt(m,_):E[Symbol.asyncIterator]?Lt(m,E):Gr(m,E)}async function*$(m,E){for await(let _ of E)await m(_),yield _}function Xs(m,E){return E===void 0?_=>$(m,_):$(m,E)}function Zs(m,E){let _=m[0]+E[0],w=m[1]+E[1];if(w>=1e9){let C=w%1e9;_+=(w-C)/1e9,w=C}return[_,w]}async function*Js(m,E){let _=E[Symbol.asyncIterator](),w=[0,0];for(;;){let C=process.hrtime(),{value:N,done:P}=await _.next(),F=process.hrtime(C);if(w=Zs(w,F),m.progress&&m.progress(F,w),P)return m.total&&m.total(w),N;yield N}}function*Ut(m,E){let _=E[Symbol.iterator](),w=[0,0];for(;;){let C=process.hrtime(),{value:N,done:P}=_.next(),F=process.hrtime(C);if(w=Zs(w,F),m.progress&&m.progress(F,w),P)return m.total&&m.total(w),N;yield N}}function Qt(m={},E){return E===void 0?_=>Qt(m,_):E[Symbol.asyncIterator]!==void 0?Js(m,E):Ut(m,E)}function b(m,E,_){let w=i(_),C=[],N=[],P=!1,F=!1,W=0,Y=null;function ae(){for(;N.length>0&&C.length>0;){let{resolve:ve}=N.shift(),Ce=C.shift();ve({done:!1,value:Ce})}for(;N.length>0&&W===0&&P;){let{resolve:ve,reject:Ce}=N.shift();Y?(Ce(Y),Y=null):ve({done:!0,value:void 0})}}async function ie(){if(P){ae();return}if(!F&&!(W+C.length>=m)){F=!0,W++;try{let{done:ve,value:Ce}=await w.next();ve?(P=!0,W--,ae()):me(Ce)}catch(ve){P=!0,W--,Y=ve,ae()}F=!1,ie()}}async function me(ve){try{let Ce=await E(ve);C.push(Ce)}catch(Ce){P=!0,Y=Ce}W--,ae(),ie()}async function le(){if(C.length===0){let Ce=s();return N.push(Ce),ie(),Ce.promise}let ve=C.shift();return ie(),{done:!1,value:ve}}let xe={next:le,[Symbol.asyncIterator]:()=>xe};return xe}function S(m,E,_){return E===void 0?(w,C)=>C?S(m,w,C):S(m,w):_===void 0?w=>S(m,E,w):b(m,E,_)}async function I(m,E){let _=null,w=null,C=null,N=Y=>{_=Y,w&&w(Y)},P=()=>{C&&C()},F=()=>{m.removeListener("error",N),m.removeListener("drain",P)};m.once("error",N);let W=()=>new Promise((Y,ae)=>{if(_)return ae(_);m.once("drain",P),C=Y,w=ae});for await(let Y of E)if(m.write(Y)===!1&&await W(),_)break;if(F(),_)throw _}function O(m,E){return E===void 0?_=>I(m,_):I(m,E)}t.batch=n,t.buffer=c,t.collect=l,t.concat=p,t.consume=g,t.filter=A,t.flatMap=q,t.flatTransform=te,t.flatten=B,t.fromStream=Ae,t.getIterator=i,t.map=z,t.merge=ge,t.parallelFlatMap=_e,t.parallelMap=Ze,t.parallelMerge=qe,t.pipeline=pe,t.reduce=$t,t.take=qt,t.tap=Xs,t.time=Qt,t.transform=S,t.writeToStream=O,Object.defineProperty(t,"__esModule",{value:!0})})});var j2=x((xU,V2)=>{V2.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),n=Object.create(null);function i(s,o){r[s]=o,e++,e>=t&&(e=0,n=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||n[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),n[s]!==void 0&&(n[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=n[s])!==void 0)return i(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:i(s,o)},clear:function(){r=Object.create(null),n=Object.create(null)}}}});var H2=x((SU,$2)=>{"use strict";var gO=j2();$2.exports=t=>{let e=gO(t);return e.delete=e.remove,e}});var G2=x((z2,au)=>{(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function p(q){var L,te,se,j=$.prototype={constructor:$,toString:null,valueOf:null},Ae=new $(1),ge=20,pe=4,Xe=-7,Ze=21,_e=-1e7,qe=1e7,re=!1,$t=1,Lt=0,Gr={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},qt="0123456789abcdefghijklmnopqrstuvwxyz";function $(b,S){var I,O,m,E,_,w,C,N,P=this;if(!(P instanceof $))return new $(b,S);if(S==null){if(b&&b._isBigNumber===!0){P.s=b.s,!b.c||b.e>qe?P.c=P.e=null:b.e<_e?P.c=[P.e=0]:(P.e=b.e,P.c=b.c.slice());return}if((w=typeof b=="number")&&b*0==0){if(P.s=1/b<0?(b=-b,-1):1,b===~~b){for(E=0,_=b;_>=10;_/=10,E++);E>qe?P.c=P.e=null:(P.e=E,P.c=[b]);return}N=String(b)}else{if(!r.test(N=String(b)))return se(P,N,w);P.s=N.charCodeAt(0)==45?(N=N.slice(1),-1):1}(E=N.indexOf("."))>-1&&(N=N.replace(".","")),(_=N.search(/e/i))>0?(E<0&&(E=_),E+=+N.slice(_+1),N=N.substring(0,_)):E<0&&(E=N.length)}else{if(A(S,2,qt.length,"Base"),S==10)return P=new $(b),Ut(P,ge+P.e+1,pe);if(N=String(b),w=typeof b=="number"){if(b*0!=0)return se(P,N,w,S);if(P.s=1/b<0?(N=N.slice(1),-1):1,$.DEBUG&&N.replace(/^0\.0*|\./,"").length>15)throw Error(o+b)}else P.s=N.charCodeAt(0)===45?(N=N.slice(1),-1):1;for(I=qt.slice(0,S),E=_=0,C=N.length;_<C;_++)if(I.indexOf(O=N.charAt(_))<0){if(O=="."){if(_>E){E=C;continue}}else if(!m&&(N==N.toUpperCase()&&(N=N.toLowerCase())||N==N.toLowerCase()&&(N=N.toUpperCase()))){m=!0,_=-1,E=0;continue}return se(P,String(b),w,S)}w=!1,N=te(N,S,10,P.s),(E=N.indexOf("."))>-1?N=N.replace(".",""):E=N.length}for(_=0;N.charCodeAt(_)===48;_++);for(C=N.length;N.charCodeAt(--C)===48;);if(N=N.slice(_,++C)){if(C-=_,w&&$.DEBUG&&C>15&&(b>u||b!==i(b)))throw Error(o+P.s*b);if((E=E-_-1)>qe)P.c=P.e=null;else if(E<_e)P.c=[P.e=0];else{if(P.e=E,P.c=[],_=(E+1)%c,E<0&&(_+=c),_<C){for(_&&P.c.push(+N.slice(0,_)),C-=c;_<C;)P.c.push(+N.slice(_,_+=c));_=c-(N=N.slice(_)).length}else _-=C;for(;_--;N+="0");P.c.push(+N)}}else P.c=[P.e=0]}$.clone=p,$.ROUND_UP=0,$.ROUND_DOWN=1,$.ROUND_CEIL=2,$.ROUND_FLOOR=3,$.ROUND_HALF_UP=4,$.ROUND_HALF_DOWN=5,$.ROUND_HALF_EVEN=6,$.ROUND_HALF_CEIL=7,$.ROUND_HALF_FLOOR=8,$.EUCLID=9,$.config=$.set=function(b){var S,I;if(b!=null)if(typeof b=="object"){if(b.hasOwnProperty(S="DECIMAL_PLACES")&&(I=b[S],A(I,0,d,S),ge=I),b.hasOwnProperty(S="ROUNDING_MODE")&&(I=b[S],A(I,0,8,S),pe=I),b.hasOwnProperty(S="EXPONENTIAL_AT")&&(I=b[S],I&&I.pop?(A(I[0],-d,0,S),A(I[1],0,d,S),Xe=I[0],Ze=I[1]):(A(I,-d,d,S),Xe=-(Ze=I<0?-I:I))),b.hasOwnProperty(S="RANGE"))if(I=b[S],I&&I.pop)A(I[0],-d,-1,S),A(I[1],1,d,S),_e=I[0],qe=I[1];else if(A(I,-d,d,S),I)_e=-(qe=I<0?-I:I);else throw Error(s+S+" cannot be zero: "+I);if(b.hasOwnProperty(S="CRYPTO"))if(I=b[S],I===!!I)if(I)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))re=I;else throw re=!I,Error(s+"crypto unavailable");else re=I;else throw Error(s+S+" not true or false: "+I);if(b.hasOwnProperty(S="MODULO_MODE")&&(I=b[S],A(I,0,9,S),$t=I),b.hasOwnProperty(S="POW_PRECISION")&&(I=b[S],A(I,0,d,S),Lt=I),b.hasOwnProperty(S="FORMAT"))if(I=b[S],typeof I=="object")Gr=I;else throw Error(s+S+" not an object: "+I);if(b.hasOwnProperty(S="ALPHABET"))if(I=b[S],typeof I=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(I))qt=I;else throw Error(s+S+" invalid: "+I)}else throw Error(s+"Object expected: "+b);return{DECIMAL_PLACES:ge,ROUNDING_MODE:pe,EXPONENTIAL_AT:[Xe,Ze],RANGE:[_e,qe],CRYPTO:re,MODULO_MODE:$t,POW_PRECISION:Lt,FORMAT:Gr,ALPHABET:qt}},$.isBigNumber=function(b){if(!b||b._isBigNumber!==!0)return!1;if(!$.DEBUG)return!0;var S,I,O=b.c,m=b.e,E=b.s;e:if({}.toString.call(O)=="[object Array]"){if((E===1||E===-1)&&m>=-d&&m<=d&&m===i(m)){if(O[0]===0){if(m===0&&O.length===1)return!0;break e}if(S=(m+1)%c,S<1&&(S+=c),String(O[0]).length==S){for(S=0;S<O.length;S++)if(I=O[S],I<0||I>=a||I!==i(I))break e;if(I!==0)return!0}}}else if(O===null&&m===null&&(E===null||E===1||E===-1))return!0;throw Error(s+"Invalid BigNumber: "+b)},$.maximum=$.max=function(){return Zs(arguments,j.lt)},$.minimum=$.min=function(){return Zs(arguments,j.gt)},$.random=function(){var b=9007199254740992,S=Math.random()*b&2097151?function(){return i(Math.random()*b)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(I){var O,m,E,_,w,C=0,N=[],P=new $(Ae);if(I==null?I=ge:A(I,0,d),_=n(I/c),re)if(crypto.getRandomValues){for(O=crypto.getRandomValues(new Uint32Array(_*=2));C<_;)w=O[C]*131072+(O[C+1]>>>11),w>=9e15?(m=crypto.getRandomValues(new Uint32Array(2)),O[C]=m[0],O[C+1]=m[1]):(N.push(w%1e14),C+=2);C=_/2}else if(crypto.randomBytes){for(O=crypto.randomBytes(_*=7);C<_;)w=(O[C]&31)*281474976710656+O[C+1]*1099511627776+O[C+2]*4294967296+O[C+3]*16777216+(O[C+4]<<16)+(O[C+5]<<8)+O[C+6],w>=9e15?crypto.randomBytes(7).copy(O,C):(N.push(w%1e14),C+=7);C=_/7}else throw re=!1,Error(s+"crypto unavailable");if(!re)for(;C<_;)w=S(),w<9e15&&(N[C++]=w%1e14);for(_=N[--C],I%=c,_&&I&&(w=l[c-I],N[C]=i(_/w)*w);N[C]===0;N.pop(),C--);if(C<0)N=[E=0];else{for(E=-1;N[0]===0;N.splice(0,1),E-=c);for(C=1,w=N[0];w>=10;w/=10,C++);C<c&&(E-=c-C)}return P.e=E,P.c=N,P}}(),$.sum=function(){for(var b=1,S=arguments,I=new $(S[0]);b<S.length;)I=I.plus(S[b++]);return I},te=function(){var b="0123456789";function S(I,O,m,E){for(var _,w=[0],C,N=0,P=I.length;N<P;){for(C=w.length;C--;w[C]*=O);for(w[0]+=E.indexOf(I.charAt(N++)),_=0;_<w.length;_++)w[_]>m-1&&(w[_+1]==null&&(w[_+1]=0),w[_+1]+=w[_]/m|0,w[_]%=m)}return w.reverse()}return function(I,O,m,E,_){var w,C,N,P,F,W,Y,ae,ie=I.indexOf("."),me=ge,le=pe;for(ie>=0&&(P=Lt,Lt=0,I=I.replace(".",""),ae=new $(O),W=ae.pow(I.length-ie),Lt=P,ae.c=S(z(g(W.c),W.e,"0"),10,m,b),ae.e=ae.c.length),Y=S(I,O,m,_?(w=qt,b):(w=b,qt)),N=P=Y.length;Y[--P]==0;Y.pop());if(!Y[0])return w.charAt(0);if(ie<0?--N:(W.c=Y,W.e=N,W.s=E,W=L(W,ae,me,le,m),Y=W.c,F=W.r,N=W.e),C=N+me+1,ie=Y[C],P=m/2,F=F||C<0||Y[C+1]!=null,F=le<4?(ie!=null||F)&&(le==0||le==(W.s<0?3:2)):ie>P||ie==P&&(le==4||F||le==6&&Y[C-1]&1||le==(W.s<0?8:7)),C<1||!Y[0])I=F?z(w.charAt(1),-me,w.charAt(0)):w.charAt(0);else{if(Y.length=C,F)for(--m;++Y[--C]>m;)Y[C]=0,C||(++N,Y=[1].concat(Y));for(P=Y.length;!Y[--P];);for(ie=0,I="";ie<=P;I+=w.charAt(Y[ie++]));I=z(I,N,w.charAt(0))}return I}}(),L=function(){function b(O,m,E){var _,w,C,N,P=0,F=O.length,W=m%f,Y=m/f|0;for(O=O.slice();F--;)C=O[F]%f,N=O[F]/f|0,_=Y*C+N*W,w=W*C+_%f*f+P,P=(w/E|0)+(_/f|0)+Y*N,O[F]=w%E;return P&&(O=[P].concat(O)),O}function S(O,m,E,_){var w,C;if(E!=_)C=E>_?1:-1;else for(w=C=0;w<E;w++)if(O[w]!=m[w]){C=O[w]>m[w]?1:-1;break}return C}function I(O,m,E,_){for(var w=0;E--;)O[E]-=w,w=O[E]<m[E]?1:0,O[E]=w*_+O[E]-m[E];for(;!O[0]&&O.length>1;O.splice(0,1));}return function(O,m,E,_,w){var C,N,P,F,W,Y,ae,ie,me,le,xe,ve,Ce,eo,Au,xr,to,Xt=O.s==m.s?1:-1,Bt=O.c,et=m.c;if(!Bt||!Bt[0]||!et||!et[0])return new $(!O.s||!m.s||(Bt?et&&Bt[0]==et[0]:!et)?NaN:Bt&&Bt[0]==0||!et?Xt*0:Xt/0);for(ie=new $(Xt),me=ie.c=[],N=O.e-m.e,Xt=E+N+1,w||(w=a,N=h(O.e/c)-h(m.e/c),Xt=Xt/c|0),P=0;et[P]==(Bt[P]||0);P++);if(et[P]>(Bt[P]||0)&&N--,Xt<0)me.push(1),F=!0;else{for(eo=Bt.length,xr=et.length,P=0,Xt+=2,W=i(w/(et[0]+1)),W>1&&(et=b(et,W,w),Bt=b(Bt,W,w),xr=et.length,eo=Bt.length),Ce=xr,le=Bt.slice(0,xr),xe=le.length;xe<xr;le[xe++]=0);to=et.slice(),to=[0].concat(to),Au=et[0],et[1]>=w/2&&Au++;do{if(W=0,C=S(et,le,xr,xe),C<0){if(ve=le[0],xr!=xe&&(ve=ve*w+(le[1]||0)),W=i(ve/Au),W>1)for(W>=w&&(W=w-1),Y=b(et,W,w),ae=Y.length,xe=le.length;S(Y,le,ae,xe)==1;)W--,I(Y,xr<ae?to:et,ae,w),ae=Y.length,C=1;else W==0&&(C=W=1),Y=et.slice(),ae=Y.length;if(ae<xe&&(Y=[0].concat(Y)),I(le,Y,xe,w),xe=le.length,C==-1)for(;S(et,le,xr,xe)<1;)W++,I(le,xr<xe?to:et,xe,w),xe=le.length}else C===0&&(W++,le=[0]);me[P++]=W,le[0]?le[xe++]=Bt[Ce]||0:(le=[Bt[Ce]],xe=1)}while((Ce++<eo||le[0]!=null)&&Xt--);F=le[0]!=null,me[0]||me.splice(0,1)}if(w==a){for(P=1,Xt=me[0];Xt>=10;Xt/=10,P++);Ut(ie,E+(ie.e=P+N*c-1)+1,_,F)}else ie.e=N,ie.r=+F;return ie}}();function Xs(b,S,I,O){var m,E,_,w,C;if(I==null?I=pe:A(I,0,8),!b.c)return b.toString();if(m=b.c[0],_=b.e,S==null)C=g(b.c),C=O==1||O==2&&(_<=Xe||_>=Ze)?k(C,_):z(C,_,"0");else if(b=Ut(new $(b),S,I),E=b.e,C=g(b.c),w=C.length,O==1||O==2&&(S<=E||E<=Xe)){for(;w<S;C+="0",w++);C=k(C,E)}else if(S-=_,C=z(C,E,"0"),E+1>w){if(--S>0)for(C+=".";S--;C+="0");}else if(S+=E-w,S>0)for(E+1==w&&(C+=".");S--;C+="0");return b.s<0&&m?"-"+C:C}function Zs(b,S){for(var I,O=1,m=new $(b[0]);O<b.length;O++)if(I=new $(b[O]),I.s)S.call(m,I)&&(m=I);else{m=I;break}return m}function Js(b,S,I){for(var O=1,m=S.length;!S[--m];S.pop());for(m=S[0];m>=10;m/=10,O++);return(I=O+I*c-1)>qe?b.c=b.e=null:I<_e?b.c=[b.e=0]:(b.e=I,b.c=S),b}se=function(){var b=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,I=/^\.([^.]+)$/,O=/^-?(Infinity|NaN)$/,m=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(E,_,w,C){var N,P=w?_:_.replace(m,"");if(O.test(P))E.s=isNaN(P)?null:P<0?-1:1;else{if(!w&&(P=P.replace(b,function(F,W,Y){return N=(Y=Y.toLowerCase())=="x"?16:Y=="b"?2:8,!C||C==N?W:F}),C&&(N=C,P=P.replace(S,"$1").replace(I,"0.$1")),_!=P))return new $(P,N);if($.DEBUG)throw Error(s+"Not a"+(C?" base "+C:"")+" number: "+_);E.s=null}E.c=E.e=null}}();function Ut(b,S,I,O){var m,E,_,w,C,N,P,F=b.c,W=l;if(F){e:{for(m=1,w=F[0];w>=10;w/=10,m++);if(E=S-m,E<0)E+=c,_=S,C=F[N=0],P=C/W[m-_-1]%10|0;else if(N=n((E+1)/c),N>=F.length)if(O){for(;F.length<=N;F.push(0));C=P=0,m=1,E%=c,_=E-c+1}else break e;else{for(C=w=F[N],m=1;w>=10;w/=10,m++);E%=c,_=E-c+m,P=_<0?0:C/W[m-_-1]%10|0}if(O=O||S<0||F[N+1]!=null||(_<0?C:C%W[m-_-1]),O=I<4?(P||O)&&(I==0||I==(b.s<0?3:2)):P>5||P==5&&(I==4||O||I==6&&(E>0?_>0?C/W[m-_]:0:F[N-1])%10&1||I==(b.s<0?8:7)),S<1||!F[0])return F.length=0,O?(S-=b.e+1,F[0]=W[(c-S%c)%c],b.e=-S||0):F[0]=b.e=0,b;if(E==0?(F.length=N,w=1,N--):(F.length=N+1,w=W[c-E],F[N]=_>0?i(C/W[m-_]%W[_])*w:0),O)for(;;)if(N==0){for(E=1,_=F[0];_>=10;_/=10,E++);for(_=F[0]+=w,w=1;_>=10;_/=10,w++);E!=w&&(b.e++,F[0]==a&&(F[0]=1));break}else{if(F[N]+=w,F[N]!=a)break;F[N--]=0,w=1}for(E=F.length;F[--E]===0;F.pop());}b.e>qe?b.c=b.e=null:b.e<_e&&(b.c=[b.e=0])}return b}function Qt(b){var S,I=b.e;return I===null?b.toString():(S=g(b.c),S=I<=Xe||I>=Ze?k(S,I):z(S,I,"0"),b.s<0?"-"+S:S)}return j.absoluteValue=j.abs=function(){var b=new $(this);return b.s<0&&(b.s=1),b},j.comparedTo=function(b,S){return v(this,new $(b,S))},j.decimalPlaces=j.dp=function(b,S){var I,O,m,E=this;if(b!=null)return A(b,0,d),S==null?S=pe:A(S,0,8),Ut(new $(E),b+E.e+1,S);if(!(I=E.c))return null;if(O=((m=I.length-1)-h(this.e/c))*c,m=I[m])for(;m%10==0;m/=10,O--);return O<0&&(O=0),O},j.dividedBy=j.div=function(b,S){return L(this,new $(b,S),ge,pe)},j.dividedToIntegerBy=j.idiv=function(b,S){return L(this,new $(b,S),0,1)},j.exponentiatedBy=j.pow=function(b,S){var I,O,m,E,_,w,C,N,P,F=this;if(b=new $(b),b.c&&!b.isInteger())throw Error(s+"Exponent not an integer: "+Qt(b));if(S!=null&&(S=new $(S)),w=b.e>14,!F.c||!F.c[0]||F.c[0]==1&&!F.e&&F.c.length==1||!b.c||!b.c[0])return P=new $(Math.pow(+Qt(F),w?2-B(b):+Qt(b))),S?P.mod(S):P;if(C=b.s<0,S){if(S.c?!S.c[0]:!S.s)return new $(NaN);O=!C&&F.isInteger()&&S.isInteger(),O&&(F=F.mod(S))}else{if(b.e>9&&(F.e>0||F.e<-1||(F.e==0?F.c[0]>1||w&&F.c[1]>=24e7:F.c[0]<8e13||w&&F.c[0]<=9999975e7)))return E=F.s<0&&B(b)?-0:0,F.e>-1&&(E=1/E),new $(C?1/E:E);Lt&&(E=n(Lt/c+2))}for(w?(I=new $(.5),C&&(b.s=1),N=B(b)):(m=Math.abs(+Qt(b)),N=m%2),P=new $(Ae);;){if(N){if(P=P.times(F),!P.c)break;E?P.c.length>E&&(P.c.length=E):O&&(P=P.mod(S))}if(m){if(m=i(m/2),m===0)break;N=m%2}else if(b=b.times(I),Ut(b,b.e+1,1),b.e>14)N=B(b);else{if(m=+Qt(b),m===0)break;N=m%2}F=F.times(F),E?F.c&&F.c.length>E&&(F.c.length=E):O&&(F=F.mod(S))}return O?P:(C&&(P=Ae.div(P)),S?P.mod(S):E?Ut(P,Lt,pe,_):P)},j.integerValue=function(b){var S=new $(this);return b==null?b=pe:A(b,0,8),Ut(S,S.e+1,b)},j.isEqualTo=j.eq=function(b,S){return v(this,new $(b,S))===0},j.isFinite=function(){return!!this.c},j.isGreaterThan=j.gt=function(b,S){return v(this,new $(b,S))>0},j.isGreaterThanOrEqualTo=j.gte=function(b,S){return(S=v(this,new $(b,S)))===1||S===0},j.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},j.isLessThan=j.lt=function(b,S){return v(this,new $(b,S))<0},j.isLessThanOrEqualTo=j.lte=function(b,S){return(S=v(this,new $(b,S)))===-1||S===0},j.isNaN=function(){return!this.s},j.isNegative=function(){return this.s<0},j.isPositive=function(){return this.s>0},j.isZero=function(){return!!this.c&&this.c[0]==0},j.minus=function(b,S){var I,O,m,E,_=this,w=_.s;if(b=new $(b,S),S=b.s,!w||!S)return new $(NaN);if(w!=S)return b.s=-S,_.plus(b);var C=_.e/c,N=b.e/c,P=_.c,F=b.c;if(!C||!N){if(!P||!F)return P?(b.s=-S,b):new $(F?_:NaN);if(!P[0]||!F[0])return F[0]?(b.s=-S,b):new $(P[0]?_:pe==3?-0:0)}if(C=h(C),N=h(N),P=P.slice(),w=C-N){for((E=w<0)?(w=-w,m=P):(N=C,m=F),m.reverse(),S=w;S--;m.push(0));m.reverse()}else for(O=(E=(w=P.length)<(S=F.length))?w:S,w=S=0;S<O;S++)if(P[S]!=F[S]){E=P[S]<F[S];break}if(E&&(m=P,P=F,F=m,b.s=-b.s),S=(O=F.length)-(I=P.length),S>0)for(;S--;P[I++]=0);for(S=a-1;O>w;){if(P[--O]<F[O]){for(I=O;I&&!P[--I];P[I]=S);--P[I],P[O]+=a}P[O]-=F[O]}for(;P[0]==0;P.splice(0,1),--N);return P[0]?Js(b,P,N):(b.s=pe==3?-1:1,b.c=[b.e=0],b)},j.modulo=j.mod=function(b,S){var I,O,m=this;return b=new $(b,S),!m.c||!b.s||b.c&&!b.c[0]?new $(NaN):!b.c||m.c&&!m.c[0]?new $(m):($t==9?(O=b.s,b.s=1,I=L(m,b,0,3),b.s=O,I.s*=O):I=L(m,b,0,$t),b=m.minus(I.times(b)),!b.c[0]&&$t==1&&(b.s=m.s),b)},j.multipliedBy=j.times=function(b,S){var I,O,m,E,_,w,C,N,P,F,W,Y,ae,ie,me,le=this,xe=le.c,ve=(b=new $(b,S)).c;if(!xe||!ve||!xe[0]||!ve[0])return!le.s||!b.s||xe&&!xe[0]&&!ve||ve&&!ve[0]&&!xe?b.c=b.e=b.s=null:(b.s*=le.s,!xe||!ve?b.c=b.e=null:(b.c=[0],b.e=0)),b;for(O=h(le.e/c)+h(b.e/c),b.s*=le.s,C=xe.length,F=ve.length,C<F&&(ae=xe,xe=ve,ve=ae,m=C,C=F,F=m),m=C+F,ae=[];m--;ae.push(0));for(ie=a,me=f,m=F;--m>=0;){for(I=0,W=ve[m]%me,Y=ve[m]/me|0,_=C,E=m+_;E>m;)N=xe[--_]%me,P=xe[_]/me|0,w=Y*N+P*W,N=W*N+w%me*me+ae[E]+I,I=(N/ie|0)+(w/me|0)+Y*P,ae[E--]=N%ie;ae[E]=I}return I?++O:ae.splice(0,1),Js(b,ae,O)},j.negated=function(){var b=new $(this);return b.s=-b.s||null,b},j.plus=function(b,S){var I,O=this,m=O.s;if(b=new $(b,S),S=b.s,!m||!S)return new $(NaN);if(m!=S)return b.s=-S,O.minus(b);var E=O.e/c,_=b.e/c,w=O.c,C=b.c;if(!E||!_){if(!w||!C)return new $(m/0);if(!w[0]||!C[0])return C[0]?b:new $(w[0]?O:m*0)}if(E=h(E),_=h(_),w=w.slice(),m=E-_){for(m>0?(_=E,I=C):(m=-m,I=w),I.reverse();m--;I.push(0));I.reverse()}for(m=w.length,S=C.length,m-S<0&&(I=C,C=w,w=I,S=m),m=0;S;)m=(w[--S]=w[S]+C[S]+m)/a|0,w[S]=a===w[S]?0:w[S]%a;return m&&(w=[m].concat(w),++_),Js(b,w,_)},j.precision=j.sd=function(b,S){var I,O,m,E=this;if(b!=null&&b!==!!b)return A(b,1,d),S==null?S=pe:A(S,0,8),Ut(new $(E),b,S);if(!(I=E.c))return null;if(m=I.length-1,O=m*c+1,m=I[m]){for(;m%10==0;m/=10,O--);for(m=I[0];m>=10;m/=10,O++);}return b&&E.e+1>O&&(O=E.e+1),O},j.shiftedBy=function(b){return A(b,-u,u),this.times("1e"+b)},j.squareRoot=j.sqrt=function(){var b,S,I,O,m,E=this,_=E.c,w=E.s,C=E.e,N=ge+4,P=new $("0.5");if(w!==1||!_||!_[0])return new $(!w||w<0&&(!_||_[0])?NaN:_?E:1/0);if(w=Math.sqrt(+Qt(E)),w==0||w==1/0?(S=g(_),(S.length+C)%2==0&&(S+="0"),w=Math.sqrt(+S),C=h((C+1)/2)-(C<0||C%2),w==1/0?S="5e"+C:(S=w.toExponential(),S=S.slice(0,S.indexOf("e")+1)+C),I=new $(S)):I=new $(w+""),I.c[0]){for(C=I.e,w=C+N,w<3&&(w=0);;)if(m=I,I=P.times(m.plus(L(E,m,N,1))),g(m.c).slice(0,w)===(S=g(I.c)).slice(0,w))if(I.e<C&&--w,S=S.slice(w-3,w+1),S=="9999"||!O&&S=="4999"){if(!O&&(Ut(m,m.e+ge+2,0),m.times(m).eq(E))){I=m;break}N+=4,w+=4,O=1}else{(!+S||!+S.slice(1)&&S.charAt(0)=="5")&&(Ut(I,I.e+ge+2,1),b=!I.times(I).eq(E));break}}return Ut(I,I.e+ge+1,pe,b)},j.toExponential=function(b,S){return b!=null&&(A(b,0,d),b++),Xs(this,b,S,1)},j.toFixed=function(b,S){return b!=null&&(A(b,0,d),b=b+this.e+1),Xs(this,b,S)},j.toFormat=function(b,S,I){var O,m=this;if(I==null)b!=null&&S&&typeof S=="object"?(I=S,S=null):b&&typeof b=="object"?(I=b,b=S=null):I=Gr;else if(typeof I!="object")throw Error(s+"Argument not an object: "+I);if(O=m.toFixed(b,S),m.c){var E,_=O.split("."),w=+I.groupSize,C=+I.secondaryGroupSize,N=I.groupSeparator||"",P=_[0],F=_[1],W=m.s<0,Y=W?P.slice(1):P,ae=Y.length;if(C&&(E=w,w=C,C=E,ae-=E),w>0&&ae>0){for(E=ae%w||w,P=Y.substr(0,E);E<ae;E+=w)P+=N+Y.substr(E,w);C>0&&(P+=N+Y.slice(E)),W&&(P="-"+P)}O=F?P+(I.decimalSeparator||"")+((C=+I.fractionGroupSize)?F.replace(new RegExp("\\d{"+C+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):F):P}return(I.prefix||"")+O+(I.suffix||"")},j.toFraction=function(b){var S,I,O,m,E,_,w,C,N,P,F,W,Y=this,ae=Y.c;if(b!=null&&(w=new $(b),!w.isInteger()&&(w.c||w.s!==1)||w.lt(Ae)))throw Error(s+"Argument "+(w.isInteger()?"out of range: ":"not an integer: ")+Qt(w));if(!ae)return new $(Y);for(S=new $(Ae),N=I=new $(Ae),O=C=new $(Ae),W=g(ae),E=S.e=W.length-Y.e-1,S.c[0]=l[(_=E%c)<0?c+_:_],b=!b||w.comparedTo(S)>0?E>0?S:N:w,_=qe,qe=1/0,w=new $(W),C.c[0]=0;P=L(w,S,0,1),m=I.plus(P.times(O)),m.comparedTo(b)!=1;)I=O,O=m,N=C.plus(P.times(m=N)),C=m,S=w.minus(P.times(m=S)),w=m;return m=L(b.minus(I),O,0,1),C=C.plus(m.times(N)),I=I.plus(m.times(O)),C.s=N.s=Y.s,E=E*2,F=L(N,O,E,pe).minus(Y).abs().comparedTo(L(C,I,E,pe).minus(Y).abs())<1?[N,O]:[C,I],qe=_,F},j.toNumber=function(){return+Qt(this)},j.toPrecision=function(b,S){return b!=null&&A(b,1,d),Xs(this,b,S,2)},j.toString=function(b){var S,I=this,O=I.s,m=I.e;return m===null?O?(S="Infinity",O<0&&(S="-"+S)):S="NaN":(b==null?S=m<=Xe||m>=Ze?k(g(I.c),m):z(g(I.c),m,"0"):b===10?(I=Ut(new $(I),ge+m+1,pe),S=z(g(I.c),I.e,"0")):(A(b,2,qt.length,"Base"),S=te(z(g(I.c),m,"0"),10,b,O,!0)),O<0&&I.c[0]&&(S="-"+S)),S},j.valueOf=j.toJSON=function(){return Qt(this)},j._isBigNumber=!0,q!=null&&$.set(q),$}function h(q){var L=q|0;return q>0||q===L?L:L-1}function g(q){for(var L,te,se=1,j=q.length,Ae=q[0]+"";se<j;){for(L=q[se++]+"",te=c-L.length;te--;L="0"+L);Ae+=L}for(j=Ae.length;Ae.charCodeAt(--j)===48;);return Ae.slice(0,j+1||1)}function v(q,L){var te,se,j=q.c,Ae=L.c,ge=q.s,pe=L.s,Xe=q.e,Ze=L.e;if(!ge||!pe)return null;if(te=j&&!j[0],se=Ae&&!Ae[0],te||se)return te?se?0:-pe:ge;if(ge!=pe)return ge;if(te=ge<0,se=Xe==Ze,!j||!Ae)return se?0:!j^te?1:-1;if(!se)return Xe>Ze^te?1:-1;for(pe=(Xe=j.length)<(Ze=Ae.length)?Xe:Ze,ge=0;ge<pe;ge++)if(j[ge]!=Ae[ge])return j[ge]>Ae[ge]^te?1:-1;return Xe==Ze?0:Xe>Ze^te?1:-1}function A(q,L,te,se){if(q<L||q>te||q!==i(q))throw Error(s+(se||"Argument")+(typeof q=="number"?q<L||q>te?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function B(q){var L=q.c.length-1;return h(q.e/c)==L&&q.c[L]%2!=0}function k(q,L){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(L<0?"e":"e+")+L}function z(q,L,te){var se,j;if(L<0){for(j=te+".";++L;j+=te);q=j+q}else if(se=q.length,++L>se){for(j=te,L-=se;--L;j+=te);q+=j}else L<se&&(q=q.slice(0,L)+"."+q.slice(L));return q}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof au!="undefined"&&au.exports?au.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(z2)});var Q2=x((W2,Y2)=>{"use strict";var mO=Math.exp;W2=Y2.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,n=0,i=0,s=0,o,a={};function c(u,l){return 1-mO(-(u-l)/e)}return a.push=function(l,f){if(o){let d=c(l,o),p=f-r,h=d*p;r=d*f+(1-d)*r,n=(1-d)*(n+p*h),i=Math.sqrt(n),s=r+d*p}else r=f;o=l},a.movingAverage=function(){return r},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return s},a}});var ex=x((AU,J2)=>{"use strict";var{EventEmitter:vO}=Wr(),{BigNumber:cu}=G2(),X2=Q2(),bO=Xo(),Z2=class extends vO{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:cu(0),dataSent:cu(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let n=this._options.movingAverageIntervals;for(let i=0;i<e.length;i++){let s=e[i];this._stats[s]=cu(0),this._movingAverages[s]={};for(let o=0;o<n.length;o++){let a=n[o];(this._movingAverages[s][a]=X2(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,n={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},i=Object.keys(r);for(let s of i){n.movingAverages[s]={};for(let o of Object.keys(r[s]))n.movingAverages[s][o]=r[s][o].movingAverage()}return n}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=bO(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=i/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],f=a[l];f||(f=a[l]=X2(l)),f.push(n,o)}}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);let i;Object.prototype.hasOwnProperty.call(this._stats,r)?i=this._stats[r]:i=this._stats[r]=cu(0),this._stats[r]=i.plus(n),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=n}};J2.exports=Z2});var nx=x((_U,rx)=>{"use strict";var wO=hs(),{pipe:EO}=Kr(),{tap:tx}=ou(),xO=H2(),{METRICS:SO}=Pc(),N0=ex(),O0=["dataReceived","dataSent"],AO={in:"dataReceived",out:"dataSent"},uu=class{constructor(e){this._options=wO(SO,e),this._globalStats=new N0(O0,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=xO(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",r=>{this.onPeerDisconnected(r.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),n=this._peerStats.get(r);n&&(n.stop(),this._peerStats.delete(r),this._oldPeers.set(r,n))}_onMessage({remotePeer:e,protocol:r,direction:n,dataLength:i}){if(!this._running)return;let s=AO[n],o=this.forPeer(e);if(o||(o=new N0(O0,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,i),this._globalStats.push(s,i),r){let a=this.forProtocol(r);a||(a=new N0(O0,this._options),this._protocolStats.set(r,a)),a.push(s,i)}}updatePlaceholder(e,r){if(!this._running)return;let n=this.forPeer(e),i=r.toB58String(),s=this.forPeer(r),o=n;s&&(o=uu.mergeStats(s,o),this._oldPeers.delete(i)),this._peerStats.delete(e.toB58String()),this._peerStats.set(i,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:n}){let i=this,s=e.source;e.source=tx(a=>i._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>EO(a,tx(c=>i._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};rx.exports=uu});var lu=x(Bi=>{"use strict";var ix=Si(),sx=ta(),_O=Kr(),CO=he(),{fromString:IO}=(Et(),At),TO=hf(),ox=IO(`
`);Bi.encode=t=>sx.encode.single(new ix([t,ox]));Bi.write=(t,e)=>t.push(Bi.encode(e));Bi.writeAll=(t,e)=>{t.push(e.reduce((r,n)=>r.append(Bi.encode(n)),new ix))};Bi.read=async t=>{let e=1,r={[Symbol.asyncIterator](){return this},next:()=>t.next(e)},n=s=>{e=s},i=await _O(r,sx.decode({onLength:n}),TO);if(i.get(i.length-1)!==ox[0])throw CO(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return i.shallowSlice(0,-1)}});var cx=x((IU,ax)=>{"use strict";var Ds=Ne()("mss:select"),RO=he(),ks=lu(),BO=ra();ax.exports=async(t,e,r)=>{e=Array.isArray(e)?[...e]:[e];let{reader:n,writer:i,rest:s,stream:o}=BO(t),a=e.shift();r?(Ds('select: write ["%s", "%s"]',r,a),ks.writeAll(i,[r,a])):(Ds('select: write "%s"',a),ks.write(i,a));let c=(await ks.read(n)).toString();if(Ds('select: read "%s"',c),c===r&&(c=(await ks.read(n)).toString(),Ds('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let u of e){Ds('select: write "%s"',u),ks.write(i,u);let l=(await ks.read(n)).toString();if(Ds('select: read "%s" for "%s"',l,u),l===u)return s(),{stream:o,protocol:u}}throw s(),RO(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var D0=x(ux=>{"use strict";ux.PROTOCOL_ID="/multistream/1.0.0"});var fx=x((RU,lx)=>{"use strict";var ca=Ne()("mss:handle"),PO=Si(),Ls=lu(),NO=ra(),{PROTOCOL_ID:k0}=D0();lx.exports=async(t,e)=>{e=Array.isArray(e)?e:[e];let{writer:r,reader:n,rest:i,stream:s}=NO(t);for(;;){let o=(await Ls.read(n)).toString();if(ca('read "%s"',o),o===k0){ca('respond with "%s" for "%s"',k0,o),Ls.write(r,k0);continue}if(e.includes(o))return Ls.write(r,o),ca('respond with "%s" for "%s"',o,o),i(),{stream:s,protocol:o};if(o==="ls"){Ls.write(r,new PO(e.map(a=>Ls.encode(a)))),ca('respond with "%s" for %s',e,o);continue}Ls.write(r,"na"),ca('respond with "na" for "%s"',o)}}});var px=x((BU,hx)=>{"use strict";var OO=n0(),DO=Ne()("it-multistream-select:ls"),dx=lu(),kO=ra(),LO=ta(),qO=Kr();hx.exports=async t=>{let{reader:e,writer:r,rest:n,stream:i}=kO(t);DO('write "ls"'),dx.write(r,"ls"),n();let s=await dx.read(e),o=OO([s]),a=[];return await qO(o,LO.decode(),async c=>{for await(let u of c)a.push(u.shallowSlice(0,-1).toString())}),{stream:i,protocols:a}}});var vx=x(fu=>{"use strict";var yx=cx(),UO=fx(),MO=px(),{PROTOCOL_ID:L0}=D0();fu.PROTOCOL_ID=L0;var q0=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await yx(this._stream,L0);this._stream=e,this._shaken=!0}},gx=class extends q0{select(e){return yx(this._stream,e,this._shaken?null:L0)}async ls(){await this._handshake();let{stream:e,protocols:r}=await MO(this._stream);return this._stream=e,r}};fu.Dialer=gx;var mx=class extends q0{handle(e){return UO(this._stream,e)}};fu.Listener=mx});var wx=x((NU,bx)=>{"use strict";var FO={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};bx.exports=FO});var Cx=x((OU,_x)=>{"use strict";var Ex=at(),{Multiaddr:KO}=Tt(),Wt=he(),{OPEN:VO,CLOSING:xx,CLOSED:U0}=wx(),Sx=Symbol.for("@libp2p/interface-connection/connection"),Ax=class{constructor({localAddr:e,remoteAddr:r,localPeer:n,remotePeer:i,newStream:s,close:o,getStreams:a,stat:c}){jO(e,n,i,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=n,this.remotePeer=i,this._stat={...c,status:VO},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[Sx](){return!0}static isConnection(e){return Boolean(e&&e[Sx])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===xx)throw Wt(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===U0)throw Wt(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:n}=await this._newStream(e);return this.addStream(r,{protocol:n}),{stream:r,protocol:n}}addStream(e,{protocol:r,metadata:n={}}){this.registry.set(e.id,{protocol:r,...n})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==U0){if(this._closing)return this._closing;this.stat.status=xx,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=U0}}};_x.exports=Ax;function jO(t,e,r,n,i,s,o){if(t&&!KO.isMultiaddr(t))throw Wt(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!Ex.isPeerId(e))throw Wt(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!Ex.isPeerId(r))throw Wt(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Wt(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Wt(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Wt(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Wt(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Wt(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Wt(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Wt(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Wt(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var Tx=x(Ix=>{"use strict";Ix.Connection=Cx()});var Bx=x((kU,Rx)=>{"use strict";function $O(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}Rx.exports=function(e){var r=void 0,n=void 0;function i(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');n=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=a}i(function(){}),e&&i(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,f=Array(l),d=0;d<l;d++)f[d]=arguments[d];return r[u].apply(null,[n].concat($O(f.slice(1))))}}});return{setTarget:i,setHandler:s,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,o)}}});var kx=x((LU,Dx)=>{"use strict";var Px=Ne(),ft=Object.assign(Px("libp2p:upgrader"),{error:Px("libp2p:upgrader:err")}),Pi=he(),qs=vx(),{Connection:HO}=Tx(),zO=at(),{pipe:GO}=Kr(),Nx=Bx(),{codes:Us}=ot(),Ox=class{constructor({localPeer:e,metrics:r,cryptos:n=new Map,muxers:i=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=r,this.cryptos=n,this.muxers=i,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let r,n,i,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=Nx());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}ft("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:r,remotePeer:n,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:i,Muxer:s}=await this._multiplexInbound(r,this.muxers):i=r}catch(l){throw ft.error("Failed to upgrade inbound connection",l),await e.close(l),l}return this.metrics&&(this.metrics.updatePlaceholder(c,n),a(n)),ft("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:i,Muxer:s,remotePeer:n})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw Pi(new Error("outbound connection must have a peer id"),Us.ERR_INVALID_MULTIADDR);let n=zO.createFromB58String(r),i,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=Nx());let d=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>d}),e=this.metrics.trackStream({stream:e,remotePeer:l})}ft("Starting the outbound connection upgrade");let f=e;this.protector&&(f=await this.protector.protect(e));try{({conn:i,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,f,n,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(i,this.muxers):o=i}catch(d){throw ft.error("Failed to upgrade outbound connection",d),await e.close(d),d}return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),ft("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:n,upgradedConn:i,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async d=>{if(!u)return;let p=new qs.Listener(d);try{let{stream:h,protocol:g}=await p.handle(Array.from(this.protocols.keys()));ft("%s: incoming stream opened on %s",r,g),this.metrics&&this.metrics.trackStream({stream:h,remotePeer:o,protocol:g}),u.addStream(d,{protocol:g}),this._onStream({connection:u,stream:{...d,...h},protocol:g})}catch(h){ft.error(h)}},onStreamEnd:d=>{u.removeStream(d.id)}}),c=async d=>{ft("%s: starting new stream on %s",r,d);let p=a.newStream(),h=new qs.Dialer(p);try{let{stream:g,protocol:v}=await h.select(d);return this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:v}),{stream:{...p,...g},protocol:v}}catch(g){throw ft.error("could not create new stream",g),Pi(g,Us.ERR_UNSUPPORTED_PROTOCOL)}},GO(i,a,i).catch(ft.error));let l=n.timeline;n.timeline=new Proxy(l,{set:(...d)=>(u&&d[1]==="close"&&d[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){ft.error(p)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...d))}),n.timeline.upgraded=Date.now();let f=()=>{throw Pi(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return u=new HO({localAddr:n.localAddr,remoteAddr:n.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:n.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||f,getStreams:()=>a?a.streams:f(),close:async()=>{await n.close(),a&&a.streams.map(d=>d.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:n}){this.protocols.get(n)({connection:e,stream:r,protocol:n})}async _encryptInbound(e,r,n){let i=new qs.Listener(r),s=Array.from(n.keys());ft("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await i.handle(s),c=n.get(a);if(ft("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Pi(o,Us.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,n,i){let s=new qs.Dialer(r),o=Array.from(i.keys());ft("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=i.get(c);if(ft("encrypting outbound connection to %j",n),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,n),protocol:c}}catch(a){throw Pi(a,Us.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let n=new qs.Dialer(e),i=Array.from(r.keys());ft("outbound selecting muxer %s",i);try{let{stream:s,protocol:o}=await n.select(i);ft("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw Pi(s,Us.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let n=new qs.Listener(e),i=Array.from(r.keys());ft("inbound handling muxers %s",i);try{let{stream:s,protocol:o}=await n.handle(i),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw Pi(s,Us.ERR_MUXER_UNAVAILABLE)}}};Dx.exports=Ox});var ua=x((qU,Mx)=>{"use strict";var M0=he(),Lx=at(),{codes:{ERR_INVALID_PARAMETERS:qx}}=ot(),WO=t=>t,Ux=class{constructor({peerStore:e,eventName:r,eventProperty:n,eventTransformer:i=WO}){this._ps=e,this.eventName=r,this.eventProperty=n,this.eventTransformer=i,this.data=new Map}set(e,r){throw M0(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,r,{emit:n=!0}={}){let i=e.toB58String();this.data.set(i,r),n&&this._emit(e,r)}_emit(e,r){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(r)})}get(e){if(!Lx.isPeerId(e))throw M0(new Error("peerId must be an instance of peer-id"),qx);let r=this.data.get(e.toB58String());return r?[...r]:void 0}delete(e){if(!Lx.isPeerId(e))throw M0(new Error("peerId must be an instance of peer-id"),qx);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};Mx.exports=Ux});var jx=x((UU,Vx)=>{"use strict";var Fx=Ne(),wr=Object.assign(Fx("libp2p:peer-store:address-book"),{error:Fx("libp2p:peer-store:address-book:err")}),Ms=he(),{Multiaddr:YO}=Tt(),du=at(),QO=ua(),XO=qc(),{codes:{ERR_INVALID_PARAMETERS:Fs}}=ot(),ZO=kc(),Kx=class extends QO{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:r=>r.addresses?r.addresses.map(n=>n.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let r;try{r=XO.createFromProtobuf(e.payload)}catch(c){return wr.error("invalid peer record received"),!1}if(!r.peerId.equals(e.peerId))return wr("signing key does not match PeerId in the PeerRecord"),!1;if(!r.multiaddrs||!r.multiaddrs.length)return!1;let n=r.peerId,i=n.toB58String(),o=(this.data.get(i)||{record:void 0}).record;if(o&&o.seqNumber>=r.seqNumber)return!1;let a=this._toAddresses(r.multiaddrs,!0);return this._setData(n,{addresses:a,record:{raw:e.marshal(),seqNumber:r.seqNumber}}),wr(`stored provided peer record for ${i}`),!0}getRawEnvelope(e){let r=this.data.get(e.toB58String());if(!(!r||!r.record||!r.record.raw))return r.record.raw}getPeerRecord(e){let r=this.getRawEnvelope(e);if(!!r)return ZO.createFromProtobuf(r)}set(e,r){if(!du.isPeerId(e))throw wr.error("peerId must be an instance of peer-id to store data"),Ms(new Error("peerId must be an instance of peer-id"),Fs);let n=this._toAddresses(r);if(!n.length)return this;let i=e.toB58String(),s=this.data.get(i);return s&&s.addresses&&s.addresses.length===n.length&&s.addresses.filter(a=>n.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(wr(`the addresses provided to store are equal to the already stored for ${i}`),this):(this._setData(e,{addresses:n,record:s&&s.record}),wr(`stored provided multiaddrs for ${i}`),s||this._ps.emit("peer",e),this)}add(e,r){if(!du.isPeerId(e))throw wr.error("peerId must be an instance of peer-id to store data"),Ms(new Error("peerId must be an instance of peer-id"),Fs);let n=this._toAddresses(r),i=e.toB58String();if(!n.length)return this;let s=this.data.get(i);return s&&s.addresses&&(s.addresses.forEach(o=>{n.find(a=>a.multiaddr.equals(o.multiaddr))||n.push(o)}),s.addresses.length===n.length)?(wr(`the addresses provided to store are already stored for ${i}`),this):(this._setData(e,{addresses:n,record:s&&s.record}),wr(`added provided multiaddrs for ${i}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!du.isPeerId(e))throw Ms(new Error("peerId must be an instance of peer-id"),Fs);let r=this.data.get(e.toB58String());return r&&r.addresses?[...r.addresses]:void 0}_toAddresses(e,r=!1){if(!e)throw wr.error("multiaddrs must be provided to store data"),Ms(new Error("multiaddrs must be provided"),Fs);let n=[];return e.forEach(i=>{if(!YO.isMultiaddr(i))throw wr.error(`multiaddr ${i} must be an instance of multiaddr`),Ms(new Error(`multiaddr ${i} must be an instance of multiaddr`),Fs);n.find(s=>s.multiaddr.equals(i))||n.push({multiaddr:i,isCertified:r})}),n}getMultiaddrsForPeer(e,r=n=>n){if(!du.isPeerId(e))throw Ms(new Error("peerId must be an instance of peer-id"),Fs);let n=this.data.get(e.toB58String());if(!(!n||!n.addresses))return r(n.addresses||[]).map(i=>{let s=i.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};Vx.exports=Kx});var Xx=x((MU,Qx)=>{"use strict";var $x=Ne(),Hx=Object.assign($x("libp2p:peer-store:key-book"),{error:$x("libp2p:peer-store:key-book:err")}),zx=he(),Gx=at(),JO=ua(),{codes:{ERR_INVALID_PARAMETERS:Wx}}=ot(),Yx=class extends JO{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:r=>r.pubKey});this.data=new Map}set(e,r){if(!Gx.isPeerId(e))throw Hx.error("peerId must be an instance of peer-id to store data"),zx(new Error("peerId must be an instance of peer-id"),Wx);let n=e.toB58String();return!this.data.get(n)&&r&&(e.pubKey=r,this._setData(e,e),Hx(`stored provided public key for ${n}`)),this}get(e){if(!Gx.isPeerId(e))throw zx(new Error("peerId must be an instance of peer-id"),Wx);let r=this.data.get(e.toB58String());return r?r.pubKey:void 0}};Qx.exports=Yx});var tS=x((FU,eS)=>{"use strict";var Zx=Ne(),F0=Object.assign(Zx("libp2p:peer-store:proto-book"),{error:Zx("libp2p:peer-store:proto-book:err")}),Ks=he(),{equals:eD}=(Dr(),Or),la=at(),tD=ua(),{codes:{ERR_INVALID_PARAMETERS:Vs}}=ot(),Jx=class extends tD{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,r,n){if(!la.isPeerId(e))throw F0.error("peerId must be an instance of peer-id to store data"),Ks(new Error("peerId must be an instance of peer-id"),Vs);if(typeof r!="string"||!(n instanceof Uint8Array))throw F0.error("valid key and value must be provided to store data"),Ks(new Error("valid key and value must be provided"),Vs);return this._setValue(e,r,n),this}_setValue(e,r,n,{emit:i=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(r);if(a&&eD(n,a)){F0(`the metadata provided to store is equal to the already stored for ${s} on ${r}`);return}o.set(r,n),this.data.set(s,o),i&&this._emit(e,r)}get(e){if(!la.isPeerId(e))throw Ks(new Error("peerId must be an instance of peer-id"),Vs);return this.data.get(e.toB58String())}getValue(e,r){if(!la.isPeerId(e))throw Ks(new Error("peerId must be an instance of peer-id"),Vs);let n=this.data.get(e.toB58String());return n&&n.get(r)}delete(e){if(!la.isPeerId(e))throw Ks(new Error("peerId must be an instance of peer-id"),Vs);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,r){if(!la.isPeerId(e))throw Ks(new Error("peerId must be an instance of peer-id"),Vs);let n=this.data.get(e.toB58String());return!n||!n.delete(r)?!1:(this._emit(e,r),!0)}};eS.exports=Jx});var sS=x((KU,iS)=>{"use strict";var rS=Ne(),Er=Object.assign(rS("libp2p:peer-store:proto-book"),{error:rS("libp2p:peer-store:proto-book:err")}),js=he(),K0=at(),rD=ua(),{codes:{ERR_INVALID_PARAMETERS:$s}}=ot(),nS=class extends rD{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:r=>Array.from(r)});this.data=new Map}set(e,r){if(!K0.isPeerId(e))throw Er.error("peerId must be an instance of peer-id to store data"),js(new Error("peerId must be an instance of peer-id"),$s);if(!r)throw Er.error("protocols must be provided to store data"),js(new Error("protocols must be provided"),$s);let n=e.toB58String(),i=this.data.get(n),s=new Set(r);return i&&((a,c)=>a.size===c.size&&[...a].every(u=>c.has(u)))(i,s)?(Er(`the protocols provided to store are equal to the already stored for ${n}`),this):(this._setData(e,s),Er(`stored provided protocols for ${n}`),this)}add(e,r){if(!K0.isPeerId(e))throw Er.error("peerId must be an instance of peer-id to store data"),js(new Error("peerId must be an instance of peer-id"),$s);if(!r)throw Er.error("protocols must be provided to store data"),js(new Error("protocols must be provided"),$s);let n=e.toB58String(),i=this.data.get(n)||new Set,s=new Set([...i,...r]);return i.size===s.size?(Er(`the protocols provided to store are already stored for ${n}`),this):(this._setData(e,s),Er(`added provided protocols for ${n}`),this)}remove(e,r){if(!K0.isPeerId(e))throw Er.error("peerId must be an instance of peer-id to store data"),js(new Error("peerId must be an instance of peer-id"),$s);if(!r)throw Er.error("protocols must be provided to store data"),js(new Error("protocols must be provided"),$s);let n=e.toB58String(),i=this.data.get(n);if(i){let s=new Set([...i].filter(o=>!r.includes(o)));if(i.size===s.size)return this;this._setData(e,s),Er(`removed provided protocols for ${n}`)}return this}};iS.exports=nS});var V0=x((VU,cS)=>{"use strict";var nD=he(),{EventEmitter:iD}=Wr(),oS=at(),sD=jx(),oD=Xx(),aD=tS(),cD=sS(),{codes:{ERR_INVALID_PARAMETERS:uD}}=ot(),aS=class extends iD{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new sD(this),this.keyBook=new oD(this),this.metadataBook=new aD(this),this.protoBook=new cD(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let r=new Map;return e.forEach(n=>{r.set(n,this.get(oS.createFromB58String(n)))}),r}delete(e){let r=this.addressBook.delete(e),n=this.keyBook.delete(e),i=this.protoBook.delete(e),s=this.metadataBook.delete(e);return r||n||i||s}get(e){if(!oS.isPeerId(e))throw nD(new Error("peerId must be an instance of peer-id"),uD);let r=this.keyBook.data.get(e.toB58String()),n=this.addressBook.get(e),i=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!r&&!n&&!i&&!s))return{id:r||e,addresses:n||[],protocols:s||[],metadata:i}}};cS.exports=aS});var lS=x((jU,uS)=>{"use strict";function lD(t,e,r){let n=new t(e,r);n._subscribeAdapter=n.subscribe,n._unsubscribeAdapter=n.unsubscribe;function i(o,a){a&&n.on(o,a),n._subscribeAdapter(o)}function s(o,a){a?n.removeListener(o,a):n.removeAllListeners(o),n.listenerCount(o)===0&&n._unsubscribeAdapter(o)}return n.subscribe=i,n.unsubscribe=s,n}uS.exports=lD});var fS=x(($U,Hs)=>{"use strict";Hs.exports.NAMESPACE_COMMON="/peers/";Hs.exports.NAMESPACE_ADDRESS="/peers/addrs/";Hs.exports.NAMESPACE_KEYS="/peers/keys/";Hs.exports.NAMESPACE_METADATA="/peers/metadata/";Hs.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var hS=x((HU,dS)=>{"use strict";var Yn=Qr(),zs=Yn.Reader,j0=Yn.Writer,it=Yn.util,dt=Yn.roots["libp2p-address-book"]||(Yn.roots["libp2p-address-book"]={});dt.Addresses=function(){function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.addrs=it.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,n){if(n||(n=j0.create()),r.addrs!=null&&r.addrs.length)for(var i=0;i<r.addrs.length;++i)dt.Addresses.Address.encode(r.addrs[i],n.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&dt.Addresses.CertifiedRecord.encode(r.certifiedRecord,n.uint32(18).fork()).ldelim(),n},t.decode=function(r,n){r instanceof zs||(r=zs.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new dt.Addresses;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(dt.Addresses.Address.decode(r,r.uint32()));break;case 2:s.certifiedRecord=dt.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof dt.Addresses)return r;var n=new dt.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var i=0;i<r.addrs.length;++i){if(typeof r.addrs[i]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[i]=dt.Addresses.Address.fromObject(r.addrs[i])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=dt.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addrs=[]),n.defaults&&(i.certifiedRecord=null),r.addrs&&r.addrs.length){i.addrs=[];for(var s=0;s<r.addrs.length;++s)i.addrs[s]=dt.Addresses.Address.toObject(r.addrs[s],n)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(i.certifiedRecord=dt.Addresses.CertifiedRecord.toObject(r.certifiedRecord,n)),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Yn.util.toJSONOptions)},t.Address=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=it.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(n,i){return i||(i=j0.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},e.decode=function(n,i){n instanceof zs||(n=zs.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new dt.Addresses.Address;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;case 2:o.isCertified=n.bool();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof dt.Addresses.Address)return n;var i=new dt.Addresses.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?it.base64.decode(n.multiaddr,i.multiaddr=it.newBuffer(it.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=it.newBuffer(s.multiaddr))),s.isCertified=!1),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?it.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(s.isCertified=n.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Yn.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.seq=it.Long?it.Long.fromBits(0,0,!0):0,e.prototype.raw=it.newBuffer([]),e.encode=function(n,i){return i||(i=j0.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&i.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&i.uint32(18).bytes(n.raw),i},e.decode=function(n,i){n instanceof zs||(n=zs.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new dt.Addresses.CertifiedRecord;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.seq=n.uint64();break;case 2:o.raw=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof dt.Addresses.CertifiedRecord)return n;var i=new dt.Addresses.CertifiedRecord;return n.seq!=null&&(it.Long?(i.seq=it.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?i.seq=parseInt(n.seq,10):typeof n.seq=="number"?i.seq=n.seq:typeof n.seq=="object"&&(i.seq=new it.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?it.base64.decode(n.raw,i.raw=it.newBuffer(it.base64.length(n.raw)),0):n.raw.length&&(i.raw=n.raw)),i},e.toObject=function(n,i){i||(i={});var s={};if(i.defaults){if(it.Long){var o=new it.Long(0,0,!0);s.seq=i.longs===String?o.toString():i.longs===Number?o.toNumber():o}else s.seq=i.longs===String?"0":0;i.bytes===String?s.raw="":(s.raw=[],i.bytes!==Array&&(s.raw=it.newBuffer(s.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?s.seq=i.longs===String?String(n.seq):n.seq:s.seq=i.longs===String?it.Long.prototype.toString.call(n.seq):i.longs===Number?new it.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(s.raw=i.bytes===String?it.base64.encode(n.raw,0,n.raw.length):i.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Yn.util.toJSONOptions)},e}(),t}();dS.exports=dt});var gS=x((zU,yS)=>{"use strict";var Gs=Qr(),pS=Gs.Reader,fD=Gs.Writer,dD=Gs.util,fa=Gs.roots["libp2p-proto-book"]||(Gs.roots["libp2p-proto-book"]={});fa.Protocols=function(){function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocols=dD.emptyArray,t.encode=function(r,n){if(n||(n=fD.create()),r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(10).string(r.protocols[i]);return n},t.decode=function(r,n){r instanceof pS||(r=pS.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new fa.Protocols;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof fa.Protocols)return r;var n=new fa.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.protocols=[]),r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Gs.util.toJSONOptions)},t}();yS.exports=fa});var xS=x((GU,ES)=>{"use strict";var mS=Ne(),wt=Object.assign(mS("libp2p:persistent-peer-store"),{error:mS("libp2p:persistent-peer-store:err")}),{Key:hu}=(_0(),A0),{Multiaddr:hD}=Tt(),$0=at(),{base32:pD}=(Zn(),Xn),yD=V0(),{NAMESPACE_ADDRESS:gD,NAMESPACE_COMMON:mD,NAMESPACE_KEYS:vD,NAMESPACE_METADATA:bD,NAMESPACE_PROTOCOL:wD}=fS(),{Addresses:vS}=hS(),{Protocols:bS}=gS(),wS=class extends yD{constructor({peerId:e,datastore:r,threshold:n=5}){super({peerId:e});this._datastore=r,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=n,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){wt("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:mD}))await this._processDatastoreEntry(e);wt("PeerStore started")}async stop(){wt("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),wt("PeerStore stopped")}_addDirtyPeer({peerId:e}){let r=e.toB58String();wt("add dirty peer",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(n=>{wt.error("error committing data",n)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let r=e.toB58String();wt("add dirty peer key",r),this._dirtyPeers.add(r),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(n=>{wt.error("error committing data",n)})}_addDirtyPeerMetadata({peerId:e,metadata:r}){let n=e.toB58String();wt("add dirty metadata peer",n),this._dirtyPeers.add(n);let i=this._dirtyMetadata.get(n)||new Set;i.add(r),this._dirtyMetadata.set(n,i),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{wt.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),wt("create batch commit");let r=this._datastore.batch();for(let n of e){let i=this.keyBook.data.get(n)||$0.createFromB58String(n);this._batchAddressBook(i,r),!i.hasInlinePublicKey()&&this._batchKeyBook(i,r),this._batchMetadataBook(i,r),this._batchProtoBook(i,r)}await r.commit(),wt("batch committed")}_batchAddressBook(e,r){let n=e.toString(),i=new hu(`${gD}${n}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){r.delete(i);return}let o=vS.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();r.put(i,o)}catch(o){wt.error(o)}}_batchKeyBook(e,r){let n=e.toString(),i=new hu(`${vD}${n}`);try{if(!e.pubKey){r.delete(i);return}let s=e.marshalPubKey();r.put(i,s)}catch(s){wt.error(s)}}_batchMetadataBook(e,r){let n=e.toString(),i=this._dirtyMetadata.get(e.toB58String())||[];try{i.forEach(s=>{let o=new hu(`${bD}${n}/${s}`),a=this.metadataBook.getValue(e,s);a?r.put(o,a):r.delete(o)})}catch(s){wt.error(s)}}_batchProtoBook(e,r){let n=e.toString(),i=new hu(`${wD}${n}`),s=this.protoBook.get(e);try{if(!s){r.delete(i);return}let o=bS.encode({protocols:s}).finish();r.put(i,o)}catch(o){wt.error(o)}}async _processDatastoreEntry({key:e,value:r}){try{let n=e.toString().split("/"),i=$0.createFromBytes(pD.decode(n[3])),s;switch(n[2]){case"addrs":s=vS.decode(r),this.addressBook._setData(i,{addresses:s.addrs.map(o=>({multiaddr:new hD(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await $0.createFromPubKey(r),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(i,n[4],r,{emit:!1});break;case"protos":s=bS.decode(r),this.protoBook._setData(i,new Set(s.protocols),{emit:!1});break;default:wt("invalid data persisted for: ",e.toString())}}catch(n){wt.error(n)}}};ES.exports=wS});var IS=x((WU,CS)=>{"use strict";var SS=()=>{},AS=Symbol.for("@libp2p/js-interfaces/topology"),_S=class{constructor({min:e=0,max:r=1/0,handlers:n={}}){this.min=e,this.max=r,this._onConnect=n.onConnect||SS,this._onDisconnect=n.onDisconnect||SS,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[AS](){return!0}static isTopology(e){return Boolean(e&&e[AS])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};CS.exports=_S});var PS=x((YU,BS)=>{"use strict";var TS=Ne(),ED=Object.assign(TS("libp2p:registrar"),{error:TS("libp2p:registrar:err")}),xD=he(),{codes:{ERR_INVALID_PARAMETERS:SD}}=ot(),AD=IS(),RS=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!AD.isTopology(e))throw ED.error("topology must be an instance of interfaces/topology"),xD(new Error("topology must be an instance of interfaces/topology"),SD);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),e.registrar=this,r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};BS.exports=RS});var H0=x((QU,da)=>{"use strict";var{Buffer:pu}=jn(),yu=Si();da.exports=async function*(t){for await(let e of t)pu.isBuffer(e)?yield e:yu.isBufferList(e)?yield e.slice():yield pu.from(e)};da.exports.toBuffer=da.exports;da.exports.toList=async function*(t){for await(let e of t)pu.isBuffer(e)?yield new yu().append(e):yu.isBufferList(e)?yield e:yield new yu().append(pu.from(e))}});var OS=x((XU,NS)=>{"use strict";NS.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var qS=x((gu,LS)=>{"use strict";var DS=Ne(),_D=Object.assign(DS("libp2p:ping"),{error:DS("libp2p:ping:err")}),CD=he(),ID=S0(),{pipe:kS}=Kr(),{toBuffer:TD}=H0(),{collect:RD,take:BD}=ou(),{equals:PD}=(Dr(),Or),{PROTOCOL_NAME:z0,PING_LENGTH:ND,PROTOCOL_VERSION:G0}=OS();async function OD(t,e){let r=`/${t._config.protocolPrefix}/${z0}/${G0}`;_D("dialing %s to %s",r,e.toB58String?e.toB58String():e);let n=await t.dial(e),{stream:i}=await n.newStream(r),s=Date.now(),o=ID.randomBytes(ND),[a]=await kS([o],i,u=>BD(1,u),TD,RD),c=Date.now();if(!PD(o,a))throw CD(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return c-s}function DD(t){t.handle(`/${t._config.protocolPrefix}/${z0}/${G0}`,({stream:e})=>kS(e,e))}function kD(t){t.unhandle(`/${t._config.protocolPrefix}/${z0}/${G0}`)}gu=LS.exports=OD;gu.mount=DD;gu.unmount=kD});var FS=x((ZU,MS)=>{"use strict";var Ws=Qr(),US=Ws.Reader,LD=Ws.Writer,Qe=Ws.util,ha=Ws.roots["libp2p-identify"]||(Ws.roots["libp2p-identify"]={});ha.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=Qe.newBuffer([]),t.prototype.listenAddrs=Qe.emptyArray,t.prototype.observedAddr=Qe.newBuffer([]),t.prototype.protocols=Qe.emptyArray,t.prototype.signedPeerRecord=Qe.newBuffer([]),t.encode=function(r,n){if(n||(n=LD.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var i=0;i<r.listenAddrs.length;++i)n.uint32(18).bytes(r.listenAddrs[i]);if(r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(26).string(r.protocols[i]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&n.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&n.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&n.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&n.uint32(66).bytes(r.signedPeerRecord),n},t.decode=function(r,n){r instanceof US||(r=US.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ha.Identify;r.pos<i;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof ha.Identify)return r;var n=new ha.Identify;if(r.protocolVersion!=null&&(n.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(n.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?Qe.base64.decode(r.publicKey,n.publicKey=Qe.newBuffer(Qe.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");n.listenAddrs=[];for(var i=0;i<r.listenAddrs.length;++i)typeof r.listenAddrs[i]=="string"?Qe.base64.decode(r.listenAddrs[i],n.listenAddrs[i]=Qe.newBuffer(Qe.base64.length(r.listenAddrs[i])),0):r.listenAddrs[i].length&&(n.listenAddrs[i]=r.listenAddrs[i])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?Qe.base64.decode(r.observedAddr,n.observedAddr=Qe.newBuffer(Qe.base64.length(r.observedAddr)),0):r.observedAddr.length&&(n.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?Qe.base64.decode(r.signedPeerRecord,n.signedPeerRecord=Qe.newBuffer(Qe.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(n.signedPeerRecord=r.signedPeerRecord)),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.listenAddrs=[],i.protocols=[]),n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=Qe.newBuffer(i.publicKey))),n.bytes===String?i.observedAddr="":(i.observedAddr=[],n.bytes!==Array&&(i.observedAddr=Qe.newBuffer(i.observedAddr))),i.protocolVersion="",i.agentVersion="",n.bytes===String?i.signedPeerRecord="":(i.signedPeerRecord=[],n.bytes!==Array&&(i.signedPeerRecord=Qe.newBuffer(i.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?Qe.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){i.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)i.listenAddrs[s]=n.bytes===String?Qe.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):n.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(i.observedAddr=n.bytes===String?Qe.base64.encode(r.observedAddr,0,r.observedAddr.length):n.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(i.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(i.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(i.signedPeerRecord=n.bytes===String?Qe.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):n.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ws.util.toJSONOptions)},t}();MS.exports=ha});var YS=x((JU,WS)=>{"use strict";var KS=Ne(),zr=Object.assign(KS("libp2p:identify"),{error:KS("libp2p:identify:err")}),W0=he(),mu=ta(),{pipe:vu}=Kr(),{collect:VS,take:jS,consume:$S}=ou(),{fromString:Ys}=(Et(),At),qD=at(),{Multiaddr:Y0}=Tt(),{toBuffer:HS}=H0(),pa=FS(),zS=kc(),GS=qc(),{MULTICODEC_IDENTIFY:UD,MULTICODEC_IDENTIFY_PUSH:MD,IDENTIFY_PROTOCOL_VERSION:FD,MULTICODEC_IDENTIFY_PROTOCOL_NAME:KD,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:VD,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:jD,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:$D}=wf(),{codes:Q0}=ot(),Ni=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${KD}/${jD}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${VD}/${$D}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=Ni.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${FD}`,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",Ys(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",Ys(this._host.protocolVersion)),this.connectionManager.on("peer:connect",n=>{this.identify(n).catch(zr.error)}),this.peerStore.on("change:multiaddrs",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),n=this._libp2p.multiaddrs.map(o=>o.bytes),i=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await vu([pa.Identify.encode({listenAddrs:n,signedPeerRecord:r,protocols:i}).finish()],mu.encode(),a,$S)}catch(a){zr.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for(let n of this.peerStore.peers.values())n.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(n.id))&&e.push(r);this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[n]=await vu([],r,mu.decode(),jS(1),HS,VS);if(!n)throw W0(new Error("No data could be retrieved"),Q0.ERR_CONNECTION_ENDED);let i;try{i=pa.Identify.decode(n)}catch(d){throw W0(d,Q0.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=i,l=await qD.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw W0(new Error("identified peer does not match the expected peer"),Q0.ERR_INVALID_PEER);let f=Ni.getCleanMultiaddr(c);try{let d=await zS.openAndCertify(u,GS.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(d)){this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",Ys(i.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",Ys(i.protocolVersion));return}}catch(d){zr("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{this.peerStore.addressBook.set(l,o.map(d=>new Y0(d)))}catch(d){zr.error("received invalid addrs",d)}this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",Ys(i.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",Ys(i.protocolVersion)),zr("received observed address of %s",f)}handleMessage({connection:e,stream:r,protocol:n}){switch(n){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:zr.error("cannot handle unknown protocol %s",n)}}async _handleIdentify({connection:e,stream:r}){let n=new Uint8Array(0);this.peerId.pubKey&&(n=this.peerId.pubKey.bytes);let i=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=pa.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:n,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:i,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await vu([o],mu.encode(),r,$S)}catch(a){zr.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:r}){let n;try{let[s]=await vu([],r,mu.decode(),jS(1),HS,VS);n=pa.Identify.decode(s)}catch(s){return zr.error("received invalid message",s)}let i=e.remotePeer;try{let s=await zS.openAndCertify(n.signedPeerRecord,GS.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(i,n.protocols);return}}catch(s){zr("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(i,n.listenAddrs.map(s=>new Y0(s)))}catch(s){zr.error("received invalid addrs",s)}this.peerStore.protoBook.set(i,n.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new Y0(e)}catch(r){return null}return null}},HD={IDENTIFY:UD,IDENTIFY_PUSH:MD};Ni.multicodecs=HD;Ni.Messsage=pa;WS.exports=Ni});var QS=x(()=>{});var XS=x(X0=>{"use strict";Object.defineProperty(X0,"__esModule",{value:!0}),X0.promisify=bu;var zD="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function bu(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[zD],r=bu.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var n=this,i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(u){if(u)return c(u);for(var l=arguments.length,f=Array(1<l?l-1:0),d=1;d<l;d++)f[d-1]=arguments[d];if(f.length===1||!e)return a(f[0]);var p={};f.forEach(function(h,g){var v=e[g];v&&(p[v]=h)}),a(p)}),t.apply(n,s)})}}bu.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",bu.Promise=void 0});var JS=x((nM,ZS)=>{function GD(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}ZS.exports=GD});var tA=x((iM,eA)=>{"use strict";var WD=JS(),wu=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,ya=WD(),YD=wu&&!ya,QD=ya&&!wu,XD=ya&&wu,ZD=typeof Di=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!ya,JD=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,e6=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;eA.exports={isTest:e6,isElectron:ya,isElectronMain:QD,isElectronRenderer:XD,isNode:ZD,isBrowser:YD,isWebWorker:JD,isEnvWithDom:wu}});var nA=x((sM,rA)=>{function dr(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}rA.exports=dr;dr.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};dr.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};dr.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};dr.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};dr.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};dr.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};dr.prototype.start=dr.prototype.try;dr.prototype.errors=function(){return this._errors};dr.prototype.attempts=function(){return this._attempts};dr.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],s=i.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=i,r=o)}return e}});var iA=x(Oi=>{var t6=nA();Oi.operation=function(t){var e=Oi.timeouts(t);return new t6(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};Oi.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<e.retries;i++)n.push(this.createTimeout(i,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(i,e)),n.sort(function(s,o){return s-o}),n};Oi.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return n=Math.min(n,e.maxTimeout),n};Oi.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var n in t)typeof t[n]=="function"&&r.push(n)}for(var i=0;i<r.length;i++){var s=r[i],o=t[s];t[s]=function(c){var u=Oi.operation(e),l=Array.prototype.slice.call(arguments,1),f=l.pop();l.push(function(d){u.retry(d)||(d&&(arguments[0]=u.mainError()),f.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,o),t[s].options=e}}});var oA=x((aM,sA)=>{sA.exports=iA()});var cA=x((cM,Eu)=>{"use strict";var r6=oA(),n6=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],Z0=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},i6=(t,e,r)=>{let n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},s6=t=>n6.includes(t),aA=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};let i=r6.operation(e);i.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){n(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof Z0)i.stop(),n(o.originalError);else if(o instanceof TypeError&&!s6(o.message))i.stop(),n(o);else{i6(o,s,e);try{await e.onFailedAttempt(o)}catch(a){n(a);return}i.retry(o)||n(i.mainError())}}})});Eu.exports=aA;Eu.exports.default=aA;Eu.exports.AbortError=Z0});var lA=x((uM,uA)=>{"use strict";function o6(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}uA.exports=o6});var dA=x((lM,fA)=>{"use strict";var a6=lA();function c6(t){let{address:e}=t.nodeAddress();return a6(e)}fA.exports=c6});var vA=x((fM,mA)=>{"use strict";var u6=QS(),hA=Ne(),{promisify:J0}=XS(),{Multiaddr:l6}=Tt(),Qs=Object.assign(hA("libp2p:nat"),{error:hA("libp2p:nat:err")}),{isBrowser:pA}=tA(),ed=cA(),f6=Ef(),yA=bf(),d6=he(),{codes:{ERR_INVALID_PARAMETERS:h6}}=ot(),p6=dA(),td=7200;function y6(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var gA=class{constructor({peerId:e,addressManager:r,transportManager:n,...i}){if(this._peerId=e,this._addressManager=r,this._transportManager=n,this._enabled=i.enabled,this._externalIp=i.externalIp,this._options={description:i.description||`${yA.name}@${yA.version} ${this._peerId}`,ttl:i.ttl||td,autoUpdate:i.keepAlive||!0,gateway:i.gateway,enablePMP:Boolean(i.pmp&&i.pmp.enabled)},this._options.ttl<td)throw d6(new Error(`NatManager ttl should be at least ${td} seconds`),h6)}start(){pA||!this._enabled||this._start().catch(e=>{Qs.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:n,host:i,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||p6(r)||n!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(f6(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=y6();Qs(`opening uPnP connection from ${c}:${u} to ${i}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(l6.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new u6(this._options),r=J0(e.map.bind(e)),n=J0(e.destroy.bind(e)),i=J0(e.externalIp.bind(e));return this._client={map:(...s)=>ed(()=>r(...s),{onFailedAttempt:Qs.error,unref:!0}),destroy:(...s)=>ed(()=>n(...s),{onFailedAttempt:Qs.error,unref:!0}),externalIp:(...s)=>ed(()=>i(...s),{onFailedAttempt:Qs.error,unref:!0})},this._client}async stop(){if(!(pA||!this._client))try{await this._client.destroy(),this._client=null}catch(e){Qs.error(e)}}};mA.exports=gA});var q6=x((dM,SA)=>{"use strict";var bA=Ne(),Yt=Object.assign(bA("libp2p"),{error:bA("libp2p:err")}),{EventEmitter:g6}=Wr(),rd=he(),m6=at(),{Multiaddr:v6}=Tt(),b6=h1(),w6=b1(),nd=gf(),{validate:E6}=Lv(),{codes:xu,messages:x6}=ot(),S6=Mv(),A6=rb(),_6=ab(),wA=Gw(),C6=oE(),I6=UE(),EA=F2(),T6=nx(),R6=Bf(),B6=kx(),P6=V0(),N6=lS(),O6=xS(),D6=PS(),Su=qS(),xA=YS(),k6=vA(),{updateSelfPeerRecord:L6}=Tf(),ga=class extends g6{static async create(e){if(e.peerId)return new ga(e);let r=await m6.create();return e.peerId=r,new ga(e)}constructor(e){super();if(this._options=E6(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new O6({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new P6({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new S6(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{L6(this).catch(n=>{Yt.error("Error updating self peer record",n)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new A6(this,{...this._options.connectionManager}),this._autodialler=new _6(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.metrics.enabled&&(this.metrics=new T6({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){Yt("creating keychain");let n=EA.generateOptions();this.keychain=new EA(this._options.keychain.datastore,{...n,...this._options.keychain}),Yt("keychain constructed")}if(this.upgrader=new B6({localPeer:this.peerId,metrics:this.metrics,onConnection:n=>this.connectionManager.onConnect(n),onConnectionEnd:n=>this.connectionManager.onDisconnect(n)}),this.transportManager=new R6({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new k6({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new D6({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw rd(new Error(x6.CONN_ENCRYPTION_REQUIRED),xu.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(n=>{this.upgrader.cryptos.set(n.protocol,n)}),this.dialer=new I6({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(n=>{let i=n.prototype[Symbol.toStringTag],s=this._config.transport[i];this.transportManager.add(i,n,s)}),this._config.relay.enabled&&(this.transportManager.add(wA.prototype[Symbol.toStringTag],wA),this.relay=new C6(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(i=>{this.upgrader.muxers.set(i.multicodec,i)}),this.identifyService=new xA({libp2p:this}),this.handle(Object.values(xA.getProtocolStr(this)),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let n=this._modules.dht;this._dht=n.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let n=this._modules.pubsub;this.pubsub=N6(n,this,this._config.pubsub)}this.peerRouting=new b6(this),this.contentRouting=new w6(this),Su.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...r){return e==="error"&&!this._events.error?(Yt.error(r),!1):super.emit(e,...r)}async start(){Yt("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),Yt("libp2p has started")}catch(e){throw this.emit("error",e),Yt.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Yt("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop(),this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),Su.unmount(this),this.dialer.destroy()}catch(e){e&&(Yt.error(e),this.emit("error",e))}Yt("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,n){if(!r||!r.length)throw rd(new Error("no protocols were provided to open a stream"),xu.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,n)).newStream(r)}async _dial(e,r){let{id:n,multiaddrs:i}=nd(e);if(n.equals(this.peerId))throw rd(new Error("Cannot dial self"),xu.ERR_DIALED_SELF);let s=this.connectionManager.get(n);return s?i&&this.peerStore.addressBook.add(n,i):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(i=>i.toString());e.length||(e=this.transportManager.getAddrs().map(i=>i.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(i=>i.toString()));let r=this._options.addresses.announceFilter,n=new Set(e);return r(Array.from(n).map(i=>new v6(i)))}async hangUp(e){let{id:r}=nd(e),n=this.connectionManager.connections.get(r.toB58String());!n||await Promise.all(n.map(i=>i.close()))}ping(e){let{id:r,multiaddrs:n}=nd(e);return n?Su(this,n[0]):Su(this,r)}handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(n=>{this.upgrader.protocols.set(n,r)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Yt.error(new Error(xu.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Yt("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(n){Yt.error(`could not connect to discovered peer ${e.toB58String()} with ${n}`)}}}async _setupPeerDiscovery(){let e=r=>{let n={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(n={...n,...this._config.peerDiscovery[r.tag]}),n.enabled&&!this._discovery.has(r.tag)){let i;typeof r=="function"?i=new r(Object.assign({},n,{peerId:this.peerId,libp2p:this})):i=r,i.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,i)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};SA.exports=ga});return q6();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) Paul Miller (paulmillr.com) */
return Libp2p}));
