(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2p = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Libp2p=(()=>{var sI=Object.create;var Ya=Object.defineProperty;var oI=Object.getOwnPropertyDescriptor;var aI=Object.getOwnPropertyNames;var cI=Object.getPrototypeOf,uI=Object.prototype.hasOwnProperty;var f0=t=>Ya(t,"__esModule",{value:!0});var d0=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var Te=(t,e)=>()=>(t&&(e=t(t=0)),e);var b=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),_t=(t,e)=>{f0(t);for(var r in e)Ya(t,r,{get:e[r],enumerable:!0})},lI=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of aI(e))!uI.call(t,n)&&n!=="default"&&Ya(t,n,{get:()=>e[n],enumerable:!(r=oI(e,n))||r.enumerable});return t},Lo=t=>lI(f0(Ya(t!=null?sI(cI(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var dl=b((pq,h0)=>{var ys=1e3,gs=ys*60,ms=gs*60,xi=ms*24,fI=xi*7,dI=xi*365.25;h0.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return hI(t);if(r==="number"&&isFinite(t))return e.long?yI(t):pI(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function hI(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*dI;case"weeks":case"week":case"w":return r*fI;case"days":case"day":case"d":return r*xi;case"hours":case"hour":case"hrs":case"hr":case"h":return r*ms;case"minutes":case"minute":case"mins":case"min":case"m":return r*gs;case"seconds":case"second":case"secs":case"sec":case"s":return r*ys;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function pI(t){var e=Math.abs(t);return e>=xi?Math.round(t/xi)+"d":e>=ms?Math.round(t/ms)+"h":e>=gs?Math.round(t/gs)+"m":e>=ys?Math.round(t/ys)+"s":t+"ms"}function yI(t){var e=Math.abs(t);return e>=xi?Qa(t,e,xi,"day"):e>=ms?Qa(t,e,ms,"hour"):e>=gs?Qa(t,e,gs,"minute"):e>=ys?Qa(t,e,ys,"second"):t+" ms"}function Qa(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var y0=b((yq,p0)=>{function gI(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=dl(),r.destroy=u,Object.keys(t).forEach(l=>{r[l]=t[l]}),r.names=[],r.skips=[],r.formatters={};function e(l){let f=0;for(let d=0;d<l.length;d++)f=(f<<5)-f+l.charCodeAt(d),f|=0;return r.colors[Math.abs(f)%r.colors.length]}r.selectColor=e;function r(l){let f,d=null,p,h;function g(...v){if(!g.enabled)return;let w=g,C=Number(new Date),q=C-(f||C);w.diff=q,w.prev=f,w.curr=C,f=C,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let W=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(M,re)=>{if(M==="%%")return"%";W++;let ie=r.formatters[re];if(typeof ie=="function"){let z=v[W];M=ie.call(w,z),v.splice(W,1),W--}return M}),r.formatArgs.call(w,v),(w.log||r.log).apply(w,v)}return g.namespace=l,g.useColors=r.useColors(),g.color=r.selectColor(l),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(p!==r.namespaces&&(p=r.namespaces,h=r.enabled(l)),h),set:v=>{d=v}}),typeof r.init=="function"&&r.init(g),g}function n(l,f){let d=r(this.namespace+(typeof f=="undefined"?":":f)+l);return d.log=this.log,d}function i(l){r.save(l),r.namespaces=l,r.names=[],r.skips=[];let f,d=(typeof l=="string"?l:"").split(/[\s,]+/),p=d.length;for(f=0;f<p;f++)!d[f]||(l=d[f].replace(/\*/g,".*?"),l[0]==="-"?r.skips.push(new RegExp("^"+l.slice(1)+"$")):r.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...r.names.map(a),...r.skips.map(a).map(f=>"-"+f)].join(",");return r.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let f,d;for(f=0,d=r.skips.length;f<d;f++)if(r.skips[f].test(l))return!1;for(f=0,d=r.names.length;f<d;f++)if(r.names[f].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}p0.exports=gI});var Oe=b((ur,Xa)=>{ur.formatArgs=vI;ur.save=EI;ur.load=bI;ur.useColors=mI;ur.storage=wI();ur.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();ur.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function mI(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function vI(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Xa.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}ur.log=console.debug||console.log||(()=>{});function EI(t){try{t?ur.storage.setItem("debug",t):ur.storage.removeItem("debug")}catch(e){}}function bI(){let t;try{t=ur.storage.getItem("debug")}catch(e){}return!t&&typeof process!="undefined"&&"env"in process&&(t=process.env.DEBUG),t}function wI(){try{return localStorage}catch(t){}}Xa.exports=y0()(ur);var{formatters:_I}=Xa.exports;_I.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var rr=b((gq,hl)=>{"use strict";var vs=typeof Reflect=="object"?Reflect:null,g0=vs&&typeof vs.apply=="function"?vs.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Za;vs&&typeof vs.ownKeys=="function"?Za=vs.ownKeys:Object.getOwnPropertySymbols?Za=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Za=function(e){return Object.getOwnPropertyNames(e)};function SI(t){console&&console.warn&&console.warn(t)}var m0=Number.isNaN||function(e){return e!==e};function ze(){ze.init.call(this)}hl.exports=ze;hl.exports.once=II;ze.EventEmitter=ze;ze.prototype._events=void 0;ze.prototype._eventsCount=0;ze.prototype._maxListeners=void 0;var v0=10;function Ja(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ze,"defaultMaxListeners",{enumerable:!0,get:function(){return v0},set:function(t){if(typeof t!="number"||t<0||m0(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");v0=t}});ze.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ze.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||m0(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function E0(t){return t._maxListeners===void 0?ze.defaultMaxListeners:t._maxListeners}ze.prototype.getMaxListeners=function(){return E0(this)};ze.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")g0(c,this,r);else for(var u=c.length,l=x0(c,u),n=0;n<u;++n)g0(l[n],this,r);return!0};function b0(t,e,r,n){var i,s,o;if(Ja(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=E0(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,SI(a)}return t}ze.prototype.addListener=function(e,r){return b0(this,e,r,!1)};ze.prototype.on=ze.prototype.addListener;ze.prototype.prependListener=function(e,r){return b0(this,e,r,!0)};function xI(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w0(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=xI.bind(n);return i.listener=r,n.wrapFn=i,i}ze.prototype.once=function(e,r){return Ja(r),this.on(e,w0(this,e,r)),this};ze.prototype.prependOnceListener=function(e,r){return Ja(r),this.prependListener(e,w0(this,e,r)),this};ze.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Ja(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():AI(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};ze.prototype.off=ze.prototype.removeListener;ze.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function _0(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?CI(i):x0(i,i.length)}ze.prototype.listeners=function(e){return _0(this,e,!0)};ze.prototype.rawListeners=function(e){return _0(this,e,!1)};ze.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):S0.call(t,e)};ze.prototype.listenerCount=S0;function S0(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ze.prototype.eventNames=function(){return this._eventsCount>0?Za(this._events):[]};function x0(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function AI(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function CI(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function II(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}A0(t,e,s,{once:!0}),e!=="error"&&TI(t,i,{once:!0})})}function TI(t,e,r){typeof t.on=="function"&&A0(t,"error",e,r)}function A0(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var ge=b((mq,I0)=>{"use strict";function C0(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function RI(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return C0(t,r)}catch(n){r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),C0(new i,r)}}I0.exports=RI});function R0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=OI;)e[r++]=t&255|T0,t/=128;for(;t&NI;)e[r++]=t&255|T0,t>>>=7;return e[r]=t|0,R0.bytes=r-n+1,e}function pl(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o)throw pl.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&B0)<<n:(s&B0)*Math.pow(2,n),n+=7}while(s>=LI);return pl.bytes=i-e,r}var BI,T0,PI,NI,OI,DI,LI,B0,kI,qI,UI,MI,FI,KI,VI,jI,$I,HI,zI,GI,ko,P0=Te(()=>{BI=R0,T0=128,PI=127,NI=~PI,OI=Math.pow(2,31);DI=pl,LI=128,B0=127;kI=Math.pow(2,7),qI=Math.pow(2,14),UI=Math.pow(2,21),MI=Math.pow(2,28),FI=Math.pow(2,35),KI=Math.pow(2,42),VI=Math.pow(2,49),jI=Math.pow(2,56),$I=Math.pow(2,63),HI=function(t){return t<kI?1:t<qI?2:t<UI?3:t<MI?4:t<FI?5:t<KI?6:t<VI?7:t<jI?8:t<$I?9:10},zI={encode:BI,decode:DI,encodingLength:HI},GI=zI,ko=GI});var qo,Es,bs,ec=Te(()=>{P0();qo=t=>[ko.decode(t),ko.decode.bytes],Es=(t,e,r=0)=>(ko.encode(t,e,r),e),bs=t=>ko.encodingLength(t)});var bq,O0,_n,D0,L0,Un=Te(()=>{bq=new Uint8Array(0),O0=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},_n=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},D0=t=>new TextEncoder().encode(t),L0=t=>new TextDecoder().decode(t)});var Uo={};_t(Uo,{Digest:()=>ws,create:()=>Mn,decode:()=>yl,equals:()=>gl});var Mn,yl,gl,ws,Ai=Te(()=>{Un();ec();Mn=(t,e)=>{let r=e.byteLength,n=bs(t),i=n+bs(r),s=new Uint8Array(i+r);return Es(t,s,0),Es(r,s,n),s.set(e,i),new ws(t,r,e,s)},yl=t=>{let e=_n(t),[r,n]=qo(e),[i,s]=qo(e.subarray(n)),o=e.subarray(n+s);if(o.byteLength!==i)throw new Error("Incorrect length");return new ws(r,i,o,e)},gl=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&O0(t.bytes,e.bytes),ws=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});function WI(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function f(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var g=0,v=0,w=0,C=h.length;w!==C&&h[w]===0;)w++,g++;for(var q=(C-w)*l+1>>>0,W=new Uint8Array(q);w!==C;){for(var F=h[w],M=0,re=q-1;(F!==0||M<v)&&re!==-1;re--,M++)F+=256*W[re]>>>0,W[re]=F%a>>>0,F=F/a>>>0;if(F!==0)throw new Error("Non-zero carry");v=M,w++}for(var ie=q-v;ie!==q&&W[ie]===0;)ie++;for(var z=c.repeat(g);ie<q;++ie)z+=t.charAt(W[ie]);return z}function d(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var g=0;if(h[g]!==" "){for(var v=0,w=0;h[g]===c;)v++,g++;for(var C=(h.length-g)*u+1>>>0,q=new Uint8Array(C);h[g];){var W=r[h.charCodeAt(g)];if(W===255)return;for(var F=0,M=C-1;(W!==0||F<w)&&M!==-1;M--,F++)W+=a*q[M]>>>0,q[M]=W%256>>>0,W=W/256>>>0;if(W!==0)throw new Error("Non-zero carry");w=F,g++}if(h[g]!==" "){for(var re=C-w;re!==C&&q[re]===0;)re++;for(var ie=new Uint8Array(v+(C-re)),z=v;re!==C;)ie[z++]=q[re++];return ie}}}function p(h){var g=d(h);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:d,decode:p}}var YI,QI,q0,U0=Te(()=>{YI=WI,QI=YI,q0=QI});var M0,F0,K0,V0,j0,tc,Fn,XI,ZI,pt,Xr=Te(()=>{U0();Un();M0=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},F0=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return V0(this,e)}},K0=class{constructor(e){this.decoders=e}or(e){return V0(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},V0=(t,e)=>new K0({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),j0=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new M0(e,r,n),this.decoder=new F0(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},tc=({name:t,prefix:e,encode:r,decode:n})=>new j0(t,e,r,n),Fn=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=q0(r,e);return tc({prefix:t,name:e,encode:n,decode:s=>_n(i(s))})},XI=(t,e,r,n)=>{let i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;let o=new Uint8Array(s*r/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let f=i[t[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|f,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},ZI=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},pt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>tc({prefix:e,name:t,encode(i){return ZI(i,n,r)},decode(i){return XI(i,n,r,t)}})});var Kn={};_t(Kn,{base58btc:()=>Zr,base58flickr:()=>JI});var Zr,JI,Vn=Te(()=>{Xr();Zr=Fn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),JI=Fn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Ci={};_t(Ci,{base32:()=>_s,base32hex:()=>nT,base32hexpad:()=>sT,base32hexpadupper:()=>oT,base32hexupper:()=>iT,base32pad:()=>tT,base32padupper:()=>rT,base32upper:()=>eT,base32z:()=>aT});var _s,eT,tT,rT,nT,iT,sT,oT,aT,Ii=Te(()=>{Xr();_s=pt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),eT=pt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),tT=pt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rT=pt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nT=pt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),iT=pt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sT=pt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oT=pt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),aT=pt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var Fo={};_t(Fo,{CID:()=>At});var At,cT,uT,lT,Mo,fT,$0,H0,rc,nc,dT,hT,pT,Ss=Te(()=>{ec();Ai();Vn();Ii();Un();At=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:nc,byteLength:nc,code:rc,version:rc,multihash:rc,bytes:rc,_baseCache:nc,asCID:nc})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Mo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==fT)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return At.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Mn(e,r);return At.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&gl(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return uT(r,i,e||Zr.encoder);default:return lT(r,i,e||_s.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return hT(/^0\.0/,pT),!!(e&&(e[H0]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof At)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:s}=e;return new At(r,n,i,s||$0(r,n,i.bytes))}else if(e!=null&&e[H0]===!0){let{version:r,multihash:n,code:i}=e,s=yl(n);return At.create(r,i,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Mo)throw new Error(`Version 0 CID must use dag-pb (code: ${Mo}) block encoding`);return new At(e,r,n,n.bytes)}case 1:{let i=$0(e,r,n.bytes);return new At(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return At.create(0,Mo,e)}static createV1(e,r){return At.create(1,e,r)}static decode(e){let[r,n]=At.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=At.inspectBytes(e),n=r.size-r.multihashSize,i=_n(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),o=new ws(r.multihashCode,r.digestSize,s,i);return[r.version===0?At.createV0(o):At.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[f,d]=qo(e.subarray(r));return r+=d,f},i=n(),s=Mo;if(i===18?(i=0,r=0):i===1&&(s=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,a=n(),c=n(),u=r+c,l=u-o;return{version:i,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,r){let[n,i]=cT(e,r),s=At.decode(i);return s._baseCache.set(n,e),s}},cT=(t,e)=>{switch(t[0]){case"Q":{let r=e||Zr;return[Zr.prefix,r.decode(`${Zr.prefix}${t}`)]}case Zr.prefix:{let r=e||Zr;return[Zr.prefix,r.decode(t)]}case _s.prefix:{let r=e||_s;return[_s.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},uT=(t,e,r)=>{let{prefix:n}=r;if(n!==Zr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let s=r.encode(t).slice(1);return e.set(n,s),s}else return i},lT=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let s=r.encode(t);return e.set(n,s),s}else return i},Mo=112,fT=18,$0=(t,e,r)=>{let n=bs(t),i=n+bs(e),s=new Uint8Array(i+r.byteLength);return Es(t,s,0),Es(e,s,n),s.set(r,i),s},H0=Symbol.for("@ipld/js-cid/CID"),rc={writable:!1,configurable:!1,enumerable:!0},nc={writable:!1,enumerable:!1,configurable:!1},dT="0.0.0-dev",hT=(t,e)=>{if(t.test(dT))console.warn(e);else throw new Error(e)},pT=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var ic={};_t(ic,{base36:()=>yT,base36upper:()=>gT});var yT,gT,ml=Te(()=>{Xr();yT=Fn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),gT=Fn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var xs={};_t(xs,{base64:()=>mT,base64pad:()=>vT,base64url:()=>ET,base64urlpad:()=>bT});var mT,vT,ET,bT,Ko=Te(()=>{Xr();mT=pt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),vT=pt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ET=pt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),bT=pt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var sc={};_t(sc,{base16:()=>wT,base16upper:()=>_T});var wT,_T,vl=Te(()=>{Xr();wT=pt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_T=pt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var G0=b((qq,z0)=>{"use strict";z0.exports=ST;function ST(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,c){r[n]=function(l){if(s)if(s=!1,l)c(l);else{for(var f=new Array(arguments.length-1),d=0;d<f.length;)f[d++]=arguments[d];a.apply(null,f)}};try{t.apply(e||null,r)}catch(u){s&&(s=!1,c(u))}})}});var X0=b(Q0=>{"use strict";var oc=Q0;oc.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var As=new Array(64),W0=new Array(123);for(Ur=0;Ur<64;)W0[As[Ur]=Ur<26?Ur+65:Ur<52?Ur+71:Ur<62?Ur-4:Ur-59|43]=Ur++;var Ur;oc.encode=function(e,r,n){for(var i=null,s=[],o=0,a=0,c;r<n;){var u=e[r++];switch(a){case 0:s[o++]=As[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=As[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=As[c|u>>6],s[o++]=As[u&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=As[c],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Y0="invalid encoding";oc.decode=function(e,r,n){for(var i=n,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=W0[c])===void 0)throw Error(Y0);switch(s){case 0:o=c,s=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:r[n++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(Y0);return n-i};oc.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var J0=b((Mq,Z0)=>{"use strict";Z0.exports=ac;function ac(){this._listeners={}}ac.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};ac.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};ac.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var op=b((Fq,sp)=>{"use strict";sp.exports=ep(ep);function ep(t){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3]}function s(c,u,l){e[0]=c,u[l]=r[3],u[l+1]=r[2],u[l+2]=r[1],u[l+3]=r[0]}t.writeFloatLE=n?i:s,t.writeFloatBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],e[0]}function a(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,s,o);else if(isNaN(i))n(2143289344,s,o);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|u)>>>0,s,o)}}t.writeFloatLE=e.bind(null,tp),t.writeFloatBE=e.bind(null,rp);function r(n,i,s){var o=n(i,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}t.readFloatLE=r.bind(null,np),t.readFloatBE=r.bind(null,ip)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(c,u,l){e[0]=c,u[l]=r[0],u[l+1]=r[1],u[l+2]=r[2],u[l+3]=r[3],u[l+4]=r[4],u[l+5]=r[5],u[l+6]=r[6],u[l+7]=r[7]}function s(c,u,l){e[0]=c,u[l]=r[7],u[l+1]=r[6],u[l+2]=r[5],u[l+3]=r[4],u[l+4]=r[3],u[l+5]=r[2],u[l+6]=r[1],u[l+7]=r[0]}t.writeDoubleLE=n?i:s,t.writeDoubleBE=n?s:i;function o(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],e[0]}function a(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,i,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)n(0,a,c+i),n(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))n(0,a,c+i),n(2146959360,a,c+s);else if(o>17976931348623157e292)n(0,a,c+i),n((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,n(l>>>0,a,c+i),n((u<<31|l/4294967296)>>>0,a,c+s);else{var f=Math.floor(Math.log(o)/Math.LN2);f===1024&&(f=1023),l=o*Math.pow(2,-f),n(l*4503599627370496>>>0,a,c+i),n((u<<31|f+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}t.writeDoubleLE=e.bind(null,tp,0,4),t.writeDoubleBE=e.bind(null,rp,4,0);function r(n,i,s,o,a){var c=n(o,a+i),u=n(o,a+s),l=(u>>31)*2+1,f=u>>>20&2047,d=4294967296*(u&1048575)+c;return f===2047?d?NaN:l*(1/0):f===0?l*5e-324*d:l*Math.pow(2,f-1075)*(d+4503599627370496)}t.readDoubleLE=r.bind(null,np,0,4),t.readDoubleBE=r.bind(null,ip,4,0)}(),t}function tp(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function rp(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function np(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function ip(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var ap=b((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var up=b(cp=>{"use strict";var El=cp;El.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)==55296&&(e.charCodeAt(i+1)&64512)==56320?(++i,r+=4):r+=3;return r};El.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var s=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};El.write=function(e,r,n){for(var i=n,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var fp=b((Vq,lp)=>{"use strict";lp.exports=xT;function xT(t,e,r){var n=r||8192,i=n>>>1,s=null,o=n;return function(c){if(c<1||c>i)return t(c);o+c>n&&(s=t(n),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var hp=b((jq,dp)=>{"use strict";dp.exports=It;var Vo=$n();function It(t,e){this.lo=t>>>0,this.hi=e>>>0}var Ti=It.zero=new It(0,0);Ti.toNumber=function(){return 0};Ti.zzEncode=Ti.zzDecode=function(){return this};Ti.length=function(){return 1};var AT=It.zeroHash="\0\0\0\0\0\0\0\0";It.fromNumber=function(e){if(e===0)return Ti;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new It(n,i)};It.from=function(e){if(typeof e=="number")return It.fromNumber(e);if(Vo.isString(e))if(Vo.Long)e=Vo.Long.fromString(e);else return It.fromNumber(parseInt(e,10));return e.low||e.high?new It(e.low>>>0,e.high>>>0):Ti};It.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};It.prototype.toLong=function(e){return Vo.Long?new Vo.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var jn=String.prototype.charCodeAt;It.fromHash=function(e){return e===AT?Ti:new It((jn.call(e,0)|jn.call(e,1)<<8|jn.call(e,2)<<16|jn.call(e,3)<<24)>>>0,(jn.call(e,4)|jn.call(e,5)<<8|jn.call(e,6)<<16|jn.call(e,7)<<24)>>>0)};It.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};It.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};It.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};It.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var $n=b(bl=>{"use strict";var ue=bl;ue.asPromise=G0();ue.base64=X0();ue.EventEmitter=J0();ue.float=op();ue.inquire=ap();ue.utf8=up();ue.pool=fp();ue.LongBits=hp();ue.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);ue.global=ue.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||bl;ue.emptyArray=Object.freeze?Object.freeze([]):[];ue.emptyObject=Object.freeze?Object.freeze({}):{};ue.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};ue.isString=function(e){return typeof e=="string"||e instanceof String};ue.isObject=function(e){return e&&typeof e=="object"};ue.isset=ue.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};ue.Buffer=function(){try{var t=ue.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(e){return null}}();ue._Buffer_from=null;ue._Buffer_allocUnsafe=null;ue.newBuffer=function(e){return typeof e=="number"?ue.Buffer?ue._Buffer_allocUnsafe(e):new ue.Array(e):ue.Buffer?ue._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};ue.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;ue.Long=ue.global.dcodeIO&&ue.global.dcodeIO.Long||ue.global.Long||ue.inquire("long");ue.key2Re=/^true|false|0|1$/;ue.key32Re=/^-?(?:0|[1-9][0-9]*)$/;ue.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;ue.longToHash=function(e){return e?ue.LongBits.from(e).toHash():ue.LongBits.zeroHash};ue.longFromHash=function(e,r){var n=ue.LongBits.fromHash(e);return ue.Long?ue.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function pp(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}ue.merge=pp;ue.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function yp(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&pp(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}ue.newError=yp;ue.ProtocolError=yp("ProtocolError");ue.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};ue.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};ue.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};ue._configure=function(){var t=ue.Buffer;if(!t){ue._Buffer_from=ue._Buffer_allocUnsafe=null;return}ue._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},ue._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Il=b((Hq,Ep)=>{"use strict";Ep.exports=De;var vr=$n(),wl,cc=vr.LongBits,gp=vr.base64,mp=vr.utf8;function jo(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function _l(){}function CT(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function De(){this.len=0,this.head=new jo(_l,0,0),this.tail=this.head,this.states=null}var vp=function(){return vr.Buffer?function(){return(De.create=function(){return new wl})()}:function(){return new De}};De.create=vp();De.alloc=function(e){return new vr.Array(e)};vr.Array!==Array&&(De.alloc=vr.pool(De.alloc,vr.Array.prototype.subarray));De.prototype._push=function(e,r,n){return this.tail=this.tail.next=new jo(e,r,n),this.len+=r,this};function Sl(t,e,r){e[r]=t&255}function IT(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function xl(t,e){this.len=t,this.next=void 0,this.val=e}xl.prototype=Object.create(jo.prototype);xl.prototype.fn=IT;De.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new xl((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};De.prototype.int32=function(e){return e<0?this._push(Al,10,cc.fromNumber(e)):this.uint32(e)};De.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Al(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}De.prototype.uint64=function(e){var r=cc.from(e);return this._push(Al,r.length(),r)};De.prototype.int64=De.prototype.uint64;De.prototype.sint64=function(e){var r=cc.from(e).zzEncode();return this._push(Al,r.length(),r)};De.prototype.bool=function(e){return this._push(Sl,1,e?1:0)};function Cl(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}De.prototype.fixed32=function(e){return this._push(Cl,4,e>>>0)};De.prototype.sfixed32=De.prototype.fixed32;De.prototype.fixed64=function(e){var r=cc.from(e);return this._push(Cl,4,r.lo)._push(Cl,4,r.hi)};De.prototype.sfixed64=De.prototype.fixed64;De.prototype.float=function(e){return this._push(vr.float.writeFloatLE,4,e)};De.prototype.double=function(e){return this._push(vr.float.writeDoubleLE,8,e)};var TT=vr.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};De.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Sl,1,0);if(vr.isString(e)){var n=De.alloc(r=gp.length(e));gp.decode(e,n,0),e=n}return this.uint32(r)._push(TT,r,e)};De.prototype.string=function(e){var r=mp.length(e);return r?this.uint32(r)._push(mp.write,r,e):this._push(Sl,1,0)};De.prototype.fork=function(){return this.states=new CT(this),this.head=this.tail=new jo(_l,0,0),this.len=0,this};De.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new jo(_l,0,0),this.len=0),this};De.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};De.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};De._configure=function(t){wl=t,De.create=vp(),wl._configure()}});var _p=b((zq,wp)=>{"use strict";wp.exports=Jr;var bp=Il();(Jr.prototype=Object.create(bp.prototype)).constructor=Jr;var Hn=$n();function Jr(){bp.call(this)}Jr._configure=function(){Jr.alloc=Hn._Buffer_allocUnsafe,Jr.writeBytesBuffer=Hn.Buffer&&Hn.Buffer.prototype instanceof Uint8Array&&Hn.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Jr.prototype.bytes=function(e){Hn.isString(e)&&(e=Hn._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Jr.writeBytesBuffer,r,e),this};function RT(t,e,r){t.length<40?Hn.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Jr.prototype.string=function(e){var r=Hn.Buffer.byteLength(e);return this.uint32(r),r&&this._push(RT,r,e),this};Jr._configure()});var Bl=b((Gq,Ip)=>{"use strict";Ip.exports=mt;var en=$n(),Tl,Sp=en.LongBits,BT=en.utf8;function Mr(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function mt(t){this.buf=t,this.pos=0,this.len=t.length}var xp=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new mt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new mt(e);throw Error("illegal buffer")},Ap=function(){return en.Buffer?function(r){return(mt.create=function(i){return en.Buffer.isBuffer(i)?new Tl(i):xp(i)})(r)}:xp};mt.create=Ap();mt.prototype._slice=en.Array.prototype.subarray||en.Array.prototype.slice;mt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Mr(this,10);return e}}();mt.prototype.int32=function(){return this.uint32()|0};mt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Rl(){var t=new Sp(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Mr(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Mr(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}mt.prototype.bool=function(){return this.uint32()!==0};function uc(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}mt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Mr(this,4);return uc(this.buf,this.pos+=4)};mt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Mr(this,4);return uc(this.buf,this.pos+=4)|0};function Cp(){if(this.pos+8>this.len)throw Mr(this,8);return new Sp(uc(this.buf,this.pos+=4),uc(this.buf,this.pos+=4))}mt.prototype.float=function(){if(this.pos+4>this.len)throw Mr(this,4);var e=en.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};mt.prototype.double=function(){if(this.pos+8>this.len)throw Mr(this,4);var e=en.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};mt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Mr(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};mt.prototype.string=function(){var e=this.bytes();return BT.read(e,0,e.length)};mt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Mr(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Mr(this);while(this.buf[this.pos++]&128);return this};mt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!=4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};mt._configure=function(t){Tl=t,mt.create=Ap(),Tl._configure();var e=en.Long?"toLong":"toNumber";en.merge(mt.prototype,{int64:function(){return Rl.call(this)[e](!1)},uint64:function(){return Rl.call(this)[e](!0)},sint64:function(){return Rl.call(this).zzDecode()[e](!1)},fixed64:function(){return Cp.call(this)[e](!0)},sfixed64:function(){return Cp.call(this)[e](!1)}})}});var Pp=b((Wq,Bp)=>{"use strict";Bp.exports=Ri;var Tp=Bl();(Ri.prototype=Object.create(Tp.prototype)).constructor=Ri;var Rp=$n();function Ri(t){Tp.call(this,t)}Ri._configure=function(){Rp.Buffer&&(Ri.prototype._slice=Rp.Buffer.prototype.slice)};Ri.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ri._configure()});var Op=b((Yq,Np)=>{"use strict";Np.exports=$o;var Pl=$n();($o.prototype=Object.create(Pl.EventEmitter.prototype)).constructor=$o;function $o(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Pl.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}$o.prototype.rpcCall=function t(e,r,n,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Pl.asPromise(t,o,e,r,n,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof n))try{u=n[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};$o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Lp=b(Dp=>{"use strict";var PT=Dp;PT.Service=Op()});var qp=b((Xq,kp)=>{"use strict";kp.exports={}});var Fp=b(Mp=>{"use strict";var nr=Mp;nr.build="minimal";nr.Writer=Il();nr.BufferWriter=_p();nr.Reader=Bl();nr.BufferReader=Pp();nr.util=$n();nr.rpc=Lp();nr.roots=qp();nr.configure=Up;function Up(){nr.util._configure(),nr.Writer._configure(nr.BufferWriter),nr.Reader._configure(nr.BufferReader)}Up()});var Sn=b((Jq,Kp)=>{"use strict";Kp.exports=Fp()});var fc=b((eU,jp)=>{"use strict";var Bi=Sn(),lc=Bi.Reader,Vp=Bi.Writer,Mt=Bi.util,Er=Bi.roots["libp2p-crypto-keys"]||(Bi.roots["libp2p-crypto-keys"]={});Er.KeyType=function(){var t={},e=Object.create(t);return e[t[0]="RSA"]=0,e[t[1]="Ed25519"]=1,e[t[2]="Secp256k1"]=2,e}();Er.PublicKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Mt.newBuffer([]),t.encode=function(r,n){return n||(n=Vp.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof lc||(r=lc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Er.PublicKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Mt.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Mt.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Er.PublicKey)return r;var n=new Er.PublicKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Mt.base64.decode(r.Data,n.Data=Mt.newBuffer(Mt.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Mt.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Er.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Mt.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Bi.util.toJSONOptions)},t}();Er.PrivateKey=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Mt.newBuffer([]),t.encode=function(r,n){return n||(n=Vp.create()),n.uint32(8).int32(r.Type),n.uint32(18).bytes(r.Data),n},t.decode=function(r,n){r instanceof lc||(r=lc.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Er.PrivateKey;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Mt.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw Mt.ProtocolError("missing required 'Data'",{instance:s});return s},t.fromObject=function(r){if(r instanceof Er.PrivateKey)return r;var n=new Er.PrivateKey;switch(r.Type){case"RSA":case 0:n.Type=0;break;case"Ed25519":case 1:n.Type=1;break;case"Secp256k1":case 2:n.Type=2;break}return r.Data!=null&&(typeof r.Data=="string"?Mt.base64.decode(r.Data,n.Data=Mt.newBuffer(Mt.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.Type=n.enums===String?"RSA":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Mt.newBuffer(i.Data)))),r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Er.KeyType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Mt.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Bi.util.toJSONOptions)},t}();jp.exports=Er});var _e=b((tU,$p)=>{$p.exports={options:{usePureJavaScript:!1}}});var Gp=b((rU,zp)=>{var Nl={};zp.exports=Nl;var Hp={};Nl.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=NT(t,e);else{var i=0,s=e.length,o=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var c=0,u=t[i];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var l=new RegExp(".{1,"+r+"}","g");n=n.match(l).join(`\r
`)}return n};Nl.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Hp[e];if(!r){r=Hp[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,s=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*i,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;t[l]===s&&l<t.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function NT(t,e){var r=0,n=e.length,i=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<s.length;++o)a+=s[o]<<8,s[o]=a%n,a=a/n|0;for(;a>0;)s.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=e[s[r]];return c}});var Qe=b((nU,Xp)=>{var Wp=_e(),Yp=Gp(),I=Xp.exports=Wp.util=Wp.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){I.nextTick=process.nextTick,typeof setImmediate=="function"?I.setImmediate=setImmediate:I.setImmediate=I.nextTick;return}if(typeof setImmediate=="function"){I.setImmediate=function(){return setImmediate.apply(void 0,arguments)},I.nextTick=function(a){return setImmediate(a)};return}if(I.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,t="forge.setImmediate",e=[];I.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=I.setImmediate;I.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(e.push(c),e.length===1&&i.setAttribute("a",n=!n))}}I.nextTick=I.setImmediate})();I.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;I.globalScope=function(){return I.isNodejs?globalThis:typeof self=="undefined"?window:self}();I.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};I.isArrayBuffer=function(t){return typeof ArrayBuffer!="undefined"&&t instanceof ArrayBuffer};I.isArrayBufferView=function(t){return t&&I.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function Ho(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}I.ByteBuffer=Ol;function Ol(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(I.isArrayBuffer(t)||I.isArrayBufferView(t))if(typeof Buffer!="undefined"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch(n){for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Ol||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}I.ByteStringBuffer=Ol;var OT=4096;I.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>OT&&(this.data.substr(0,1),this._constructedStringLength=0)};I.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};I.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};I.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};I.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};I.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};I.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(I.encodeUtf8(t))};I.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};I.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};I.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};I.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};I.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};I.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};I.ByteStringBuffer.prototype.putInt=function(t,e){Ho(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};I.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};I.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};I.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};I.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};I.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};I.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};I.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};I.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};I.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};I.ByteStringBuffer.prototype.getInt=function(t){Ho(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};I.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};I.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};I.ByteStringBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};I.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};I.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};I.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};I.ByteStringBuffer.prototype.copy=function(){var t=I.createBuffer(this.data);return t.read=this.read,t};I.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};I.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};I.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};I.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};I.ByteStringBuffer.prototype.toString=function(){return I.decodeUtf8(this.bytes())};function DT(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=I.isArrayBuffer(t),n=I.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}I.DataBuffer=DT;I.DataBuffer.prototype.length=function(){return this.write-this.read};I.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};I.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};I.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};I.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};I.DataBuffer.prototype.putBytes=function(t,e){if(I.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(I.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof I.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&I.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof I.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=I.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=I.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=I.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=I.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=I.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};I.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};I.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};I.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};I.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};I.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};I.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};I.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};I.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};I.DataBuffer.prototype.putInt=function(t,e){Ho(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};I.DataBuffer.prototype.putSignedInt=function(t,e){return Ho(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};I.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};I.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};I.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};I.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};I.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};I.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};I.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};I.DataBuffer.prototype.getInt=function(t){Ho(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};I.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};I.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};I.DataBuffer.prototype.bytes=function(t){return typeof t=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};I.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};I.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};I.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};I.DataBuffer.prototype.copy=function(){return new I.DataBuffer(this)};I.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};I.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};I.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};I.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};I.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return I.binary.raw.encode(e);if(t==="hex")return I.binary.hex.encode(e);if(t==="base64")return I.binary.base64.encode(e);if(t==="utf8")return I.text.utf8.decode(e);if(t==="utf16")return I.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};I.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=I.encodeUtf8(t)),new I.ByteBuffer(t)};I.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};I.xorBytes=function(t,e,r){for(var n="",i="",s="",o=0,a=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=s,s="",a=0),s+=String.fromCharCode(i),++a;return n+=s,n};I.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};I.bytesToHex=function(t){return I.createBuffer(t).toHex()};I.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var zn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Gn=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Qp="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";I.encode64=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.length;)i=t.charCodeAt(a++),s=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=zn.charAt(i>>2),r+=zn.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=zn.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":zn.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};I.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,s,o=0;o<t.length;)r=Gn[t.charCodeAt(o++)-43],n=Gn[t.charCodeAt(o++)-43],i=Gn[t.charCodeAt(o++)-43],s=Gn[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(e+=String.fromCharCode((i&3)<<6|s)));return e};I.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};I.decodeUtf8=function(t){return decodeURIComponent(escape(t))};I.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Yp.encode,decode:Yp.decode}};I.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};I.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};I.binary.hex.encode=I.bytesToHex;I.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,s=r;for(t.length&1&&(i=1,n[s++]=parseInt(t[0],16));i<t.length;i+=2)n[s++]=parseInt(t.substr(i,2),16);return e?s-r:n};I.binary.base64.encode=function(t,e){for(var r="",n="",i,s,o,a=0;a<t.byteLength;)i=t[a++],s=t[a++],o=t[a++],r+=zn.charAt(i>>2),r+=zn.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=zn.charAt((s&15)<<2|o>>6),r+=isNaN(o)?"=":zn.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};I.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,o,a,c=0,u=r;c<t.length;)i=Gn[t.charCodeAt(c++)-43],s=Gn[t.charCodeAt(c++)-43],o=Gn[t.charCodeAt(c++)-43],a=Gn[t.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,o!==64&&(n[u++]=(s&15)<<4|o>>2,a!==64&&(n[u++]=(o&3)<<6|a));return e?u-r:n.subarray(0,u)};I.binary.base58.encode=function(t,e){return I.binary.baseN.encode(t,Qp,e)};I.binary.base58.decode=function(t,e){return I.binary.baseN.decode(t,Qp,e)};I.text={utf8:{},utf16:{}};I.text.utf8.encode=function(t,e,r){t=I.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,s=0;s<t.length;++s)n[i++]=t.charCodeAt(s);return e?i-r:n};I.text.utf8.decode=function(t){return I.decodeUtf8(String.fromCharCode.apply(null,t))};I.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,o=r,a=0;a<t.length;++a)i[o++]=t.charCodeAt(a),s+=2;return e?s-r:n};I.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};I.deflate=function(t,e,r){if(e=I.decode64(t.deflate(I.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};I.inflate=function(t,e,r){var n=t.inflate(I.encode64(e)).rval;return n===null?null:I.decode64(n)};var Dl=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=I.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n!="undefined"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Ll=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(I.decode64(r))),r},LT=function(t,e,r,n){var i=Ll(t,e);i===null&&(i={}),i[r]=n,Dl(t,e,i)},kT=function(t,e,r){var n=Ll(t,e);return n!==null&&(n=r in n?n[r]:null),n},qT=function(t,e,r){var n=Ll(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Dl(t,e,n)}},UT=function(t,e){Dl(t,e,null)},dc=function(t,e,r){var n=null;typeof r=="undefined"&&(r=["web","flash"]);var i,s=!1,o=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return n};I.setItem=function(t,e,r,n,i){dc(LT,arguments,i)};I.getItem=function(t,e,r,n){return dc(kT,arguments,n)};I.removeItem=function(t,e,r,n){dc(qT,arguments,n)};I.clearItems=function(t,e,r){dc(UT,arguments,r)};I.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};I.format=function(t){for(var e=/%./g,r,n,i=0,s=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&s.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(t.substring(o)),s.join("")};I.formatNumber=function(t,e,r,n){var i=t,s=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(i-u).toFixed(s).slice(2):"")};I.formatSize=function(t){return t>=1073741824?t=I.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=I.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=I.formatNumber(t/1024,0)+" KiB":t=I.formatNumber(t,0)+" bytes",t};I.bytesFromIP=function(t){return t.indexOf(".")!==-1?I.bytesFromIPv4(t):t.indexOf(":")!==-1?I.bytesFromIPv6(t):null};I.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=I.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};I.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=I.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=I.hexToBytes(t[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};I.bytesToIP=function(t){return t.length===4?I.bytesToIPv4(t):t.length===16?I.bytesToIPv6(t):null};I.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};I.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var s=I.bytesToHex(t[i]+t[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};I.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in I&&!t.update)return e(null,I.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return I.cores=navigator.hardwareConcurrency,e(null,I.cores);if(typeof Worker=="undefined")return I.cores=1,e(null,I.cores);if(typeof Blob=="undefined")return I.cores=2,e(null,I.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,f){return l+f},0)/o.length);return I.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,I.cores)}i(c,function(l,f){o.push(s(c,f)),n(o,a-1,c)})}function i(o,a){for(var c=[],u=[],l=0;l<o;++l){var f=new Worker(r);f.addEventListener("message",function(d){if(u.push(d.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(f)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],f=c[u]=[],d=0;d<o;++d)if(u!==d){var p=a[d];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&f.push(d)}return c.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var Cs=b((iU,Zp)=>{var zo=_e();zo.pki=zo.pki||{};var kl=Zp.exports=zo.pki.oids=zo.oids=zo.oids||{};function G(t,e){kl[t]=e,kl[e]=t}function Ke(t,e){kl[t]=e}G("1.2.840.113549.1.1.1","rsaEncryption");G("1.2.840.113549.1.1.4","md5WithRSAEncryption");G("1.2.840.113549.1.1.5","sha1WithRSAEncryption");G("1.2.840.113549.1.1.7","RSAES-OAEP");G("1.2.840.113549.1.1.8","mgf1");G("1.2.840.113549.1.1.9","pSpecified");G("1.2.840.113549.1.1.10","RSASSA-PSS");G("1.2.840.113549.1.1.11","sha256WithRSAEncryption");G("1.2.840.113549.1.1.12","sha384WithRSAEncryption");G("1.2.840.113549.1.1.13","sha512WithRSAEncryption");G("1.3.101.112","EdDSA25519");G("1.2.840.10040.4.3","dsa-with-sha1");G("1.3.14.3.2.7","desCBC");G("1.3.14.3.2.26","sha1");G("1.3.14.3.2.29","sha1WithRSASignature");G("2.16.840.1.101.3.4.2.1","sha256");G("2.16.840.1.101.3.4.2.2","sha384");G("2.16.840.1.101.3.4.2.3","sha512");G("2.16.840.1.101.3.4.2.4","sha224");G("2.16.840.1.101.3.4.2.5","sha512-224");G("2.16.840.1.101.3.4.2.6","sha512-256");G("1.2.840.113549.2.2","md2");G("1.2.840.113549.2.5","md5");G("1.2.840.113549.1.7.1","data");G("1.2.840.113549.1.7.2","signedData");G("1.2.840.113549.1.7.3","envelopedData");G("1.2.840.113549.1.7.4","signedAndEnvelopedData");G("1.2.840.113549.1.7.5","digestedData");G("1.2.840.113549.1.7.6","encryptedData");G("1.2.840.113549.1.9.1","emailAddress");G("1.2.840.113549.1.9.2","unstructuredName");G("1.2.840.113549.1.9.3","contentType");G("1.2.840.113549.1.9.4","messageDigest");G("1.2.840.113549.1.9.5","signingTime");G("1.2.840.113549.1.9.6","counterSignature");G("1.2.840.113549.1.9.7","challengePassword");G("1.2.840.113549.1.9.8","unstructuredAddress");G("1.2.840.113549.1.9.14","extensionRequest");G("1.2.840.113549.1.9.20","friendlyName");G("1.2.840.113549.1.9.21","localKeyId");G("1.2.840.113549.1.9.22.1","x509Certificate");G("1.2.840.113549.1.12.10.1.1","keyBag");G("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");G("1.2.840.113549.1.12.10.1.3","certBag");G("1.2.840.113549.1.12.10.1.4","crlBag");G("1.2.840.113549.1.12.10.1.5","secretBag");G("1.2.840.113549.1.12.10.1.6","safeContentsBag");G("1.2.840.113549.1.5.13","pkcs5PBES2");G("1.2.840.113549.1.5.12","pkcs5PBKDF2");G("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");G("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");G("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");G("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");G("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");G("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");G("1.2.840.113549.2.7","hmacWithSHA1");G("1.2.840.113549.2.8","hmacWithSHA224");G("1.2.840.113549.2.9","hmacWithSHA256");G("1.2.840.113549.2.10","hmacWithSHA384");G("1.2.840.113549.2.11","hmacWithSHA512");G("1.2.840.113549.3.7","des-EDE3-CBC");G("2.16.840.1.101.3.4.1.2","aes128-CBC");G("2.16.840.1.101.3.4.1.22","aes192-CBC");G("2.16.840.1.101.3.4.1.42","aes256-CBC");G("2.5.4.3","commonName");G("2.5.4.4","surname");G("2.5.4.5","serialNumber");G("2.5.4.6","countryName");G("2.5.4.7","localityName");G("2.5.4.8","stateOrProvinceName");G("2.5.4.9","streetAddress");G("2.5.4.10","organizationName");G("2.5.4.11","organizationalUnitName");G("2.5.4.12","title");G("2.5.4.13","description");G("2.5.4.15","businessCategory");G("2.5.4.17","postalCode");G("2.5.4.42","givenName");G("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");G("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");G("2.16.840.1.113730.1.1","nsCertType");G("2.16.840.1.113730.1.13","nsComment");Ke("2.5.29.1","authorityKeyIdentifier");Ke("2.5.29.2","keyAttributes");Ke("2.5.29.3","certificatePolicies");Ke("2.5.29.4","keyUsageRestriction");Ke("2.5.29.5","policyMapping");Ke("2.5.29.6","subtreesConstraint");Ke("2.5.29.7","subjectAltName");Ke("2.5.29.8","issuerAltName");Ke("2.5.29.9","subjectDirectoryAttributes");Ke("2.5.29.10","basicConstraints");Ke("2.5.29.11","nameConstraints");Ke("2.5.29.12","policyConstraints");Ke("2.5.29.13","basicConstraints");G("2.5.29.14","subjectKeyIdentifier");G("2.5.29.15","keyUsage");Ke("2.5.29.16","privateKeyUsagePeriod");G("2.5.29.17","subjectAltName");G("2.5.29.18","issuerAltName");G("2.5.29.19","basicConstraints");Ke("2.5.29.20","cRLNumber");Ke("2.5.29.21","cRLReason");Ke("2.5.29.22","expirationDate");Ke("2.5.29.23","instructionCode");Ke("2.5.29.24","invalidityDate");Ke("2.5.29.25","cRLDistributionPoints");Ke("2.5.29.26","issuingDistributionPoint");Ke("2.5.29.27","deltaCRLIndicator");Ke("2.5.29.28","issuingDistributionPoint");Ke("2.5.29.29","certificateIssuer");Ke("2.5.29.30","nameConstraints");G("2.5.29.31","cRLDistributionPoints");G("2.5.29.32","certificatePolicies");Ke("2.5.29.33","policyMappings");Ke("2.5.29.34","policyConstraints");G("2.5.29.35","authorityKeyIdentifier");Ke("2.5.29.36","policyConstraints");G("2.5.29.37","extKeyUsage");Ke("2.5.29.46","freshestCRL");Ke("2.5.29.54","inhibitAnyPolicy");G("1.3.6.1.4.1.11129.2.4.2","timestampList");G("1.3.6.1.5.5.7.1.1","authorityInfoAccess");G("1.3.6.1.5.5.7.3.1","serverAuth");G("1.3.6.1.5.5.7.3.2","clientAuth");G("1.3.6.1.5.5.7.3.3","codeSigning");G("1.3.6.1.5.5.7.3.4","emailProtection");G("1.3.6.1.5.5.7.3.8","timeStamping")});var Wn=b((sU,ey)=>{var et=_e();Qe();Cs();var Z=ey.exports=et.asn1=et.asn1||{};Z.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Z.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Z.create=function(t,e,r,n,i){if(et.util.isArray(n)){for(var s=[],o=0;o<n.length;++o)n[o]!==void 0&&s.push(n[o]);n=s}var a={tagClass:t,type:e,constructed:r,composed:r||et.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=Z.copy(a)),a};Z.copy=function(t,e){var r;if(et.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(Z.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Z.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Z.equals=function(t,e,r){if(et.util.isArray(t)){if(!et.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Z.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Z.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};Z.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Go(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var MT=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Go(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};Z.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=et.util.createBuffer(t));var r=t.length(),n=hc(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function hc(t,e,r,n){var i;Go(t,e,2);var s=t.getByte();e--;var o=s&192,a=s&31;i=t.length();var c=MT(t,e);if(e-=i-t.length(),c!==void 0&&c>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=c,u}c=e}var l,f,d=(s&32)==32;if(d)if(l=[],c===void 0)for(;;){if(Go(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),l.push(hc(t,e,r+1,n)),e-=i-t.length()}else for(;c>0;)i=t.length(),l.push(hc(t,c,r+1,n)),e-=i-t.length(),c-=i-t.length();if(l===void 0&&o===Z.Class.UNIVERSAL&&a===Z.Type.BITSTRING&&(f=t.bytes(c)),l===void 0&&n.decodeBitStrings&&o===Z.Class.UNIVERSAL&&a===Z.Type.BITSTRING&&c>1){var p=t.read,h=e,g=0;if(a===Z.Type.BITSTRING&&(Go(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={strict:!0,decodeBitStrings:!0},w=hc(t,e,r+1,v),C=i-t.length();e-=C,a==Z.Type.BITSTRING&&C++;var q=w.tagClass;C===c&&(q===Z.Class.UNIVERSAL||q===Z.Class.CONTEXT_SPECIFIC)&&(l=[w])}catch(F){}l===void 0&&(t.read=p,e=h)}if(l===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Z.Type.BMPSTRING)for(l="";c>0;c-=2)Go(t,e,2),l+=String.fromCharCode(t.getInt16()),e-=2;else l=t.getBytes(c),e-=c}var W=f===void 0?null:{bitStringContents:f};return Z.create(o,a,d,l,W)}Z.toDer=function(t){var e=et.util.createBuffer(),r=t.tagClass|t.type,n=et.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=Z.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(Z.toDer(t.value[s]))}else if(t.type===Z.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===Z.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)==0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)==128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(n),e};Z.oidToDer=function(t){var e=t.split("."),r=et.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,s,o,a=2;a<e.length;++a){n=!0,i=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,n||(o|=128),i.push(o),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};Z.derToOid=function(t){var e;typeof t=="string"&&(t=et.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};Z.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,0),u&&(c=t.charAt(u),c==="+"||c==="-")){var l=parseInt(t.substr(u+1,2),10),f=parseInt(t.substr(u+4,2),10),d=l*60+f;d*=6e4,c==="+"?e.setTime(+e-d):e.setTime(+e+d)}return e};Z.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,u=0,l=!1;t.charAt(t.length-1)==="Z"&&(l=!0);var f=t.length-5,d=t.charAt(f);if(d==="+"||d==="-"){var p=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10);u=p*60+h,u*=6e4,d==="+"&&(u*=-1),l=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),l?(e.setUTCFullYear(r,n,i),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(s,o,a,c)),e};Z.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Z.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Z.integerToDer=function(t){var e=et.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Z.derToInteger=function(t){typeof t=="string"&&(t=et.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Z.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(t.type===e.type||typeof e.type=="undefined"))if(t.constructed===e.constructed||typeof e.constructed=="undefined"){if(i=!0,e.value&&et.util.isArray(e.value))for(var s=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[s]&&(i=Z.validate(t.value[s],e.value[o],r,n),i?++s:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Jp=/[^\\u0000-\\u00ff]/;Z.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",s=0;s<e*r;++s)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case Z.Class.UNIVERSAL:n+="Universal:";break;case Z.Class.APPLICATION:n+="Application:";break;case Z.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case Z.Class.PRIVATE:n+="Private:";break}if(t.tagClass===Z.Class.UNIVERSAL)switch(n+=t.type,t.type){case Z.Type.NONE:n+=" (None)";break;case Z.Type.BOOLEAN:n+=" (Boolean)";break;case Z.Type.INTEGER:n+=" (Integer)";break;case Z.Type.BITSTRING:n+=" (Bit string)";break;case Z.Type.OCTETSTRING:n+=" (Octet string)";break;case Z.Type.NULL:n+=" (Null)";break;case Z.Type.OID:n+=" (Object Identifier)";break;case Z.Type.ODESC:n+=" (Object Descriptor)";break;case Z.Type.EXTERNAL:n+=" (External or Instance of)";break;case Z.Type.REAL:n+=" (Real)";break;case Z.Type.ENUMERATED:n+=" (Enumerated)";break;case Z.Type.EMBEDDED:n+=" (Embedded PDV)";break;case Z.Type.UTF8:n+=" (UTF8)";break;case Z.Type.ROID:n+=" (Relative Object Identifier)";break;case Z.Type.SEQUENCE:n+=" (Sequence)";break;case Z.Type.SET:n+=" (Set)";break;case Z.Type.PRINTABLESTRING:n+=" (Printable String)";break;case Z.Type.IA5String:n+=" (IA5String (ASCII))";break;case Z.Type.UTCTIME:n+=" (UTC time)";break;case Z.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case Z.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(o+=1,a+=Z.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(a+=","));n+=i+"Sub values: "+o+a}else{if(n+=i+"Value: ",t.type===Z.Type.OID){var c=Z.derToOid(t.value);n+=c,et.pki&&et.pki.oids&&c in et.pki.oids&&(n+=" ("+et.pki.oids[c]+") ")}if(t.type===Z.Type.INTEGER)try{n+=Z.derToInteger(t.value)}catch(l){n+="0x"+et.util.bytesToHex(t.value)}else if(t.type===Z.Type.BITSTRING){if(t.value.length>1?n+="0x"+et.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===Z.Type.OCTETSTRING)Jp.test(t.value)||(n+="("+t.value+") "),n+="0x"+et.util.bytesToHex(t.value);else if(t.type===Z.Type.UTF8)try{n+=et.util.decodeUtf8(t.value)}catch(l){if(l.message==="URI malformed")n+="0x"+et.util.bytesToHex(t.value)+" (malformed UTF8)";else throw l}else t.type===Z.Type.PRINTABLESTRING||t.type===Z.Type.IA5String?n+=t.value:Jp.test(t.value)?n+="0x"+et.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Ul=b((oU,ty)=>{var Tt=_e();Qe();ty.exports=Tt.cipher=Tt.cipher||{};Tt.cipher.algorithms=Tt.cipher.algorithms||{};Tt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Tt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Tt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Tt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Tt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Tt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Tt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Tt.cipher.algorithms[t]=e};Tt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Tt.cipher.algorithms?Tt.cipher.algorithms[t]:null};var ql=Tt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ql.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Tt.util.createBuffer(),this.output=t.output||Tt.util.createBuffer(),this.mode.start(e)};ql.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ql.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Fl=b((aU,ry)=>{var Rt=_e();Qe();Rt.cipher=Rt.cipher||{};var Se=ry.exports=Rt.cipher.modes=Rt.cipher.modes||{};Se.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Se.ecb.prototype.start=function(t){};Se.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Se.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Se.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Se.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Se.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Se.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=pc(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Se.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Se.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Se.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Se.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Se.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};Se.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=pc(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Se.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Se.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Se.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};Se.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=pc(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Se.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Se.ofb.prototype.decrypt=Se.ofb.prototype.encrypt;Se.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0};Se.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=pc(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Se.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}yc(this._inBlock)};Se.ctr.prototype.decrypt=Se.ctr.prototype.encrypt;Se.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Rt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Se.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Rt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Rt.util.createBuffer(t.additionalData):r=Rt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Rt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ml(n*8)))}this._inBlock=this._j0.slice(0),yc(this._inBlock),this._partialBytes=0,r=Rt.util.createBuffer(r),this._aDataLength=Ml(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Se.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),yc(this._inBlock)};Se.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),yc(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Se.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Rt.util.createBuffer();var n=this._aDataLength.concat(Ml(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Se.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var s=t[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Se.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Se.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,s=this._m[r][i];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};Se.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Se.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,s=new Array(i),o=0;o<i;++o){var a=[0,0,0,0],c=o/n|0,u=(n-1-o%n)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,t),e)}return s};Se.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var o=1;o<s;++o){var a=i[s],c=i[o];i[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function pc(t,e){if(typeof t=="string"&&(t=Rt.util.createBuffer(t)),Rt.util.isArray(t)&&t.length>4){var r=t;t=Rt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Rt.util.isArray(t)){for(var i=[],s=e/4,n=0;n<s;++n)i.push(t.getInt32());t=i}return t}function yc(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Ml(t){return[t/4294967296|0,t&4294967295]}});var Rs=b((cU,oy)=>{var Xe=_e();Ul();Fl();Qe();oy.exports=Xe.aes=Xe.aes||{};Xe.aes.startEncrypting=function(t,e,r,n){var i=gc({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};Xe.aes.createEncryptionCipher=function(t,e){return gc({key:t,output:null,decrypt:!1,mode:e})};Xe.aes.startDecrypting=function(t,e,r,n){var i=gc({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};Xe.aes.createDecryptionCipher=function(t,e){return gc({key:t,output:null,decrypt:!0,mode:e})};Xe.aes.Algorithm=function(t,e){Kl||iy();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return jl(r._w,n,i,!1)},decrypt:function(n,i){return jl(r._w,n,i,!0)}}}),r._init=!1};Xe.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Xe.util.createBuffer(e);else if(Xe.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Xe.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Xe.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!Xe.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=sy(e,t.decrypt&&!o),this._init=!0}};Xe.aes._expandKey=function(t,e){return Kl||iy(),sy(t,e)};Xe.aes._updateBlock=jl;Is("AES-ECB",Xe.cipher.modes.ecb);Is("AES-CBC",Xe.cipher.modes.cbc);Is("AES-CFB",Xe.cipher.modes.cfb);Is("AES-OFB",Xe.cipher.modes.ofb);Is("AES-CTR",Xe.cipher.modes.ctr);Is("AES-GCM",Xe.cipher.modes.gcm);function Is(t,e){var r=function(){return new Xe.aes.Algorithm(t,e)};Xe.cipher.registerAlgorithm(t,r)}var Kl=!1,Ts=4,Wt,Vl,ny,Pi,Fr;function iy(){Kl=!0,ny=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Wt=new Array(256),Vl=new Array(256),Pi=new Array(4),Fr=new Array(4);for(var e=0;e<4;++e)Pi[e]=new Array(256),Fr[e]=new Array(256);for(var r=0,n=0,i,s,o,a,c,u,l,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Wt[r]=a,Vl[a]=r,c=t[a],i=t[r],s=t[i],o=t[s],u=c<<24^a<<16^a<<8^(a^c),l=(i^s^o)<<24^(r^o)<<16^(r^s^o)<<8^(r^i^o);for(var f=0;f<4;++f)Pi[f][r]=u,Fr[f][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function sy(t,e){for(var r=t.slice(0),n,i=1,s=r.length,o=s+6+1,a=Ts*o,c=s;c<a;++c)n=r[c-1],c%s==0?(n=Wt[n>>>16&255]<<24^Wt[n>>>8&255]<<16^Wt[n&255]<<8^Wt[n>>>24]^ny[i]<<24,i++):s>6&&c%s==4&&(n=Wt[n>>>24]<<24^Wt[n>>>16&255]<<16^Wt[n>>>8&255]<<8^Wt[n&255]),r[c]=r[c-s]^n;if(e){var u,l=Fr[0],f=Fr[1],d=Fr[2],p=Fr[3],h=r.slice(0);a=r.length;for(var c=0,g=a-Ts;c<a;c+=Ts,g-=Ts)if(c===0||c===a-Ts)h[c]=r[g],h[c+1]=r[g+3],h[c+2]=r[g+2],h[c+3]=r[g+1];else for(var v=0;v<Ts;++v)u=r[g+v],h[c+(3&-v)]=l[Wt[u>>>24]]^f[Wt[u>>>16&255]]^d[Wt[u>>>8&255]]^p[Wt[u&255]];r=h}return r}function jl(t,e,r,n){var i=t.length/4-1,s,o,a,c,u;n?(s=Fr[0],o=Fr[1],a=Fr[2],c=Fr[3],u=Vl):(s=Pi[0],o=Pi[1],a=Pi[2],c=Pi[3],u=Wt);var l,f,d,p,h,g,v;l=e[0]^t[0],f=e[n?3:1]^t[1],d=e[2]^t[2],p=e[n?1:3]^t[3];for(var w=3,C=1;C<i;++C)h=s[l>>>24]^o[f>>>16&255]^a[d>>>8&255]^c[p&255]^t[++w],g=s[f>>>24]^o[d>>>16&255]^a[p>>>8&255]^c[l&255]^t[++w],v=s[d>>>24]^o[p>>>16&255]^a[l>>>8&255]^c[f&255]^t[++w],p=s[p>>>24]^o[l>>>16&255]^a[f>>>8&255]^c[d&255]^t[++w],l=h,f=g,d=v;r[0]=u[l>>>24]<<24^u[f>>>16&255]<<16^u[d>>>8&255]<<8^u[p&255]^t[++w],r[n?3:1]=u[f>>>24]<<24^u[d>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^t[++w],r[2]=u[d>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[f&255]^t[++w],r[n?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[f>>>8&255]<<8^u[d&255]^t[++w]}function gc(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Xe.cipher.createDecipher(r,t.key):n=Xe.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof Xe.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var vc=b((uU,cy)=>{var st=_e();Ul();Fl();Qe();cy.exports=st.des=st.des||{};st.des.startEncrypting=function(t,e,r,n){var i=mc({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};st.des.createEncryptionCipher=function(t,e){return mc({key:t,output:null,decrypt:!1,mode:e})};st.des.startDecrypting=function(t,e,r,n){var i=mc({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};st.des.createDecryptionCipher=function(t,e){return mc({key:t,output:null,decrypt:!0,mode:e})};st.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return ay(r._keys,n,i,!1)},decrypt:function(n,i){return ay(r._keys,n,i,!0)}}}),r._init=!1};st.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=st.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=WT(e),this._init=!0}};tn("DES-ECB",st.cipher.modes.ecb);tn("DES-CBC",st.cipher.modes.cbc);tn("DES-CFB",st.cipher.modes.cfb);tn("DES-OFB",st.cipher.modes.ofb);tn("DES-CTR",st.cipher.modes.ctr);tn("3DES-ECB",st.cipher.modes.ecb);tn("3DES-CBC",st.cipher.modes.cbc);tn("3DES-CFB",st.cipher.modes.cfb);tn("3DES-OFB",st.cipher.modes.ofb);tn("3DES-CTR",st.cipher.modes.ctr);function tn(t,e){var r=function(){return new st.des.Algorithm(t,e)};st.cipher.registerAlgorithm(t,r)}var FT=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],KT=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],VT=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],jT=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],$T=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],HT=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],zT=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],GT=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function WT(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],w=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],C=0,q,W=0;W<g;W++){var F=t.getInt32(),M=t.getInt32();q=(F>>>4^M)&252645135,M^=q,F^=q<<4,q=(M>>>-16^F)&65535,F^=q,M^=q<<-16,q=(F>>>2^M)&858993459,M^=q,F^=q<<2,q=(M>>>-16^F)&65535,F^=q,M^=q<<-16,q=(F>>>1^M)&1431655765,M^=q,F^=q<<1,q=(M>>>8^F)&16711935,F^=q,M^=q<<8,q=(F>>>1^M)&1431655765,M^=q,F^=q<<1,q=F<<8|M>>>20&240,F=M<<24|M<<8&16711680|M>>>8&65280|M>>>24&240,M=q;for(var re=0;re<w.length;++re){w[re]?(F=F<<2|F>>>26,M=M<<2|M>>>26):(F=F<<1|F>>>27,M=M<<1|M>>>27),F&=-15,M&=-15;var ie=e[F>>>28]|r[F>>>24&15]|n[F>>>20&15]|i[F>>>16&15]|s[F>>>12&15]|o[F>>>8&15]|a[F>>>4&15],z=c[M>>>28]|u[M>>>24&15]|l[M>>>20&15]|f[M>>>16&15]|d[M>>>12&15]|p[M>>>8&15]|h[M>>>4&15];q=(z>>>16^ie)&65535,v[C++]=ie^q,v[C++]=z^q<<16}}return v}function ay(t,e,r,n){var i=t.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var l=s[u+1],f=s[u+2],d=s[u];d!=l;d+=f){var p=c^t[d],h=(c>>>4|c<<28)^t[d+1];o=a,a=c,c=o^(KT[p>>>24&63]|jT[p>>>16&63]|HT[p>>>8&63]|GT[p&63]|FT[h>>>24&63]|VT[h>>>16&63]|$T[h>>>8&63]|zT[h&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function mc(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=st.cipher.createDecipher(r,t.key):n=st.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(s,o){var a=null;o instanceof st.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,i.call(n,o)},n}});var Yn=b((lU,uy)=>{var Ec=_e();uy.exports=Ec.md=Ec.md||{};Ec.md.algorithms=Ec.md.algorithms||{}});var fy=b((fU,ly)=>{var xn=_e();Yn();Qe();var YT=ly.exports=xn.hmac=xn.hmac||{};YT.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in xn.md.algorithms)e=xn.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=t;else{if(typeof o=="string")o=xn.util.createBuffer(o);else if(xn.util.isArray(o)){var a=o;o=xn.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=xn.util.createBuffer(),n=xn.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(s){e.update(s)},i.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},i.digest=i.getMac,i}});var Bs=b(()=>{});var $l=b((pU,dy)=>{var Yt=_e();fy();Yn();Qe();var QT=Yt.pkcs5=Yt.pkcs5||{},An;Yt.util.isNodejs&&!Yt.options.usePureJavaScript&&(An=Bs());dy.exports=Yt.pbkdf2=QT.pbkdf2=function(t,e,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Yt.util.isNodejs&&!Yt.options.usePureJavaScript&&An.pbkdf2&&(i===null||typeof i!="object")&&(An.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?An.pbkdf2Sync.length===4?An.pbkdf2(t,e,r,n,function(q,W){if(q)return s(q);s(null,W.toString("binary"))}):An.pbkdf2(t,e,r,n,i,function(q,W){if(q)return s(q);s(null,W.toString("binary"))}):An.pbkdf2Sync.length===4?An.pbkdf2Sync(t,e,r,n).toString("binary"):An.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i=="undefined"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Yt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Yt.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(n/o),u=n-(c-1)*o,l=Yt.hmac.create();l.start(i,t);var f="",d,p,h;if(!s){for(var g=1;g<=c;++g){l.start(null,null),l.update(e),l.update(Yt.util.int32ToBytes(g)),d=h=l.digest().getBytes();for(var v=2;v<=r;++v)l.start(null,null),l.update(h),p=l.digest().getBytes(),d=Yt.util.xorBytes(d,p,o),h=p;f+=g<c?d:d.substr(0,u)}return f}var g=1,v;function w(){if(g>c)return s(null,f);l.start(null,null),l.update(e),l.update(Yt.util.int32ToBytes(g)),d=h=l.digest().getBytes(),v=2,C()}function C(){if(v<=r)return l.start(null,null),l.update(h),p=l.digest().getBytes(),d=Yt.util.xorBytes(d,p,o),h=p,++v,Yt.util.setImmediate(C);f+=g<c?d:d.substr(0,u),++g,w()}w()}});var _c=b((yU,py)=>{var bc=_e();Qe();var hy=py.exports=bc.pem=bc.pem||{};hy.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=wc(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=wc(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=wc(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=wc(t.headers[i]);return t.procType&&(r+=`\r
`),r+=bc.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};hy.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(t),!!s;){var o=s[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:bc.util.decode64(s[3])};if(e.push(a),!!s[2]){for(var c=s[2].split(i),u=0;s&&u<c.length;){for(var l=c[u].replace(/\s+$/,""),f=u+1;f<c.length;++f){var d=c[f];if(!/\s/.test(d[0]))break;l+=d,u=f}if(s=l.match(n),s){for(var p={name:s[1],values:[]},h=s[2].split(","),g=0;g<h.length;++g)p.values.push(XT(h[g]));if(a.procType)if(!a.contentDomain&&p.name==="Content-Domain")a.contentDomain=h[0]||"";else if(!a.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:h[0],parameters:h[1]||null}}else a.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:h[0],type:h[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function wc(t){for(var e=t.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,o=-1,i=0;i<e.length;++i,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function XT(t){return t.replace(/^\s+/,"")}});var by=b((gU,Ey)=>{var rn=_e();Yn();Qe();var yy=Ey.exports=rn.sha256=rn.sha256||{};rn.md.sha256=rn.md.algorithms.sha256=yy;yy.create=function(){gy||ZT();var t=null,e=rn.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=rn.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=rn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),vy(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=rn.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Hl.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};vy(f,r,i);var d=rn.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},n};var Hl=null,gy=!1,my=null;function ZT(){Hl=String.fromCharCode(128),Hl+=rn.util.fillString(String.fromCharCode(0),64),my=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],gy=!0}function vy(t,e,r){for(var n,i,s,o,a,c,u,l,f,d,p,h,g,v,w,C=r.length();C>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(l=t.h0,f=t.h1,d=t.h2,p=t.h3,h=t.h4,g=t.h5,v=t.h6,w=t.h7,u=0;u<64;++u)o=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),a=v^h&(g^v),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&f|d&(l^f),n=w+o+a+my[u]+e[u],i=s+c,w=v,v=g,g=h,h=p+n>>>0,p=d,d=f,f=l,l=n+i>>>0;t.h0=t.h0+l|0,t.h1=t.h1+f|0,t.h2=t.h2+d|0,t.h3=t.h3+p|0,t.h4=t.h4+h|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+w|0,C-=64}}});var _y=b((mU,wy)=>{var nn=_e();Qe();var Sc=null;nn.util.isNodejs&&!nn.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Sc=Bs());var JT=wy.exports=nn.prng=nn.prng||{};JT.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var f=e.plugin.cipher,d=e.plugin.increment,p=e.plugin.formatKey,h=e.plugin.formatSeed,g=nn.util.createBuffer();e.key=null,v();function v(w){if(w)return l(w);if(g.length()>=u)return l(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return nn.util.nextTick(function(){s(v)});var C=f(e.key,e.seed);e.generated+=C.length,g.putBytes(C),e.key=p(f(e.key,d(e.seed))),e.seed=h(f(e.key,e.seed)),nn.util.setImmediate(v)}},e.generateSync=function(u){var l=e.plugin.cipher,f=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var h=nn.util.createBuffer();h.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=l(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=d(l(e.key,f(e.seed))),e.seed=p(l(e.key,e.seed))}return h.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(f,d){if(f)return u(f);e.collect(d),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,f=0;f<32;++f)e.reseeds%l==0&&(u.update(e.pools[f].digest().getBytes()),e.pools[f].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var d=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(d),e.generated=0}function c(u){var l=null,f=nn.util.globalScope,d=f.crypto||f.msCrypto;d&&d.getRandomValues&&(l=function(F){return d.getRandomValues(F)});var p=nn.util.createBuffer();if(l)for(;p.length()<u;){var h=Math.max(1,Math.min(u-p.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{l(g);for(var v=0;v<g.length;++v)p.putInt32(g[v])}catch(F){if(!(typeof QuotaExceededError!="undefined"&&F instanceof QuotaExceededError))throw F}}if(p.length()<u)for(var w,C,q,W=Math.floor(Math.random()*65536);p.length()<u;){C=16807*(W&65535),w=16807*(W>>16),C+=(w&32767)<<16,C+=w>>15,C=(C&2147483647)+(C>>31),W=C&4294967295;for(var v=0;v<3;++v)q=W>>>(v<<3),q^=Math.floor(Math.random()*256),p.putByte(q&255)}return p.getBytes(u)}return Sc?(e.seedFile=function(u,l){Sc.randomBytes(u,function(f,d){if(f)return l(f);l(null,d.toString())})},e.seedFileSync=function(u){return Sc.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(f){l(f)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,f=0;f<l;++f)e.pools[e.pool].update(u.substr(f,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var f="",d=0;d<l;d+=8)f+=String.fromCharCode(u>>d&255);e.collect(f)},e.registerWorker=function(u){if(u===self)e.seedFile=function(f,d){function p(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",p),d(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:f}}})};else{var l=function(f){var d=f.data;d.forge&&d.forge.prng&&e.seedFile(d.forge.prng.needed,function(p,h){u.postMessage({forge:{prng:{err:p,bytes:h}}})})};u.addEventListener("message",l)}},e}});var Ni=b((vU,zl)=>{var Bt=_e();Rs();by();_y();Qe();(function(){if(Bt.random&&Bt.random.getBytes){zl.exports=Bt.random;return}(function(t){var e={},r=new Array(4),n=Bt.util.createBuffer();e.formatKey=function(f){var d=Bt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),Bt.aes._expandKey(f,!1)},e.formatSeed=function(f){var d=Bt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),f},e.cipher=function(f,d){return Bt.aes._updateBlock(f,d,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(f){return++f[3],f},e.md=Bt.md.sha256;function i(){var f=Bt.prng.create(e);return f.getBytes=function(d,p){return f.generate(d,p)},f.getBytesSync=function(d){return f.generate(d)},f}var s=i(),o=null,a=Bt.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(f){return c.getRandomValues(f)}),Bt.options.usePureJavaScript||!Bt.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(f){}s.collect(u),u=null}t&&(t().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),t().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!Bt.random)Bt.random=s;else for(var l in s)Bt.random[l]=s[l];Bt.random.createInstance=i,zl.exports=Bt.random})(typeof jQuery!="undefined"?jQuery:null)})()});var Cy=b((EU,Ay)=>{var ir=_e();Qe();var Gl=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Sy=[1,2,3,5],eR=function(t,e){return t<<e&65535|(t&65535)>>16-e},tR=function(t,e){return(t&65535)>>e|t<<16-e&65535};Ay.exports=ir.rc2=ir.rc2||{};ir.rc2.expandKey=function(t,e){typeof t=="string"&&(t=ir.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,s=Math.ceil(i/8),o=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(Gl[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-s,Gl[r.at(128-s)&o]),a=127-s;a>=0;a--)r.setAt(a,Gl[r.at(a+1)^r.at(a+s)]);return r};var xy=function(t,e,r){var n=!1,i=null,s=null,o=null,a,c,u,l,f=[];for(t=ir.rc2.expandKey(t,e),u=0;u<64;u++)f.push(t.getInt16Le());r?(a=function(h){for(u=0;u<4;u++)h[u]+=f[l]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),h[u]=eR(h[u],Sy[u]),l++},c=function(h){for(u=0;u<4;u++)h[u]+=f[h[(u+3)%4]&63]}):(a=function(h){for(u=3;u>=0;u--)h[u]=tR(h[u],Sy[u]),h[u]-=f[l]+(h[(u+3)%4]&h[(u+2)%4])+(~h[(u+3)%4]&h[(u+1)%4]),l--},c=function(h){for(u=3;u>=0;u--)h[u]-=f[h[(u+3)%4]&63]});var d=function(h){var g=[];for(u=0;u<4;u++){var v=i.getInt16Le();o!==null&&(r?v^=o.getInt16Le():o.putInt16Le(v)),g.push(v&65535)}l=r?0:63;for(var w=0;w<h.length;w++)for(var C=0;C<h[w][0];C++)h[w][1](g);for(u=0;u<4;u++)o!==null&&(r?o.putInt16Le(g[u]):g[u]^=o.getInt16Le()),s.putInt16Le(g[u])},p=null;return p={start:function(h,g){h&&typeof h=="string"&&(h=ir.util.createBuffer(h)),n=!1,i=ir.util.createBuffer(),s=g||new ir.util.createBuffer,o=h,p.output=s},update:function(h){for(n||i.putBuffer(h);i.length()>=8;)d([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(h){var g=!0;if(r)if(h)g=h(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,p.update()),!r&&(g=i.length()===0,g))if(h)g=h(8,s,!r);else{var w=s.length(),C=s.at(w-1);C>w?g=!1:s.truncate(C)}return g}},p};ir.rc2.startEncrypting=function(t,e,r){var n=ir.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};ir.rc2.createEncryptionCipher=function(t,e){return xy(t,e,!0)};ir.rc2.startDecrypting=function(t,e,r){var n=ir.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};ir.rc2.createDecryptionCipher=function(t,e){return xy(t,e,!1)}});var Cc=b((bU,Dy)=>{var Wl=_e();Dy.exports=Wl.jsbn=Wl.jsbn||{};var Cn,rR=244837814094590,Iy=(rR&16777215)==15715070;function $(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Wl.jsbn.BigInteger=$;function Le(){return new $(null)}function nR(t,e,r,n,i,s){for(;--s>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function iR(t,e,r,n,i,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[t]&32767,u=this.data[t++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(l>>>15)+a*u+(i>>>30),r.data[n++]=c&1073741823}return i}function Ty(t,e,r,n,i,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[t]&16383,u=this.data[t++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+r.data[n]+i,i=(c>>28)+(l>>14)+a*u,r.data[n++]=c&268435455}return i}typeof navigator=="undefined"?($.prototype.am=Ty,Cn=28):Iy&&navigator.appName=="Microsoft Internet Explorer"?($.prototype.am=iR,Cn=30):Iy&&navigator.appName!="Netscape"?($.prototype.am=nR,Cn=26):($.prototype.am=Ty,Cn=28);$.prototype.DB=Cn;$.prototype.DM=(1<<Cn)-1;$.prototype.DV=1<<Cn;var Yl=52;$.prototype.FV=Math.pow(2,Yl);$.prototype.F1=Yl-Cn;$.prototype.F2=2*Cn-Yl;var sR="0123456789abcdefghijklmnopqrstuvwxyz",xc=new Array,Ps,br;Ps="0".charCodeAt(0);for(br=0;br<=9;++br)xc[Ps++]=br;Ps="a".charCodeAt(0);for(br=10;br<36;++br)xc[Ps++]=br;Ps="A".charCodeAt(0);for(br=10;br<36;++br)xc[Ps++]=br;function Ry(t){return sR.charAt(t)}function By(t,e){var r=xc[t.charCodeAt(e)];return r??-1}function oR(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function aR(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Qn(t){var e=Le();return e.fromInt(t),e}function cR(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,s=0;--n>=0;){var o=r==8?t[n]&255:By(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=o:s+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&$.ZERO.subTo(this,this)}function uR(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function lR(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(i=!0,s=Ry(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(i=!0),i&&(s+=Ry(n));return i?s:"0"}function fR(){var t=Le();return $.ZERO.subTo(this,t),t}function dR(){return this.s<0?this.negate():this}function hR(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Ac(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function pR(){return this.t<=0?0:this.DB*(this.t-1)+Ac(this.data[this.t-1]^this.s&this.DM)}function yR(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function gR(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function mR(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>n|o,o=(this.data[a]&i)<<r;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function vR(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&s)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<i),e.t=this.t-r,e.clamp()}function ER(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function bR(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&$.ZERO.subTo(e,e)}function wR(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function _R(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e!=null&&e.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Le());var s=Le(),o=this.s,a=t.s,c=this.DB-Ac(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,l=s.data[u-1];if(l!=0){var f=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),d=this.FV/f,p=(1<<this.F1)/f,h=1<<this.F2,g=r.t,v=g-u,w=e??Le();for(s.dlShiftTo(v,w),r.compareTo(w)>=0&&(r.data[r.t++]=1,r.subTo(w,r)),$.ONE.dlShiftTo(u,w),w.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--v>=0;){var C=r.data[--g]==l?this.DM:Math.floor(r.data[g]*d+(r.data[g-1]+h)*p);if((r.data[g]+=s.am(0,C,r,v,0,u))<C)for(s.dlShiftTo(v,w),r.subTo(w,r);r.data[g]<--C;)r.subTo(w,r)}e!=null&&(r.drShiftTo(u,e),o!=a&&$.ZERO.subTo(e,e)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&$.ZERO.subTo(r,r)}}}function SR(t){var e=Le();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo($.ZERO)>0&&t.subTo(e,e),e}function Oi(t){this.m=t}function xR(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function AR(t){return t}function CR(t){t.divRemTo(this.m,null,t)}function IR(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function TR(t,e){t.squareTo(e),this.reduce(e)}Oi.prototype.convert=xR;Oi.prototype.revert=AR;Oi.prototype.reduce=CR;Oi.prototype.mulTo=IR;Oi.prototype.sqrTo=TR;function RR(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Di(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function BR(t){var e=Le();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo($.ZERO)>0&&this.m.subTo(e,e),e}function PR(t){var e=Le();return t.copyTo(e),this.reduce(e),e}function NR(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function OR(t,e){t.squareTo(e),this.reduce(e)}function DR(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Di.prototype.convert=BR;Di.prototype.revert=PR;Di.prototype.reduce=NR;Di.prototype.mulTo=DR;Di.prototype.sqrTo=OR;function LR(){return(this.t>0?this.data[0]&1:this.s)==0}function kR(t,e){if(t>4294967295||t<1)return $.ONE;var r=Le(),n=Le(),i=e.convert(this),s=Ac(t)-1;for(i.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function qR(t,e){var r;return t<256||e.isEven()?r=new Oi(e):r=new Di(e),this.exp(t,r)}$.prototype.copyTo=oR;$.prototype.fromInt=aR;$.prototype.fromString=cR;$.prototype.clamp=uR;$.prototype.dlShiftTo=yR;$.prototype.drShiftTo=gR;$.prototype.lShiftTo=mR;$.prototype.rShiftTo=vR;$.prototype.subTo=ER;$.prototype.multiplyTo=bR;$.prototype.squareTo=wR;$.prototype.divRemTo=_R;$.prototype.invDigit=RR;$.prototype.isEven=LR;$.prototype.exp=kR;$.prototype.toString=lR;$.prototype.negate=fR;$.prototype.abs=dR;$.prototype.compareTo=hR;$.prototype.bitLength=pR;$.prototype.mod=SR;$.prototype.modPowInt=qR;$.ZERO=Qn(0);$.ONE=Qn(1);function UR(){var t=Le();return this.copyTo(t),t}function MR(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function FR(){return this.t==0?this.s:this.data[0]<<24>>24}function KR(){return this.t==0?this.s:this.data[0]<<16>>16}function VR(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function jR(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function $R(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Qn(r),i=Le(),s=Le(),o="";for(this.divRemTo(n,i,s);i.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,s);return s.intValue().toString(t)+o}function HR(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,s=0,o=0,a=0;a<t.length;++a){var c=By(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),i&&$.ZERO.subTo(this,this)}function zR(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo($.ONE.shiftLeft(t-1),Ql,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo($.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function GR(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function WR(t){return this.compareTo(t)==0}function YR(t){return this.compareTo(t)<0?this:t}function QR(t){return this.compareTo(t)>0?this:t}function XR(t,e,r){var n,i,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function ZR(t,e){return t&e}function JR(t){var e=Le();return this.bitwiseTo(t,ZR,e),e}function Ql(t,e){return t|e}function e4(t){var e=Le();return this.bitwiseTo(t,Ql,e),e}function Py(t,e){return t^e}function t4(t){var e=Le();return this.bitwiseTo(t,Py,e),e}function Ny(t,e){return t&~e}function r4(t){var e=Le();return this.bitwiseTo(t,Ny,e),e}function n4(){for(var t=Le(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function i4(t){var e=Le();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function s4(t){var e=Le();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function o4(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function a4(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+o4(this.data[t]);return this.s<0?this.t*this.DB:-1}function c4(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function u4(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=c4(this.data[r]^e);return t}function l4(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function f4(t,e){var r=$.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function d4(t){return this.changeBit(t,Ql)}function h4(t){return this.changeBit(t,Ny)}function p4(t){return this.changeBit(t,Py)}function y4(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function g4(t){var e=Le();return this.addTo(t,e),e}function m4(t){var e=Le();return this.subTo(t,e),e}function v4(t){var e=Le();return this.multiplyTo(t,e),e}function E4(t){var e=Le();return this.divRemTo(t,e,null),e}function b4(t){var e=Le();return this.divRemTo(t,null,e),e}function w4(t){var e=Le(),r=Le();return this.divRemTo(t,e,r),new Array(e,r)}function _4(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function S4(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Wo(){}function Oy(t){return t}function x4(t,e,r){t.multiplyTo(e,r)}function A4(t,e){t.squareTo(e)}Wo.prototype.convert=Oy;Wo.prototype.revert=Oy;Wo.prototype.mulTo=x4;Wo.prototype.sqrTo=A4;function C4(t){return this.exp(t,new Wo)}function I4(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function T4(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Ns(t){this.r2=Le(),this.q3=Le(),$.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function R4(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Le();return t.copyTo(e),this.reduce(e),e}function B4(t){return t}function P4(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function N4(t,e){t.squareTo(e),this.reduce(e)}function O4(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Ns.prototype.convert=R4;Ns.prototype.revert=B4;Ns.prototype.reduce=P4;Ns.prototype.mulTo=O4;Ns.prototype.sqrTo=N4;function D4(t,e){var r=t.bitLength(),n,i=Qn(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Oi(e):e.isEven()?s=new Ns(e):s=new Di(e);var o=new Array,a=3,c=n-1,u=(1<<n)-1;if(o[1]=s.convert(this),n>1){var l=Le();for(s.sqrTo(o[1],l);a<=u;)o[a]=Le(),s.mulTo(l,o[a-2],o[a]),a+=2}var f=t.t-1,d,p=!0,h=Le(),g;for(r=Ac(t.data[f])-1;f>=0;){for(r>=c?d=t.data[f]>>r-c&u:(d=(t.data[f]&(1<<r+1)-1)<<c-r,f>0&&(d|=t.data[f-1]>>this.DB+r-c)),a=n;(d&1)==0;)d>>=1,--a;if((r-=a)<0&&(r+=this.DB,--f),p)o[d].copyTo(i),p=!1;else{for(;a>1;)s.sqrTo(i,h),s.sqrTo(h,i),a-=2;a>0?s.sqrTo(i,h):(g=i,i=h,h=g),s.mulTo(h,o[d],i)}for(;f>=0&&(t.data[f]&1<<r)==0;)s.sqrTo(i,h),g=i,i=h,h=g,--r<0&&(r=this.DB-1,--f)}return s.revert(i)}function L4(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function k4(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function q4(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return $.ZERO;for(var r=t.clone(),n=this.clone(),i=Qn(1),s=Qn(0),o=Qn(0),a=Qn(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(t,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),s.subTo(a,s)):(n.subTo(r,n),e&&o.subTo(i,o),a.subTo(s,a))}if(n.compareTo($.ONE)!=0)return $.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var Kr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],U4=(1<<26)/Kr[Kr.length-1];function M4(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Kr[Kr.length-1]){for(e=0;e<Kr.length;++e)if(r.data[0]==Kr[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Kr.length;){for(var n=Kr[e],i=e+1;i<Kr.length&&n<U4;)n*=Kr[i++];for(n=r.modInt(n);e<i;)if(n%Kr[e++]==0)return!1}return r.millerRabin(t)}function F4(t){var e=this.subtract($.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=K4(),s,o=0;o<t;++o){do s=new $(this.bitLength(),i);while(s.compareTo($.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(n,this);if(a.compareTo($.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo($.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function K4(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}$.prototype.chunkSize=VR;$.prototype.toRadix=$R;$.prototype.fromRadix=HR;$.prototype.fromNumber=zR;$.prototype.bitwiseTo=XR;$.prototype.changeBit=f4;$.prototype.addTo=y4;$.prototype.dMultiply=_4;$.prototype.dAddOffset=S4;$.prototype.multiplyLowerTo=I4;$.prototype.multiplyUpperTo=T4;$.prototype.modInt=k4;$.prototype.millerRabin=F4;$.prototype.clone=UR;$.prototype.intValue=MR;$.prototype.byteValue=FR;$.prototype.shortValue=KR;$.prototype.signum=jR;$.prototype.toByteArray=GR;$.prototype.equals=WR;$.prototype.min=YR;$.prototype.max=QR;$.prototype.and=JR;$.prototype.or=e4;$.prototype.xor=t4;$.prototype.andNot=r4;$.prototype.not=n4;$.prototype.shiftLeft=i4;$.prototype.shiftRight=s4;$.prototype.getLowestSetBit=a4;$.prototype.bitCount=u4;$.prototype.testBit=l4;$.prototype.setBit=d4;$.prototype.clearBit=h4;$.prototype.flipBit=p4;$.prototype.add=g4;$.prototype.subtract=m4;$.prototype.multiply=v4;$.prototype.divide=E4;$.prototype.remainder=b4;$.prototype.divideAndRemainder=w4;$.prototype.modPow=D4;$.prototype.modInverse=q4;$.prototype.pow=C4;$.prototype.gcd=L4;$.prototype.isProbablePrime=M4});var My=b((wU,Uy)=>{var sn=_e();Yn();Qe();var Ly=Uy.exports=sn.sha1=sn.sha1||{};sn.md.sha1=sn.md.algorithms.sha1=Ly;Ly.create=function(){ky||V4();var t=null,e=sn.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return e=sn.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=sn.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),qy(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=sn.util.createBuffer();i.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=s&n.blockLength-1;i.putBytes(Xl.substr(0,n.blockLength-o));for(var a,c,u=n.fullMessageLength[0]*8,l=0;l<n.fullMessageLength.length-1;++l)a=n.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var f={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};qy(f,r,i);var d=sn.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},n};var Xl=null,ky=!1;function V4(){Xl=String.fromCharCode(128),Xl+=sn.util.fillString(String.fromCharCode(0),64),ky=!0}function qy(t,e,r){for(var n,i,s,o,a,c,u,l,f=r.length();f>=64;){for(i=t.h0,s=t.h1,o=t.h2,a=t.h3,c=t.h4,l=0;l<16;++l)n=r.getInt32(),e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<20;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=a^s&(o^a),n=(i<<5|i>>>27)+u+c+1518500249+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<32;++l)n=e[l-3]^e[l-8]^e[l-14]^e[l-16],n=n<<1|n>>>31,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<40;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+1859775393+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<60;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s&o|a&(s^o),n=(i<<5|i>>>27)+u+c+2400959708+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;for(;l<80;++l)n=e[l-6]^e[l-16]^e[l-28]^e[l-32],n=n<<2|n>>>30,e[l]=n,u=s^o^a,n=(i<<5|i>>>27)+u+c+3395469782+n,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+s|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,f-=64}}});var Vy=b((_U,Ky)=>{var on=_e();Qe();Ni();My();var Fy=Ky.exports=on.pkcs1=on.pkcs1||{};Fy.encode_rsa_oaep=function(t,e,r){var n,i,s,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),s?s.start():s=on.md.sha1.create(),o||(o=s);var a=Math.ceil(t.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var l=s.digest(),f="",d=c-e.length,p=0;p<d;p++)f+="\0";var h=l.getBytes()+f+""+e;if(!i)i=on.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var g=Ic(i,a-s.digestLength-1,o),v=on.util.xorBytes(h,g,h.length),w=Ic(v,s.digestLength,o),C=on.util.xorBytes(i,w,i.length);return"\0"+C+v};Fy.decode_rsa_oaep=function(t,e,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=o,v}if(i===void 0?i=on.md.sha1.create():i.start(),s||(s=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),c=e.charAt(0),u=e.substring(1,i.digestLength+1),l=e.substring(1+i.digestLength),f=Ic(l,i.digestLength,s),d=on.util.xorBytes(u,f,u.length),p=Ic(d,o-i.digestLength-1,s),h=on.util.xorBytes(l,p,l.length),g=h.substring(0,i.digestLength),v=c!=="\0",w=0;w<i.digestLength;++w)v|=a.charAt(w)!==g.charAt(w);for(var C=1,q=i.digestLength,W=i.digestLength;W<h.length;W++){var F=h.charCodeAt(W),M=F&1^1,re=C?65534:0;v|=F&re,C=C&M,q+=C}if(v||h.charCodeAt(q)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(q+1)};function Ic(t,e,r){r||(r=on.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),s=0;s<i;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var jy=b((SU,Zl)=>{var Xn=_e();Qe();Cc();Ni();(function(){if(Xn.prime){Zl.exports=Xn.prime;return}var t=Zl.exports=Xn.prime=Xn.prime||{},e=Xn.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(f,d){return f|d};t.generateProbablePrime=function(f,d,p){typeof d=="function"&&(p=d,d={}),d=d||{};var h=d.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=d.prng||Xn.random,v={nextBytes:function(w){for(var C=g.getBytesSync(w.length),q=0;q<w.length;++q)w[q]=C.charCodeAt(q)}};if(h.name==="PRIMEINC")return s(f,v,h.options,p);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(f,d,p,h){return"workers"in p?c(f,d,p,h):o(f,d,p,h)}function o(f,d,p,h){var g=u(f,d),v=0,w=l(g.bitLength());"millerRabinTests"in p&&(w=p.millerRabinTests);var C=10;"maxBlockTime"in p&&(C=p.maxBlockTime),a(g,f,d,v,w,C,h)}function a(f,d,p,h,g,v,w){var C=+new Date;do{if(f.bitLength()>d&&(f=u(d,p)),f.isProbablePrime(g))return w(null,f);f.dAddOffset(r[h++%8],0)}while(v<0||+new Date-C<v);Xn.util.setImmediate(function(){a(f,d,p,h,g,v,w)})}function c(f,d,p,h){if(typeof Worker=="undefined")return o(f,d,p,h);var g=u(f,d),v=p.workers,w=p.workLoad||100,C=w*30/8,q=p.workerScript||"forge/prime.worker.js";if(v===-1)return Xn.util.estimateCores(function(F,M){F&&(M=2),v=M-1,W()});W();function W(){v=Math.max(1,v);for(var F=[],M=0;M<v;++M)F[M]=new Worker(q);for(var re=v,M=0;M<v;++M)F[M].addEventListener("message",z);var ie=!1;function z(Ae){if(!ie){--re;var ye=Ae.data;if(ye.found){for(var be=0;be<F.length;++be)F[be].terminate();return ie=!0,h(null,new e(ye.prime,16))}g.bitLength()>f&&(g=u(f,d));var ft=g.toString(16);Ae.target.postMessage({hex:ft,workLoad:w}),g.dAddOffset(C,0)}}}}function u(f,d){var p=new e(f,d),h=f-1;return p.testBit(h)||p.bitwiseTo(e.ONE.shiftLeft(h),i,p),p.dAddOffset(31-p.mod(n).byteValue(),0),p}function l(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})()});var Yo=b((xU,Qy)=>{var le=_e();Wn();Cc();Cs();Vy();jy();Ni();Qe();typeof Be=="undefined"&&(Be=le.jsbn.BigInteger);var Be,Jl=le.util.isNodejs?Bs():null,N=le.asn1,wr=le.util;le.pki=le.pki||{};Qy.exports=le.pki.rsa=le.rsa=le.rsa||{};var me=le.pki,j4=[6,4,2,4,2,4,6,2],$4={name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},H4={name:"RSAPrivateKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},z4={name:"RSAPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},G4=le.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},W4={name:"DigestInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:N.Class.UNIVERSAL,type:N.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Y4=function(t){var e;if(t.algorithm in me.oids)e=me.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=N.oidToDer(e).getBytes(),i=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]),s=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);s.value.push(N.create(N.Class.UNIVERSAL,N.Type.OID,!1,n)),s.value.push(N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,""));var o=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(s),i.value.push(o),N.toDer(i).getBytes()},$y=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Be.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Be.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Be(le.util.bytesToHex(le.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Be.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(s)<0;)i=i.add(e.p);var o=i.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};me.rsa.encrypt=function(t,e,r){var n=r,i,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Hy(t,e,r)):(i=le.util.createBuffer(),i.putBytes(t));for(var o=new Be(i.toHex(),16),a=$y(o,e,n),c=a.toString(16),u=le.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(le.util.hexToBytes(c)),u.getBytes()};me.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=i,s}var o=new Be(le.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=$y(o,e,r),c=a.toString(16),u=le.util.createBuffer(),l=i-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(le.util.hexToBytes(c)),n!==!1?Tc(u.getBytes(),e,r):u.getBytes()};me.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||le.random,i={nextBytes:function(a){for(var c=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:t,rng:i,eInt:e||65537,e:new Be(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};me.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Be(null);r.fromInt(30);for(var n=0,i=function(f,d){return f|d},s=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,u=c-1;t.pqState===0?(t.num=new Be(c,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Be.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(X4(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(j4[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Be.ONE).gcd(t.e).compareTo(Be.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Be.ONE),t.q1=t.q.subtract(Be.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Be.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var l=t.e.modInverse(t.phi);t.keys={privateKey:me.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:me.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-s,s=o}return t.keys!==null};me.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!le.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(zy("generateKeyPair"))return Jl.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return n(a);n(null,{privateKey:me.privateKeyFromPem(u),publicKey:me.publicKeyFromPem(c)})});if(Gy("generateKey")&&Gy("exportKey"))return wr.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Yy(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return wr.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=me.privateKeyFromAsn1(N.fromDer(le.util.createBuffer(a)));n(null,{privateKey:c,publicKey:me.setRsaPublicKey(c.n,c.e)})}});if(Wy("generateKey")&&Wy("exportKey")){var i=wr.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Yy(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var c=a.target.result,u=wr.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var f=l.target.result,d=me.privateKeyFromAsn1(N.fromDer(le.util.createBuffer(f)));n(null,{privateKey:d,publicKey:me.setRsaPublicKey(d.n,d.e)})},u.onerror=function(l){n(l)}},i.onerror=function(a){n(a)};return}}else if(zy("generateKeyPairSync")){var s=Jl.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:me.privateKeyFromPem(s.privateKey),publicKey:me.publicKeyFromPem(s.publicKey)}}}var o=me.rsa.createKeyPairGenerationState(t,e,r);if(!n)return me.rsa.stepKeyPairGenerationState(o,0),o.keys;Q4(o,r,n)};me.setRsaPublicKey=me.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,c,u){return Hy(a,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,c){return le.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return me.rsa.encrypt(o,r,!0)},r.verify=function(n,i,s,o){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=Tc(u,r,!0);var l=N.fromDer(u,{parseAllBytes:o._parseAllDigestBytes}),f={},d=[];if(!N.validate(l,W4,f,d)){var p=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw p.errors=d,p}var h=N.derToOid(f.algorithmIdentifier);if(!(h===le.oids.md2||h===le.oids.md5||h===le.oids.sha1||h===le.oids.sha224||h===le.oids.sha256||h===le.oids.sha384||h===le.oids.sha512||h===le.oids["sha512-224"]||h===le.oids["sha512-256"])){var p=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw p.oid=h,p}if((h===le.oids.md2||h===le.oids.md5)&&!("parameters"in f))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===f.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=Tc(u,r,!0),c===u}});var a=me.rsa.decrypt(i,r,!0,!1);return s.verify(n,a,r.n.bitLength())},r};me.setRsaPrivateKey=me.rsa.setPrivateKey=function(t,e,r,n,i,s,o,a){var c={n:t,e,d:r,p:n,q:i,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,f){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var d=me.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:Tc};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,h){return le.pkcs1.decode_rsa_oaep(h,p,f)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(d,c,!1)},c.sign=function(u,l){var f=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:Y4},f=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},f=1);var d=l.encode(u,c.n.bitLength());return me.rsa.encrypt(d,c,f)},c};me.wrapRsaPrivateKey=function(t){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(0).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(me.oids.rsaEncryption).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,N.toDer(t).getBytes())])};me.privateKeyFromAsn1=function(t){var e={},r=[];if(N.validate(t,$4,e,r)&&(t=N.fromDer(le.util.createBuffer(e.privateKey))),e={},r=[],!N.validate(t,H4,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,o,a,c,u,l,f;return i=le.util.createBuffer(e.privateKeyModulus).toHex(),s=le.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=le.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=le.util.createBuffer(e.privateKeyPrime1).toHex(),c=le.util.createBuffer(e.privateKeyPrime2).toHex(),u=le.util.createBuffer(e.privateKeyExponent1).toHex(),l=le.util.createBuffer(e.privateKeyExponent2).toHex(),f=le.util.createBuffer(e.privateKeyCoefficient).toHex(),me.setRsaPrivateKey(new Be(i,16),new Be(s,16),new Be(o,16),new Be(a,16),new Be(c,16),new Be(u,16),new Be(l,16),new Be(f,16))};me.privateKeyToAsn1=me.privateKeyToRSAPrivateKey=function(t){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(0).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.n)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.e)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.d)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.p)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.q)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.dP)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.dQ)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.qInv))])};me.publicKeyFromAsn1=function(t){var e={},r=[];if(N.validate(t,G4,e,r)){var n=N.derToOid(e.publicKeyOid);if(n!==me.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!N.validate(t,z4,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=le.util.createBuffer(e.publicKeyModulus).toHex(),o=le.util.createBuffer(e.publicKeyExponent).toHex();return me.setRsaPublicKey(new Be(s,16),new Be(o,16))};me.publicKeyToAsn1=me.publicKeyToSubjectPublicKeyInfo=function(t){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(me.oids.rsaEncryption).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,[me.publicKeyToRSAPublicKey(t)])])};me.publicKeyToRSAPublicKey=function(t){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.n)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,an(t.e))])};function Hy(t,e,r){var n=le.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var o=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var u=0,l=le.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:n.putByte(a);o=u}return n.putByte(0),n.putBytes(t),n}function Tc(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),s=le.util.createBuffer(t),o=s.getByte(),a=s.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Q4(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){s(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);s(t.qBits,o)})}function s(a,c){le.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Be.ONE).gcd(t.e).compareTo(Be.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Be.ONE).gcd(t.e).compareTo(Be.ONE)!==0){t.q=null,s(t.qBits,o);return}if(t.p1=t.p.subtract(Be.ONE),t.q1=t.q.subtract(Be.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Be.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,o);return}var l=t.e.modInverse(t.phi);t.keys={privateKey:me.rsa.setPrivateKey(t.n,t.e,l,t.p,t.q,l.mod(t.p1),l.mod(t.q1),t.q.modInverse(t.p)),publicKey:me.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function an(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=le.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)==0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)==128)?r.substr(1):r}function X4(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function zy(t){return le.util.isNodejs&&typeof Jl[t]=="function"}function Gy(t){return typeof wr.globalScope!="undefined"&&typeof wr.globalScope.crypto=="object"&&typeof wr.globalScope.crypto.subtle=="object"&&typeof wr.globalScope.crypto.subtle[t]=="function"}function Wy(t){return typeof wr.globalScope!="undefined"&&typeof wr.globalScope.msCrypto=="object"&&typeof wr.globalScope.msCrypto.subtle=="object"&&typeof wr.globalScope.msCrypto.subtle[t]=="function"}function Yy(t){for(var e=le.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var ef=b((AU,tg)=>{var te=_e();Rs();Wn();vc();Yn();Cs();$l();_c();Ni();Cy();Yo();Qe();typeof Xy=="undefined"&&(Xy=te.jsbn.BigInteger);var Xy,K=te.asn1,Ee=te.pki=te.pki||{};tg.exports=Ee.pbe=te.pbe=te.pbe||{};var Li=Ee.oids,Z4={name:"EncryptedPrivateKeyInfo",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:K.Class.UNIVERSAL,type:K.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:K.Class.UNIVERSAL,type:K.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},J4={name:"PBES2Algorithms",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:K.Class.UNIVERSAL,type:K.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:K.Class.UNIVERSAL,type:K.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:K.Class.UNIVERSAL,type:K.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:K.Class.UNIVERSAL,type:K.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:K.Class.UNIVERSAL,type:K.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:K.Class.UNIVERSAL,type:K.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:K.Class.UNIVERSAL,type:K.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},eB={name:"pkcs-12PbeParams",tagClass:K.Class.UNIVERSAL,type:K.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:K.Class.UNIVERSAL,type:K.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:K.Class.UNIVERSAL,type:K.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ee.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=te.random.getBytesSync(r.saltSize),i=r.count,s=K.integerToDer(i),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,l,f;switch(r.algorithm){case"aes128":o=16,u=16,l=Li["aes128-CBC"],f=te.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=Li["aes192-CBC"],f=te.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=Li["aes256-CBC"],f=te.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=Li.desCBC,f=te.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),h=eg(p),g=te.pkcs5.pbkdf2(e,n,i,o,h),v=te.random.getBytesSync(u),w=f(g);w.start(v),w.update(K.toDer(t)),w.finish(),c=w.output.getBytes();var C=tB(n,s,o,p);a=K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(Li.pkcs5PBES2).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(Li.pkcs5PBKDF2).getBytes()),C]),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(l).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){o=24;var q=new te.util.ByteBuffer(n),g=Ee.pbe.generatePkcs12Key(e,q,1,i,o),v=Ee.pbe.generatePkcs12Key(e,q,2,i,o),w=te.des.createEncryptionCipher(g);w.start(v),w.update(K.toDer(t)),w.finish(),c=w.output.getBytes(),a=K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(Li["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,n),K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var W=K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[a,K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,c)]);return W};Ee.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!K.validate(t,Z4,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=K.derToOid(n.encryptionOid),a=Ee.pbe.getCipher(o,n.encryptionParams,e),c=te.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=K.fromDer(a.output)),r};Ee.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:K.toDer(t).getBytes()};return te.pem.encode(r,{maxline:e})};Ee.encryptedPrivateKeyFromPem=function(t){var e=te.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return K.fromDer(e.body)};Ee.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=Ee.wrapRsaPrivateKey(Ee.privateKeyToAsn1(t));return n=Ee.encryptPrivateKeyInfo(n,e,r),Ee.encryptedPrivateKeyToPem(n)}var i,s,o,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,s=te.random.getBytesSync(16),a=te.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,s=te.random.getBytesSync(16),a=te.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,s=te.random.getBytesSync(16),a=te.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,s=te.random.getBytesSync(8),a=te.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,s=te.random.getBytesSync(8),a=te.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=te.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(K.toDer(Ee.privateKeyToAsn1(t))),l.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:te.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return te.pem.encode(f)};Ee.decryptRsaPrivateKey=function(t,e){var r=null,n=te.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,o;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,o=te.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=te.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=te.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=te.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=te.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(f){return te.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,o=function(f){return te.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,o=function(f){return te.rc2.createDecryptionCipher(f,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=te.util.hexToBytes(n.dekInfo.parameters),c=te.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(te.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Ee.decryptPrivateKeyInfo(K.fromDer(r),e):r=K.fromDer(r),r!==null&&(r=Ee.privateKeyFromAsn1(r)),r};Ee.pbe.generatePkcs12Key=function(t,e,r,n,i,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in te.md))throw new Error('"sha1" hash algorithm unavailable.');s=te.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new te.util.ByteBuffer,f=new te.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)f.putInt16(t.charCodeAt(a));f.putInt16(0)}var d=f.length(),p=e.length(),h=new te.util.ByteBuffer;h.fillWithByte(r,u);var g=u*Math.ceil(p/u),v=new te.util.ByteBuffer;for(a=0;a<g;a++)v.putByte(e.at(a%p));var w=u*Math.ceil(d/u),C=new te.util.ByteBuffer;for(a=0;a<w;a++)C.putByte(f.at(a%d));var q=v;q.putBuffer(C);for(var W=Math.ceil(i/c),F=1;F<=W;F++){var M=new te.util.ByteBuffer;M.putBytes(h.bytes()),M.putBytes(q.bytes());for(var re=0;re<n;re++)s.start(),s.update(M.getBytes()),M=s.digest();var ie=new te.util.ByteBuffer;for(a=0;a<u;a++)ie.putByte(M.at(a%c));var z=Math.ceil(p/u)+Math.ceil(d/u),Ae=new te.util.ByteBuffer;for(o=0;o<z;o++){var ye=new te.util.ByteBuffer(q.getBytes(u)),be=511;for(a=ie.length()-1;a>=0;a--)be=be>>8,be+=ie.at(a)+ye.at(a),ye.setAt(a,be&255);Ae.putBuffer(ye)}q=Ae,l.putBuffer(M)}return l.truncate(l.length()-i),l};Ee.pbe.getCipher=function(t,e,r){switch(t){case Ee.oids.pkcs5PBES2:return Ee.pbe.getCipherForPBES2(t,e,r);case Ee.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ee.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ee.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Ee.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!K.validate(e,J4,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(t=K.derToOid(n.kdfOid),t!==Ee.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=K.derToOid(n.encOid),t!==Ee.oids["aes128-CBC"]&&t!==Ee.oids["aes192-CBC"]&&t!==Ee.oids["aes256-CBC"]&&t!==Ee.oids["des-EDE3-CBC"]&&t!==Ee.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=n.kdfSalt,a=te.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(Ee.oids[t]){case"aes128-CBC":c=16,u=te.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=te.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=te.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=te.des.createDecryptionCipher;break;case"desCBC":c=8,u=te.des.createDecryptionCipher;break}var l=Jy(n.prfOid),f=te.pkcs5.pbkdf2(r,o,a,c,l),d=n.encIv,p=u(f);return p.start(d),p};Ee.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!K.validate(e,eB,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var o=te.util.createBuffer(n.salt),a=te.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(t){case Ee.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=te.des.startDecrypting;break;case Ee.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(g,v){var w=te.rc2.createDecryptionCipher(g,40);return w.start(v,null),w};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var f=Jy(n.prfOid),d=Ee.pbe.generatePkcs12Key(r,o,1,a,c,f);f.start();var p=Ee.pbe.generatePkcs12Key(r,o,2,a,u,f);return l(d,p)};Ee.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n=="undefined"||n===null){if(!("md5"in te.md))throw new Error('"md5" hash algorithm unavailable.');n=te.md.md5.create()}e===null&&(e="");for(var i=[Zy(n,t+e)],s=16,o=1;s<r;++o,s+=16)i.push(Zy(n,i[o-1]+t+e));return i.join("").substr(0,r)};function Zy(t,e){return t.start().update(e).digest().getBytes()}function Jy(t){var e;if(!t)e="hmacWithSHA1";else if(e=Ee.oids[K.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return eg(e)}function eg(t){var e=te.md;switch(t){case"hmacWithSHA224":e=te.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function tB(t,e,r,n){var i=K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,t),K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,te.util.hexToBytes(r.toString(16))),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(Ee.oids[n]).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.NULL,!1,"")])),i}});var tf={};_t(tf,{identity:()=>rB});var rB,rg=Te(()=>{Xr();Un();rB=tc({prefix:"\0",name:"identity",encode:t=>L0(t),decode:t=>D0(t)})});var rf={};_t(rf,{base2:()=>nB});var nB,ng=Te(()=>{Xr();nB=pt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var nf={};_t(nf,{base8:()=>iB});var iB,ig=Te(()=>{Xr();iB=pt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var sf={};_t(sf,{base10:()=>sB});var sB,sg=Te(()=>{Xr();sB=Fn({prefix:"9",name:"base10",alphabet:"0123456789"})});var of,og,af=Te(()=>{Ai();of=({name:t,code:e,encode:r})=>new og(t,e,r),og=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Mn(this.code,r):r.then(n=>Mn(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var Zn={};_t(Zn,{sha256:()=>oB,sha512:()=>aB});var cg,oB,aB,ki=Te(()=>{af();cg=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),oB=of({name:"sha2-256",code:18,encode:cg("SHA-256")}),aB=of({name:"sha2-512",code:19,encode:cg("SHA-512")})});var Qo={};_t(Qo,{identity:()=>lB});var ug,cB,lg,uB,lB,Rc=Te(()=>{Un();Ai();ug=0,cB="identity",lg=_n,uB=t=>Mn(ug,lg(t)),lB={code:ug,name:cB,encode:lg,digest:uB}});var fg=Te(()=>{Un()});var kU,qU,dg=Te(()=>{kU=new TextEncoder,qU=new TextDecoder});var hg=Te(()=>{Ss();ec();Un();af();Ai()});var cf,KU,pg=Te(()=>{rg();ng();ig();sg();vl();Ii();ml();Vn();Ko();ki();Rc();fg();dg();hg();cf={...tf,...rf,...nf,...sf,...sc,...Ci,...ic,...Kn,...xs},KU={...Zn,...Qo}});function yg(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var gg,uf,hB,Bc,lf=Te(()=>{pg();gg=yg("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),uf=yg("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),hB={utf8:gg,"utf-8":gg,hex:cf.base16,latin1:uf,ascii:uf,binary:uf,...cf},Bc=hB});var Ft={};_t(Ft,{fromString:()=>ff});function ff(t,e="utf8"){let r=Bc[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var Dt=Te(()=>{lf()});var Jn={};_t(Jn,{concat:()=>pB});function pB(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var ei=Te(()=>{});var Xo=b(mg=>{"use strict";mg.get=(t=globalThis)=>{let e=t.crypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var df=b((GU,Eg)=>{"use strict";var{concat:yB}=(ei(),Jn),{fromString:vg}=(Dt(),Ft),gB=Xo();function mB({algorithm:t="AES-GCM",nonceLength:e=12,keyLength:r=16,digest:n="SHA-256",saltLength:i=16,iterations:s=32767}={}){let o=gB.get();r*=8;async function a(u,l){let f=o.getRandomValues(new Uint8Array(i)),d=o.getRandomValues(new Uint8Array(e)),p={name:t,iv:d},h={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},g=await o.subtle.importKey("raw",vg(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(h,g,{name:t,length:r},!0,["encrypt"]),w=await o.subtle.encrypt(p,v,u);return yB([f,p.iv,new Uint8Array(w)])}async function c(u,l){let f=u.slice(0,i),d=u.slice(i,i+e),p=u.slice(i+e),h={name:t,iv:d},g={name:"PBKDF2",salt:f,iterations:s,hash:{name:n}},v=await o.subtle.importKey("raw",vg(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),w=await o.subtle.deriveKey(g,v,{name:t,length:r},!0,["decrypt"]),C=await o.subtle.decrypt(h,w,p);return new Uint8Array(C)}return{encrypt:a,decrypt:c}}Eg.exports={create:mB}});var wg=b((WU,bg)=>{"use strict";var{base64:vB}=(Ko(),xs),EB=df();bg.exports={import:async function(t,e){let r=vB.decode(t);return await EB.create().decrypt(r,e)}}});var _r={};_t(_r,{equals:()=>bB});function bB(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Sr=Te(()=>{});var Kt={};_t(Kt,{toString:()=>hf});function hf(t,e="utf8"){let r=Bc[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var Lt=Te(()=>{lf()});var gf=b((QU,Ag)=>{var tt=_e();Yn();Qe();var Zo=Ag.exports=tt.sha512=tt.sha512||{};tt.md.sha512=tt.md.algorithms.sha512=Zo;var _g=tt.sha384=tt.sha512.sha384=tt.sha512.sha384||{};_g.create=function(){return Zo.create("SHA-384")};tt.md.sha384=tt.md.algorithms.sha384=_g;tt.sha512.sha256=tt.sha512.sha256||{create:function(){return Zo.create("SHA-512/256")}};tt.md["sha512/256"]=tt.md.algorithms["sha512/256"]=tt.sha512.sha256;tt.sha512.sha224=tt.sha512.sha224||{create:function(){return Zo.create("SHA-512/224")}};tt.md["sha512/224"]=tt.md.algorithms["sha512/224"]=tt.sha512.sha224;Zo.create=function(t){if(Sg||wB(),typeof t=="undefined"&&(t="SHA-512"),!(t in qi))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=qi[t],r=null,n=tt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);n=tt.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=tt.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var f=a.fullMessageLength.length-1;f>=0;--f)a.fullMessageLength[f]+=l[1],l[1]=l[0]+(a.fullMessageLength[f]/4294967296>>>0),a.fullMessageLength[f]=a.fullMessageLength[f]>>>0,l[0]=l[1]/4294967296>>>0;return n.putBytes(c),xg(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=tt.util.createBuffer();c.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(pf.substr(0,a.blockLength-l));for(var f,d,p=a.fullMessageLength[0]*8,h=0;h<a.fullMessageLength.length-1;++h)f=a.fullMessageLength[h+1]*8,d=f/4294967296>>>0,p+=d,c.putInt32(p>>>0),p=f>>>0;c.putInt32(p);for(var g=new Array(r.length),h=0;h<r.length;++h)g[h]=r[h].slice(0);xg(g,i,c);var v=tt.util.createBuffer(),w;t==="SHA-512"?w=g.length:t==="SHA-384"?w=g.length-2:w=g.length-4;for(var h=0;h<w;++h)v.putInt32(g[h][0]),(h!==w-1||t!=="SHA-512/224")&&v.putInt32(g[h][1]);return v},a};var pf=null,Sg=!1,yf=null,qi=null;function wB(){pf=String.fromCharCode(128),pf+=tt.util.fillString(String.fromCharCode(0),128),yf=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],qi={},qi["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],qi["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],qi["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],qi["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Sg=!0}function xg(t,e,r){for(var n,i,s,o,a,c,u,l,f,d,p,h,g,v,w,C,q,W,F,M,re,ie,z,Ae,ye,be,ft,bt,Fe,$e,se,Jt,Ot,wn,er,Qr=r.length();Qr>=128;){for(Fe=0;Fe<16;++Fe)e[Fe][0]=r.getInt32()>>>0,e[Fe][1]=r.getInt32()>>>0;for(;Fe<80;++Fe)Jt=e[Fe-2],$e=Jt[0],se=Jt[1],n=(($e>>>19|se<<13)^(se>>>29|$e<<3)^$e>>>6)>>>0,i=(($e<<13|se>>>19)^(se<<3|$e>>>29)^($e<<26|se>>>6))>>>0,wn=e[Fe-15],$e=wn[0],se=wn[1],s=(($e>>>1|se<<31)^($e>>>8|se<<24)^$e>>>7)>>>0,o=(($e<<31|se>>>1)^($e<<24|se>>>8)^($e<<25|se>>>7))>>>0,Ot=e[Fe-7],er=e[Fe-16],se=i+Ot[1]+o+er[1],e[Fe][0]=n+Ot[0]+s+er[0]+(se/4294967296>>>0)>>>0,e[Fe][1]=se>>>0;for(g=t[0][0],v=t[0][1],w=t[1][0],C=t[1][1],q=t[2][0],W=t[2][1],F=t[3][0],M=t[3][1],re=t[4][0],ie=t[4][1],z=t[5][0],Ae=t[5][1],ye=t[6][0],be=t[6][1],ft=t[7][0],bt=t[7][1],Fe=0;Fe<80;++Fe)u=((re>>>14|ie<<18)^(re>>>18|ie<<14)^(ie>>>9|re<<23))>>>0,l=((re<<18|ie>>>14)^(re<<14|ie>>>18)^(ie<<23|re>>>9))>>>0,f=(ye^re&(z^ye))>>>0,d=(be^ie&(Ae^be))>>>0,a=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,c=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,p=(g&w|q&(g^w))>>>0,h=(v&C|W&(v^C))>>>0,se=bt+l+d+yf[Fe][1]+e[Fe][1],n=ft+u+f+yf[Fe][0]+e[Fe][0]+(se/4294967296>>>0)>>>0,i=se>>>0,se=c+h,s=a+p+(se/4294967296>>>0)>>>0,o=se>>>0,ft=ye,bt=be,ye=z,be=Ae,z=re,Ae=ie,se=M+i,re=F+n+(se/4294967296>>>0)>>>0,ie=se>>>0,F=q,M=W,q=w,W=C,w=g,C=v,se=i+o,g=n+s+(se/4294967296>>>0)>>>0,v=se>>>0;se=t[0][1]+v,t[0][0]=t[0][0]+g+(se/4294967296>>>0)>>>0,t[0][1]=se>>>0,se=t[1][1]+C,t[1][0]=t[1][0]+w+(se/4294967296>>>0)>>>0,t[1][1]=se>>>0,se=t[2][1]+W,t[2][0]=t[2][0]+q+(se/4294967296>>>0)>>>0,t[2][1]=se>>>0,se=t[3][1]+M,t[3][0]=t[3][0]+F+(se/4294967296>>>0)>>>0,t[3][1]=se>>>0,se=t[4][1]+ie,t[4][0]=t[4][0]+re+(se/4294967296>>>0)>>>0,t[4][1]=se>>>0,se=t[5][1]+Ae,t[5][0]=t[5][0]+z+(se/4294967296>>>0)>>>0,t[5][1]=se>>>0,se=t[6][1]+be,t[6][0]=t[6][0]+ye+(se/4294967296>>>0)>>>0,t[6][1]=se>>>0,se=t[7][1]+bt,t[7][0]=t[7][0]+ft+(se/4294967296>>>0)>>>0,t[7][1]=se>>>0,Qr-=128}}});var Ig=b((XU,Cg)=>{"use strict";var Pc=65536;function _B(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>Pc)for(;r<t;)r+Pc>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+Pc)),r+=Pc);else crypto.getRandomValues(e);return e}Cg.exports=_B});var Nc=b((ZU,Tg)=>{"use strict";var SB=Ig(),xB=ge();Tg.exports=function(t){if(isNaN(t)||t<=0)throw xB(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return SB(t)}});var Oc=b(Jo=>{"use strict";Qe();Cc();var AB=_e(),{fromString:CB}=(Dt(),Ft),{toString:Rg}=(Lt(),Kt),{concat:Bg}=(ei(),Jn);Jo.bigIntegerToUintBase64url=(t,e)=>{let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Bg([new Uint8Array(e-r.length),r])}return Rg(r,"base64url")};Jo.base64urlToBigInteger=t=>{let e=Jo.base64urlToBuffer(t);return new AB.jsbn.BigInteger(Rg(e,"base16"),16)};Jo.base64urlToBuffer=(t,e)=>{let r=CB(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Bg([new Uint8Array(e-r.length),r])}return r}});var Og=b(ea=>{"use strict";Wn();Yo();var ti=_e(),{bigIntegerToUintBase64url:cn,base64urlToBigInteger:un}=Oc(),{fromString:Pg}=(Dt(),Ft),{toString:Ng}=(Lt(),Kt);ea.pkcs1ToJwk=function(t){let e=ti.asn1.fromDer(Ng(t,"ascii")),r=ti.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:cn(r.n),e:cn(r.e),d:cn(r.d),p:cn(r.p),q:cn(r.q),dp:cn(r.dP),dq:cn(r.dQ),qi:cn(r.qInv),alg:"RS256",kid:"2011-04-29"}};ea.jwkToPkcs1=function(t){let e=ti.pki.privateKeyToAsn1({n:un(t.n),e:un(t.e),d:un(t.d),p:un(t.p),q:un(t.q),dP:un(t.dp),dQ:un(t.dq),qInv:un(t.qi)});return Pg(ti.asn1.toDer(e).getBytes(),"ascii")};ea.pkixToJwk=function(t){let e=ti.asn1.fromDer(Ng(t,"ascii")),r=ti.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:cn(r.n),e:cn(r.e),alg:"RS256",kid:"2011-04-29"}};ea.jwkToPkix=function(t){let e=ti.pki.publicKeyToAsn1({n:un(t.n),e:un(t.e)});return Pg(ti.asn1.toDer(e).getBytes(),"ascii")}});var qg=b((tM,kg)=>{"use strict";Yo();var Dg=_e(),{base64urlToBigInteger:IB}=Oc();function Lg(t,e){return e.map(r=>IB(t[r]))}function TB(t){return Dg.pki.setRsaPrivateKey(...Lg(t,["n","e","d","p","q","dp","dq","qi"]))}function RB(t){return Dg.pki.setRsaPublicKey(...Lg(t,["n","e"]))}kg.exports={jwk2pub:RB,jwk2priv:TB}});var Fg=b(Tn=>{"use strict";var In=Xo(),BB=Nc(),{toString:PB}=(Lt(),Kt),{fromString:NB}=(Dt(),Ft);Tn.utils=Og();Tn.generateKey=async function(t){let e=await In.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Ug(e);return{privateKey:r[0],publicKey:r[1]}};Tn.unmarshalPrivateKey=async function(t){let r=[await In.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await OB(t)],n=await Ug({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}};Tn.getRandomValues=BB;Tn.hashAndSign=async function(t,e){let r=await In.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await In.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,n.byteOffset,n.byteLength)};Tn.hashAndVerify=async function(t,e,r){let n=await In.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return In.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)};function Ug(t){return Promise.all([In.get().subtle.exportKey("jwk",t.privateKey),In.get().subtle.exportKey("jwk",t.publicKey)])}function OB(t){return In.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:DB,jwk2priv:LB}=qg();function Mg(t,e,r,n){let i=e?DB(t):LB(t),s=PB(Uint8Array.from(r),"ascii"),o=n(s,i);return NB(o,"ascii")}Tn.encrypt=function(t,e){return Mg(t,!0,e,(r,n)=>n.encrypt(r))};Tn.decrypt=function(t,e){return Mg(t,!1,e,(r,n)=>n.decrypt(r))}});var Dc=b((nM,Kg)=>{"use strict";var{base64:kB}=(Ko(),xs),qB=df();Kg.exports={export:async function(t,e){let n=await qB.create().encrypt(t,e);return kB.encode(n)}}});var zg=b((iM,Hg)=>{"use strict";var{sha256:Vg}=(ki(),Zn),jg=ge(),{equals:$g}=(Sr(),_r),{toString:UB}=(Lt(),Kt);gf();var Lc=_e(),xr=Fg(),kc=fc(),MB=Dc(),qc=class{constructor(e){this._key=e}async verify(e,r){return xr.hashAndVerify(this._key,r,e)}marshal(){return xr.utils.jwkToPkix(this._key)}get bytes(){return kc.PublicKey.encode({Type:kc.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return xr.encrypt(this._key,e)}equals(e){return $g(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vg.digest(this.bytes);return e}},ta=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return xr.getRandomValues(16)}async sign(e){return xr.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw jg(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new qc(this._publicKey)}decrypt(e){return xr.decrypt(this._key,e)}marshal(){return xr.utils.jwkToPkcs1(this._key)}get bytes(){return kc.PrivateKey.encode({Type:kc.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return $g(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Vg.digest(this.bytes);return e}async id(){let e=await this.public.hash();return UB(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Lc.util.ByteBuffer(this.marshal()),i=Lc.asn1.fromDer(n),s=Lc.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Lc.pki.encryptRsaPrivateKey(s,e,o)}else{if(r==="libp2p-key")return MB.export(this.bytes,e);throw jg(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function FB(t){let e=xr.utils.pkcs1ToJwk(t),r=await xr.unmarshalPrivateKey(e);return new ta(r.privateKey,r.publicKey)}function KB(t){let e=xr.utils.pkixToJwk(t);return new qc(e)}async function VB(t){let e=await xr.unmarshalPrivateKey(t);return new ta(e.privateKey,e.publicKey)}async function jB(t){let e=await xr.generateKey(t);return new ta(e.privateKey,e.publicKey)}Hg.exports={RsaPublicKey:qc,RsaPrivateKey:ta,unmarshalRsaPublicKey:KB,unmarshalRsaPrivateKey:FB,generateKeyPair:jB,fromJwk:VB}});var rm=b(qe=>{"use strict";var $B=qe&&qe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(qe,"__esModule",{value:!0});qe.utils=qe.curve25519=qe.getSharedSecret=qe.verify=qe.sign=qe.getPublicKey=qe.Signature=qe.Point=qe.RistrettoPoint=qe.ExtendedPoint=qe.CURVE=void 0;var HB=$B(Bs()),dt=BigInt(0),xe=BigInt(1),kt=BigInt(2),Gg=BigInt(255),Wg=kt**BigInt(252)+BigInt("27742317777372353535851937790883648493"),Ge={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:kt**Gg-BigInt(19),l:Wg,n:Wg,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};qe.CURVE=Ge;var Yg=kt**BigInt(256),ra=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),sM=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),zB=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),GB=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),WB=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),YB=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Pe=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof ot))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ot.ZERO)?Pe.ZERO:new Pe(e.x,e.y,xe,j(e.x*e.y))}static toAffineBatch(e){let r=ZB(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Qg(e);let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=j(r*a),u=j(s*i),l=j(n*a),f=j(o*i);return c===u&&l===f}negate(){return new Pe(j(-this.x),this.y,this.z,j(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=Ge,s=j(e**kt),o=j(r**kt),a=j(kt*j(n**kt)),c=j(i*s),u=j(j((e+r)**kt)-s-o),l=c+o,f=l-a,d=c-o,p=j(u*f),h=j(l*d),g=j(u*d),v=j(f*l);return new Pe(p,h,v,g)}add(e){Qg(e);let{x:r,y:n,z:i,t:s}=this,{x:o,y:a,z:c,t:u}=e,l=j((n-r)*(a+o)),f=j((n+r)*(a-o)),d=j(f-l);if(d===dt)return this.double();let p=j(i*kt*u),h=j(s*kt*c),g=h+p,v=f+l,w=h-p,C=j(g*d),q=j(v*w),W=j(g*w),F=j(d*v);return new Pe(C,q,F,W)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Pe.BASE)&&(r=ot.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Ef.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Pe.normalizeZ(i),Ef.set(r,i)));let s=Pe.ZERO,o=Pe.ZERO,a=1+256/n,c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let d=0;d<a;d++){let p=d*c,h=Number(e&u);if(e>>=f,h>c&&(h-=l,e+=xe),h===0){let g=i[p];d%2&&(g=g.negate()),o=o.add(g)}else{let g=i[p+Math.abs(h)-1];h<0&&(g=g.negate()),s=s.add(g)}}return Pe.normalizeZ([s,o])[0]}multiply(e,r){return this.wNAF(Ds(e,Ge.l),r)}multiplyUnsafe(e){let r=Ds(e,Ge.l,!1),n=Pe.BASE,i=Pe.ZERO;if(r===dt)return i;if(this.equals(i)||r===xe)return this;if(this.equals(n))return this.wNAF(r);let s=i,o=this;for(;r>dt;)r&xe&&(s=s.add(o)),o=o.double(),r>>=xe;return s}isSmallOrder(){return this.multiplyUnsafe(Ge.h).equals(Pe.ZERO)}isTorsionFree(){return this.multiplyUnsafe(Ge.l).equals(Pe.ZERO)}toAffine(e=Uc(this.z)){let{x:r,y:n,z:i}=this,s=j(r*e),o=j(n*e);if(j(i*e)!==xe)throw new Error("invZ was invalid");return new ot(s,o)}fromRistrettoBytes(){vf()}toRistrettoBytes(){vf()}fromRistrettoHash(){vf()}};qe.ExtendedPoint=Pe;Pe.BASE=new Pe(Ge.Gx,Ge.Gy,xe,j(Ge.Gx*Ge.Gy));Pe.ZERO=new Pe(dt,xe,xe,dt);function Qg(t){if(!(t instanceof Pe))throw new TypeError("ExtendedPoint expected")}function mf(t){if(!(t instanceof sr))throw new TypeError("RistrettoPoint expected")}function vf(){throw new Error("Legacy method: switch to RistrettoPoint")}var sr=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=Ge,n=j(ra*e*e),i=j((n+xe)*WB),s=BigInt(-1),o=j((s-r*n)*j(n+r)),{isValid:a,value:c}=wf(i,o),u=j(c*e);ri(u)||(u=j(-u)),a||(c=u),a||(s=n);let l=j(s*(n-xe)*YB-o),f=c*c,d=j((c+c)*o),p=j(l*zB),h=j(xe-f),g=j(xe+f);return new Pe(j(d*g),j(h*p),j(p*g),j(d*h))}static hashToCurve(e){e=ln(e,64);let r=bf(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=bf(e.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new sr(n.add(s))}static fromHex(e){e=ln(e,32);let{a:r,d:n}=Ge,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=bf(e);if(!JB(Os(s),e)||ri(s))throw new Error(i);let o=j(s*s),a=j(xe+r*o),c=j(xe-r*o),u=j(a*a),l=j(c*c),f=j(r*n*u-l),{isValid:d,value:p}=em(j(f*l)),h=j(p*c),g=j(p*h*f),v=j((s+s)*h);ri(v)&&(v=j(-v));let w=j(a*g),C=j(v*w);if(!d||ri(C)||w===dt)throw new Error(i);return new sr(new Pe(v,w,xe,C))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,s=j(j(n+r)*j(n-r)),o=j(e*r),{value:a}=em(j(s*o**kt)),c=j(a*s),u=j(a*o),l=j(c*u*i),f;if(ri(i*l)){let p=j(r*ra),h=j(e*ra);e=p,r=h,f=j(c*GB)}else f=u;ri(e*l)&&(r=j(-r));let d=j((n-r)*f);return ri(d)&&(d=j(-d)),Os(d)}toHex(){return na(this.toRawBytes())}toString(){return this.toHex()}equals(e){mf(e);let r=this.ep,n=e.ep,i=j(r.x*n.y)===j(r.y*n.x),s=j(r.y*n.y)===j(r.x*n.x);return i||s}add(e){return mf(e),new sr(this.ep.add(e.ep))}subtract(e){return mf(e),new sr(this.ep.subtract(e.ep))}multiply(e){return new sr(this.ep.multiply(e))}multiplyUnsafe(e){return new sr(this.ep.multiplyUnsafe(e))}};qe.RistrettoPoint=sr;sr.BASE=new sr(Pe.BASE);sr.ZERO=new sr(Pe.ZERO);var Ef=new WeakMap,ot=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Ef.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=Ge;e=ln(e,32);let s=e.slice();s[31]=e[31]&~128;let o=ni(s);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=Yg)throw new Error("Expected 0 < hex < 2**256");let a=j(o*o),c=j(a-xe),u=j(n*a+xe),{isValid:l,value:f}=wf(c,u);if(!l)throw new Error("Point.fromHex: invalid y coordinate");let d=(f&xe)===xe;return(e[31]&128)!=0!==d&&(f=j(-f)),new ot(f,o)}static async fromPrivateKey(e){return(await ia(e)).point}toRawBytes(){let e=Os(this.y);return e[31]|=this.x&xe?128:0,e}toHex(){return na(this.toRawBytes())}toX25519(){let{y:e}=this,r=j((xe+e)*Uc(xe-e));return Os(r)}isTorsionFree(){return Pe.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new ot(j(-this.x),this.y)}add(e){return Pe.fromAffine(this).add(Pe.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Pe.fromAffine(this).multiply(e,this).toAffine()}};qe.Point=ot;ot.BASE=new ot(Ge.Gx,Ge.Gy);ot.ZERO=new ot(dt,xe);var Ui=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=ln(e,64),n=ot.fromHex(r.slice(0,32),!1),i=ni(r.slice(32,64));return new Ui(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof ot))throw new Error("Expected Point instance");return Ds(r,Ge.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Os(this.s),32),e}toHex(){return na(this.toRawBytes())}};qe.Signature=Ui;function QB(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}var XB=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function na(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=XB[t[r]];return e}function Xg(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function Zg(t){let e=32,r=t.toString(16).padStart(e*2,"0");return Xg(r)}function Os(t){return Zg(t).reverse()}function ri(t){return(j(t)&xe)===xe}function ni(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+na(Uint8Array.from(t).reverse()))}function bf(t){return j(ni(t)&kt**Gg-xe)}function j(t,e=Ge.P){let r=t%e;return r>=dt?r:e+r}function Uc(t,e=Ge.P){if(t===dt||e<=dt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=j(t,e),n=e,i=dt,s=xe,o=xe,a=dt;for(;r!==dt;){let u=n/r,l=n%r,f=i-o*u,d=s-a*u;n=r,r=l,i=o,s=a,o=f,a=d}if(n!==xe)throw new Error("invert: does not exist");return j(i,e)}function ZB(t,e=Ge.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===dt?s:(r[a]=s,j(s*o,e)),xe),i=Uc(n,e);return t.reduceRight((s,o,a)=>o===dt?s:(r[a]=j(s*r[a],e),j(s*o,e)),i),r}function Vr(t,e){let{P:r}=Ge,n=t;for(;e-- >dt;)n*=n,n%=r;return n}function Jg(t){let{P:e}=Ge,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),o=BigInt(80),c=t*t%e*t%e,u=Vr(c,kt)*c%e,l=Vr(u,xe)*t%e,f=Vr(l,r)*l%e,d=Vr(f,n)*f%e,p=Vr(d,i)*d%e,h=Vr(p,s)*p%e,g=Vr(h,o)*h%e,v=Vr(g,o)*h%e,w=Vr(v,n)*f%e;return{pow_p_5_8:Vr(w,kt)*t%e,b2:c}}function wf(t,e){let r=j(e*e*e),n=j(r*r*e),i=Jg(t*n).pow_p_5_8,s=j(t*r*i),o=j(e*s*s),a=s,c=j(s*ra),u=o===t,l=o===j(-t),f=o===j(-t*ra);return u&&(s=a),(l||f)&&(s=c),ri(s)&&(s=j(-s)),{isValid:u||l,value:s}}function em(t){return wf(xe,t)}async function _f(...t){let e=await qe.utils.sha512(QB(...t)),r=ni(e);return j(r,Ge.l)}function JB(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function ln(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):Xg(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Ds(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(dt<t)return t}else if(dt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function tm(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function e8(t){return ni(tm(ln(t,32)))}async function ia(t){if(t=typeof t=="bigint"||typeof t=="number"?Zg(Ds(t,Yg)):ln(t),t.length!==32)throw new Error("Expected 32 bytes");let e=await qe.utils.sha512(t),r=tm(e.slice(0,32)),n=e.slice(32,64),i=j(ni(r),Ge.l),s=ot.BASE.multiply(i),o=s.toRawBytes();return{head:r,prefix:n,scalar:i,point:s,pointBytes:o}}async function t8(t){return(await ia(t)).pointBytes}qe.getPublicKey=t8;async function r8(t,e){t=ln(t);let{prefix:r,scalar:n,pointBytes:i}=await ia(e),s=await _f(r,t),o=ot.BASE.multiply(s),a=await _f(o.toRawBytes(),i,t),c=j(s+a*n,Ge.l);return new Ui(o,c).toRawBytes()}qe.sign=r8;async function n8(t,e,r){e=ln(e),r instanceof ot||(r=ot.fromHex(r,!1));let{r:n,s:i}=t instanceof Ui?t.assertValidity():Ui.fromHex(t),s=Pe.BASE.multiplyUnsafe(i),o=await _f(n.toRawBytes(),r.toRawBytes(),e),a=Pe.fromAffine(r).multiplyUnsafe(o);return Pe.fromAffine(n).add(a).subtract(s).multiplyUnsafe(Ge.h).equals(Pe.ZERO)}qe.verify=n8;async function i8(t,e){let{head:r}=await ia(t),n=ot.fromHex(e).toX25519();return qe.curve25519.scalarMult(r,n)}qe.getSharedSecret=i8;ot.BASE._setWindowSize(8);function Mc(t,e,r){let n=j(t*(e-r));return e=j(e-n),r=j(r+n),[e,r]}function s8(t,e){let{P:r}=Ge,n=Ds(t,r),i=Ds(e,r),s=BigInt(121665),o=n,a=xe,c=dt,u=n,l=xe,f=dt,d;for(let v=BigInt(255-1);v>=dt;v--){let w=i>>v&xe;f^=w,d=Mc(f,a,u),a=d[0],u=d[1],d=Mc(f,c,l),c=d[0],l=d[1],f=w;let C=a+c,q=j(C*C),W=a-c,F=j(W*W),M=q-F,re=u+l,ie=u-l,z=j(ie*C),Ae=j(re*W);u=j((z+Ae)**kt),l=j(o*(z-Ae)**kt),a=j(q*F),c=j(M*(q+j(s*M)))}d=Mc(f,a,u),a=d[0],u=d[1],d=Mc(f,c,l),c=d[0],l=d[1];let{pow_p_5_8:p,b2:h}=Jg(c),g=j(Vr(p,BigInt(3))*h);return j(a*g)}function o8(t){return Os(j(t,Ge.P))}function a8(t){let e=ln(t,32);return e[31]&=127,ni(e)}qe.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(t,e){let r=a8(e),n=e8(t),i=s8(r,n);if(i===dt)throw new Error("Invalid private or public key received");return o8(i)},scalarMultBase(t){return qe.curve25519.scalarMult(t,qe.curve25519.BASE_POINT_U)}};var ii={node:HB.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};qe.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:na,getExtendedPublicKey:ia,mod:j,invert:Uc,hashToPrivateScalar:t=>{if(t=ln(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=j(ni(t),Ge.l);if(e===dt||e===xe)throw new Error("Invalid private key");return e},randomBytes:(t=32)=>{if(ii.web)return ii.web.getRandomValues(new Uint8Array(t));if(ii.node){let{randomBytes:e}=ii.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>qe.utils.randomBytes(32),sha512:async t=>{if(ii.web){let e=await ii.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(ii.node)return Uint8Array.from(ii.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ot.BASE){let r=e.equals(ot.BASE)?e:new ot(e.x,e.y);return r._setWindowSize(t),r.multiply(kt),r}}});var im=b(si=>{"use strict";var sa=rm(),c8=32,u8=64,Fc=32;si.publicKeyLength=c8;si.privateKeyLength=u8;si.generateKey=async function(){let t=sa.utils.randomPrivateKey(),e=await sa.getPublicKey(t);return{privateKey:nm(t,e),publicKey:e}};si.generateKeyFromSeed=async function(t){if(t.length!==Fc)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await sa.getPublicKey(e);return{privateKey:nm(e,r),publicKey:r}};si.hashAndSign=function(t,e){let r=t.slice(0,Fc);return sa.sign(e,r)};si.hashAndVerify=function(t,e,r){return sa.verify(e,r,t)};function nm(t,e){let r=new Uint8Array(si.privateKeyLength);for(let n=0;n<Fc;n++)r[n]=t[n],r[Fc+n]=e[n];return r}});var um=b((cM,cm)=>{"use strict";var sm=ge(),{equals:om}=(Sr(),_r),{sha256:am}=(ki(),Zn),{base58btc:l8}=(Vn(),Kn),{identity:f8}=(Rc(),Qo),Vt=im(),Kc=fc(),d8=Dc(),Vc=class{constructor(e){this._key=ks(e,Vt.publicKeyLength)}async verify(e,r){return Vt.hashAndVerify(this._key,r,e)}marshal(){return this._key}get bytes(){return Kc.PublicKey.encode({Type:Kc.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return om(this.bytes,e.bytes)}async hash(){let{bytes:e}=await am.digest(this.bytes);return e}},Ls=class{constructor(e,r){this._key=ks(e,Vt.privateKeyLength),this._publicKey=ks(r,Vt.publicKeyLength)}async sign(e){return Vt.hashAndSign(this._key,e)}get public(){return new Vc(this._publicKey)}marshal(){return this._key}get bytes(){return Kc.PrivateKey.encode({Type:Kc.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return om(this.bytes,e.bytes)}async hash(){let{bytes:e}=await am.digest(this.bytes);return e}async id(){let e=await f8.digest(this.public.bytes);return l8.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return d8.export(this.bytes,e);throw sm(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function h8(t){if(t.length>Vt.privateKeyLength){t=ks(t,Vt.privateKeyLength+Vt.publicKeyLength);let n=t.slice(0,Vt.privateKeyLength),i=t.slice(Vt.privateKeyLength,t.length);return new Ls(n,i)}t=ks(t,Vt.privateKeyLength);let e=t.slice(0,Vt.privateKeyLength),r=t.slice(Vt.publicKeyLength);return new Ls(e,r)}function p8(t){return t=ks(t,Vt.publicKeyLength),new Vc(t)}async function y8(){let{privateKey:t,publicKey:e}=await Vt.generateKey();return new Ls(t,e)}async function g8(t){let{privateKey:e,publicKey:r}=await Vt.generateKeyFromSeed(t);return new Ls(e,r)}function ks(t,e){if(t=Uint8Array.from(t||[]),t.length!==e)throw sm(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}cm.exports={Ed25519PublicKey:Vc,Ed25519PrivateKey:Ls,unmarshalEd25519PrivateKey:h8,unmarshalEd25519PublicKey:p8,generateKeyPair:y8,generateKeyPairFromSeed:g8}});var Cm=b(Re=>{"use strict";var m8=Re&&Re.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Re,"__esModule",{value:!0});Re.utils=Re.schnorr=Re.verify=Re.signSync=Re.sign=Re.getSharedSecret=Re.recoverPublicKey=Re.getPublicKey=Re.Signature=Re.Point=Re.CURVE=void 0;var v8=m8(Bs()),Ie=BigInt(0),rt=BigInt(1),vt=BigInt(2),oa=BigInt(3),E8=BigInt(8),Sf=vt**BigInt(256),We={a:Ie,b:BigInt(7),P:Sf-vt**BigInt(32)-BigInt(977),n:Sf-BigInt("432420386565659656852420866394968145599"),h:rt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};Re.CURVE=We;function lm(t){let{a:e,b:r}=We,n=ee(t*t),i=ee(n*t);return ee(i+e*t+r)}var jc=We.a===Ie,Ue=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof Me))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Ue(e.x,e.y,rt)}static toAffineBatch(e){let r=S8(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Ue.toAffineBatch(e).map(Ue.fromAffine)}equals(e){if(!(e instanceof Ue))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e,c=ee(i**vt),u=ee(a**vt),l=ee(r*u),f=ee(s*c),d=ee(ee(n*a)*u),p=ee(ee(o*i)*c);return l===f&&d===p}negate(){return new Ue(this.x,ee(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=ee(e**vt),s=ee(r**vt),o=ee(s**vt),a=ee(vt*(ee((e+s)**vt)-i-o)),c=ee(oa*i),u=ee(c**vt),l=ee(u-vt*a),f=ee(c*(a-l)-E8*o),d=ee(vt*r*n);return new Ue(l,f,d)}add(e){if(!(e instanceof Ue))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:s,y:o,z:a}=e;if(s===Ie||o===Ie)return this;if(r===Ie||n===Ie)return e;let c=ee(i**vt),u=ee(a**vt),l=ee(r*u),f=ee(s*c),d=ee(ee(n*a)*u),p=ee(ee(o*i)*c),h=ee(f-l),g=ee(p-d);if(h===Ie)return g===Ie?this.double():Ue.ZERO;let v=ee(h**vt),w=ee(h*v),C=ee(l*v),q=ee(g**vt-w-vt*C),W=ee(g*(C-q)-d*w),F=ee(i*a*h);return new Ue(q,W,F)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=hm(e),n=Ue.BASE,i=Ue.ZERO;if(r===Ie)return i;if(r===rt)return this;if(!jc){let d=i,p=this;for(;r>Ie;)r&rt&&(d=d.add(p)),p=p.double(),r>>=rt;return d}let{k1neg:s,k1:o,k2neg:a,k2:c}=ym(r),u=i,l=i,f=this;for(;o>Ie||c>Ie;)o&rt&&(u=u.add(f)),c&rt&&(l=l.add(f)),f=f.double(),o>>=rt,c>>=rt;return s&&(u=u.negate()),a&&(l=l.negate()),l=new Ue(ee(l.x*We.beta),l.y,l.z),u.add(l)}precomputeWindow(e){let r=jc?128/e+1:256/e+1,n=[],i=this,s=i;for(let o=0;o<r;o++){s=i,n.push(s);for(let a=1;a<2**(e-1);a++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(e,r){!r&&this.equals(Ue.BASE)&&(r=Me.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&xf.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Ue.normalizeZ(i),xf.set(r,i)));let s=Ue.ZERO,o=Ue.ZERO,a=1+(jc?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),l=2**n,f=BigInt(n);for(let d=0;d<a;d++){let p=d*c,h=Number(e&u);if(e>>=f,h>c&&(h-=l,e+=rt),h===0){let g=i[p];d%2&&(g=g.negate()),o=o.add(g)}else{let g=i[p+Math.abs(h)-1];h<0&&(g=g.negate()),s=s.add(g)}}return{p:s,f:o}}multiply(e,r){let n=hm(e),i,s;if(jc){let{k1neg:o,k1:a,k2neg:c,k2:u}=ym(n),{p:l,f}=this.wNAF(a,r),{p:d,f:p}=this.wNAF(u,r);o&&(l=l.negate()),c&&(d=d.negate()),d=new Ue(ee(d.x*We.beta),d.y,d.z),i=l.add(d),s=f.add(p)}else{let{p:o,f:a}=this.wNAF(n,r);i=o,s=a}return Ue.normalizeZ([i,s])[0]}toAffine(e=ua(this.z)){let{x:r,y:n,z:i}=this,s=e,o=ee(s*s),a=ee(o*s),c=ee(r*o),u=ee(n*a);if(ee(i*s)!==rt)throw new Error("invZ was invalid");return new Me(c,u)}};Ue.BASE=new Ue(We.Gx,We.Gy,rt);Ue.ZERO=new Ue(Ie,rt,Ie);var xf=new WeakMap,Me=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,xf.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=Ar(r?e:e.subarray(1));if(!zc(n))throw new Error("Point is not on curve");let i=lm(n),s=_8(i),o=(s&rt)===rt;r?o&&(s=ee(-s)):(e[0]&1)==1!==o&&(s=ee(-s));let a=new Me(n,s);return a.assertValidity(),a}static fromUncompressedHex(e){let r=Ar(e.subarray(1,33)),n=Ar(e.subarray(33,65)),i=new Me(r,n);return i.assertValidity(),i}static fromHex(e){let r=dn(e),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return Me.BASE.multiply(Ms(e))}static fromSignature(e,r,n){e=dn(e);let i=gm(e),{r:s,s:o}=vm(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(i===Ie)throw new Error("Cannot recover signature: msgHash cannot be 0");let a=n&1?"03":"02",c=Me.fromHex(a+Rn(s)),{n:u}=We,l=ua(s,u),f=ee(-i*l,u),d=ee(o*l,u),p=Me.BASE.multiplyAndAddUnsafe(c,f,d);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return oi(this.toHex(e))}toHex(e=!1){let r=Rn(this.x);return e?`${this.y&rt?"03":"02"}${r}`:`04${r}${Rn(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!zc(r)||!zc(n))throw new Error(e);let i=ee(n*n),s=lm(r);if(ee(i-s)!==Ie)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Me(this.x,ee(-this.y))}double(){return Ue.fromAffine(this).double().toAffine()}add(e){return Ue.fromAffine(this).add(Ue.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Ue.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let s=Ue.fromAffine(this).multiply(r),o=Ue.fromAffine(e).multiplyUnsafe(n),a=s.add(o);return a.equals(Ue.ZERO)?void 0:a.toAffine()}};Re.Point=Me;Me.BASE=new Me(We.Gx,We.Gy);Me.ZERO=new Me(Ie,Ie);function fm(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function dm(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${qs(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ar(r),left:t.subarray(e+2)}}function b8(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${qs(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=dm(t.subarray(2)),{data:n,left:i}=dm(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${qs(i)}`);return{r:e,s:n}}var fn=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=aa(e),n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?qs(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new fn($c(i.slice(0,64)),$c(i.slice(64,128)))}static fromDER(e){let r=aa(e);if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=b8(r?e:oi(e));return new fn(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Us(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Us(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=We.n>>rt;return this.s>e}normalizeS(){return this.hasHighS()?new fn(this.r,We.n-this.s):this}toDERRawBytes(e=!1){return oi(this.toDERHex(e))}toDERHex(e=!1){let r=fm(ca(this.s));if(e)return r;let n=fm(ca(this.r)),i=ca(n.length/2),s=ca(r.length/2);return`30${ca(n.length/2+r.length/2+4)}02${i}${n}02${s}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return oi(this.toCompactHex())}toCompactHex(){return Rn(this.r)+Rn(this.s)}};Re.Signature=fn;function Af(...t){if(!t.every(aa))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let s=t[n];r.set(s,i),i+=s.length}return r}function aa(t){return t instanceof Uint8Array}var w8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function qs(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=w8[t[r]];return e}function Rn(t){if(t>Sf)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function Cf(t){return oi(Rn(t))}function ca(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function $c(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function oi(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");e[r]=s}return e}function Ar(t){return $c(qs(t))}function dn(t){return t instanceof Uint8Array?Uint8Array.from(t):oi(t)}function hm(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Us(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function ee(t,e=We.P){let r=t%e;return r>=Ie?r:e+r}function Cr(t,e){let{P:r}=We,n=t;for(;e-- >Ie;)n*=n,n%=r;return n}function _8(t){let{P:e}=We,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),o=BigInt(44),a=BigInt(88),c=t*t*t%e,u=c*c*t%e,l=Cr(u,oa)*u%e,f=Cr(l,oa)*u%e,d=Cr(f,vt)*c%e,p=Cr(d,n)*d%e,h=Cr(p,i)*p%e,g=Cr(h,o)*h%e,v=Cr(g,a)*g%e,w=Cr(v,o)*h%e,C=Cr(w,oa)*u%e,q=Cr(C,s)*p%e,W=Cr(q,r)*c%e;return Cr(W,vt)}function ua(t,e=We.P){if(t===Ie||e<=Ie)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=ee(t,e),n=e,i=Ie,s=rt,o=rt,a=Ie;for(;r!==Ie;){let u=n/r,l=n%r,f=i-o*u,d=s-a*u;n=r,r=l,i=o,s=a,o=f,a=d}if(n!==rt)throw new Error("invert: does not exist");return ee(i,e)}function S8(t,e=We.P){let r=new Array(t.length),n=t.reduce((s,o,a)=>o===Ie?s:(r[a]=s,ee(s*o,e)),rt),i=ua(n,e);return t.reduceRight((s,o,a)=>o===Ie?s:(r[a]=ee(s*r[a],e),ee(s*o,e)),i),r}var pm=(t,e)=>(t+e/vt)/e,Hc=vt**BigInt(128);function ym(t){let{n:e}=We,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-rt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,o=pm(s*t,e),a=pm(-n*t,e),c=ee(t-o*r-a*i,e),u=ee(-o*n-a*s,e),l=c>Hc,f=u>Hc;if(l&&(c=e-c),f&&(u=e-u),c>Hc||u>Hc)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:l,k1:c,k2neg:f,k2:u}}function gm(t){let{n:e}=We,n=t.length*8-256,i=Ar(t);return n>0&&(i=i>>BigInt(n)),i>=e&&(i-=e),i}var If=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return Re.utils.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof Re.utils.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=Re.utils.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function Us(t){return Ie<t&&t<We.n}function zc(t){return Ie<t&&t<We.P}function mm(t,e,r){let n=Ar(t);if(!Us(n))return;let{n:i}=We,s=Me.BASE.multiply(n),o=ee(s.x,i);if(o===Ie)return;let a=ee(ua(n,i)*ee(e+r*o,i),i);if(a===Ie)return;let c=new fn(o,a),u=(s.x===c.r?0:2)|Number(s.y&rt);return{sig:c,recovery:u}}function Ms(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=$c(t)}else if(aa(t)){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=Ar(t)}else throw new TypeError("Expected valid private key");if(!Us(e))throw new Error("Expected private key: 0 < key < n");return e}function Tf(t){return t instanceof Me?(t.assertValidity(),t):Me.fromHex(t)}function vm(t){if(t instanceof fn)return t.assertValidity(),t;try{return fn.fromDER(t)}catch(e){return fn.fromCompact(t)}}function x8(t,e=!1){return Me.fromPrivateKey(t).toRawBytes(e)}Re.getPublicKey=x8;function A8(t,e,r,n=!1){return Me.fromSignature(t,e,r).toRawBytes(n)}Re.recoverPublicKey=A8;function Em(t){let e=aa(t),r=typeof t=="string",n=(e||r)&&t.length;return e?n===33||n===65:r?n===66||n===130:t instanceof Me}function C8(t,e,r=!1){if(Em(t))throw new TypeError("getSharedSecret: first arg must be private key");if(!Em(e))throw new TypeError("getSharedSecret: second arg must be public key");let n=Tf(e);return n.assertValidity(),n.multiply(Ms(t)).toRawBytes(r)}Re.getSharedSecret=C8;function bm(t){let e=t.length>32?t.slice(0,32):t;return Ar(e)}function I8(t){let e=bm(t),r=ee(e,We.n);return wm(r<Ie?e:r)}function wm(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=Rn(t);return oi(e)}function _m(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=dn(t),i=Ms(e),s=[wm(i),I8(n)];if(r!=null){r===!0&&(r=Re.utils.randomBytes(32));let c=dn(r);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");s.push(c)}let o=Af(...s),a=bm(n);return{seed:o,m:a,d:i}}function Sm(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:s,recovered:o}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let a=s?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function T8(t,e,r={}){let{seed:n,m:i,d:s}=_m(t,e,r.extraEntropy),o,a=new If;for(await a.reseed(n);!(o=mm(await a.generate(),i,s));)await a.reseed();return Sm(o,r)}Re.sign=T8;function R8(t,e,r={}){let{seed:n,m:i,d:s}=_m(t,e,r.extraEntropy),o,a=new If;for(a.reseedSync(n);!(o=mm(a.generateSync(),i,s));)a.reseedSync();return Sm(o,r)}Re.signSync=R8;var B8={strict:!0};function P8(t,e,r,n=B8){let i;try{i=vm(t),e=dn(e)}catch(g){return!1}let{r:s,s:o}=i;if(n.strict&&i.hasHighS())return!1;let a=gm(e);if(a===Ie)return!1;let c;try{c=Tf(r)}catch(g){return!1}let{n:u}=We,l=ua(o,u),f=ee(a*l,u),d=ee(s*l,u),p=Me.BASE.multiplyAndAddUnsafe(c,f,d);return p?ee(p.x,u)===s:!1}Re.verify=P8;async function Rf(t,...e){let r=new Uint8Array(t.split("").map(s=>s.charCodeAt(0))),n=await Re.utils.sha256(r),i=await Re.utils.sha256(Af(n,n,...e));return Ar(i)}async function xm(t,e,r){let n=Cf(t),i=await Rf("BIP0340/challenge",n,e.toRawX(),r);return ee(i,We.n)}function Bf(t){return(t.y&rt)===Ie}var Mi=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=dn(e);if(r.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${r.length}`);let n=Ar(r.subarray(0,32)),i=Ar(r.subarray(32,64));return new Mi(n,i)}assertValidity(){let{r:e,s:r}=this;if(!zc(e)||!Us(r))throw new Error("Invalid signature")}toHex(){return Rn(this.r)+Rn(this.s)}toRawBytes(){return oi(this.toHex())}};function N8(t){return Me.fromPrivateKey(t).toRawX()}async function O8(t,e,r=Re.utils.randomBytes()){if(t==null)throw new TypeError(`sign: Expected valid message, not "${t}"`);let{n}=We,i=dn(t),s=Ms(e),o=dn(r);if(o.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");let a=Me.fromPrivateKey(s),c=Bf(a)?s:n-s,u=await Rf("BIP0340/aux",o),l=c^u,f=await Rf("BIP0340/nonce",Cf(l),a.toRawX(),i),d=ee(f,n);if(d===Ie)throw new Error("sign: Creation of signature failed. k is zero");let p=Me.fromPrivateKey(d),h=Bf(p)?d:n-d,g=await xm(p.x,a,i),v=new Mi(p.x,ee(h+g*c,n)).toRawBytes();if(!await Am(v,i,a.toRawX()))throw new Error("sign: Invalid signature produced");return v}async function Am(t,e,r){let n=t instanceof Mi,i;try{i=n?t:Mi.fromHex(t),n&&i.assertValidity()}catch(f){return!1}let{r:s,s:o}=i,a=dn(e),c;try{c=Tf(r)}catch(f){return!1}let u=await xm(s,c,a),l=Me.BASE.multiplyAndAddUnsafe(c,Ms(o),ee(-u,We.n));return!(!l||!Bf(l)||l.x!==s)}Re.schnorr={Signature:Mi,getPublicKey:N8,sign:O8,verify:Am};Me.BASE._setWindowSize(8);var lr={node:v8.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};Re.utils={isValidPrivateKey(t){try{return Ms(t),!0}catch(e){return!1}},hashToPrivateKey:t=>{if(t=dn(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=ee(Ar(t),We.n);if(e===Ie||e===rt)throw new Error("Invalid private key");return Cf(e)},randomBytes:(t=32)=>{if(lr.web)return lr.web.getRandomValues(new Uint8Array(t));if(lr.node){let{randomBytes:e}=lr.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Re.utils.hashToPrivateKey(Re.utils.randomBytes(40)),bytesToHex:qs,mod:ee,sha256:async t=>{if(lr.web){let e=await lr.web.subtle.digest("SHA-256",t.buffer);return new Uint8Array(e)}else if(lr.node){let{createHash:e}=lr.node;return Uint8Array.from(e("sha256").update(t).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(lr.web){let r=await lr.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Af(...e),i=await lr.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(lr.node){let{createHmac:r}=lr.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(t=8,e=Me.BASE){let r=e===Me.BASE?e:new Me(e.x,e.y);return r._setWindowSize(t),r.multiply(oa),r}}});var Rm=b((lM,Tm)=>{"use strict";var la=ge(),ai=Cm(),{sha256:Im}=(ki(),Zn);Tm.exports=()=>{let t=32;function e(){return ai.utils.randomPrivateKey()}async function r(u,l){let{digest:f}=await Im.digest(l);try{return await ai.sign(f,u)}catch(d){throw la(d,"ERR_INVALID_INPUT")}}async function n(u,l,f){try{let{digest:d}=await Im.digest(f);return ai.verify(l,d,u)}catch(d){throw la(d,"ERR_INVALID_INPUT")}}function i(u){return ai.Point.fromHex(u).toRawBytes(!0)}function s(u){return ai.Point.fromHex(u).toRawBytes(!1)}function o(u){try{ai.getPublicKey(u,!0)}catch(l){throw la(l,"ERR_INVALID_PRIVATE_KEY")}}function a(u){try{ai.Point.fromHex(u)}catch(l){throw la(l,"ERR_INVALID_PUBLIC_KEY")}}function c(u){try{return ai.getPublicKey(u,!0)}catch(l){throw la(l,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:e,privateKeyLength:t,hashAndSign:r,hashAndVerify:n,compressPublicKey:i,decompressPublicKey:s,validatePrivateKey:o,validatePublicKey:a,computePublicKey:c}}});var Om=b((fM,Nm)=>{"use strict";var{sha256:Bm}=(ki(),Zn),D8=ge(),{equals:Pm}=(Sr(),_r),{toString:L8}=(Lt(),Kt),k8=Dc();Nm.exports=(t,e,r)=>{r=r||Rm()();class n{constructor(u){r.validatePublicKey(u),this._key=u}verify(u,l){return r.hashAndVerify(this._key,l,u)}marshal(){return r.compressPublicKey(this._key)}get bytes(){return t.PublicKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Pm(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Bm.digest(this.bytes);return u}}class i{constructor(u,l){this._key=u,this._publicKey=l||r.computePublicKey(u),r.validatePrivateKey(this._key),r.validatePublicKey(this._publicKey)}sign(u){return r.hashAndSign(this._key,u)}get public(){return new n(this._publicKey)}marshal(){return this._key}get bytes(){return t.PrivateKey.encode({Type:t.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return Pm(this.bytes,u.bytes)}async hash(){let{bytes:u}=await Bm.digest(this.bytes);return u}async id(){let u=await this.public.hash();return L8(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return k8.export(this.bytes,u);throw D8(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new i(c)}function o(c){return new n(c)}async function a(){let c=await r.generateKey();return new i(c)}return{Secp256k1PublicKey:n,Secp256k1PrivateKey:i,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var Lm=b((dM,Dm)=>{"use strict";Dm.exports={SHA1:20,SHA256:32,SHA512:64}});var Pf=b(qm=>{"use strict";var km=Xo(),q8=Lm(),U8={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},M8=async(t,e)=>{let r=await km.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,r.byteOffset,r.byteLength)};qm.create=async function(t,e){let r=U8[t],n=await km.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return M8(n,i)},length:q8[t]}}});var Vm=b((pM,Km)=>{"use strict";var Um=ge(),{concat:Mm}=(ei(),Jn),{fromString:F8}=(Dt(),Ft),K8=Pf(),Fm={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};Km.exports=async(t,e,r)=>{let n=Fm[t];if(!n){let C=Object.keys(Fm).join(" / ");throw Um(new Error(`unknown cipher type '${t}'. Must be ${C}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw Um(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,s=n.ivSize,o=20,a=F8("key expansion"),c=2*(s+i+o),u=await K8.create(e,r),l=await u.digest(a),f=[],d=0;for(;d<c;){let C=await u.digest(Mm([l,a])),q=C.length;d+q>c&&(q=c-d),f.push(C),d+=q,l=await u.digest(l)}let p=c/2,h=Mm(f),g=h.slice(0,p),v=h.slice(p,c),w=C=>({iv:C.slice(0,s),cipherKey:C.slice(s,s+i),macKey:C.slice(s+i)});return{k1:w(g),k2:w(v)}}});var $m=b((yM,jm)=>{"use strict";var V8=ge();jm.exports=function(t,e){if(!t.includes(e)){let r=t.join(" / ");throw V8(new Error(`Unknown curve: ${e}. Must be ${r}`),"ERR_INVALID_CURVE")}}});var Qm=b(Ym=>{"use strict";var j8=ge(),fa=Xo(),{base64urlToBuffer:Hm}=Oc(),$8=$m(),{toString:Nf}=(Lt(),Kt),{concat:H8}=(ei(),Jn),{equals:z8}=(Sr(),_r),zm={"P-256":256,"P-384":384,"P-521":521};Ym.generateEphmeralKeyPair=async function(t){$8(Object.keys(zm),t);let e=await fa.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(i,s)=>{let o;s?o=await fa.get().subtle.importKey("jwk",W8(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let a=[await fa.get().subtle.importKey("jwk",Wm(t,i),{name:"ECDH",namedCurve:t},!1,[]),o],c=await fa.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:a[0]},a[1],zm[t]);return new Uint8Array(c,c.byteOffset,c.byteLength)},n=await fa.get().subtle.exportKey("jwk",e.publicKey);return{key:G8(n),genSharedKey:r}};var Gm={"P-256":32,"P-384":48,"P-521":66};function G8(t){let e=Gm[t.crv];return H8([Uint8Array.from([4]),Hm(t.x,e),Hm(t.y,e)],1+e*2)}function Wm(t,e){let r=Gm[t];if(z8(!e.slice(0,1),Uint8Array.from([4])))throw j8(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:Nf(e.slice(1,r+1),"base64url"),y:Nf(e.slice(1+r),"base64url"),ext:!0}}var W8=(t,e)=>({...Wm(t,e.public),d:Nf(e.private,"base64url")})});var Zm=b((mM,Xm)=>{"use strict";var Y8=Qm();Xm.exports=async t=>Y8.generateEphmeralKeyPair(t)});var Wc=b((vM,ev)=>{"use strict";var hn=fc();Wn();ef();var Of=_e(),da=ge(),{fromString:Q8}=(Dt(),Ft),X8=wg(),Ir={rsa:zg(),ed25519:um(),secp256k1:Om()(hn,Nc())},Gc={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function Fs(t){let e=Ir[t.toLowerCase()];if(!e){let r=Object.keys(Ir).join(" / ");throw da(new Error(`invalid or unsupported key type ${t}. Must be ${r}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var Z8=async(t,e)=>Fs(t).generateKeyPair(e),J8=async(t,e,r)=>{let n=Fs(t);if(t.toLowerCase()!=="ed25519")throw da(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return n.generateKeyPairFromSeed(e,r)},eP=t=>{let e=hn.PublicKey.decode(t),r=e.Data;switch(e.Type){case hn.KeyType.RSA:return Ir.rsa.unmarshalRsaPublicKey(r);case hn.KeyType.Ed25519:return Ir.ed25519.unmarshalEd25519PublicKey(r);case hn.KeyType.Secp256k1:if(Ir.secp256k1)return Ir.secp256k1.unmarshalSecp256k1PublicKey(r);throw da(new Error(Gc.message),Gc.code);default:Fs(e.Type)}},tP=(t,e)=>(e=(e||"rsa").toLowerCase(),Fs(e),t.bytes),Jm=async t=>{let e=hn.PrivateKey.decode(t),r=e.Data;switch(e.Type){case hn.KeyType.RSA:return Ir.rsa.unmarshalRsaPrivateKey(r);case hn.KeyType.Ed25519:return Ir.ed25519.unmarshalEd25519PrivateKey(r);case hn.KeyType.Secp256k1:if(Ir.secp256k1)return Ir.secp256k1.unmarshalSecp256k1PrivateKey(r);throw da(new Error(Gc.message),Gc.code);default:Fs(e.Type)}},rP=(t,e)=>(e=(e||"rsa").toLowerCase(),Fs(e),t.bytes),nP=async(t,e)=>{try{let i=await X8.import(t,e);return Jm(i)}catch(i){}let r=Of.pki.decryptRsaPrivateKey(t,e);if(r===null)throw da(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=Of.asn1.toDer(Of.pki.privateKeyToAsn1(r));return n=Q8(n.getBytes(),"ascii"),Ir.rsa.unmarshalRsaPrivateKey(n)};ev.exports={supportedKeys:Ir,keysPBM:hn,keyStretcher:Vm(),generateEphemeralKeyPair:Zm(),generateKeyPair:Z8,generateKeyPairFromSeed:J8,unmarshalPublicKey:eP,marshalPublicKey:tP,unmarshalPrivateKey:Jm,marshalPrivateKey:rP,import:nP}});var tv=b((EM,Df)=>{"use strict";function iP(t,{className:e,symbolName:r}){let n=Symbol.for(r),i={[e]:class extends t{constructor(...s){super(...s);Object.defineProperty(this,n,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return i[`is${e}`]=s=>!!(s&&s[n]),i}function sP(t,{className:e,symbolName:r,withoutNew:n}){let i=Symbol.for(r),s={[e]:function(...o){if(n&&!(this instanceof s))return new s(...o);let a=t.call(this,...o)||this;return a&&!a[i]&&Object.defineProperty(a,i,{value:!0}),a}}[e];return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[i]),s}Df.exports=iP;Df.exports.proto=sP});var iv=b((bM,nv)=>{"use strict";var Ks=Sn(),rv=Ks.Reader,oP=Ks.Writer,Ct=Ks.util,ha=Ks.roots["libp2p-peer-id"]||(Ks.roots["libp2p-peer-id"]={});ha.PeerIdProto=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.id=Ct.newBuffer([]),t.prototype.pubKey=Ct.newBuffer([]),t.prototype.privKey=Ct.newBuffer([]),t.encode=function(r,n){return n||(n=oP.create()),n.uint32(10).bytes(r.id),r.pubKey!=null&&Object.hasOwnProperty.call(r,"pubKey")&&n.uint32(18).bytes(r.pubKey),r.privKey!=null&&Object.hasOwnProperty.call(r,"privKey")&&n.uint32(26).bytes(r.privKey),n},t.decode=function(r,n){r instanceof rv||(r=rv.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new ha.PeerIdProto;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.id=r.bytes();break;case 2:s.pubKey=r.bytes();break;case 3:s.privKey=r.bytes();break;default:r.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw Ct.ProtocolError("missing required 'id'",{instance:s});return s},t.fromObject=function(r){if(r instanceof ha.PeerIdProto)return r;var n=new ha.PeerIdProto;return r.id!=null&&(typeof r.id=="string"?Ct.base64.decode(r.id,n.id=Ct.newBuffer(Ct.base64.length(r.id)),0):r.id.length&&(n.id=r.id)),r.pubKey!=null&&(typeof r.pubKey=="string"?Ct.base64.decode(r.pubKey,n.pubKey=Ct.newBuffer(Ct.base64.length(r.pubKey)),0):r.pubKey.length&&(n.pubKey=r.pubKey)),r.privKey!=null&&(typeof r.privKey=="string"?Ct.base64.decode(r.privKey,n.privKey=Ct.newBuffer(Ct.base64.length(r.privKey)),0):r.privKey.length&&(n.privKey=r.privKey)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.id="":(i.id=[],n.bytes!==Array&&(i.id=Ct.newBuffer(i.id))),n.bytes===String?i.pubKey="":(i.pubKey=[],n.bytes!==Array&&(i.pubKey=Ct.newBuffer(i.pubKey))),n.bytes===String?i.privKey="":(i.privKey=[],n.bytes!==Array&&(i.privKey=Ct.newBuffer(i.privKey)))),r.id!=null&&r.hasOwnProperty("id")&&(i.id=n.bytes===String?Ct.base64.encode(r.id,0,r.id.length):n.bytes===Array?Array.prototype.slice.call(r.id):r.id),r.pubKey!=null&&r.hasOwnProperty("pubKey")&&(i.pubKey=n.bytes===String?Ct.base64.encode(r.pubKey,0,r.pubKey.length):n.bytes===Array?Array.prototype.slice.call(r.pubKey):r.pubKey),r.privKey!=null&&r.hasOwnProperty("privKey")&&(i.privKey=n.bytes===String?Ct.base64.encode(r.privKey,0,r.privKey.length):n.bytes===Array?Array.prototype.slice.call(r.privKey):r.privKey),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ks.util.toJSONOptions)},t}();nv.exports=ha});var qt=b((jt,dv)=>{"use strict";var{CID:Lf}=(Ss(),Fo),aP=(Ii(),Ci),cP=(ml(),ic),uP=(Vn(),Kn),lP=(Ko(),xs),{base58btc:kf}=(Vn(),Kn),{base32:fP}=(Ii(),Ci),{base16:sv}=(vl(),sc),pa=(Ai(),Uo),pn=Wc(),dP=tv(),{PeerIdProto:ov}=iv(),{equals:Fi}=(Sr(),_r),{fromString:ya}=(Dt(),Ft),{toString:hP}=(Lt(),Kt),{identity:Yc}=(Rc(),Qo),av={...aP,...cP,...uP,...lP},pP=Object.keys(av).reduce((t,e)=>t.or(av[e]),fP.decoder),yP=112,cv=114,uv=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(r&&n&&!Fi(r.public.bytes,n.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=kf.encode(this.id).substring(1),this._privKey=r,this._pubKey=n}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=pa.decode(this.id);e.code===Yc.code&&(this._pubKey=pn.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return pn.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return pn.marshalPrivateKey(this.privKey)}marshal(e){return ov.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let r=6;return e.length<r&&(r=e.length),"<peer.ID "+e.substr(0,r)+">"}toJSON(){return{id:this.toB58String(),privKey:fv(this.marshalPrivKey()),pubKey:fv(this.marshalPubKey())}}toHexString(){return sv.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=Lf.createV1(cv,pa.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return Fi(this.id,e);if(e.id)return Fi(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&Fi(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(pa.decode(this.id).code===Yc.code)return!0}catch(e){}return!1}},yn=dP(uv,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});jt=dv.exports=yn;var ga=t=>t.bytes.length<=42?pa.create(Yc.code,t.bytes).bytes:t.hash(),qf=async(t,e)=>{let r=await ga(e);return new yn(r,t,e)};jt.create=async t=>{t=t||{},t.bits=t.bits||2048,t.keyType=t.keyType||"RSA";let e=await pn.generateKeyPair(t.keyType,t.bits);return qf(e,e.public)};jt.createFromHexString=t=>new yn(sv.decode("f"+t));jt.createFromBytes=t=>{try{let e=Lf.decode(t);if(!lv(e))throw new Error("Supplied PeerID CID is invalid");return jt.createFromCID(e)}catch{if(pa.decode(t).code!==Yc.code)throw new Error("Supplied PeerID CID is invalid");return new yn(t)}};jt.createFromB58String=t=>jt.createFromBytes(kf.decode("z"+t));var lv=t=>t.code===cv||t.code===yP;jt.createFromCID=t=>{if(t=Lf.asCID(t),!t||!lv(t))throw new Error("Supplied PeerID CID is invalid");return new yn(t.multihash.bytes)};jt.createFromPubKey=async t=>{let e=t;if(typeof e=="string"&&(e=ya(t,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let r=await pn.unmarshalPublicKey(e);return qf(void 0,r)};jt.createFromPrivKey=async t=>{if(typeof t=="string"&&(t=ya(t,"base64pad")),!(t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await pn.unmarshalPrivateKey(t);return qf(e,e.public)};jt.createFromJSON=async t=>{let e=kf.decode("z"+t.id),r=t.privKey&&ya(t.privKey,"base64pad"),n=t.pubKey&&ya(t.pubKey,"base64pad"),i=n&&await pn.unmarshalPublicKey(n);if(!r)return new yn(e,void 0,i);let s=await pn.unmarshalPrivateKey(r),o=await ga(s.public),a;if(i&&(a=await ga(i)),i&&!Fi(o,a))throw new Error("Public and private key do not match");if(e&&!Fi(o,e))throw new Error("Id and private key do not match");return new yn(e,s,i)};jt.createFromProtobuf=async t=>{typeof t=="string"&&(t=ya(t,"base16"));let{id:e,privKey:r,pubKey:n}=ov.decode(t);r=r?await pn.unmarshalPrivateKey(r):!1,n=n?await pn.unmarshalPublicKey(n):!1;let i,s;if(r&&(s=await ga(r.public)),n&&(i=await ga(n)),r){if(n&&!Fi(s,i))throw new Error("Public and private key do not match");return new yn(s,r,r.public)}if(n)return new yn(i,void 0,n);if(e)return new yn(e);throw new Error("Protobuf did not contain any usable key material")};jt.parse=t=>((t.charAt(0)==="1"||t.charAt(0)==="Q")&&(t=`z${t}`),jt.createFromBytes(pP.decode(t)));jt.isPeerId=t=>Boolean(typeof t=="object"&&t._id&&t._idB58String);function fv(t){if(t)return hP(t,"base64pad")}});var Mf=b((wM,pv)=>{"use strict";var hv="[a-fA-F\\d:]",ci=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${hv})|(?<=${hv})(?=\\s|$))`:"",jr="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",St="[a-fA-F\\d]{1,4}",Qc=`
(?:
(?:${St}:){7}(?:${St}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${St}:){6}(?:${jr}|:${St}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${St}:){5}(?::${jr}|(?::${St}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${St}:){4}(?:(?::${St}){0,1}:${jr}|(?::${St}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${St}:){3}(?:(?::${St}){0,2}:${jr}|(?::${St}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${St}:){2}(?:(?::${St}){0,3}:${jr}|(?::${St}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${St}:){1}(?:(?::${St}){0,4}:${jr}|(?::${St}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${St}){0,5}:${jr}|(?::${St}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),gP=new RegExp(`(?:^${jr}$)|(?:^${Qc}$)`),mP=new RegExp(`^${jr}$`),vP=new RegExp(`^${Qc}$`),Uf=t=>t&&t.exact?gP:new RegExp(`(?:${ci(t)}${jr}${ci(t)})|(?:${ci(t)}${Qc}${ci(t)})`,"g");Uf.v4=t=>t&&t.exact?mP:new RegExp(`${ci(t)}${jr}${ci(t)}`,"g");Uf.v6=t=>t&&t.exact?vP:new RegExp(`${ci(t)}${Qc}${ci(t)}`,"g");pv.exports=Uf});var Kf=b((_M,yv)=>{"use strict";var Ff=Mf(),Vs=t=>Ff({exact:!0}).test(t);Vs.v4=t=>Ff.v4({exact:!0}).test(t);Vs.v6=t=>Ff.v6({exact:!0}).test(t);Vs.version=t=>Vs(t)?Vs.v4(t)?4:6:void 0;yv.exports=Vs});var bv=b((SM,Ev)=>{"use strict";var Vf=Kf(),{toString:gv}=(Lt(),Kt),EP=Vf,jf=Vf.v4,mv=Vf.v6,vv=function(t,e,r){r=~~r;let n;if(jf(t))n=e||new Uint8Array(r+4),t.split(/\./g).map(function(i){n[r++]=parseInt(i,10)&255});else if(mv(t)){let i=t.split(":",8),s;for(s=0;s<i.length;s++){let o=jf(i[s]),a;o&&(a=vv(i[s]),i[s]=gv(a.slice(0,2),"base16")),a&&++s<8&&i.splice(s,0,gv(a.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(s=0;s<i.length&&i[s]!=="";s++);let o=[s,"1"];for(s=9-i.length;s>0;s--)o.push("0");i.splice.apply(i,o)}for(n=e||new Uint8Array(r+16),s=0;s<i.length;s++){let o=parseInt(i[s],16);n[r++]=o>>8&255,n[r++]=o&255}}if(!n)throw Error("Invalid ip address: "+t);return n},bP=function(t,e,r){e=~~e,r=r||t.length-e;let n=[],i,s=new DataView(t.buffer);if(r===4){for(let o=0;o<r;o++)n.push(t[e+o]);i=n.join(".")}else if(r===16){for(let o=0;o<r;o+=2)n.push(s.getUint16(e+o).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};Ev.exports={isIP:EP,isV4:jf,isV6:mv,toBytes:vv,toString:bP}});var ma=b((xM,_v)=>{"use strict";function or(t){if(typeof t=="number"){if(or.codes[t])return or.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(or.names[t])return or.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var Tr=-1;or.lengthPrefixedVarSize=Tr;or.V=Tr;or.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Tr,"ip6zone"],[53,Tr,"dns","resolvable"],[54,Tr,"dns4","resolvable"],[55,Tr,"dns6","resolvable"],[56,Tr,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Tr,"unix",!1,"path"],[421,Tr,"ipfs"],[421,Tr,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Tr,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Tr,"memory"]];or.names={};or.codes={};or.table.map(t=>{let e=wv.apply(null,t);return or.codes[e.code]=e,or.names[e.name]=e,null});or.object=wv;function wv(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}_v.exports=or});var Av=b((AM,xv)=>{xv.exports=$f;var Sv=128,wP=127,_P=~wP,SP=Math.pow(2,31);function $f(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw $f.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=SP;)e[r++]=t&255|Sv,t/=128;for(;t&_P;)e[r++]=t&255|Sv,t>>>=7;return e[r]=t|0,$f.bytes=r-n+1,e}});var Tv=b((CM,Iv)=>{Iv.exports=Hf;var xP=128,Cv=127;function Hf(t,e){var r=0,e=e||0,n=0,i=e,s,o=t.length;do{if(i>=o||n>49)throw Hf.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=n<28?(s&Cv)<<n:(s&Cv)*Math.pow(2,n),n+=7}while(s>=xP);return Hf.bytes=i-e,r}});var Bv=b((IM,Rv)=>{var AP=Math.pow(2,7),CP=Math.pow(2,14),IP=Math.pow(2,21),TP=Math.pow(2,28),RP=Math.pow(2,35),BP=Math.pow(2,42),PP=Math.pow(2,49),NP=Math.pow(2,56),OP=Math.pow(2,63);Rv.exports=function(t){return t<AP?1:t<CP?2:t<IP?3:t<TP?4:t<RP?5:t<BP?6:t<PP?7:t<NP?8:t<OP?9:10}});var Ki=b((TM,Pv)=>{Pv.exports={encode:Av(),decode:Tv(),encodingLength:Bv()}});var Mv=b((RM,Uv)=>{"use strict";var Xc=bv(),Nv=ma(),{CID:DP}=(Ss(),Fo),{base32:Ov}=(Ii(),Ci),{base58btc:LP}=(Vn(),Kn),kP=(Ai(),Uo),js=Ki(),{toString:Zc}=(Lt(),Kt),{fromString:Dv}=(Dt(),Ft),{concat:Jc}=(ei(),Jn);Uv.exports=va;function va(t,e){return e instanceof Uint8Array?va.toString(t,e):va.toBytes(t,e)}va.toString=function(e,r){switch(Nv(e).code){case 4:case 41:return qP(r);case 6:case 273:case 33:case 132:return kv(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return MP(r);case 421:return KP(r);case 444:return qv(r);case 445:return qv(r);default:return Zc(r,"base16")}};va.toBytes=function(e,r){switch(Nv(e).code){case 4:return Lv(r);case 41:return Lv(r);case 6:case 273:case 33:case 132:return zf(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return UP(r);case 421:return FP(r);case 444:return VP(r);case 445:return jP(r);default:return Dv(r,"base16")}};function Lv(t){if(!Xc.isIP(t))throw new Error("invalid ip address");return Xc.toBytes(t)}function qP(t){let e=Xc.toString(t);if(!e||!Xc.isIP(e))throw new Error("invalid ip address");return e}function zf(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function kv(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function UP(t){let e=Dv(t),r=Uint8Array.from(js.encode(e.length));return Jc([r,e],r.length+e.length)}function MP(t){let e=js.decode(t);if(t=t.slice(js.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return Zc(t)}function FP(t){let e;t[0]==="Q"||t[0]==="1"?e=kP.decode(LP.decode(`z${t}`)).bytes:e=DP.parse(t).multihash.bytes;let r=Uint8Array.from(js.encode(e.length));return Jc([r,e],r.length+e.length)}function KP(t){let e=js.decode(t),r=t.slice(js.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return Zc(r,"base58btc")}function VP(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=Ov.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=zf(n);return Jc([r,i],r.length+i.length)}function jP(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=Ov.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=zf(n);return Jc([r,i],r.length+i.length)}function qv(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=Zc(e,"base32"),i=kv(r);return n+":"+i}});var Xv=b((BM,Qv)=>{"use strict";var Fv=Mv(),Gf=ma(),Ea=Ki(),{concat:Kv}=(ei(),Jn),{toString:$P}=(Lt(),Kt);Qv.exports={stringToStringTuples:Vv,stringTuplesToString:jv,tuplesToStringTuples:Hv,stringTuplesToTuples:$v,bytesToTuples:Wf,tuplesToBytes:zv,bytesToString:HP,stringToBytes:Wv,fromString:zP,fromBytes:Yv,validateBytes:Yf,isValidBytes:GP,cleanPath:eu,ParseError:Qf,protoFromTuple:ba,sizeForAddr:Gv};function Vv(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=Gf(i);if(s.size===0){e.push([i]);continue}if(n++,n>=r.length)throw Qf("invalid address: "+t);if(s.path){e.push([i,eu(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function jv(t){let e=[];return t.map(r=>{let n=ba(r);return e.push(n.name),r.length>1&&e.push(r[1]),null}),eu(e.join("/"))}function $v(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=ba(e);return e.length>1?[r.code,Fv.toBytes(r.code,e[1])]:[r.code]})}function Hv(t){return t.map(e=>{let r=ba(e);return e[1]?[r.code,Fv.toString(r.code,e[1])]:[r.code]})}function zv(t){return Yv(Kv(t.map(e=>{let r=ba(e),n=Uint8Array.from(Ea.encode(r.code));return e.length>1&&(n=Kv([n,e[1]])),n})))}function Gv(t,e){return t.size>0?t.size/8:t.size===0?0:Ea.decode(e)+Ea.decode.bytes}function Wf(t){let e=[],r=0;for(;r<t.length;){let n=Ea.decode(t,r),i=Ea.decode.bytes,s=Gf(n),o=Gv(s,t.slice(r+i));if(o===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+o);if(r+=o+i,r>t.length)throw Qf("Invalid address Uint8Array: "+$P(t,"base16"));e.push([n,a])}return e}function HP(t){let e=Wf(t),r=Hv(e);return jv(r)}function Wv(t){t=eu(t);let e=Vv(t),r=$v(e);return zv(r)}function zP(t){return Wv(t)}function Yv(t){let e=Yf(t);if(e)throw e;return Uint8Array.from(t)}function Yf(t){try{Wf(t)}catch(e){return e}}function GP(t){return Yf(t)===void 0}function eu(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function Qf(t){return new Error("Error parsing address: "+t)}function ba(t){return Gf(t[0])}});var $t=b((PM,e1)=>{"use strict";var $r=Xv(),$s=ma(),Zv=Ki(),{CID:WP}=(Ss(),Fo),{base58btc:YP}=(Vn(),Kn),QP=ge(),XP=Symbol.for("nodejs.util.inspect.custom"),{toString:tu}=(Lt(),Kt),{equals:ZP}=(Sr(),_r),Xf=new Map,Jv=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Qt=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,Jv,{value:!0}),e instanceof Uint8Array)this.bytes=$r.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=$r.fromString(e)}else if(Qt.isMultiaddr(e))this.bytes=$r.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return $r.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},$s(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=Zv.decode(r,n),s=Zv.decode.bytes,o=$s(i);n+=$r.sizeForAddr(o,r.slice(n+s))+s,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return $r.bytesToTuples(this.bytes)}stringTuples(){let e=$r.bytesToTuples(this.bytes);return $r.tuplesToStringTuples(e)}encapsulate(e){return e=new Qt(e),new Qt(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new Qt(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Qt($r.tuplesToBytes(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===$s.names.ipfs.code).pop();if(r&&r[1]){let n=r[1];return n[0]==="Q"||n[0]==="1"?tu(YP.decode(`z${n}`),"base58btc"):tu(WP.parse(n).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!$s(r[0]).path)[0][1],e||(e=null)}catch(r){e=null}return e}equals(e){return ZP(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(!e)return[this];let r=Xf.get(e.name);if(!r)throw QP(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(i=>new Qt(i))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new Qt("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return Qt.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof Qt||Boolean(e&&e[Jv])}[XP](){return"<Multiaddr "+tu(this.bytes,"base16")+" - "+$r.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+tu(this.bytes,"base16")+" - "+$r.bytesToString(this.bytes)+">"}};Qt.protocols=$s;Qt.resolvers=Xf;function JP(t){return new Qt(t)}e1.exports={Multiaddr:Qt,multiaddr:JP,protocols:$s,resolvers:Xf}});var Vi=b((NM,t1)=>{"use strict";var eN=async t=>{let e=[];for await(let r of t)e.push(r);return e};t1.exports=eN});var r1,Zf,n1=Te(()=>{r1=Lo(Vi()),Zf=(t,e)=>async function*(){yield*(await(0,r1.default)(t)).sort(e)}()});var wa=b((DM,i1)=>{"use strict";var tN=async t=>{for await(let e of t);};i1.exports=tN});var ji=b((LM,s1)=>{"use strict";var rN=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};s1.exports=rN});var Jf=b((kM,o1)=>{"use strict";var nN=async function*(t,e){let r=0;if(!(e<1)){for await(let n of t)if(yield n,r++,r===e)return}};o1.exports=nN});var ed,$i,td,rd,a1=Te(()=>{n1();ed=Lo(wa()),$i=Lo(ji()),td=Lo(Jf()),rd=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,n){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:n,value:i}of e)await this.put(n,i,r),yield{key:n,value:i}}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}async*deleteMany(e,r={}){for await(let n of e)await this.delete(n,r),yield n}batch(){let e=[],r=[];return{put(n,i){e.push({key:n,value:i})},delete(n){r.push(n)},commit:async n=>{await(0,ed.default)(this.putMany(e,n)),e=[],await(0,ed.default)(this.deleteMany(r,n)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let n=this._all(e,r);if(e.prefix!=null&&(n=(0,$i.default)(n,i=>i.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,s)=>(0,$i.default)(i,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,s)=>Zf(i,s),n)),e.offset!=null){let i=0;n=(0,$i.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,td.default)(n,e.limit)),n}queryKeys(e,r){let n=this._allKeys(e,r);if(e.prefix!=null&&(n=(0,$i.default)(n,i=>i.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,s)=>(0,$i.default)(i,s),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,s)=>Zf(i,s),n)),e.offset!=null){let i=0;n=(0,$i.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,td.default)(n,e.limit)),n}}});var c1,u1=Te(()=>{c1="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var id={};_t(id,{customAlphabet:()=>iN,customRandom:()=>f1,nanoid:()=>nd,random:()=>l1,urlAlphabet:()=>c1});var l1,f1,iN,nd,ru=Te(()=>{u1();l1=t=>crypto.getRandomValues(new Uint8Array(t)),f1=(t,e,r)=>{let n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*n*e/t.length);return(s=e)=>{let o="";for(;;){let a=r(i),c=i;for(;c--;)if(o+=t[a[c]&n]||"",o.length===s)return o}}},iN=(t,e=21)=>f1(t,e,l1),nd=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=r[t]&63;n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n<63?e+="_":e+="-"}return e}});var sd={};_t(sd,{Key:()=>Ut});function sN(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function oN(t){let e=t.split(":");return e[e.length-1]}function aN(t){return[].concat(...t)}var Bn,d1,nu,Ut,iu=Te(()=>{ru();Lt();Dt();Bn="/",d1=new TextEncoder().encode(Bn),nu=d1[0],Ut=class{constructor(e,r){if(typeof e=="string")this._buf=ff(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==nu)throw new Error("Invalid key")}toString(e="utf8"){return hf(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ut(e.join(Bn))}static random(){return new Ut(nd().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new Ut(e):e.uint8Array?new Ut(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=d1),this._buf[0]!==nu){let e=new Uint8Array(this._buf.byteLength+1);e.fill(nu,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===nu;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],o=n[i];if(s<o)return!0;if(s>o)return!1}return r.length<n.length}reverse(){return Ut.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Bn).slice(1)}type(){return sN(this.baseNamespace())}name(){return oN(this.baseNamespace())}instance(e){return new Ut(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Bn)||(e+=Bn),e+=this.type(),new Ut(e)}parent(){let e=this.list();return e.length===1?new Ut(Bn):new Ut(e.slice(0,-1).join(Bn))}child(e){return this.toString()===Bn?e:e.toString()===Bn?this:new Ut(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Ut.withNamespaces([...this.namespaces(),...aN(e.map(r=>r.namespaces()))])}}});function p1(t){return t=t||new Error("Not Found"),(0,h1.default)(t,"ERR_NOT_FOUND")}var h1,y1=Te(()=>{h1=Lo(ge())});var m1={};_t(m1,{MemoryDatastore:()=>g1});var g1,v1=Te(()=>{a1();iu();y1();g1=class extends rd{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw p1();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new Ut(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new Ut(e))}}});var Ye=b(od=>{"use strict";od.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required",NOT_FOUND:"Not found"};od.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_PEER_DIAL_INTERCEPTED:"ERR_PEER_DIAL_INTERCEPTED",ERR_CONNECTION_INTERCEPTED:"ERR_CONNECTION_INTERCEPTED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_NOT_FOUND:"ERR_NOT_FOUND",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID",ERR_FIND_SELF:"ERR_FIND_SELF",ERR_NO_ROUTERS_AVAILABLE:"ERR_NO_ROUTERS_AVAILABLE",ERR_CONNECTION_NOT_MULTIPLEXED:"ERR_CONNECTION_NOT_MULTIPLEXED",ERR_NO_DIAL_TOKENS:"ERR_NO_DIAL_TOKENS",ERR_KEYCHAIN_REQUIRED:"ERR_KEYCHAIN_REQUIRED",ERR_INVALID_CMS:"ERR_INVALID_CMS",ERR_MISSING_KEYS:"ERR_MISSING_KEYS",ERR_NO_KEY:"ERR_NO_KEY",ERR_INVALID_KEY_NAME:"ERR_INVALID_KEY_NAME",ERR_INVALID_KEY_TYPE:"ERR_INVALID_KEY_TYPE",ERR_KEY_ALREADY_EXISTS:"ERR_KEY_ALREADY_EXISTS",ERR_INVALID_KEY_SIZE:"ERR_INVALID_KEY_SIZE",ERR_KEY_NOT_FOUND:"ERR_KEY_NOT_FOUND",ERR_OLD_KEY_NAME_INVALID:"ERR_OLD_KEY_NAME_INVALID",ERR_NEW_KEY_NAME_INVALID:"ERR_NEW_KEY_NAME_INVALID",ERR_PASSWORD_REQUIRED:"ERR_PASSWORD_REQUIRED",ERR_PEM_REQUIRED:"ERR_PEM_REQUIRED",ERR_CANNOT_READ_KEY:"ERR_CANNOT_READ_KEY",ERR_MISSING_PRIVATE_KEY:"ERR_MISSING_PRIVATE_KEY",ERR_INVALID_OLD_PASS_TYPE:"ERR_INVALID_OLD_PASS_TYPE",ERR_INVALID_NEW_PASS_TYPE:"ERR_INVALID_NEW_PASS_TYPE",ERR_INVALID_PASS_LENGTH:"ERR_INVALID_PASS_LENGTH",ERR_NOT_IMPLEMENTED:"ERR_NOT_IMPLEMENTED",ERR_WRONG_PING_ACK:"ERR_WRONG_PING_ACK"}});var ad=b((YM,E1)=>{"use strict";var cN=async function*(t,e){for await(let r of t)yield e(r)};E1.exports=cN});var cd=b((QM,b1)=>{"use strict";var uN=ge(),lN=ji(),fN=ad(),dN=Jf();async function*hN(t,e){yield*fN(t,async r=>(await e.addressBook.add(r.id,r.multiaddrs),r))}function pN(t){let e=new Set;return lN(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*yN(t,e=1){let r=0;for await(let n of t)r++,yield n;if(r<e)throw uN(new Error("not found"),"NOT_FOUND")}function gN(t,e){return e?dN(t,e):t}b1.exports={storeAddresses:hN,uniquePeers:pN,requirePeers:yN,maybeLimitSource:gN}});var _1=b((XM,w1)=>{"use strict";w1.exports=function(){return Date.now()}});var _a=b((ZM,x1)=>{"use strict";var su=_1(),S1=class{constructor(e,r,n){let i=this;this._started=su(),this._rescheduled=0,this._scheduled=r,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(su()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=su();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=su(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function mN(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new S1(arguments[0],arguments[1],t)}x1.exports=mN});var ud=b((JM,C1)=>{"use strict";var{AbortController:vN}=globalThis,A1=_a(),ou=class extends vN{constructor(e){super();this._ms=e,this._timer=A1(()=>this.abort(),e),Object.setPrototypeOf(this,ou.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=A1(()=>this.abort(),this._ms)}};C1.exports={TimeoutController:ou}});var T1=b((tF,I1)=>{I1.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var ld=b((nF,B1)=>{var R1=T1();B1.exports=class{constructor(e){this.hwm=e||16,this.head=new R1(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new R1(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var dd=b((iF,P1)=>{var fd=ld();P1.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new fd,n,i,s,o=()=>{if(!r.isEmpty()){if(t.writev){let g,v=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;v.push(g.value)}return{done:g.done,value:v}}let h=r.shift();if(h.error)throw h.error;return h}return s?{done:!0}:new Promise((h,g)=>{i=v=>(i=null,v.error?g(v.error):t.writev&&!v.done?h({done:v.done,value:[v.value]}):h(v),n)})},a=h=>i?i(h):(r.push(h),n),c=h=>(r=new fd,i?i({error:h}):(r.push({error:h}),n)),u=h=>s?n:a({done:!1,value:h}),l=h=>s?n:(s=!0,h?c(h):a({done:!0})),f=()=>(r=new fd,l(),{done:!0}),d=h=>(l(h),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:f,throw:d,push:u,end:l},!e)return n;let p=n;return n={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(h){return p.throw(h),e&&(e(h),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(h){return p.end(h),e&&(e(h),e=null),n}},n}});var hd=b((sF,N1)=>{"use strict";var EN=dd(),bN=async function*(...t){let e=EN();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};N1.exports=bN});var fr=b((oF,Hs)=>{var O1=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},pd=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),au=t=>t&&typeof t.sink=="function"&&pd(t.source),wN=t=>e=>(t.sink(e),t.source),D1=(...t)=>{if(au(t[0])){let e=t[0];t[0]=()=>e.source}else if(pd(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&au(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)au(t[e])&&(t[e]=wN(t[e]));return O1(...t)};Hs.exports=D1;Hs.exports.pipe=D1;Hs.exports.rawPipe=O1;Hs.exports.isIterable=pd;Hs.exports.isDuplex=au});var yd=b((aF,L1)=>{"use strict";var _N=async t=>{for await(let e of t)return e};L1.exports=_N});var gd=b((cF,k1)=>{"use strict";var zs=new Map,SN=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function xN(t,e,r){for(;zs.get(r);){try{await t()}catch(n){setTimeout(()=>{throw n},1);break}if(!zs.get(r))break;await new Promise(n=>{let i=setTimeout(n,e);zs.set(r,i)})}}function AN(t,e,r){r=r||e;let n=SN(),i=setTimeout(()=>{xN(t,e,n)},r);return zs.set(n,i),n}function CN(t){let e=zs.get(t);e&&(clearTimeout(e),zs.delete(t))}k1.exports={setDelayedInterval:AN,clearDelayedInterval:CN}});var M1=b((uF,U1)=>{"use strict";var IN=ge(),{messages:TN,codes:RN}=Ye(),q1=class{constructor(e){this._dht=e}async findPeer(e,r={}){for await(let n of this._dht.findPeer(e,r))if(n.name==="FINAL_PEER")return n.peer;throw IN(new Error(TN.NOT_FOUND),RN.ERR_NOT_FOUND)}async*getClosestPeers(e,r={}){for await(let n of this._dht.getClosestPeers(e,r))n.name==="PEER_RESPONSE"&&(yield*n.closer)}};U1.exports={DHTPeerRouting:q1}});var W1=b((lF,G1)=>{"use strict";var F1=Oe(),K1=Object.assign(F1("libp2p:peer-routing"),{error:F1("libp2p:peer-routing:err")}),cu=ge(),Sa=Ye(),{storeAddresses:V1,uniquePeers:BN,requirePeers:PN}=cd(),{TimeoutController:NN}=ud(),j1=hd(),{pipe:$1}=fr(),ON=yd(),DN=wa(),LN=ji(),{setDelayedInterval:kN,clearDelayedInterval:qN}=gd(),{DHTPeerRouting:UN}=M1(),{setMaxListeners:H1}=rr(),z1=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(new UN(e._dht)),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=kN(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await DN(this.getClosestPeers(this._peerId.id,{timeout:this._refreshManagerOptions.timeout||1e4}))}catch(e){K1.error(e)}}stop(){qN(this._timeoutId)}async findPeer(e,r){if(!this._routers.length)throw cu(new Error("No peer routers available"),Sa.codes.ERR_NO_ROUTERS_AVAILABLE);if(e.toB58String()===this._peerId.toB58String())throw cu(new Error("Should not try to find self"),Sa.codes.ERR_FIND_SELF);let n=await $1(j1(...this._routers.map(i=>async function*(){try{yield await i.findPeer(e,r)}catch(s){K1.error(s)}}())),i=>LN(i,Boolean),i=>V1(i,this._peerStore),i=>ON(i));if(n)return n;throw cu(new Error(Sa.messages.NOT_FOUND),Sa.codes.ERR_NOT_FOUND)}async*getClosestPeers(e,r={timeout:3e4}){if(!this._routers.length)throw cu(new Error("No peer routers available"),Sa.codes.ERR_NO_ROUTERS_AVAILABLE);if(r.timeout){let n=new NN(r.timeout);try{H1&&H1(1/0,n.signal)}catch{}r.signal=n.signal}yield*$1(j1(...this._routers.map(n=>n.getClosestPeers(e,r))),n=>V1(n,this._peerStore),n=>BN(n),n=>PN(n))}};G1.exports=z1});var X1=b((fF,Q1)=>{"use strict";var MN=wa(),Y1=class{constructor(e){this._dht=e}async provide(e){await MN(this._dht.provide(e))}async*findProviders(e,r){for await(let n of this._dht.findProviders(e,r))n.name==="PROVIDER"&&(yield*n.providers)}};Q1.exports={DHTContentRouting:Y1}});var eE=b((dF,J1)=>{"use strict";var Hi=ge(),{messages:xa,codes:zi}=Ye(),{storeAddresses:FN,uniquePeers:KN,requirePeers:VN,maybeLimitSource:jN}=cd(),$N=wa(),HN=hd(),{pipe:zN}=fr(),{DHTContentRouting:GN}=X1(),Z1=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(new GN(this.dht))}async*findProviders(e,r={}){if(!this.routers.length)throw Hi(new Error("No content this.routers available"),zi.ERR_NO_ROUTERS_AVAILABLE);yield*zN(HN(...this.routers.map(n=>n.findProviders(e,r))),n=>FN(n,this.libp2p.peerStore),n=>KN(n),n=>jN(n,r.maxNumProviders),n=>VN(n))}async provide(e){if(!this.routers.length)throw Hi(new Error("No content routers available"),zi.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(r=>r.provide(e)))}async put(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Hi(new Error(xa.NOT_STARTED_YET),zi.DHT_NOT_STARTED);await $N(this.dht.put(e,r,n))}async get(e,r){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Hi(new Error(xa.NOT_STARTED_YET),zi.DHT_NOT_STARTED);for await(let n of this.dht.get(e,r))if(n.name==="VALUE")return{from:n.peerId,val:n.value};throw Hi(new Error(xa.NOT_FOUND),zi.ERR_NOT_FOUND)}async*getMany(e,r,n){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Hi(new Error(xa.NOT_STARTED_YET),zi.DHT_NOT_STARTED);if(!r)return;let i=0;for await(let s of this.dht.get(e,n))if(s.name==="VALUE"&&(yield{from:s.peerId,val:s.value},i++,i===r))break;if(i===0)throw Hi(new Error(xa.NOT_FOUND),zi.ERR_NOT_FOUND)}};J1.exports=Z1});var md=b((hF,iE)=>{"use strict";var WN=qt(),{Multiaddr:tE}=$t(),rE=ge(),{codes:nE}=Ye();function YN(t){typeof t=="string"&&(t=new tE(t));let e;if(tE.isMultiaddr(t)){e=t;let r=t.getPeerId();if(!r)throw rE(new Error(`${t} does not have a valid peer type`),nE.ERR_INVALID_MULTIADDR);try{t=WN.createFromB58String(r)}catch(n){throw rE(new Error(`${t} is not a valid peer type`),nE.ERR_INVALID_MULTIADDR)}}return{id:t,multiaddrs:e?[e]:void 0}}iE.exports=YN});var oE=b((pF,sE)=>{"use strict";sE.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var Ys=b((lE,fE)=>{"use strict";var uu=oE(),{hasOwnProperty:aE}=Object.prototype,{propertyIsEnumerable:QN}=Object,Gs=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),XN=lE,cE={concatArrays:!1,ignoreUndefined:!1},lu=t=>{let e=[];for(let r in t)aE.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)QN.call(t,n)&&e.push(n)}return e};function Ws(t){return Array.isArray(t)?ZN(t):uu(t)?JN(t):t}function ZN(t){let e=t.slice(0,0);return lu(t).forEach(r=>{Gs(e,r,Ws(t[r]))}),e}function JN(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return lu(t).forEach(r=>{Gs(e,r,Ws(t[r]))}),e}var uE=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]=="undefined"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?Gs(t,i,vd(t[i],e[i],n)):Gs(t,i,Ws(e[i])))}),t),eO=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!aE.call(s,a)||(o.push(String(a)),s===t?Gs(n,i++,s[a]):Gs(n,i++,Ws(s[a])));n=uE(n,s,lu(s).filter(a=>!o.includes(a)),r)}),n};function vd(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?eO(t,e,r):!uu(e)||!uu(t)?Ws(e):uE(t,e,lu(e),r)}fE.exports=function(...t){let e=vd(Ws(cE),this!==XN&&this||{},cE),r={_:{}};for(let n of t)if(n!==void 0){if(!uu(n))throw new TypeError("`"+n+"` is not an Option Object");r=vd(r,{_:n},e)}return r._}});var pE=b((yF,hE)=>{"use strict";hE.exports=dE;var tO=dl(),ui=dE.prototype,rO=new Date%1e9;function nO(){return(Math.random()*1e9>>>0)+rO++}function dE(t){t=t||{},this.id=t.id||nO(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}ui.has=function(t){return t in this._lookup};ui.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};ui.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};ui.set=function(t,e,r){var n=this._lookup[t],i=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this};ui.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};ui.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=tO(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this};ui.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};ui.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var Aa=b((Qs,yE)=>{"use strict";var iO=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Pn!="undefined")return Pn;throw new Error("unable to locate global object")},Pn=iO();yE.exports=Qs=Pn.fetch;Pn.fetch&&(Qs.default=Pn.fetch.bind(Pn));Qs.Headers=Pn.Headers;Qs.Request=Pn.Request;Qs.Response=Pn.Response});var gE=b((gF,Ed)=>{"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?Ed.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:Ed.exports={default:Aa().default,Headers:Aa().Headers,Request:Aa().Request,Response:Aa().Response}});var vE=b((mF,mE)=>{"use strict";var{default:sO,Headers:oO}=gE();function aO({serverResolver:t,hostname:e,recordType:r}){return`${t}?name=${e}&type=${r}`}function cO(t){return sO(t,{headers:new oO({accept:"application/dns-json"})})}function uO(t,e){return`${e}_${t}`}mE.exports={buildResource:aO,fetch:cO,getCacheKey:uO}});var wE=b((vF,bE)=>{"use strict";var EE=Oe(),fu=EE("dns-over-http-resolver");fu.error=EE("dns-over-http-resolver:error");var lO=pE(),Rr=vE(),du=class{constructor({maxCache:e=100}={}){this._cache=new lO({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let r=e.length-1;r>0;r--){let n=Math.floor(Math.random()*r),i=e[r];e[r]=e[n],e[n]=i}return e}setServers(e){this._servers=e}resolve(e,r="A"){switch(r){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",n=this._cache.get(Rr.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await Rr.fetch(Rr.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Rr.getCacheKey(e,r),a,{ttl:c}),a}catch(s){fu.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",n=this._cache.get(Rr.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await Rr.fetch(Rr.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Rr.getCacheKey(e,r),a,{ttl:c}),a}catch(s){fu.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",n=this._cache.get(Rr.getCacheKey(e,r));if(n)return n;for(let i of this._getShuffledServers())try{let o=await(await Rr.fetch(Rr.buildResource({serverResolver:i,hostname:e,recordType:r}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(Rr.getCacheKey(e,r),a,{ttl:c}),a}catch(s){fu.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}};du.Resolver=du;bE.exports=du});var SE=b((EF,_E)=>{"use strict";var fO=wE();_E.exports=fO});var AE=b((bF,xE)=>{"use strict";var dO=ma(),{code:hO}=dO("dnsaddr");async function pO(t){let e=SE(),r=new e,n=t.getPeerId(),[,i]=t.stringTuples().find(([a])=>a===hO)||[],o=(await r.resolveTxt(`_dnsaddr.${i}`)).flat().map(a=>a.split("=")[1]);return n&&(o=o.filter(a=>a.includes(n))),o}xE.exports={dnsaddrResolver:pO}});var hu=b((wF,CE)=>{"use strict";CE.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var bd=b((_F,yO)=>{yO.exports={name:"libp2p",version:"0.36.2",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:fetch && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:fetch":"pbjs -t static-module -w commonjs -r libp2p-fetch --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/fetch/proto.js ./src/fetch/proto.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:peer":"pbjs -t static-module -w commonjs -r libp2p-peer --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/pb/peer.js ./src/peer-store/pb/peer.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:fetch && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:fetch":"pbts -o src/fetch/proto.d.ts src/fetch/proto.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:peer":"pbts -o src/peer-store/pb/peer.d.ts src/peer-store/pb/peer.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all","test:interop":"LIBP2P_JS=$PWD npx aegir test -t node -f ./node_modules/libp2p-interop/test/*",prepare:"npm run build",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=15.0.0"},browser:{"nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use","*.d.ts"]},dependencies:{"@vascosantos/moving-average":"^1.1.0","abortable-iterator":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^3.0.0","bignumber.js":"^9.0.1","class-is":"^1.1.0","datastore-core":"^7.0.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^7.0.0",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^6.0.2","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-foreach":"^0.1.1","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-sort":"^1.0.1","it-take":"^1.0.0","libp2p-crypto":"^0.21.2","libp2p-interfaces":"^4.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.1",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^3.0.0","mutable-proxy":"^1.0.0","nat-api":"^0.3.1","node-forge":"^1.2.1","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.16.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^3.0.0",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^5.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^1.0.0","@types/varint":"^6.0.0",aegir:"^36.0.0",buffer:"^6.0.3",delay:"^5.0.0","into-stream":"^6.0.0","ipfs-http-client":"^54.0.2","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.14.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.11.1","libp2p-interfaces-compliance-tests":"^4.0.8","libp2p-interop":"^0.7.1","libp2p-kad-dht":"^0.28.6","libp2p-mdns":"^0.18.0","libp2p-mplex":"^0.10.4","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.25.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^12.0.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","dirkmc <dirkmdev@gmail.com>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Robert Kiel <robert.kiel@hoprnet.org>","Richard Littauer <richard.littauer@gmail.com>","a1300 <matthias-knopp@gmx.net>","Ryan Bell <ryan@piing.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Franck Royer <franck@royer.one>","Thomas Eizinger <thomas@eizinger.io>","V\xEDt Habada <vithabada93@gmail.com>","Giovanni T. Parra <fiatjaf@gmail.com>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Alan Smithee <ggnore.alan.smithee@gmail.com>","Elven <mon.samuel@qq.com>","Samlior <samlior@foxmail.com>","Didrik Nordstr\xF6m <didrik.nordstrom@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","TJKoury <TJKoury@gmail.com>","TheStarBoys <41286328+TheStarBoys@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Tim Daubensch\xFCtz <tim@daubenschuetz.de>","XiaoZhang <zxinmyth@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","isan_rivkin <isanrivkin@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","mcclure <andi.m.mcclure@gmail.com>","patrickwoodhead <91056047+patrickwoodhead@users.noreply.github.com>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","swedneck <40505480+swedneck@users.noreply.github.com>","tuyennhv <vutuyen2636@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","Aleksei <vozhdb@gmail.com>","Bernd Strehl <bernd.strehl@gmail.com>","Chris Bratlien <chrisbratlien@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Ethan Lam <elmemphis2000@gmail.com>","Fei Liu <liu.feiwood@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","Francis Gulotta <wizard@roborooter.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Leask Wong <i@leaskh.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Marston Connell <34043723+TheMarstonConnell@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>"]}});var wd=b((SF,gn)=>{"use strict";var gO=bd().version;gn.exports.PROTOCOL_VERSION="ipfs/0.1.0";gn.exports.AGENT_VERSION=`js-libp2p/${gO}`;gn.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";gn.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";gn.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";gn.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";gn.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";gn.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";gn.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var pu=b((xF,TE)=>{"use strict";var IE=60*1e3;TE.exports={ADVERTISE_BOOT_DELAY:15*IE,ADVERTISE_TTL:30*IE,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var RE=b(Ca=>{(function(){var t,e,r,n,i,s,o,a;a=function(c){var u,l,f,d;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,f=(c&255<<8)>>>8,d=c&255,[u,l,f,d].join(".")},o=function(c){var u,l,f,d,p,h;for(u=[],f=d=0;d<=3&&c.length!==0;f=++d){if(f>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}h=e(c),p=h[0],l=h[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(c){return c.charCodeAt(0)},n=r("0"),s=r("a"),i=r("A"),e=function(c){var u,l,f,d,p;for(d=0,u=10,l="9",f=0,c.length>1&&c[f]==="0"&&(c[f+1]==="x"||c[f+1]==="X"?(f+=2,u=16):"0"<=c[f+1]&&c[f+1]<="9"&&(f++,u=8,l="7")),p=f;f<c.length;){if("0"<=c[f]&&c[f]<=l)d=d*u+(r(c[f])-n)>>>0;else if(u===16)if("a"<=c[f]&&c[f]<="f")d=d*u+(10+r(c[f])-s)>>>0;else if("A"<=c[f]&&c[f]<="F")d=d*u+(10+r(c[f])-i)>>>0;else break;else break;if(d>4294967295)throw new Error("too large");f++}if(f===p)throw new Error("empty octet");return[d,f]},t=function(){function c(u,l){var f,d,p,h;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(h=u.split("/",2),u=h[0],l=h[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(g){throw f=g,new Error("Invalid mask: "+l)}for(d=p=32;p>=0;d=--p)if(this.maskLong===4294967295<<32-d>>>0){this.bitmask=d;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(g){throw f=g,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,f,d;for(d=o(this.first),f=o(this.last),l=0;d<=f;)u(a(d),d,l),l++,d++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),Ca.ip2long=o,Ca.long2ip=a,Ca.Netmask=t}).call(Ca)});var PE=b((BE,yu)=>{(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},n=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),s="%[0-9a-z]{1,}",o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(s,"i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(${s})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${s})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${e}\\.${e}\\.${e}\\.${e}(${s})?$`,"i")};function c(p,h){if(p.indexOf("::")!==p.lastIndexOf("::"))return null;let g=0,v=-1,w=(p.match(a.zoneIndex)||[])[0],C,q;for(w&&(w=w.substring(1),p=p.replace(/%.+$/,""));(v=p.indexOf(":",v+1))>=0;)g++;if(p.substr(0,2)==="::"&&g--,p.substr(-2,2)==="::"&&g--,g>h)return null;for(q=h-g,C=":";q--;)C+="0:";return p=p.replace("::",C),p[0]===":"&&(p=p.slice(1)),p[p.length-1]===":"&&(p=p.slice(0,-1)),h=function(){let W=p.split(":"),F=[];for(let M=0;M<W.length;M++)F.push(parseInt(W[M],16));return F}(),{parts:h,zoneId:w}}function u(p,h,g,v){if(p.length!==h.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let w=0,C;for(;v>0;){if(C=g-v,C<0&&(C=0),p[w]>>C!=h[w]>>C)return!1;v-=g,w+=1}return!0}function l(p){if(i.test(p))return parseInt(p,16);if(p[0]==="0"&&!isNaN(parseInt(p[1],10))){if(n.test(p))return parseInt(p,8);throw new Error(`ipaddr: cannot parse ${p} as octal`)}return parseInt(p,10)}function f(p,h){for(;p.length<h;)p=`0${p}`;return p}let d={};d.IPv4=function(){function p(h){if(h.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let g,v;for(g=0;g<h.length;g++)if(v=h[g],!(0<=v&&v<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=h}return p.prototype.SpecialRanges={unspecified:[[new p([0,0,0,0]),8]],broadcast:[[new p([255,255,255,255]),32]],multicast:[[new p([224,0,0,0]),4]],linkLocal:[[new p([169,254,0,0]),16]],loopback:[[new p([127,0,0,0]),8]],carrierGradeNat:[[new p([100,64,0,0]),10]],private:[[new p([10,0,0,0]),8],[new p([172,16,0,0]),12],[new p([192,168,0,0]),16]],reserved:[[new p([192,0,0,0]),24],[new p([192,0,2,0]),24],[new p([192,88,99,0]),24],[new p([198,51,100,0]),24],[new p([203,0,113,0]),24],[new p([240,0,0,0]),4]]},p.prototype.kind=function(){return"ipv4"},p.prototype.match=function(h,g){let v;if(g===void 0&&(v=h,h=v[0],g=v[1]),h.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,h.octets,8,g)},p.prototype.prefixLengthFromSubnetMask=function(){let h=0,g=!1,v={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},w,C,q;for(w=3;w>=0;w-=1)if(C=this.octets[w],C in v){if(q=v[C],g&&q!==0)return null;q!==8&&(g=!0),h+=q}else return null;return 32-h},p.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){return this.octets.slice(0)},p.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)},p.prototype.toNormalizedString=function(){return this.toString()},p.prototype.toString=function(){return this.octets.join(".")},p}(),d.IPv4.broadcastAddressFromCIDR=function(p){try{let h=this.parseCIDR(p),g=h[0].toByteArray(),v=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),w=[],C=0;for(;C<4;)w.push(parseInt(g[C],10)|parseInt(v[C],10)^255),C++;return new this(w)}catch(h){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.isIPv4=function(p){return this.parser(p)!==null},d.IPv4.isValid=function(p){try{return new this(this.parser(p)),!0}catch(h){return!1}},d.IPv4.isValidFourPartDecimal=function(p){return!!(d.IPv4.isValid(p)&&p.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},d.IPv4.networkAddressFromCIDR=function(p){let h,g,v,w,C;try{for(h=this.parseCIDR(p),v=h[0].toByteArray(),C=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),w=[],g=0;g<4;)w.push(parseInt(v[g],10)&parseInt(C[g],10)),g++;return new this(w)}catch(q){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},d.IPv4.parse=function(p){let h=this.parser(p);if(h===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(h)},d.IPv4.parseCIDR=function(p){let h;if(h=p.match(/^(.+)\/(\d+)$/)){let g=parseInt(h[2]);if(g>=0&&g<=32){let v=[this.parse(h[1]),g];return Object.defineProperty(v,"toString",{value:function(){return this.join("/")}}),v}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},d.IPv4.parser=function(p){let h,g,v;if(h=p.match(r.fourOctet))return function(){let w=h.slice(1,6),C=[];for(let q=0;q<w.length;q++)g=w[q],C.push(l(g));return C}();if(h=p.match(r.longValue)){if(v=l(h[1]),v>4294967295||v<0)throw new Error("ipaddr: address outside defined range");return function(){let w=[],C;for(C=0;C<=24;C+=8)w.push(v>>C&255);return w}().reverse()}else return(h=p.match(r.twoOctet))?function(){let w=h.slice(1,4),C=[];if(v=l(w[1]),v>16777215||v<0)throw new Error("ipaddr: address outside defined range");return C.push(l(w[0])),C.push(v>>16&255),C.push(v>>8&255),C.push(v&255),C}():(h=p.match(r.threeOctet))?function(){let w=h.slice(1,5),C=[];if(v=l(w[2]),v>65535||v<0)throw new Error("ipaddr: address outside defined range");return C.push(l(w[0])),C.push(l(w[1])),C.push(v>>8&255),C.push(v&255),C}():null},d.IPv4.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>32)throw new Error("ipaddr: invalid IPv4 prefix length");let h=[0,0,0,0],g=0,v=Math.floor(p/8);for(;g<v;)h[g]=255,g++;return v<4&&(h[v]=Math.pow(2,p%8)-1<<8-p%8),new this(h)},d.IPv6=function(){function p(h,g){let v,w;if(h.length===16)for(this.parts=[],v=0;v<=14;v+=2)this.parts.push(h[v]<<8|h[v+1]);else if(h.length===8)this.parts=h;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(v=0;v<this.parts.length;v++)if(w=this.parts[v],!(0<=w&&w<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");g&&(this.zoneId=g)}return p.prototype.SpecialRanges={unspecified:[new p([0,0,0,0,0,0,0,0]),128],linkLocal:[new p([65152,0,0,0,0,0,0,0]),10],multicast:[new p([65280,0,0,0,0,0,0,0]),8],loopback:[new p([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new p([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new p([0,0,0,0,0,65535,0,0]),96],rfc6145:[new p([0,0,0,0,65535,0,0,0]),96],rfc6052:[new p([100,65435,0,0,0,0,0,0]),96],"6to4":[new p([8194,0,0,0,0,0,0,0]),16],teredo:[new p([8193,0,0,0,0,0,0,0]),32],reserved:[[new p([8193,3512,0,0,0,0,0,0]),32]]},p.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},p.prototype.kind=function(){return"ipv6"},p.prototype.match=function(h,g){let v;if(g===void 0&&(v=h,h=v[0],g=v[1]),h.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,h.parts,16,g)},p.prototype.prefixLengthFromSubnetMask=function(){let h=0,g=!1,v={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},w,C;for(let q=7;q>=0;q-=1)if(w=this.parts[q],w in v){if(C=v[w],g&&C!==0)return null;C!==16&&(g=!0),h+=C}else return null;return 128-h},p.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)},p.prototype.toByteArray=function(){let h,g=[],v=this.parts;for(let w=0;w<v.length;w++)h=v[w],g.push(h>>8),g.push(h&255);return g},p.prototype.toFixedLengthString=function(){let h=function(){let v=[];for(let w=0;w<this.parts.length;w++)v.push(f(this.parts[w].toString(16),4));return v}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),h+g},p.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let h=this.parts.slice(-2),g=h[0],v=h[1];return new d.IPv4([g>>8,g&255,v>>8,v&255])},p.prototype.toNormalizedString=function(){let h=function(){let v=[];for(let w=0;w<this.parts.length;w++)v.push(this.parts[w].toString(16));return v}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),h+g},p.prototype.toRFC5952String=function(){let h=/((^|:)(0(:|$)){2,})/g,g=this.toNormalizedString(),v=0,w=-1,C;for(;C=h.exec(g);)C[0].length>w&&(v=C.index,w=C[0].length);return w<0?g:`${g.substring(0,v)}::${g.substring(v+w)}`},p.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},p}(),d.IPv6.broadcastAddressFromCIDR=function(p){try{let h=this.parseCIDR(p),g=h[0].toByteArray(),v=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),w=[],C=0;for(;C<16;)w.push(parseInt(g[C],10)|parseInt(v[C],10)^255),C++;return new this(w)}catch(h){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${h})`)}},d.IPv6.isIPv6=function(p){return this.parser(p)!==null},d.IPv6.isValid=function(p){if(typeof p=="string"&&p.indexOf(":")===-1)return!1;try{let h=this.parser(p);return new this(h.parts,h.zoneId),!0}catch(h){return!1}},d.IPv6.networkAddressFromCIDR=function(p){let h,g,v,w,C;try{for(h=this.parseCIDR(p),v=h[0].toByteArray(),C=this.subnetMaskFromPrefixLength(h[1]).toByteArray(),w=[],g=0;g<16;)w.push(parseInt(v[g],10)&parseInt(C[g],10)),g++;return new this(w)}catch(q){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${q})`)}},d.IPv6.parse=function(p){let h=this.parser(p);if(h.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(h.parts,h.zoneId)},d.IPv6.parseCIDR=function(p){let h,g,v;if((g=p.match(/^(.+)\/(\d+)$/))&&(h=parseInt(g[2]),h>=0&&h<=128))return v=[this.parse(g[1]),h],Object.defineProperty(v,"toString",{value:function(){return this.join("/")}}),v;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},d.IPv6.parser=function(p){let h,g,v,w,C,q;if(v=p.match(a.deprecatedTransitional))return this.parser(`::ffff:${v[1]}`);if(a.native.test(p))return c(p,8);if((v=p.match(a.transitional))&&(q=v[6]||"",h=c(v[1].slice(0,-1)+q,6),h.parts)){for(C=[parseInt(v[2]),parseInt(v[3]),parseInt(v[4]),parseInt(v[5])],g=0;g<C.length;g++)if(w=C[g],!(0<=w&&w<=255))return null;return h.parts.push(C[0]<<8|C[1]),h.parts.push(C[2]<<8|C[3]),{parts:h.parts,zoneId:h.zoneId}}return null},d.IPv6.subnetMaskFromPrefixLength=function(p){if(p=parseInt(p),p<0||p>128)throw new Error("ipaddr: invalid IPv6 prefix length");let h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,v=Math.floor(p/8);for(;g<v;)h[g]=255,g++;return v<16&&(h[v]=Math.pow(2,p%8)-1<<8-p%8),new this(h)},d.fromByteArray=function(p){let h=p.length;if(h===4)return new d.IPv4(p);if(h===16)return new d.IPv6(p);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},d.isValid=function(p){return d.IPv6.isValid(p)||d.IPv4.isValid(p)},d.parse=function(p){if(d.IPv6.isValid(p))return d.IPv6.parse(p);if(d.IPv4.isValid(p))return d.IPv4.parse(p);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},d.parseCIDR=function(p){try{return d.IPv6.parseCIDR(p)}catch(h){try{return d.IPv4.parseCIDR(p)}catch(g){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},d.process=function(p){let h=this.parse(p);return h.kind()==="ipv6"&&h.isIPv4MappedAddress()?h.toIPv4Address():h},d.subnetMatch=function(p,h,g){let v,w,C,q;g==null&&(g="unicast");for(w in h)if(Object.prototype.hasOwnProperty.call(h,w)){for(C=h[w],C[0]&&!(C[0]instanceof Array)&&(C=[C]),v=0;v<C.length;v++)if(q=C[v],p.kind()===q[0].kind()&&p.match.apply(p,q))return w}return g},typeof yu!="undefined"&&yu.exports?yu.exports=d:t.ipaddr=d})(BE)});var LE=b(Ia=>{"use strict";var NE=Ia&&Ia.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ia,"__esModule",{value:!0});var mO=RE(),vO=NE(Mf()),EO=NE(Kf()),OE=PE(),bO=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],wO=bO.map(t=>new mO.Netmask(t));function _O(t){for(let e of wO)if(e.contains(t))return!0;return!1}function DE(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}Ia.default=t=>{if(OE.isValid(t)){let e=OE.parse(t);if(e.kind()==="ipv4")return _O(e.toNormalizedString());if(e.kind()==="ipv6")return DE(t)}else if(EO.default(t)&&vO.default.v6().test(t))return DE(t)}});var _d=b((IF,kE)=>{"use strict";kE.exports=LE().default});var UE=b((TF,qE)=>{"use strict";var SO=_d();function xO(t){let{address:e}=t.nodeAddress();return SO(e)}qE.exports=xO});var Sd=b((RF,FE)=>{"use strict";var ME=UE();function AO(t,e){let r=ME(t.multiaddr),n=ME(e.multiaddr);return r&&!n?1:!r&&n||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}function CO(t){return[...t].sort(AO)}FE.exports.publicAddressesFirst=CO});var VE=b((BF,xd)=>{"use strict";var KE=async t=>{try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};xd.exports=KE;xd.exports.default=KE});var $E=b((PF,Ad)=>{"use strict";var jE=(t,...e)=>new Promise(r=>{r(t(...e))});Ad.exports=jE;Ad.exports.default=jE});var zE=b((NF,Cd)=>{"use strict";var IO=$E(),HE=t=>{if(!((Number.isInteger(t)||t===1/0)&&t>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],r=0,n=()=>{r--,e.length>0&&e.shift()()},i=(a,c,...u)=>{r++;let l=IO(a,...u);c(l),l.then(n,n)},s=(a,c,...u)=>{r<t?i(a,c,...u):e.push(i.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>r},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};Cd.exports=HE;Cd.exports.default=HE});var WE=b((OF,GE)=>{"use strict";var Id=VE(),TO=zE();GE.exports=async(t,e={})=>{let{concurrency:r=1/0}=e,n=TO(r);return Promise.all(t.map(i=>i&&typeof i.then=="function"?Id(i):Id(typeof i=="function"?n(()=>i()):Promise.resolve(i))))}});var XE=b((DF,QE)=>{"use strict";var Xs=Sn(),YE=Xs.Reader,RO=Xs.Writer,at=Xs.util,Ta=Xs.roots["libp2p-envelope"]||(Xs.roots["libp2p-envelope"]={});Ta.Envelope=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=at.newBuffer([]),t.prototype.payloadType=at.newBuffer([]),t.prototype.payload=at.newBuffer([]),t.prototype.signature=at.newBuffer([]),t.encode=function(r,n){return n||(n=RO.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof YE||(r=YE.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Ta.Envelope;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Ta.Envelope)return r;var n=new Ta.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?at.base64.decode(r.publicKey,n.publicKey=at.newBuffer(at.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?at.base64.decode(r.payloadType,n.payloadType=at.newBuffer(at.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?at.base64.decode(r.payload,n.payload=at.newBuffer(at.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?at.base64.decode(r.signature,n.signature=at.newBuffer(at.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=at.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=at.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=at.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=at.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?at.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?at.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?at.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?at.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Xs.util.toJSONOptions)},t}();QE.exports=Ta});var mu=b((LF,eb)=>{"use strict";var BO=ge(),{concat:PO}=(ei(),Jn),{fromString:NO}=(Dt(),Ft),OO=Wc(),DO=qt(),Td=Ki(),{equals:gu}=(Sr(),_r),{codes:LO}=Ye(),{Envelope:ZE}=XE(),li=class{constructor({peerId:e,payloadType:r,payload:n,signature:i}){this.peerId=e,this.payloadType=r,this.payload=n,this.signature=i,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=OO.marshalPublicKey(this.peerId.pubKey);return this._marshal=ZE.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return gu(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&gu(this.payloadType,e.payloadType)&&gu(this.payload,e.payload)&&gu(this.signature,e.signature)}validate(e){let r=JE(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(r,this.signature)}},JE=(t,e,r)=>{let n=NO(t),i=Td.encode(n.byteLength),s=Td.encode(e.length),o=Td.encode(r.length);return PO([new Uint8Array(i),n,new Uint8Array(s),e,new Uint8Array(o),r])};li.createFromProtobuf=async t=>{let e=ZE.decode(t),r=await DO.createFromPubKey(e.publicKey);return new li({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};li.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),s=JE(r,n,i),o=await e.privKey.sign(s);return new li({peerId:e,payloadType:n,payload:i,signature:o})};li.openAndCertify=async(t,e)=>{let r=await li.createFromProtobuf(t);if(!await r.validate(e))throw BO(new Error("envelope signature is not valid for the given domain"),LO.ERR_SIGNATURE_NOT_VALID);return r};eb.exports=li});var rb=b((kF,tb)=>{"use strict";function kO(t,e){return t.length===e.length&&e.sort()&&t.sort().every((r,n)=>e[n].equals(r))}tb.exports=kO});var sb=b((qF,ib)=>{"use strict";var Gi=Sn(),vu=Gi.Reader,nb=Gi.Writer,yt=Gi.util,Br=Gi.roots["libp2p-peer-record"]||(Gi.roots["libp2p-peer-record"]={});Br.PeerRecord=function(){function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.peerId=yt.newBuffer([]),t.prototype.seq=yt.Long?yt.Long.fromBits(0,0,!0):0,t.prototype.addresses=yt.emptyArray,t.encode=function(r,n){if(n||(n=nb.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&n.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)Br.PeerRecord.AddressInfo.encode(r.addresses[i],n.uint32(26).fork()).ldelim();return n},t.decode=function(r,n){r instanceof vu||(r=vu.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Br.PeerRecord;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.peerId=r.bytes();break;case 2:s.seq=r.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(Br.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Br.PeerRecord)return r;var n=new Br.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?yt.base64.decode(r.peerId,n.peerId=yt.newBuffer(yt.base64.length(r.peerId)),0):r.peerId.length&&(n.peerId=r.peerId)),r.seq!=null&&(yt.Long?(n.seq=yt.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new yt.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=Br.PeerRecord.AddressInfo.fromObject(r.addresses[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=yt.newBuffer(i.peerId))),yt.Long){var s=new yt.Long(0,0,!0);i.seq=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else i.seq=n.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?yt.base64.encode(r.peerId,0,r.peerId.length):n.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?yt.Long.prototype.toString.call(r.seq):n.longs===Number?new yt.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){i.addresses=[];for(var o=0;o<r.addresses.length;++o)i.addresses[o]=Br.PeerRecord.AddressInfo.toObject(r.addresses[o],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Gi.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=yt.newBuffer([]),e.encode=function(n,i){return i||(i=nb.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof vu||(n=vu.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Br.PeerRecord.AddressInfo;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return o},e.fromObject=function(n){if(n instanceof Br.PeerRecord.AddressInfo)return n;var i=new Br.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?yt.base64.decode(n.multiaddr,i.multiaddr=yt.newBuffer(yt.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=yt.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?yt.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Gi.util.toJSONOptions)},e}(),t}();ib.exports=Br});var ab=b((UF,ob)=>{"use strict";var qO="libp2p-peer-record",UO=Uint8Array.from([3,1]);ob.exports={ENVELOPE_DOMAIN_PEER_RECORD:qO,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:UO}});var Eu=b((MF,lb)=>{"use strict";var{Multiaddr:MO}=$t(),FO=qt(),KO=rb(),{PeerRecord:cb}=sb(),{ENVELOPE_DOMAIN_PEER_RECORD:ub,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:VO}=ab(),Wi=class{constructor({peerId:e,multiaddrs:r=[],seqNumber:n=Date.now()}){this.domain=ub,this.codec=VO,this.peerId=e,this.multiaddrs=r,this.seqNumber=n,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=cb.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Wi)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!KO(this.multiaddrs,e.multiaddrs))}};Wi.createFromProtobuf=t=>{let e=cb.decode(t),r=FO.createFromBytes(e.peerId),n=(e.addresses||[]).map(s=>new MO(s.multiaddr)),i=Number(e.seq);return new Wi({peerId:r,multiaddrs:n,seqNumber:i})};Wi.DOMAIN=ub;lb.exports=Wi});var Rd=b((FF,fb)=>{"use strict";var jO=mu(),$O=Eu();async function HO(t){let e=new $O({peerId:t.peerId,multiaddrs:t.multiaddrs}),r=await jO.seal(e,t.peerId);await t.peerStore.addressBook.consumePeerRecord(r)}fb.exports.updateSelfPeerRecord=HO});var Pd=b((KF,pb)=>{"use strict";var db=Oe(),Yi=Object.assign(db("libp2p:transports"),{error:db("libp2p:transports:err")}),zO=WE(),{codes:Zs}=Ye(),Ra=ge(),{updateSelfPeerRecord:hb}=Rd(),Bd=class{constructor({libp2p:e,upgrader:r,faultTolerance:n=bu.FATAL_ALL}){this.libp2p=e,this.upgrader=r,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=n}add(e,r,n={}){if(Yi("adding %s",e),!e)throw Ra(new Error(`Transport must have a valid key, was given '${e}'`),Zs.ERR_INVALID_KEY);if(this._transports.has(e))throw Ra(new Error("There is already a transport with this key"),Zs.ERR_DUPLICATE_TRANSPORT);let i=new r({...n,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,i),this._listenerOptions.set(e,n.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[r,n]of this._listeners)for(Yi("closing listeners for %s",r);n.length;){let i=n.pop();i.removeAllListeners("listening"),i.removeAllListeners("close"),e.push(i.close())}await Promise.all(e),Yi("all listeners closed");for(let r of this._listeners.keys())this._listeners.set(r,[])}async dial(e,r){let n=this.transportForMultiaddr(e);if(!n)throw Ra(new Error(`No transport available for address ${String(e)}`),Zs.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,r)}catch(i){throw i.code||(i.code=Zs.ERR_TRANSPORT_DIAL_FAILED),i}}getAddrs(){let e=[];for(let r of this._listeners.values())for(let n of r)e=[...e,...n.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let r of this._transports.values())if(r.filter([e]).length)return r;return null}async listen(e){if(!e||e.length===0){Yi("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[n,i]of this._transports.entries()){let s=i.filter(e),o=[];for(let u of s){Yi("creating listener for %s on %s",n,u);let l=i.createListener(this._listenerOptions.get(n));this._listeners.get(n).push(l),l.on("listening",()=>hb(this.libp2p)),l.on("close",()=>hb(this.libp2p)),o.push(l.listen(u))}if(o.length===0){r.push(n);continue}if(!(await zO(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==bu.NO_FATAL)throw Ra(new Error(`Transport (${n}) could not listen on any available address`),Zs.ERR_NO_VALID_ADDRESSES)}if(r.length===this._transports.size){let n=`no valid addresses were provided for transports [${r}]`;if(this.faultTolerance===bu.FATAL_ALL)throw Ra(new Error(n),Zs.ERR_NO_VALID_ADDRESSES);Yi(`libp2p in dial mode only: ${n}`)}}async remove(e){if(Yi("removing %s",e),this._listeners.has(e))for(let r of this._listeners.get(e))r.removeAllListeners("listening"),r.removeAllListeners("close"),await r.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let r of this._transports.keys())e.push(this.remove(r));await Promise.all(e)}},bu={FATAL_ALL:0,NO_FATAL:1};Bd.FaultTolerance=bu;pb.exports=Bd});var mb=b((VF,gb)=>{"use strict";var GO=Ys(),{dnsaddrResolver:WO}=AE(),Nd=hu(),{AGENT_VERSION:YO}=wd(),yb=pu(),{publicAddressesFirst:QO}=Sd(),{FaultTolerance:XO}=Pd(),ZO={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{minConnections:25},connectionGater:{},transportManager:{faultTolerance:XO.FATAL_ALL},dialer:{maxParallelDials:Nd.MAX_PARALLEL_DIALS,maxDialsPerPeer:Nd.MAX_PER_PEER_DIALS,dialTimeout:Nd.DIAL_TIMEOUT,resolvers:{dnsaddr:WO},addressSorter:QO},host:{agentVersion:YO},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:yb.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:yb.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};gb.exports.validate=t=>{let e=GO(ZO,t);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var bb=b((jF,Eb)=>{"use strict";var{EventEmitter:JO}=rr(),{Multiaddr:Ba}=$t(),e3=qt(),vb=class extends JO{constructor(e,{listen:r=[],announce:n=[]}={}){super();this.peerId=e,this.listen=new Set(r.map(i=>i.toString())),this.announce=new Set(n.map(i=>i.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new Ba(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new Ba(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new Ba(e))}addObservedAddr(e){let r=new Ba(e),n=r.getPeerId();n&&e3.createFromB58String(n).equals(this.peerId)&&(r=r.decapsulate(new Ba(`/p2p/${this.peerId}`)));let i=r.toString();this.observed.has(i)||(this.observed.add(i),this.emit("change:addresses"))}};Eb.exports=vb});var Sb=b(($F,_b)=>{"use strict";var{EventEmitter:t3}=rr(),Od=Oe()("latency-monitor:VisibilityChangeEmitter"),wb=class extends t3{constructor(){super();if(typeof document=="undefined"){Od('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,r;typeof document.hidden!="undefined"?(e="hidden",r="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",r="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",r="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",r="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=r}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?Od("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];Od(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};_b.exports=wb});var Cb=b((HF,Ab)=>{"use strict";var{EventEmitter:r3}=rr(),n3=Sb(),Nn=Oe()("latency-monitor:LatencyMonitor"),xb=class extends r3{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:r,asyncTestFn:n,latencyRandomPercentage:i}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=i||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=r===null||r===0?void 0:r||5*1e3,Nn("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?Nn("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):Nn("Not emitting summaries"),s.asyncTestFn=n}start(){globalThis.process&&globalThis.process.hrtime?(Nn("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let r=this.now(e);return r[0]*1e3+r[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(Nn("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(Nn("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),i3()&&(this._visibilityChangeEmitter=new n3,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),Nn("Summary: %O",e),e}_checkLatency(){let e=this,r=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,n={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+r),startTime:e.now()},i=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(n.startTime)-n.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,Nn("MS: %s Data: %O",s,e._latencyData)};Nn("localData: %O",n),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(n.deltaOffset=0,n.startTime=e.now(),e.asyncTestFn(i)):(n.deltaOffset-=1,i())},n.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function i3(){return typeof window!="undefined"}Ab.exports=xb});var Dd=b((zF,Tb)=>{"use strict";var Ib=class extends Map{constructor(e){super();let{system:r,component:n,metric:i,metrics:s}=e;this._system=r,this._component=n,this._metric=i,this._metrics=s,this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}set(e,r){return super.set(e,r),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),this}delete(e){let r=super.delete(e);return this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size}),r}clear(){super.clear(),this._metrics.updateComponentMetric({system:this._system,component:this._component,metric:this._metric,value:this.size})}};Tb.exports=({system:t="libp2p",component:e,metric:r,metrics:n})=>{let i;return n?i=new Ib({system:t,component:e,metric:r,metrics:n}):i=new Map,i}});var qb=b((GF,kb)=>{"use strict";var Rb=Oe(),Hr=Object.assign(Rb("libp2p:connection-manager"),{error:Rb("libp2p:connection-manager:err")}),Bb=ge(),s3=Ys(),o3=Cb(),Pb=_a(),{EventEmitter:a3}=rr(),Nb=Dd(),c3=qt(),{codes:{ERR_INVALID_PARAMETERS:Ob}}=Ye(),u3={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},Db="connection-manager",l3="peer-connections",f3="peer-values",Lb=class extends a3{constructor(e,r={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=s3.call({ignoreUndefined:!0},u3,r),this._options.maxConnections<this._options.minConnections)throw Bb(new Error("Connection Manager maxConnections must be greater than minConnections"),Ob);Hr("options: %j",this._options),this._peerValues=Nb({component:Db,metric:f3,metrics:this._libp2p.metrics}),this.connections=Nb({component:Db,metric:l3,metrics:this._libp2p.metrics}),this._started=!1,this._timer=null,this._checkMetrics=this._checkMetrics.bind(this),this._latencyMonitor=new o3({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval}),this.setMaxListeners(1/0)}get size(){return Array.from(this.connections.values()).reduce((e,r)=>e+r.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||Pb(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,Hr("started")}async stop(){this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),Hr("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let n of r)e.push(n.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),r)}async _checkMetrics(){if(this._libp2p.metrics)try{let e=this._libp2p.metrics.global.movingAverages,r=e.dataReceived[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxReceivedData",r);let n=e.dataSent[this._options.movingAverageInterval].movingAverage();await this._checkMaxLimit("maxSentData",n);let i=r+n;await this._checkMaxLimit("maxData",i),Hr("metrics update",i)}finally{this._timer=Pb(this._checkMetrics,this._options.pollInterval)}}async onConnect(e){if(!this._started){await e.close();return}let r=e.remotePeer,n=r.toB58String(),i=this.connections.get(n);this.emit("peer:connect",e),i?i.push(e):this.connections.set(n,[e]),await this._libp2p.peerStore.keyBook.set(r,r.pubKey),this._peerValues.has(n)||this._peerValues.set(n,this._options.defaultPeerValue),await this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){if(!this._started)return;let r=e.remotePeer.toB58String(),n=this.connections.get(r);n&&n.length>1?(n=n.filter(i=>i.id!==e.id),this.connections.set(r,n)):n&&(this.connections.delete(r),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e),this._libp2p.metrics&&this._libp2p.metrics.onPeerDisconnected(e.remotePeer))}get(e){let r=this.getAll(e);return r.length?r[0]:null}getAll(e){if(!c3.isPeerId(e))throw Bb(new Error("peerId must be an instance of peer-id"),Ob);let r=e.toB58String(),n=this.connections.get(r);return n?n.filter(i=>i.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs).catch(r=>{Hr.error(r)})}async _checkMaxLimit(e,r){let n=this._options[e];Hr("checking limit of %s. current value: %d of %d",e,r,n),r>n&&(Hr("%s: limit exceeded: %s, %d",this._peerId,e,r),await this._maybeDisconnectOne())}async _maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((n,i)=>n[1]-i[1])));Hr("%s: sorted peer values: %j",this._peerId,e);let r=e[0];if(r){let n=r[0];Hr("%s: lowest value peer is %s",this._peerId,n),Hr("%s: closing a connection to %j",this._peerId,n);for(let i of this.connections.values())if(i[0].remotePeer.toB58String()===n){i[0].close().catch(s=>{Hr.error(s)}),this.onDisconnect(i[0]);break}}}}};kb.exports=Lb});var Mb=b((WF,Ub)=>{"use strict";var d3=Vi(),h3=async function*(t,e){yield*(await d3(t)).sort(e)};Ub.exports=h3});var $b=b((YF,jb)=>{"use strict";var Fb=Oe(),p3=Ys(),Kb=_a(),y3=Vi(),{pipe:g3}=fr(),m3=ji(),v3=Mb(),fi=Object.assign(Fb("libp2p:connection-manager:auto-dialler"),{error:Fb("libp2p:connection-manager:auto-dialler:err")}),E3={enabled:!0,minConnections:0,autoDialInterval:1e4},Vb=class{constructor(e,r={}){this._options=p3.call({ignoreUndefined:!0},E3,r),this._libp2p=e,this._running=!1,this._autoDialTimeout=null,this._autoDial=this._autoDial.bind(this),fi("options: %j",this._options)}async start(){if(!this._options.enabled){fi("not enabled");return}this._running=!0,this._autoDial().catch(e=>{fi.error("could start autodial",e)}),fi("started")}async stop(){if(!this._options.enabled){fi("not enabled");return}this._running=!1,this._autoDialTimeout&&this._autoDialTimeout.clear(),fi("stopped")}async _autoDial(){let e=this._options.minConnections;if(this._libp2p.connections.size>=e){this._autoDialTimeout=Kb(this._autoDial,this._options.autoDialInterval);return}let r=await g3(this._libp2p.peerStore.getPeers(),n=>m3(n,i=>!i.id.equals(this._libp2p.peerId)),n=>v3(n,(i,s)=>s.protocols&&s.protocols.length&&(!i.protocols||!i.protocols.length)||s.id.pubKey&&!i.id.pubKey?1:-1),n=>y3(n));for(let n=0;this._running&&n<r.length&&this._libp2p.connections.size<e;n++){let i=r[n];if(!this._libp2p.connectionManager.get(i.id)){fi("connecting to a peerStore stored peer %s",i.id.toB58String());try{await this._libp2p.dialer.connectToPeer(i.id)}catch(s){fi.error("could not connect to peerStore stored peer",s)}}}!this._running||(this._autoDialTimeout=Kb(this._autoDial,this._options.autoDialInterval))}};jb.exports=Vb});var tw=b((QF,ew)=>{"use strict";var{Multiaddr:Ld}=$t(),Hb=de("dns4"),zb=de("dns6"),Gb=de("dnsaddr"),Qi=Ht(de("dns"),Gb,Hb,zb),Pa=Ht(de("ip4"),de("ip6")),Js=Ht(we(Pa,de("tcp")),we(Qi,de("tcp"))),kd=we(Pa,de("udp")),Wb=we(kd,de("utp")),Yb=we(kd,de("quic")),eo=Ht(we(Js,de("ws")),we(Qi,de("ws"))),to=Ht(we(Js,de("wss")),we(Qi,de("wss"))),wu=Ht(we(Js,de("http")),we(Pa,de("http")),we(Qi,de("http"))),_u=Ht(we(Js,de("https")),we(Pa,de("https")),we(Qi,de("https"))),qd=Ht(we(eo,de("p2p-webrtc-star"),de("p2p")),we(to,de("p2p-webrtc-star"),de("p2p")),we(eo,de("p2p-webrtc-star")),we(to,de("p2p-webrtc-star"))),b3=Ht(we(eo,de("p2p-websocket-star"),de("p2p")),we(to,de("p2p-websocket-star"),de("p2p")),we(eo,de("p2p-websocket-star")),we(to,de("p2p-websocket-star"))),Ud=Ht(we(wu,de("p2p-webrtc-direct"),de("p2p")),we(_u,de("p2p-webrtc-direct"),de("p2p")),we(wu,de("p2p-webrtc-direct")),we(_u,de("p2p-webrtc-direct"))),ro=Ht(eo,to,wu,_u,qd,Ud,Js,Wb,Yb,Qi),w3=Ht(we(ro,de("p2p-stardust"),de("p2p")),we(ro,de("p2p-stardust"))),di=Ht(we(ro,de("p2p")),qd,Ud,de("p2p")),Qb=Ht(we(di,de("p2p-circuit"),di),we(di,de("p2p-circuit")),we(de("p2p-circuit"),di),we(ro,de("p2p-circuit")),we(de("p2p-circuit"),ro),de("p2p-circuit")),Xb=()=>Ht(we(Qb,Xb),Qb),no=Xb(),Zb=Ht(we(no,di,no),we(di,no),we(no,di),no,di);ew.exports={DNS:Qi,DNS4:Hb,DNS6:zb,DNSADDR:Gb,IP:Pa,TCP:Js,UDP:kd,QUIC:Yb,UTP:Wb,HTTP:wu,HTTPS:_u,WebSockets:eo,WebSocketsSecure:to,WebSocketStar:b3,WebRTCStar:qd,WebRTCDirect:Ud,Reliable:ro,Stardust:w3,Circuit:no,P2P:Zb,IPFS:Zb};function Jb(t){function e(r){if(!Ld.isMultiaddr(r))try{r=new Ld(r)}catch(i){return!1}let n=t(r.protoNames());return n===null?!1:n===!0||n===!1?n:n.length===0}return e}function we(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Jb(e),partialMatch:e}}function Ht(...t){function e(n){let i=null;return t.some(s=>{let o=typeof s=="function"?s().partialMatch(n):s.partialMatch(n);return o?(i=o,!0):!1}),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:Jb(e),partialMatch:e}}function de(t){let e=t;function r(i){let s;if(typeof i=="string"||i instanceof Uint8Array)try{s=new Ld(i)}catch(a){return!1}else s=i;let o=s.protoNames();return o.length===1&&o[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}});var io=b((XF,nw)=>{"use strict";var Xi=Sn(),Su=Xi.Reader,rw=Xi.Writer,Pr=Xi.util,Pt=Xi.roots["libp2p-circuit"]||(Xi.roots["libp2p-circuit"]={});Pt.CircuitRelay=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.type=1,t.prototype.srcPeer=null,t.prototype.dstPeer=null,t.prototype.code=100,t.encode=function(r,n){return n||(n=rw.create()),r.type!=null&&Object.hasOwnProperty.call(r,"type")&&n.uint32(8).int32(r.type),r.srcPeer!=null&&Object.hasOwnProperty.call(r,"srcPeer")&&Pt.CircuitRelay.Peer.encode(r.srcPeer,n.uint32(18).fork()).ldelim(),r.dstPeer!=null&&Object.hasOwnProperty.call(r,"dstPeer")&&Pt.CircuitRelay.Peer.encode(r.dstPeer,n.uint32(26).fork()).ldelim(),r.code!=null&&Object.hasOwnProperty.call(r,"code")&&n.uint32(32).int32(r.code),n},t.decode=function(r,n){r instanceof Su||(r=Su.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Pt.CircuitRelay;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.type=r.int32();break;case 2:s.srcPeer=Pt.CircuitRelay.Peer.decode(r,r.uint32());break;case 3:s.dstPeer=Pt.CircuitRelay.Peer.decode(r,r.uint32());break;case 4:s.code=r.int32();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Pt.CircuitRelay)return r;var n=new Pt.CircuitRelay;switch(r.type){case"HOP":case 1:n.type=1;break;case"STOP":case 2:n.type=2;break;case"STATUS":case 3:n.type=3;break;case"CAN_HOP":case 4:n.type=4;break}if(r.srcPeer!=null){if(typeof r.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");n.srcPeer=Pt.CircuitRelay.Peer.fromObject(r.srcPeer)}if(r.dstPeer!=null){if(typeof r.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");n.dstPeer=Pt.CircuitRelay.Peer.fromObject(r.dstPeer)}switch(r.code){case"SUCCESS":case 100:n.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:n.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:n.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:n.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:n.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:n.code=260;break;case"HOP_CANT_DIAL_DST":case 261:n.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:n.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:n.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:n.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:n.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:n.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:n.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:n.code=351;break;case"STOP_RELAY_REFUSED":case 390:n.code=390;break;case"MALFORMED_MESSAGE":case 400:n.code=400;break}return n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.type=n.enums===String?"HOP":1,i.srcPeer=null,i.dstPeer=null,i.code=n.enums===String?"SUCCESS":100),r.type!=null&&r.hasOwnProperty("type")&&(i.type=n.enums===String?Pt.CircuitRelay.Type[r.type]:r.type),r.srcPeer!=null&&r.hasOwnProperty("srcPeer")&&(i.srcPeer=Pt.CircuitRelay.Peer.toObject(r.srcPeer,n)),r.dstPeer!=null&&r.hasOwnProperty("dstPeer")&&(i.dstPeer=Pt.CircuitRelay.Peer.toObject(r.dstPeer,n)),r.code!=null&&r.hasOwnProperty("code")&&(i.code=n.enums===String?Pt.CircuitRelay.Status[r.code]:r.code),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Xi.util.toJSONOptions)},t.Status=function(){var e={},r=Object.create(e);return r[e[100]="SUCCESS"]=100,r[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,r[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,r[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,r[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,r[e[260]="HOP_NO_CONN_TO_DST"]=260,r[e[261]="HOP_CANT_DIAL_DST"]=261,r[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,r[e[270]="HOP_CANT_SPEAK_RELAY"]=270,r[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,r[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,r[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,r[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,r[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,r[e[390]="STOP_RELAY_REFUSED"]=390,r[e[400]="MALFORMED_MESSAGE"]=400,r}(),t.Type=function(){var e={},r=Object.create(e);return r[e[1]="HOP"]=1,r[e[2]="STOP"]=2,r[e[3]="STATUS"]=3,r[e[4]="CAN_HOP"]=4,r}(),t.Peer=function(){function e(r){if(this.addrs=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.id=Pr.newBuffer([]),e.prototype.addrs=Pr.emptyArray,e.encode=function(n,i){if(i||(i=rw.create()),i.uint32(10).bytes(n.id),n.addrs!=null&&n.addrs.length)for(var s=0;s<n.addrs.length;++s)i.uint32(18).bytes(n.addrs[s]);return i},e.decode=function(n,i){n instanceof Su||(n=Su.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Pt.CircuitRelay.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.id=n.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(n.bytes());break;default:n.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw Pr.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(n){if(n instanceof Pt.CircuitRelay.Peer)return n;var i=new Pt.CircuitRelay.Peer;if(n.id!=null&&(typeof n.id=="string"?Pr.base64.decode(n.id,i.id=Pr.newBuffer(Pr.base64.length(n.id)),0):n.id.length&&(i.id=n.id)),n.addrs){if(!Array.isArray(n.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");i.addrs=[];for(var s=0;s<n.addrs.length;++s)typeof n.addrs[s]=="string"?Pr.base64.decode(n.addrs[s],i.addrs[s]=Pr.newBuffer(Pr.base64.length(n.addrs[s])),0):n.addrs[s].length&&(i.addrs[s]=n.addrs[s])}return i},e.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addrs=[]),i.defaults&&(i.bytes===String?s.id="":(s.id=[],i.bytes!==Array&&(s.id=Pr.newBuffer(s.id)))),n.id!=null&&n.hasOwnProperty("id")&&(s.id=i.bytes===String?Pr.base64.encode(n.id,0,n.id.length):i.bytes===Array?Array.prototype.slice.call(n.id):n.id),n.addrs&&n.addrs.length){s.addrs=[];for(var o=0;o<n.addrs.length;++o)s.addrs[o]=i.bytes===String?Pr.base64.encode(n.addrs[o],0,n.addrs[o].length):i.bytes===Array?Array.prototype.slice.call(n.addrs[o]):n.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Xi.util.toJSONOptions)},e}(),t}();nw.exports=Pt});var sw=b((ZF,iw)=>{iw.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var aw=b((eK,ow)=>{ow.exports=class extends Error{constructor(e,r){super(e||"The operation was aborted");this.type="aborted",this.code=r||"ABORT_ERR"}}});var xu=b((tK,Zi)=>{var _3=sw(),Md=aw(),cw=(t,e,r)=>Fd(t,Array.isArray(e)?e:[{signal:e,options:r}]),Fd=(t,e)=>{t=_3(t),e=e.map(({signal:n,options:i})=>({signal:n,options:i||{}}));async function*r(){let n,i=()=>{n&&n()};for(let{signal:s}of e)s.addEventListener("abort",i);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new Md(u,l)}let o=new Promise((a,c)=>{n=()=>{let{options:u}=e.find(({signal:d})=>d.aborted),{abortMessage:l,abortCode:f}=u;c(new Md(l,f))}});s=await Promise.race([o,t.next()]),n=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",i);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(t),typeof t.return=="function")try{let u=t.return();u instanceof Promise&&u.catch(l=>{a.options.onReturnError!=null&&a.options.onReturnError(l)})}catch(u){a.options.onReturnError!=null&&a.options.onReturnError(u)}if(c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",i)}return r()},uw=(t,e,r)=>lw(t,Array.isArray(e)?e:[{signal:e,options:r}]),lw=(t,e)=>r=>t(Fd(r,e)),S3=(t,e,r)=>x3(t,Array.isArray(e)?e:[{signal:e,options:r}]),x3=(t,e)=>({sink:lw(t.sink,e),source:Fd(t.source,e)});Zi.exports=cw;Zi.exports.AbortError=Md;Zi.exports.source=cw;Zi.exports.sink=uw;Zi.exports.transform=uw;Zi.exports.duplex=S3});var hw=b((rK,dw)=>{"use strict";var{source:fw}=xu(),A3=Oe(),C3=A3("libp2p:stream:converter");function I3({stream:t,remoteAddr:e,localAddr:r},n={}){let{sink:i,source:s}=t,o={async sink(c){n.signal&&(c=fw(c,n.signal));try{await i(c)}catch(u){u.type!=="aborted"&&C3(u)}a()},source:n.signal?fw(s,n.signal):s,conn:t,localAddr:r,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return i(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}dw.exports=I3});var Na=b((nK,pw)=>{"use strict";pw.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var gw=b((iK,yw)=>{"use strict";var{EventEmitter:T3}=rr(),{Multiaddr:R3}=$t();yw.exports=t=>{let e=new Map;async function r(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await t.dial(new R3(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),i.emit("listening")}function n(){let s=[];for(let o of e.values())s.push(o);return s}let i=Object.assign(new T3,{close:()=>Promise.resolve(),listen:r,getAddrs:n});return t.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&i.emit("close")}),i}});var Kd=b((sK,Ew)=>{"use strict";var{Multiaddr:mw}=$t(),{CircuitRelay:Ji}=io();function vw(t,e){t.write({type:Ji.Type.STATUS,code:e})}function B3(t,e){try{t.dstPeer&&t.dstPeer.addrs&&t.dstPeer.addrs.forEach(r=>new mw(r))}catch(r){throw vw(e,t.type===Ji.Type.HOP?Ji.Status.HOP_DST_MULTIADDR_INVALID:Ji.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer&&t.srcPeer.addrs&&t.srcPeer.addrs.forEach(r=>new mw(r))}catch(r){throw vw(e,t.type===Ji.Type.HOP?Ji.Status.HOP_SRC_MULTIADDR_INVALID:Ji.Status.STOP_SRC_MULTIADDR_INVALID),r}}Ew.exports={validateAddrs:B3}});var _w=b(Au=>{"use strict";Au.byteLength=N3;Au.toByteArray=D3;Au.fromByteArray=q3;var mn=[],Nr=[],P3=typeof Uint8Array!="undefined"?Uint8Array:Array,Vd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(es=0,bw=Vd.length;es<bw;++es)mn[es]=Vd[es],Nr[Vd.charCodeAt(es)]=es;var es,bw;Nr["-".charCodeAt(0)]=62;Nr["_".charCodeAt(0)]=63;function ww(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function N3(t){var e=ww(t),r=e[0],n=e[1];return(r+n)*3/4-n}function O3(t,e,r){return(e+r)*3/4-r}function D3(t){var e,r=ww(t),n=r[0],i=r[1],s=new P3(O3(t,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=Nr[t.charCodeAt(c)]<<18|Nr[t.charCodeAt(c+1)]<<12|Nr[t.charCodeAt(c+2)]<<6|Nr[t.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Nr[t.charCodeAt(c)]<<2|Nr[t.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Nr[t.charCodeAt(c)]<<10|Nr[t.charCodeAt(c+1)]<<4|Nr[t.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function L3(t){return mn[t>>18&63]+mn[t>>12&63]+mn[t>>6&63]+mn[t&63]}function k3(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),i.push(L3(n));return i.join("")}function q3(t){for(var e,r=t.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(k3(t,o,o+s>a?a:o+s));return n===1?(e=t[r-1],i.push(mn[e>>2]+mn[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(mn[e>>10]+mn[e>>4&63]+mn[e<<2&63]+"=")),i.join("")}});var Sw=b(jd=>{jd.read=function(t,e,r,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=t[e+f];for(f+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=s*256+t[e+f],f+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=o*256+t[e+f],f+=d,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-u}return(p?-1:1)*o*Math.pow(2,s-n)};jd.write=function(t,e,r,n,i,s){var o,a,c,u=s*8-i-1,l=(1<<u)-1,f=l>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=d/c:e+=d*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[r+p]=a&255,p+=h,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+p]=o&255,p+=h,o/=256,u-=8);t[r+p-h]|=g*128}});var pi=b(co=>{"use strict";var $d=_w(),so=Sw(),xw=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;co.Buffer=V;co.SlowBuffer=j3;co.INSPECT_MAX_BYTES=50;var Cu=2147483647;co.kMaxLength=Cu;V.TYPED_ARRAY_SUPPORT=U3();!V.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function U3(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch(t){return!1}}Object.defineProperty(V.prototype,"parent",{enumerable:!0,get:function(){if(!!V.isBuffer(this))return this.buffer}});Object.defineProperty(V.prototype,"offset",{enumerable:!0,get:function(){if(!!V.isBuffer(this))return this.byteOffset}});function On(t){if(t>Cu)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,V.prototype),e}function V(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Hd(t)}return Aw(t,e,r)}V.poolSize=8192;function Aw(t,e,r){if(typeof t=="string")return F3(t,e);if(ArrayBuffer.isView(t))return K3(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(vn(t,ArrayBuffer)||t&&vn(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(vn(t,SharedArrayBuffer)||t&&vn(t.buffer,SharedArrayBuffer)))return Gd(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return V.from(n,e,r);let i=V3(t);if(i)return i;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return V.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}V.from=function(t,e,r){return Aw(t,e,r)};Object.setPrototypeOf(V.prototype,Uint8Array.prototype);Object.setPrototypeOf(V,Uint8Array);function Cw(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function M3(t,e,r){return Cw(t),t<=0?On(t):e!==void 0?typeof r=="string"?On(t).fill(e,r):On(t).fill(e):On(t)}V.alloc=function(t,e,r){return M3(t,e,r)};function Hd(t){return Cw(t),On(t<0?0:Wd(t)|0)}V.allocUnsafe=function(t){return Hd(t)};V.allocUnsafeSlow=function(t){return Hd(t)};function F3(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!V.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=Iw(t,e)|0,n=On(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function zd(t){let e=t.length<0?0:Wd(t.length)|0,r=On(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function K3(t){if(vn(t,Uint8Array)){let e=new Uint8Array(t);return Gd(e.buffer,e.byteOffset,e.byteLength)}return zd(t)}function Gd(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,V.prototype),n}function V3(t){if(V.isBuffer(t)){let e=Wd(t.length)|0,r=On(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||Xd(t.length)?On(0):zd(t);if(t.type==="Buffer"&&Array.isArray(t.data))return zd(t.data)}function Wd(t){if(t>=Cu)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Cu.toString(16)+" bytes");return t|0}function j3(t){return+t!=t&&(t=0),V.alloc(+t)}V.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==V.prototype};V.compare=function(e,r){if(vn(e,Uint8Array)&&(e=V.from(e,e.offset,e.byteLength)),vn(r,Uint8Array)&&(r=V.from(r,r.offset,r.byteLength)),!V.isBuffer(e)||!V.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let s=0,o=Math.min(n,i);s<o;++s)if(e[s]!==r[s]){n=e[s],i=r[s];break}return n<i?-1:i<n?1:0};V.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};V.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return V.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=V.allocUnsafe(r),s=0;for(n=0;n<e.length;++n){let o=e[n];if(vn(o,Uint8Array))s+o.length>i.length?(V.isBuffer(o)||(o=V.from(o)),o.copy(i,s)):Uint8Array.prototype.set.call(i,o,s);else if(V.isBuffer(o))o.copy(i,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return i};function Iw(t,e){if(V.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||vn(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Qd(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Mw(t).length;default:if(i)return n?-1:Qd(t).length;e=(""+e).toLowerCase(),i=!0}}V.byteLength=Iw;function $3(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return eD(this,e,r);case"utf8":case"utf-8":return Bw(this,e,r);case"ascii":return Z3(this,e,r);case"latin1":case"binary":return J3(this,e,r);case"base64":return Q3(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return tD(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}V.prototype._isBuffer=!0;function ts(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}V.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)ts(this,r,r+1);return this};V.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)ts(this,r,r+3),ts(this,r+1,r+2);return this};V.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)ts(this,r,r+7),ts(this,r+1,r+6),ts(this,r+2,r+5),ts(this,r+3,r+4);return this};V.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Bw(this,0,e):$3.apply(this,arguments)};V.prototype.toLocaleString=V.prototype.toString;V.prototype.equals=function(e){if(!V.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:V.compare(this,e)===0};V.prototype.inspect=function(){let e="",r=co.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};xw&&(V.prototype[xw]=V.prototype.inspect);V.prototype.compare=function(e,r,n,i,s){if(vn(e,Uint8Array)&&(e=V.from(e,e.offset,e.byteLength)),!V.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),s===void 0&&(s=this.length),r<0||n>e.length||i<0||s>this.length)throw new RangeError("out of range index");if(i>=s&&r>=n)return 0;if(i>=s)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,s>>>=0,this===e)return 0;let o=s-i,a=n-r,c=Math.min(o,a),u=this.slice(i,s),l=e.slice(r,n);for(let f=0;f<c;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0};function Tw(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Xd(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=V.from(e,n)),V.isBuffer(e))return e.length===0?-1:Rw(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Rw(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function Rw(t,e,r,n,i){let s=1,o=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;s=2,o/=2,a/=2,r/=2}function c(l,f){return s===1?l[f]:l.readUInt16BE(f*s)}let u;if(i){let l=-1;for(u=r;u<o;u++)if(c(t,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(r+a>o&&(r=o-a),u=r;u>=0;u--){let l=!0;for(let f=0;f<a;f++)if(c(t,u+f)!==c(e,f)){l=!1;break}if(l)return u}return-1}V.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};V.prototype.indexOf=function(e,r,n){return Tw(this,e,r,n,!0)};V.prototype.lastIndexOf=function(e,r,n){return Tw(this,e,r,n,!1)};function H3(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let s=e.length;n>s/2&&(n=s/2);let o;for(o=0;o<n;++o){let a=parseInt(e.substr(o*2,2),16);if(Xd(a))return o;t[r+o]=a}return o}function z3(t,e,r,n){return Iu(Qd(e,t.length-r),t,r,n)}function G3(t,e,r,n){return Iu(sD(e),t,r,n)}function W3(t,e,r,n){return Iu(Mw(e),t,r,n)}function Y3(t,e,r,n){return Iu(oD(e,t.length-r),t,r,n)}V.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-r;if((n===void 0||n>s)&&(n=s),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return H3(this,e,r,n);case"utf8":case"utf-8":return z3(this,e,r,n);case"ascii":case"latin1":case"binary":return G3(this,e,r,n);case"base64":return W3(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y3(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}};V.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q3(t,e,r){return e===0&&r===t.length?$d.fromByteArray(t):$d.fromByteArray(t.slice(e,r))}function Bw(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let s=t[i],o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a<=r){let c,u,l,f;switch(a){case 1:s<128&&(o=s);break;case 2:c=t[i+1],(c&192)==128&&(f=(s&31)<<6|c&63,f>127&&(o=f));break;case 3:c=t[i+1],u=t[i+2],(c&192)==128&&(u&192)==128&&(f=(s&15)<<12|(c&63)<<6|u&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:c=t[i+1],u=t[i+2],l=t[i+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(f=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),i+=a}return X3(n)}var Pw=4096;function X3(t){let e=t.length;if(e<=Pw)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Pw));return r}function Z3(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function J3(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function eD(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let s=e;s<r;++s)i+=aD[t[s]];return i}function tD(t,e,r){let n=t.slice(e,r),i="";for(let s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+n[s+1]*256);return i}V.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,V.prototype),i};function Nt(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}V.prototype.readUintLE=V.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Nt(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return i};V.prototype.readUintBE=V.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Nt(e,r,this.length);let i=this[e+--r],s=1;for(;r>0&&(s*=256);)i+=this[e+--r]*s;return i};V.prototype.readUint8=V.prototype.readUInt8=function(e,r){return e=e>>>0,r||Nt(e,1,this.length),this[e]};V.prototype.readUint16LE=V.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Nt(e,2,this.length),this[e]|this[e+1]<<8};V.prototype.readUint16BE=V.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Nt(e,2,this.length),this[e]<<8|this[e+1]};V.prototype.readUint32LE=V.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Nt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};V.prototype.readUint32BE=V.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Nt(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};V.prototype.readBigUInt64LE=hi(function(e){e=e>>>0,ao(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Oa(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(s)<<BigInt(32))});V.prototype.readBigUInt64BE=hi(function(e){e=e>>>0,ao(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Oa(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(s)});V.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Nt(e,r,this.length);let i=this[e],s=1,o=0;for(;++o<r&&(s*=256);)i+=this[e+o]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*r)),i};V.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Nt(e,r,this.length);let i=r,s=1,o=this[e+--i];for(;i>0&&(s*=256);)o+=this[e+--i]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*r)),o};V.prototype.readInt8=function(e,r){return e=e>>>0,r||Nt(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};V.prototype.readInt16LE=function(e,r){e=e>>>0,r||Nt(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};V.prototype.readInt16BE=function(e,r){e=e>>>0,r||Nt(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};V.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Nt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};V.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Nt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};V.prototype.readBigInt64LE=hi(function(e){e=e>>>0,ao(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Oa(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});V.prototype.readBigInt64BE=hi(function(e){e=e>>>0,ao(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&Oa(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});V.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Nt(e,4,this.length),so.read(this,e,!0,23,4)};V.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Nt(e,4,this.length),so.read(this,e,!1,23,4)};V.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Nt(e,8,this.length),so.read(this,e,!0,52,8)};V.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Nt(e,8,this.length),so.read(this,e,!1,52,8)};function ar(t,e,r,n,i,s){if(!V.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}V.prototype.writeUintLE=V.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;ar(this,e,r,n,a,0)}let s=1,o=0;for(this[r]=e&255;++o<n&&(s*=256);)this[r+o]=e/s&255;return r+n};V.prototype.writeUintBE=V.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;ar(this,e,r,n,a,0)}let s=n-1,o=1;for(this[r+s]=e&255;--s>=0&&(o*=256);)this[r+s]=e/o&255;return r+n};V.prototype.writeUint8=V.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,1,255,0),this[r]=e&255,r+1};V.prototype.writeUint16LE=V.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};V.prototype.writeUint16BE=V.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};V.prototype.writeUint32LE=V.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};V.prototype.writeUint32BE=V.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Nw(t,e,r,n,i){Uw(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,r}function Ow(t,e,r,n,i){Uw(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s=s>>8,t[r+6]=s,s=s>>8,t[r+5]=s,s=s>>8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o=o>>8,t[r+2]=o,o=o>>8,t[r+1]=o,o=o>>8,t[r]=o,r+8}V.prototype.writeBigUInt64LE=hi(function(e,r=0){return Nw(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});V.prototype.writeBigUInt64BE=hi(function(e,r=0){return Ow(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});V.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);ar(this,e,r,n,c-1,-c)}let s=0,o=1,a=0;for(this[r]=e&255;++s<n&&(o*=256);)e<0&&a===0&&this[r+s-1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};V.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let c=Math.pow(2,8*n-1);ar(this,e,r,n,c-1,-c)}let s=n-1,o=1,a=0;for(this[r+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[r+s+1]!==0&&(a=1),this[r+s]=(e/o>>0)-a&255;return r+n};V.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};V.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};V.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};V.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};V.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||ar(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};V.prototype.writeBigInt64LE=hi(function(e,r=0){return Nw(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});V.prototype.writeBigInt64BE=hi(function(e,r=0){return Ow(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Dw(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Lw(t,e,r,n,i){return e=+e,r=r>>>0,i||Dw(t,e,r,4,34028234663852886e22,-34028234663852886e22),so.write(t,e,r,n,23,4),r+4}V.prototype.writeFloatLE=function(e,r,n){return Lw(this,e,r,!0,n)};V.prototype.writeFloatBE=function(e,r,n){return Lw(this,e,r,!1,n)};function kw(t,e,r,n,i){return e=+e,r=r>>>0,i||Dw(t,e,r,8,17976931348623157e292,-17976931348623157e292),so.write(t,e,r,n,52,8),r+8}V.prototype.writeDoubleLE=function(e,r,n){return kw(this,e,r,!0,n)};V.prototype.writeDoubleBE=function(e,r,n){return kw(this,e,r,!1,n)};V.prototype.copy=function(e,r,n,i){if(!V.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let s=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),s};V.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!V.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{let o=V.isBuffer(e)?e:V.from(e,i),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=o[s%a]}return this};var oo={};function Yd(t,e,r){oo[t]=class extends r{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Yd("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Yd("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);Yd("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=qw(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=qw(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function qw(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function rD(t,e,r){ao(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&Oa(e,t.length-(r+1))}function Uw(t,e,r,n,i,s){if(t>r||t<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${r}${o}`,new oo.ERR_OUT_OF_RANGE("value",a,t)}rD(n,i,s)}function ao(t,e){if(typeof t!="number")throw new oo.ERR_INVALID_ARG_TYPE(e,"number",t)}function Oa(t,e,r){throw Math.floor(t)!==t?(ao(t,r),new oo.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new oo.ERR_BUFFER_OUT_OF_BOUNDS:new oo.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var nD=/[^+/0-9A-Za-z-_]/g;function iD(t){if(t=t.split("=")[0],t=t.trim().replace(nD,""),t.length<2)return"";for(;t.length%4!=0;)t=t+"=";return t}function Qd(t,e){e=e||1/0;let r,n=t.length,i=null,s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return s}function sD(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function oD(t,e){let r,n,i,s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}function Mw(t){return $d.toByteArray(iD(t))}function Iu(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function vn(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function Xd(t){return t!==t}var aD=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function hi(t){return typeof BigInt=="undefined"?cD:t}function cD(){throw new Error("BigInt not supported")}});var rs=b((lK,Kw)=>{"use strict";var{Buffer:zr}=pi(),Fw=Symbol.for("BufferList");function Ze(t){if(!(this instanceof Ze))return new Ze(t);Ze._init.call(this,t)}Ze._init=function(e){Object.defineProperty(this,Fw,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};Ze.prototype._new=function(e){return new Ze(e)};Ze.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){let i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}};Ze.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r};Ze.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};Ze.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};Ze.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||zr.alloc(0);let s=!!e,o=this._offset(n),a=i-n,c=a,u=s&&r||0,l=o[1];if(n===0&&i===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:zr.concat(this._bufs,this.length);for(let f=0;f<this._bufs.length;f++)this._bufs[f].copy(e,u),u+=this._bufs[f].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,r,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=zr.allocUnsafe(a));for(let f=o[0];f<this._bufs.length;f++){let d=this._bufs[f].length-l;if(c>d)this._bufs[f].copy(e,u,l),u+=d;else{this._bufs[f].copy(e,u,l,l+c),u+=d;break}c-=d,l&&(l=0)}return e.length>u?e.slice(0,u):e};Ze.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let n=this._offset(e),i=this._offset(r),s=this._bufs.slice(n[0],i[0]+1);return i[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,i[1]),n[1]!==0&&(s[0]=s[0].slice(n[1])),this._new(s)};Ze.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)};Ze.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};Ze.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};Ze.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(zr.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(zr.from(e));return this};Ze.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};Ze.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=zr.from([t]):typeof t=="string"?t=zr.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=zr.from(t.buffer,t.byteOffset,t.byteLength):zr.isBuffer(t)||(t=zr.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],s=n[1];for(;i<this._bufs.length;i++){let o=this._bufs[i];for(;s<o.length;)if(o.length-s>=t.length){let c=o.indexOf(t,s);if(c!==-1)return this._reverseOffset([i,c]);s=o.length-t.length+1}else{let c=this._reverseOffset([i,s]);if(this._match(c,t))return c;s++}s=0}return-1};Ze.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?Ze.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:Ze.prototype[r]=function(n=0){return this.slice(n,n+t[r])[r](0)}})(e)})();Ze.prototype._isBufferList=function(e){return e instanceof Ze||Ze.isBufferList(e)};Ze.isBufferList=function(e){return e!=null&&e[Fw]};Kw.exports=Ze});var Zd=b((fK,$w)=>{"use strict";var Vw=Ki(),{Buffer:uD}=pi(),jw=(t,e,r)=>{let n=Vw.encode(t,e,r);return jw.bytes=Vw.encode.bytes,e||uD.from(n)};$w.exports=jw});var Qw=b((dK,Tu)=>{"use strict";var{Buffer:Hw}=pi(),zw=rs(),Gw=Zd(),Jd=8,Ww=10*1024;function Yw(t){t=t||{};let e=Math.max(t.poolSize||Ww,t.minPoolSize||Jd),r=t.lengthEncoder||Gw;return async function*(i){let s=Hw.alloc(e),o=0;for await(let a of i){r(a.length,s,o);let c=s.slice(o,o+r.bytes);o+=r.bytes,s.length-o<Jd&&(s=Hw.alloc(e),o=0),yield new zw().append(c).append(a)}}}Yw.single=(t,e)=>{e=e||{};let r=e.lengthEncoder||Gw;return new zw([r(t.length),t.slice()])};Tu.exports=Yw;Tu.exports.MIN_POOL_SIZE=Jd;Tu.exports.DEFAULT_POOL_SIZE=Ww});var eh=b((hK,Jw)=>{"use strict";var Xw=Ki(),{Buffer:lD}=pi(),fD=t=>new Proxy({},{get:(e,r)=>r[0]==="l"?t[r]:t.get(parseInt(r))}),Zw=t=>{let e=Xw.decode(lD.isBuffer(t)?t:fD(t));return Zw.bytes=Xw.decode.bytes,e};Jw.exports=Zw});var n2=b((pK,Ru)=>{"use strict";var{Buffer:dD}=pi(),th=rs(),hD=eh(),e2=8,t2=1024*1024*4,r2=dD.alloc(0),yi={LENGTH:"readLength",DATA:"readData"},pD={[yi.LENGTH]:(t,e,r,n)=>{e=e.append(t);let i;try{i=n.lengthDecoder(e)}catch(s){if(e.length>n.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:yi.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(i>n.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return t=e.shallowSlice(n.lengthDecoder.bytes),e=new th,n.onLength&&n.onLength(i),i<=0?(n.onData&&n.onData(r2),{mode:yi.LENGTH,chunk:t,buffer:e,data:r2}):{mode:yi.DATA,chunk:t,buffer:e,state:{dataLength:i},data:void 0}},[yi.DATA]:(t,e,r,n)=>{if(e=e.append(t),!r)throw new Error("state is required");if(e.length<r.dataLength)return{mode:yi.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,s=e.shallowSlice(0,i),o=e.length>i?e.shallowSlice(i):void 0;return e=new th,n.onData&&n.onData(s),{mode:yi.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function rh(t){t=t||{};let e={lengthDecoder:t.lengthDecoder||hD,maxLengthLength:t.maxLengthLength||e2,maxDataLength:t.maxDataLength||t2,onLength:t.onLength,onData:t.onData};return async function*(n){let i=new th,s=yi.LENGTH,o;for await(let a of n){let c=a;for(;c;){let u=pD[s](c,i,o,e);s=u.mode,c=u.chunk,i=u.buffer,o=u.state,u.data&&(yield u.data)}}if(i.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}rh.fromReader=(t,e)=>{let r=1,n={[Symbol.asyncIterator](){return this},next:async()=>{try{return await t.next(r)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}};return rh({...e||{},onLength:s=>{r=s}})(n)};Ru.exports=rh;Ru.exports.MAX_LENGTH_LENGTH=e2;Ru.exports.MAX_DATA_LENGTH=t2});var o2=b((yK,s2)=>{"use strict";var{Buffer:yD}=pi(),i2=(t,e,r)=>(e=e||yD.allocUnsafe(4),e.writeInt32BE(t,r),e);i2.bytes=4;s2.exports=i2});var u2=b((gK,c2)=>{"use strict";var a2=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return t.readInt32BE(0)};a2.bytes=4;c2.exports=a2});var uo=b(ns=>{"use strict";ns.encode=Qw();ns.decode=n2();ns.varintEncode=Zd();ns.varintDecode=eh();ns.int32BEEncode=o2();ns.int32BEDecode=u2()});var ih=b((vK,l2)=>{var nh=rs();l2.exports=t=>{let e=async function*(){let r=yield,n=new nh;for await(let i of t){if(!r){r=yield n.append(i),n=new nh;continue}for(n.append(i);n.length>=r;){let s=n.shallowSlice(0,r);if(n.consume(r),r=yield s,!r){n.length&&(r=yield n,n=new nh);break}}}if(r)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e}});var sh=b((EK,f2)=>{"use strict";var gD=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};f2.exports=gD});var lo=b((bK,d2)=>{"use strict";var mD=ih(),vD=dd(),ED=sh();d2.exports=t=>{let e=vD(),r=mD(t.source),n=ED(),i,s=t.sink(async function*(){yield*e,yield*await n.promise}());return s.catch(a=>{i=a}),{reader:r,writer:e,stream:{sink:a=>i?Promise.reject(i):(n.resolve(a),s),source:r},rest:()=>e.end(),write:e.push,read:async()=>(await r.next()).value}}});var Pu=b((wK,m2)=>{"use strict";var h2=Oe(),Bu=Object.assign(h2("libp2p:circuit:stream-handler"),{error:h2("libp2p:circuit:stream-handler:err")}),p2=uo(),bD=lo(),{CircuitRelay:y2}=io(),g2=class{constructor({stream:e,maxLength:r=4096}){this.stream=e,this.shake=bD(this.stream),this.decoder=p2.decode.fromReader(this.shake.reader,{maxDataLength:r})}async read(){let e=await this.decoder.next();if(e.value){let r=y2.decode(e.value.slice());return Bu("read message type",r.type),r}Bu("read received no value, closing stream"),this.close()}write(e){Bu("write message type %s",e.type),this.shake.write(p2.encode.single(y2.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){Bu("closing the stream"),this.rest().sink([])}};m2.exports=g2});var ch=b((_K,ah)=>{"use strict";var v2=Oe(),Da=Object.assign(v2("libp2p:circuit:stop"),{error:v2("libp2p:circuit:stop:err")}),{CircuitRelay:oh}=io(),wD=Na(),_D=Pu(),{validateAddrs:SD}=Kd();ah.exports.handleStop=function({connection:e,request:r,streamHandler:n}){try{SD(r,n)}catch(i){return Da.error("invalid stop request via peer %s",e.remotePeer.toB58String(),i)}return Da("stop request is valid"),n.write({type:oh.Type.STATUS,code:oh.Status.SUCCESS}),n.rest()};ah.exports.stop=async function({connection:e,request:r}){let{stream:n}=await e.newStream([wD.relay]);Da("starting stop request to %s",e.remotePeer.toB58String());let i=new _D({stream:n});i.write(r);let s=await i.read();if(!s)return i.close();if(s.code===oh.Status.SUCCESS)return Da("stop request to %s was successful",e.remotePeer.toB58String()),i.rest();Da("stop request failed with code %d",s.code),i.close()}});var uh=b((SK,x2)=>{"use strict";var E2=Oe(),Dn=Object.assign(E2("libp2p:circuit:hop"),{error:E2("libp2p:circuit:hop:err")}),b2=ge(),xD=qt(),{validateAddrs:AD}=Kd(),w2=Pu(),{CircuitRelay:dr}=io(),{pipe:CD}=fr(),{codes:_2}=Ye(),{stop:ID}=ch(),S2=Na();async function TD({connection:t,request:e,streamHandler:r,circuit:n}){if(!n._options.hop.enabled)return Dn("HOP request received but we are not acting as a relay"),r.end({type:dr.Type.STATUS,code:dr.Status.HOP_CANT_SPEAK_RELAY});try{AD(e,r)}catch(u){return Dn.error("invalid hop request via peer %s",t.remotePeer.toB58String(),u)}if(!e.dstPeer){Dn("HOP request received but we do not receive a dstPeer");return}let i=new xD(e.dstPeer.id),s=n._connectionManager.get(i);if(!s&&!n._options.hop.active)return Dn("HOP request received but we are not connected to the destination peer"),r.end({type:dr.Type.STATUS,code:dr.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:dr.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await ID({connection:s,request:o})}catch(u){return Dn.error(u)}Dn("hop request from %s is valid",t.remotePeer.toB58String()),r.write({type:dr.Type.STATUS,code:dr.Status.SUCCESS});let c=r.rest();return CD(c,a,c)}async function RD({connection:t,request:e}){let{stream:r}=await t.newStream([S2.relay]),n=new w2({stream:r});n.write(e);let i=await n.read();if(!i)throw b2(new Error("HOP request had no response"),_2.ERR_HOP_REQUEST_FAILED);if(i.code===dr.Status.SUCCESS)return Dn("hop request was successful"),n.rest();throw Dn("hop request failed with code %d, closing stream",i.code),n.close(),b2(new Error(`HOP request failed with code ${i.code}`),_2.ERR_HOP_REQUEST_FAILED)}async function BD({connection:t}){let{stream:e}=await t.newStream([S2.relay]),r=new w2({stream:e});r.write({type:dr.Type.CAN_HOP});let n=await r.read();return await r.close(),!(!n||n.code!==dr.Status.SUCCESS)}function PD({connection:t,streamHandler:e,circuit:r}){let n=r._options.hop.enabled;Dn("can hop (%s) request from %s",n,t.remotePeer.toB58String()),e.end({type:dr.Type.STATUS,code:n?dr.Status.SUCCESS:dr.Status.HOP_CANT_SPEAK_RELAY})}x2.exports={handleHop:TD,hop:RD,canHop:BD,handleCanHop:PD}});var B2=b((xK,R2)=>{"use strict";var A2=Oe(),Ln=Object.assign(A2("libp2p:circuit"),{error:A2("libp2p:circuit:err")}),ND=ge(),OD=tw(),{Multiaddr:La}=$t(),C2=qt(),{CircuitRelay:ka}=io(),{codes:DD}=Ye(),I2=hw(),{relay:LD}=Na(),kD=gw(),{handleCanHop:qD,handleHop:UD,hop:MD}=uh(),{handleStop:FD}=ch(),KD=Pu(),VD=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),T2=class{constructor({libp2p:e,upgrader:r}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=r,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(LD,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:r}){let n=new KD({stream:r}),i=await n.read();if(!i)return;let s=this,o;switch(i.type){case ka.Type.CAN_HOP:{Ln("received CAN_HOP request from %s",e.remotePeer.toB58String()),await qD({circuit:s,connection:e,streamHandler:n});break}case ka.Type.HOP:{Ln("received HOP request from %s",e.remotePeer.toB58String()),o=await UD({connection:e,request:i,streamHandler:n,circuit:s});break}case ka.Type.STOP:{Ln("received STOP request from %s",e.remotePeer.toB58String()),o=await FD({connection:e,request:i,streamHandler:n});break}default:Ln("Request of type %s not supported",i.type)}if(o){let a=new La(i.dstPeer.addrs[0]),c=new La(i.srcPeer.addrs[0]),u=I2({stream:o,remoteAddr:a,localAddr:c}),l=i.type===ka.Type.HOP?"relay":"inbound";Ln("new %s connection %s",l,u.remoteAddr);let f=await this._upgrader.upgradeInbound(u);Ln("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(f)}}async dial(e,r){let n=e.toString().split("/p2p-circuit"),i=new La(n[0]),s=new La(n[n.length-1]),o=i.getPeerId(),a=s.getPeerId();if(!o||!a){let d="Circuit relay dial failed as addresses did not have peer id";throw Ln.error(d),ND(new Error(d),DD.ERR_RELAYED_DIAL)}let c=C2.createFromB58String(o),u=C2.createFromB58String(a),l=!1,f=this._connectionManager.get(c);f||(f=await this._dialer.connectToPeer(i,r),l=!0);try{let d=await MD({connection:f,request:{type:ka.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(g=>g.bytes)},dstPeer:{id:u.toBytes(),addrs:[new La(s).bytes]}}}),p=i.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),h=I2({stream:d,remoteAddr:e,localAddr:p});return Ln("new outbound connection %s",h.remoteAddr),this._upgrader.upgradeOutbound(h)}catch(d){throw Ln.error("Circuit relay dial failed",d),l&&await f.close(),d}}createListener(e,r){return typeof e=="function"&&(r=e,e={}),this.handler=r,kD(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>OD.Circuit.matches(r))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[VD])}};R2.exports=T2});var lh=b((AK,P2)=>{"use strict";var{CID:jD}=(Ss(),Fo),{sha256:$D}=(ki(),Zn);P2.exports.namespaceToCid=async t=>{let e=new TextEncoder().encode(t),r=await $D.digest(e);return jD.createV0(r)}});var q2=b((CK,k2)=>{"use strict";var N2=Oe(),fh=Object.assign(N2("libp2p:auto-relay"),{error:N2("libp2p:auto-relay:err")}),{fromString:HD}=(Dt(),Ft),{toString:zD}=(Lt(),Kt),{Multiaddr:GD}=$t(),WD=Vi(),{relay:YD}=Na(),{canHop:QD}=uh(),{namespaceToCid:XD}=lh(),{CIRCUIT_PROTO_CODE:ZD,HOP_METADATA_KEY:O2,HOP_METADATA_VALUE:D2,RELAY_RENDEZVOUS_NS:JD}=pu(),L2=class{constructor({libp2p:e,maxListeners:r=1,onError:n}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=r,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(i,s)=>{fh.error(s||i),n&&n(i,s)}}async _onProtocolChange({peerId:e,protocols:r}){let n=e.toB58String(),i=r.find(s=>s===YD);if(!i&&this._listenRelays.has(n)){await this._removeListenRelay(n);return}else if(!i||this._listenRelays.has(n))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(ZD)){fh(`relayed connection to ${n} will not be used to hop on`);return}await QD({connection:s})&&(await this._peerStore.metadataBook.setValue(e,O2,HD(D2)),await this._addListenRelay(s,n))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let n=e.remotePeer.toB58String();!this._listenRelays.has(n)||this._removeListenRelay(n).catch(i=>{fh.error(i)})}async _addListenRelay(e,r){try{if(this._listenRelays.size>=this.maxListeners)return;let n=await this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);(await Promise.all(n.map(async s=>{try{return await this._transportManager.listen([new GD(`${s.toString()}/p2p-circuit`)]),!0}catch(o){this._onError(o)}return!1}))).includes(!0)&&this._listenRelays.add(r)}catch(n){this._onError(n),this._listenRelays.delete(r)}}async _removeListenRelay(e){this._listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let r=[],n=await WD(this._peerStore.getPeers());for await(let{id:i,metadata:s}of n){let o=i.toB58String();if(this._listenRelays.has(o)||e.includes(o))continue;let a=s.get(O2);if(!a||zD(a)!==D2)continue;let c=this._connectionManager.get(i);if(!c){r.push(i);continue}if(await this._addListenRelay(c,o),this._listenRelays.size>=this.maxListeners)return}for(let i of r)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await XD(JD);for await(let s of this._libp2p.contentRouting.findProviders(i)){if(!s.multiaddrs.length)continue;let o=s.id;if(await this._peerStore.addressBook.add(o,s.multiaddrs),await this._tryToListenOnRelay(o),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let r=await this._libp2p.dial(e);await this._addListenRelay(r,e.toB58String())}catch(r){this._onError(r,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};k2.exports=L2});var V2=b((IK,K2)=>{"use strict";var U2=Oe(),M2=Object.assign(U2("libp2p:relay"),{error:U2("libp2p:relay:err")}),{codes:eL}=Ye(),{setDelayedInterval:tL,clearDelayedInterval:rL}=gd(),nL=q2(),{namespaceToCid:iL}=lh(),{RELAY_RENDEZVOUS_NS:sL}=pu(),F2=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new nL({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=tL(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){rL(this._timeout)}async _advertiseService(){try{let e=await iL(sL);await this._libp2p.contentRouting.provide(e)}catch(e){e.code===eL.ERR_NO_ROUTERS_AVAILABLE?(M2.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):M2.error(e)}}};K2.exports=F2});var hh=b((TK,dh)=>{function j2(t){let e=new globalThis.AbortController;function r(){e.abort();for(let n of t)!n||!n.removeEventListener||n.removeEventListener("abort",r)}for(let n of t)if(!(!n||!n.addEventListener)){if(n.aborted){r();break}n.addEventListener("abort",r)}return e.signal}dh.exports=j2;dh.exports.anySignal=j2});var G2=b((BK,z2)=>{var $2=ld(),H2=sh();z2.exports=class{constructor(){this._buffer=new $2,this._waitingConsumers=new $2}push(e){let{promise:r,resolve:n}=H2();return this._buffer.push({chunk:e,resolve:n}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=H2();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var Y2=b((PK,W2)=>{"use strict";W2.exports=(t,e=1,r)=>{if(r={indent:" ",includeEmptyLines:!1,...r},typeof t!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof r.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof r.indent}\``);if(e===0)return t;let n=r.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(n,r.indent.repeat(e))}});var Q2=b(()=>{});var e_=b((DK,J2)=>{"use strict";var X2=Q2(),Z2=/\s+at.*(?:\(|\s)(.*)\)?/,oL=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,aL=typeof X2.homedir=="undefined"?"":X2.homedir();J2.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split(`
`).filter(r=>{let n=r.match(Z2);if(n===null||!n[1])return!0;let i=n[1];return i.includes(".app/Contents/Resources/electron.asar")||i.includes(".app/Contents/Resources/default_app.asar")?!1:!oL.test(i)}).filter(r=>r.trim()!=="").map(r=>e.pretty?r.replace(Z2,(n,i)=>n.replace(i,i.replace(aL,"~"))):r).join(`
`))});var n_=b((LK,r_)=>{"use strict";var cL=Y2(),uL=e_(),lL=t=>t.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),t_=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(n=>n instanceof Error?n:n!==null&&typeof n=="object"?Object.assign(new Error(n.message),n):new Error(n));let r=e.map(n=>typeof n.stack=="string"?lL(uL(n.stack)):String(n)).join(`
`);r=`
`+cL(r,4);super(r);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};r_.exports=t_});var i_=b((kK,yh)=>{"use strict";var ph=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},qa=class{static fn(e){return(...r)=>new qa((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new ph(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(qa.prototype,Promise.prototype);yh.exports=qa;yh.exports.CancelError=ph});var o_=b((qK,Nu)=>{"use strict";var s_=n_(),fL=i_(),gh=class extends Error{},dL=(t,e)=>new fL((r,n,i)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){n(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,f=new Set,d=()=>(a.length===s&&(r(a),l=!0),u-c.length<s&&(n(new s_(c)),l=!0),l),p=()=>{for(let h of t)!f.has(h)&&typeof h.cancel=="function"&&h.cancel()};i(p);for(let h of t)u++,(async()=>{try{let g=await h;if(l)return;if(!o(g))throw new gh("Value does not satisfy filter");a.push(g)}catch(g){c.push(g)}finally{f.add(h),!l&&d()&&p()}})();s>u&&(n(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});Nu.exports=dL;Nu.exports.AggregateError=s_;Nu.exports.FilterError=gh});var a_=b((UK,vh)=>{"use strict";var mh=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},Ua=class{static fn(e){return(...r)=>new Ua((n,i,s)=>{r.push(s),e(...r).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},s=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,s,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new mh(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Ua.prototype,Promise.prototype);vh.exports=Ua;vh.exports.CancelError=mh});var u_=b((MK,Eh)=>{"use strict";var c_=o_(),hL=a_();Eh.exports=(t,e)=>{let r=c_(t,{...e,count:1});return hL.fn(async n=>{n(()=>{r.cancel()});let[i]=await r;return i})()};Eh.exports.AggregateError=c_.AggregateError});var h_=b((FK,d_)=>{"use strict";var pL=ge(),{anySignal:yL}=hh(),gL=G2(),mL=u_(),{setMaxListeners:l_}=rr(),{codes:vL}=Ye(),f_=class{constructor({addrs:e,dialAction:r,dialer:n}){this.addrs=e,this.dialer=n,this.dialAction=r}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw pL(new Error("No dial tokens available"),vL.ERR_NO_DIAL_TOKENS);let n=new gL;r.forEach(o=>n.push(o));let i=this.addrs.map(()=>{let o=new AbortController;try{l_&&l_(1/0,o.signal)}catch{}return o}),s=0;try{return await mL(this.addrs.map(async(o,a)=>{let c=await n.shift(),u;try{let l=i[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?yL([l,e.signal]):l}),i[a]=void 0}finally{s++,this.addrs.length-s>=r.length?n.push(c):this.dialer.releaseToken(r.splice(r.indexOf(c),1)[0])}return u}))}finally{i.forEach(o=>{o!==void 0&&o.abort()}),r.forEach(o=>this.dialer.releaseToken(o))}}};d_.exports=f_});var w_=b((KK,b_)=>{"use strict";var p_=Oe(),EL=Vi(),bL=ji(),{pipe:wL}=fr(),fo=Object.assign(p_("libp2p:dialer"),{error:p_("libp2p:dialer:err")}),Ou=ge(),{Multiaddr:bh}=$t(),{TimeoutController:_L}=ud(),{AbortError:SL}=xu(),{anySignal:xL}=hh(),{setMaxListeners:y_}=rr(),AL=h_(),{publicAddressesFirst:CL}=Sd(),g_=md(),m_=Dd(),{codes:Ma}=Ye(),{DIAL_TIMEOUT:IL,MAX_PARALLEL_DIALS:TL,MAX_PER_PEER_DIALS:RL,MAX_ADDRS_TO_DIAL:BL}=hu(),v_="dialler",PL="pending-dials",NL="pending-dial-targets",E_=class{constructor({transportManager:e,peerStore:r,connectionGater:n,addressSorter:i=CL,maxParallelDials:s=TL,maxAddrsToDial:o=BL,dialTimeout:a=IL,maxDialsPerPeer:c=RL,resolvers:u={},metrics:l}){this.connectionGater=n,this.transportManager=e,this.peerStore=r,this.addressSorter=i,this.maxParallelDials=s,this.maxAddrsToDial=o,this.timeout=a,this.maxDialsPerPeer=c,this.tokens=[...new Array(s)].map((f,d)=>d),this._pendingDials=m_({component:v_,metric:PL,metrics:l}),this._pendingDialTargets=m_({component:v_,metric:NL,metrics:l});for(let[f,d]of Object.entries(u))bh.resolvers.set(f,d)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(r){fo.error(r)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new SL("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,r={}){let{id:n}=g_(e);if(await this.connectionGater.denyDialPeer(n))throw Ou(new Error("The dial request is blocked by gater.allowDialPeer"),Ma.ERR_PEER_DIAL_INTERCEPTED);let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw Ou(new Error("The dial request has no valid addresses"),Ma.ERR_NO_VALID_ADDRESSES);let s=this._pendingDials.get(i.id)||this._createPendingDial(i,r);try{let o=await s.promise;return fo("dial succeeded to %s",i.id),o}catch(o){throw s.controller.signal.aborted&&(o.code=Ma.ERR_TIMEOUT),fo.error(o),o}finally{s.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,n=new Promise((i,s)=>{this._pendingDialTargets.set(r,{resolve:i,reject:s})});try{return await Promise.race([this._createDialTarget(e),n])}finally{this._pendingDialTargets.delete(r)}}async _createDialTarget(e){let{id:r,multiaddrs:n}=g_(e);n&&await this.peerStore.addressBook.add(r,n);let i=await wL(await this.peerStore.addressBook.getMultiaddrsForPeer(r,this.addressSorter),a=>bL(a,async c=>!await this.connectionGater.denyDialMultiaddr(r,c)),a=>EL(a));bh.isMultiaddr(e)&&(i=i.filter(a=>!e.equals(a)),i.unshift(e));let s=[];for(let a of i)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw await this.peerStore.delete(r),Ou(new Error("dial with more addresses than allowed"),Ma.ERR_TOO_MANY_ADDRESSES);return{id:r.toB58String(),addrs:o}}_createPendingDial(e,r={}){let n=(u,l)=>{if(l.signal.aborted)throw Ou(new Error("already aborted"),Ma.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},i=new AL({addrs:e.addrs,dialAction:n,dialer:this}),s=new _L(this.timeout),o=[s.signal];r.signal&&o.push(r.signal);let a=xL(o);try{y_&&y_(1/0,a)}catch{}let c={dialRequest:i,controller:s,promise:i.run({...r,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,r);return fo("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),n}releaseToken(e){this.tokens.indexOf(e)>-1||(fo("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let n=await this._resolveRecord(e);return(await Promise.all(n.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new bh(e.toString()),await e.resolve()}catch(r){return fo.error(`multiaddr ${e} could not be resolved`),[]}}};b_.exports=E_});var S_=b((VK,__)=>{"use strict";function OL(t){return t>=55296&&t<=56319}function DL(t){return t>=56320&&t<=57343}__.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,s=0,o,a,c=0;c<i;c+=1){if(o=r.charCodeAt(c),a=r[c],OL(o)&&DL(r.charCodeAt(c+1))&&(c+=1,a+=r[c]),s+=e(a),s===n)return r.slice(0,c+1);if(s>n)return r.slice(0,c-a.length+1)}return r}});var A_=b((jK,x_)=>{"use strict";function LL(t){return t>=55296&&t<=56319}function kL(t){return t>=56320&&t<=57343}x_.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,s=null,o=0;o<r;o++)i=e.charCodeAt(o),kL(i)?s!=null&&LL(s)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),s=i;return n}});var I_=b(($K,C_)=>{"use strict";var qL=S_(),UL=A_();C_.exports=qL.bind(null,UL)});var B_=b((HK,R_)=>{"use strict";var ML=I_(),FL=/[\/\?<>\\:\*\|"]/g,KL=/[\x00-\x1f\x80-\x9f]/g,VL=/^\.+$/,jL=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,$L=/[\. ]+$/;function T_(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(FL,e).replace(KL,e).replace(VL,e).replace(jL,e).replace($L,e);return ML(r,255)}R_.exports=function(t,e){var r=e&&e.replacement||"",n=T_(t,r);return r===""?n:T_(n,"")}});var O_=b((zK,N_)=>{"use strict";Rs();var Du=_e(),{toString:ho}=(Lt(),Kt),{fromString:P_}=(Dt(),Ft);N_.exports={createCipheriv:(t,e,r)=>{let n=Du.cipher.createCipher("AES-CTR",ho(e,"ascii"));return n.start({iv:ho(r,"ascii")}),{update:i=>(n.update(Du.util.createBuffer(ho(i,"ascii"))),P_(n.output.getBytes(),"ascii"))}},createDecipheriv:(t,e,r)=>{let n=Du.cipher.createDecipher("AES-CTR",ho(e,"ascii"));return n.start({iv:ho(r,"ascii")}),{update:i=>(n.update(Du.util.createBuffer(ho(i,"ascii"))),P_(n.output.getBytes(),"ascii"))}}}});var k_=b((GK,L_)=>{"use strict";var HL=ge(),D_={16:"aes-128-ctr",32:"aes-256-ctr"};L_.exports=function(t){let e=D_[t.length];if(!e){let r=Object.entries(D_).map(([n,i])=>`${n} (${i})`).join(" / ");throw HL(new Error(`Invalid key length ${t.length} bytes. Must be ${r}`),"ERR_INVALID_KEY_LENGTH")}return e}});var M_=b(U_=>{"use strict";var q_=O_(),zL=k_();U_.create=async function(t,e){let r=zL(t),n=q_.createCipheriv(r,t,e),i=q_.createDecipheriv(r,t,e);return{async encrypt(o){return n.update(o)},async decrypt(o){return i.update(o)}}}});var V_=b((YK,K_)=>{"use strict";var GL=$l(),WL=Qe(),YL=ge(),F_={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function QL(t,e,r,n,i){let s=F_[i];if(!s){let a=Object.keys(F_).join(" / ");throw YL(new Error(`Hash '${i}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=GL(t,e,r,n,s);return WL.encode64(o)}K_.exports=QL});var Lu=b(po=>{"use strict";var XL=Pf(),ZL=M_(),JL=Wc();po.aes=ZL;po.hmac=XL;po.keys=JL;po.randomBytes=Nc();po.pbkdf2=V_()});var z_=b((XK,H_)=>{var yo=_e();Wn();Qe();var J=yo.asn1,go=H_.exports=yo.pkcs7asn1=yo.pkcs7asn1||{};yo.pkcs7=yo.pkcs7||{};yo.pkcs7.asn1=go;var j_={name:"ContentInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};go.contentInfoValidator=j_;var $_={name:"EncryptedContentInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};go.envelopedDataValidator={name:"EnvelopedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat($_)};go.encryptedDataValidator={name:"EncryptedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"}].concat($_)};var e6={name:"SignerInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:J.Class.UNIVERSAL,type:J.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:J.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};go.signedDataValidator={name:"SignedData",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},j_,{name:"SignedData.Certificates",tagClass:J.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:J.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:J.Class.UNIVERSAL,type:J.Type.SET,capture:"signerInfos",optional:!0,value:[e6]}]};go.recipientInfoValidator={name:"RecipientInfo",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:J.Class.UNIVERSAL,type:J.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:J.Class.UNIVERSAL,type:J.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:J.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:J.Class.UNIVERSAL,type:J.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var W_=b((ZK,G_)=>{var is=_e();Qe();is.mgf=is.mgf||{};var t6=G_.exports=is.mgf.mgf1=is.mgf1=is.mgf1||{};t6.create=function(t){var e={generate:function(r,n){for(var i=new is.util.ByteBuffer,s=Math.ceil(n/t.digestLength),o=0;o<s;o++){var a=new is.util.ByteBuffer;a.putInt32(o),t.start(),t.update(r+a.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return e}});var Q_=b((JK,Y_)=>{var ku=_e();W_();Y_.exports=ku.mgf=ku.mgf||{};ku.mgf.mgf1=ku.mgf1});var Z_=b((eV,X_)=>{var ss=_e();Ni();Qe();var r6=X_.exports=ss.pss=ss.pss||{};r6.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=ss.util.createBuffer(i));var s;if("saltLength"in t)s=t.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=t.prng||ss.random,a={};return a.encode=function(c,u){var l,f=u-1,d=Math.ceil(f/8),p=c.digest().getBytes();if(d<n+s+2)throw new Error("Message is too long to encrypt.");var h;i===null?h=o.getBytesSync(s):h=i.bytes();var g=new ss.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(p),g.putBytes(h),e.start(),e.update(g.getBytes());var v=e.digest().getBytes(),w=new ss.util.ByteBuffer;w.fillWithByte(0,d-s-n-2),w.putByte(1),w.putBytes(h);var C=w.getBytes(),q=d-n-1,W=r.generate(v,q),F="";for(l=0;l<q;l++)F+=String.fromCharCode(C.charCodeAt(l)^W.charCodeAt(l));var M=65280>>8*d-f&255;return F=String.fromCharCode(F.charCodeAt(0)&~M)+F.substr(1),F+v+String.fromCharCode(188)},a.verify=function(c,u,l){var f,d=l-1,p=Math.ceil(d/8);if(u=u.substr(-p),p<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=p-n-1,g=u.substr(0,h),v=u.substr(h,n),w=65280>>8*p-d&255;if((g.charCodeAt(0)&w)!=0)throw new Error("Bits beyond keysize not zero as expected.");var C=r.generate(v,h),q="";for(f=0;f<h;f++)q+=String.fromCharCode(g.charCodeAt(f)^C.charCodeAt(f));q=String.fromCharCode(q.charCodeAt(0)&~w)+q.substr(1);var W=p-n-s-2;for(f=0;f<W;f++)if(q.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(q.charCodeAt(W)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var F=q.substr(-s),M=new ss.util.ByteBuffer;M.fillWithByte(0,8),M.putBytes(c),M.putBytes(F),e.start(),e.update(M.getBytes());var re=e.digest().getBytes();return v===re},a}});var _h=b((tV,nS)=>{var fe=_e();Rs();Wn();vc();Yn();Q_();Cs();_c();Z_();Yo();Qe();var y=fe.asn1,Q=nS.exports=fe.pki=fe.pki||{},Ne=Q.oids,gt={};gt.CN=Ne.commonName;gt.commonName="CN";gt.C=Ne.countryName;gt.countryName="C";gt.L=Ne.localityName;gt.localityName="L";gt.ST=Ne.stateOrProvinceName;gt.stateOrProvinceName="ST";gt.O=Ne.organizationName;gt.organizationName="O";gt.OU=Ne.organizationalUnitName;gt.organizationalUnitName="OU";gt.E=Ne.emailAddress;gt.emailAddress="E";var J_=fe.pki.rsa.publicKeyValidator,n6={name:"Certificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:y.Class.UNIVERSAL,type:y.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:y.Class.UNIVERSAL,type:y.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},J_,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},i6={name:"rsapss",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:y.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:y.Class.UNIVERSAL,type:y.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:y.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:y.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:y.Class.UNIVERSAL,type:y.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},s6={name:"CertificationRequestInfo",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:y.Class.UNIVERSAL,type:y.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},J_,{name:"CertificationRequestInfo.attributes",tagClass:y.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:y.Class.UNIVERSAL,type:y.Type.SET,constructed:!0}]}]}]},o6={name:"CertificationRequest",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[s6,{name:"CertificationRequest.signatureAlgorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:y.Class.UNIVERSAL,type:y.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:y.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:y.Class.UNIVERSAL,type:y.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Q.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,s,o=0;o<t.value.length;++o){n=t.value[o];for(var a=0;a<n.value.length;++a)s={},i=n.value[a],s.type=y.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in Ne&&(s.name=Ne[s.type],s.name in gt&&(s.shortName=gt[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};Q.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=y.derToOid(n.value[0].value),s=n.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=i,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in Ne&&(a.name=Ne[a.type],a.name in gt&&(a.shortName=gt[a.name])),a.type===Ne.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Q.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function gi(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var qu=function(t,e,r){var n={};if(t!==Ne["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:Ne.sha1},mgf:{algorithmOid:Ne.mgf1,hash:{algorithmOid:Ne.sha1}},saltLength:20});var i={},s=[];if(!y.validate(e,i6,i,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=y.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=y.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=y.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},Uu=function(t){switch(Ne[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return fe.md.sha1.create();case"md5WithRSAEncryption":return fe.md.md5.create();case"sha256WithRSAEncryption":return fe.md.sha256.create();case"sha384WithRSAEncryption":return fe.md.sha384.create();case"sha512WithRSAEncryption":return fe.md.sha512.create();case"RSASSA-PSS":return fe.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},eS=function(t){var e=t.certificate,r;switch(e.signatureOid){case Ne.sha1WithRSAEncryption:case Ne.sha1WithRSASignature:break;case Ne["RSASSA-PSS"]:var n,i;if(n=Ne[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||fe.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(i=Ne[e.signatureParameters.mgf.algorithmOid],i===void 0||fe.mgf[i]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=i,s}if(i=fe.mgf[i].create(fe.md[n].create()),n=Ne[e.signatureParameters.hash.algorithmOid],n===void 0||fe.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=n,s}r=fe.pss.create(fe.md[n].create(),i,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};Q.certificateFromPem=function(t,e,r){var n=fe.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=y.fromDer(n.body,r);return Q.certificateFromAsn1(s,e)};Q.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:y.toDer(Q.certificateToAsn1(t)).getBytes()};return fe.pem.encode(r,{maxline:e})};Q.publicKeyFromPem=function(t){var e=fe.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=y.fromDer(e.body);return Q.publicKeyFromAsn1(n)};Q.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:y.toDer(Q.publicKeyToAsn1(t)).getBytes()};return fe.pem.encode(r,{maxline:e})};Q.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:y.toDer(Q.publicKeyToRSAPublicKey(t)).getBytes()};return fe.pem.encode(r,{maxline:e})};Q.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||fe.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=y.toDer(Q.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=y.toDer(Q.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var s=r.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Q.certificationRequestFromPem=function(t,e,r){var n=fe.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=y.fromDer(n.body,r);return Q.certificationRequestFromAsn1(s,e)};Q.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:y.toDer(Q.certificationRequestToAsn1(t)).getBytes()};return fe.pem.encode(r,{maxline:e})};Q.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return gi(t.issuer,e)},t.issuer.addField=function(e){Or([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return gi(t.subject,e)},t.subject.addField=function(e){Or([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){Or(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){Or(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)tS(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||fe.md.sha1.create();var n=Ne[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=Q.getTBSCertificate(t);var s=y.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){o=Uu({signatureOid:e.signatureOid,type:"certificate"});var a=e.tbsCertificate||Q.getTBSCertificate(e),c=y.toDer(a);o.update(c.getBytes())}return o!==null&&(r=eS({certificate:t,md:o,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,o,a=0;r&&a<n.attributes.length;++a)s=n.attributes[a],o=i.attributes[a],(s.type!==o.type||s.value!==o.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return Q.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=Ne.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return fe.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};Q.certificateFromAsn1=function(t,e){var r={},n=[];if(!y.validate(t,n6,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=y.derToOid(r.publicKeyOid);if(s!==Q.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Q.createCertificate();o.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=fe.util.createBuffer(r.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=fe.asn1.derToOid(r.certSignatureOid),o.signatureParameters=qu(o.signatureOid,r.certSignatureParams,!0),o.siginfo.algorithmOid=fe.asn1.derToOid(r.certinfoSignatureOid),o.siginfo.parameters=qu(o.siginfo.algorithmOid,r.certinfoSignatureParams,!1),o.signature=r.certSignature;var c=[];if(r.certValidity1UTCTime!==void 0&&c.push(y.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&c.push(y.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&c.push(y.generalizedTimeToDate(r.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=r.tbsCertificate,e){o.md=Uu({signatureOid:o.signatureOid,type:"certificate"});var u=y.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=fe.md.sha1.create(),f=y.toDer(r.certIssuer);l.update(f.getBytes()),o.issuer.getField=function(h){return gi(o.issuer,h)},o.issuer.addField=function(h){Or([h]),o.issuer.attributes.push(h)},o.issuer.attributes=Q.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(o.issuer.uniqueId=r.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var d=fe.md.sha1.create(),p=y.toDer(r.certSubject);return d.update(p.getBytes()),o.subject.getField=function(h){return gi(o.subject,h)},o.subject.addField=function(h){Or([h]),o.subject.attributes.push(h)},o.subject.attributes=Q.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(o.subject.uniqueId=r.certSubjectUniqueId),o.subject.hash=d.digest().toHex(),r.certExtensions?o.extensions=Q.certificateExtensionsFromAsn1(r.certExtensions):o.extensions=[],o.publicKey=Q.publicKeyFromAsn1(r.subjectPublicKeyInfo),o};Q.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(Q.certificateExtensionFromAsn1(n.value[i]));return e};Q.certificateExtensionFromAsn1=function(t){var e={};if(e.id=y.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===y.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in Ne){if(e.name=Ne[e.id],e.name==="keyUsage"){var r=y.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)==128,e.nonRepudiation=(n&64)==64,e.keyEncipherment=(n&32)==32,e.dataEncipherment=(n&16)==16,e.keyAgreement=(n&8)==8,e.keyCertSign=(n&4)==4,e.cRLSign=(n&2)==2,e.encipherOnly=(n&1)==1,e.decipherOnly=(i&128)==128}else if(e.name==="basicConstraints"){var r=y.fromDer(e.value);r.value.length>0&&r.value[0].type===y.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===y.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=y.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=y.fromDer(e.value),o=0;o<r.value.length;++o){var a=y.derToOid(r.value[o].value);a in Ne?e[Ne[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=y.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)==128,e.server=(n&64)==64,e.email=(n&32)==32,e.objsign=(n&16)==16,e.reserved=(n&8)==8,e.sslCA=(n&4)==4,e.emailCA=(n&2)==2,e.objCA=(n&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,r=y.fromDer(e.value),u=0;u<r.value.length;++u){c=r.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=fe.util.bytesToIP(c.value);break;case 8:l.oid=y.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=y.fromDer(e.value);e.subjectKeyIdentifier=fe.util.bytesToHex(r.value)}}return e};Q.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!y.validate(t,o6,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=y.derToOid(r.publicKeyOid);if(s!==Q.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Q.createCertificationRequest();if(o.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,o.signatureOid=fe.asn1.derToOid(r.csrSignatureOid),o.signatureParameters=qu(o.signatureOid,r.csrSignatureParams,!0),o.siginfo.algorithmOid=fe.asn1.derToOid(r.csrSignatureOid),o.siginfo.parameters=qu(o.siginfo.algorithmOid,r.csrSignatureParams,!1),o.signature=r.csrSignature,o.certificationRequestInfo=r.certificationRequestInfo,e){o.md=Uu({signatureOid:o.signatureOid,type:"certification request"});var a=y.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=fe.md.sha1.create();return o.subject.getField=function(u){return gi(o.subject,u)},o.subject.addField=function(u){Or([u]),o.subject.attributes.push(u)},o.subject.attributes=Q.RDNAttributesAsArray(r.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Q.publicKeyFromAsn1(r.subjectPublicKeyInfo),o.getAttribute=function(u){return gi(o,u)},o.addAttribute=function(u){Or([u]),o.attributes.push(u)},o.attributes=Q.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),o};Q.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return gi(t.subject,e)},t.subject.addField=function(e){Or([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return gi(t,e)},t.addAttribute=function(e){Or([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){Or(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){Or(e),t.attributes=e},t.sign=function(e,r){t.md=r||fe.md.sha1.create();var n=Ne[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=Q.getCertificationRequestInfo(t);var s=y.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=Uu({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||Q.getCertificationRequestInfo(t),i=y.toDer(n);r.update(i.getBytes())}return r!==null&&(e=eS({certificate:t,md:r,signature:t.signature})),e},t};function mo(t){for(var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,s=0;s<i.length;++s){r=i[s];var o=r.value,a=y.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===y.Type.UTF8&&(o=fe.util.encodeUtf8(o))),n=y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(r.type).getBytes()),y.create(y.Class.UNIVERSAL,a,!1,o)])]),e.value.push(n)}return e}function Or(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name=="undefined"&&(e.type&&e.type in Q.oids?e.name=Q.oids[e.type]:e.shortName&&e.shortName in gt&&(e.name=Q.oids[gt[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Q.oids)e.type=Q.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName=="undefined"&&e.name&&e.name in gt&&(e.shortName=gt[e.name]),e.type===Ne.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=y.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(Q.certificateExtensionToAsn1(tS(e.extensions[i])))}if(typeof e.value=="undefined"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function tS(t,e){if(e=e||{},typeof t.name=="undefined"&&t.id&&t.id in Q.oids&&(t.name=Q.oids[t.id]),typeof t.id=="undefined")if(t.name&&t.name in Q.oids)t.id=Q.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value!="undefined")return t;if(t.name==="keyUsage"){var n=0,i=0,s=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(s|=128,n=7);var o=String.fromCharCode(n);s!==0?o+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(o+=String.fromCharCode(i)),t.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,o)}else if(t.name==="basicConstraints")t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var c in t)t[c]===!0&&(c in Ne?a.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(Ne[c]).getBytes())):c.indexOf(".")!==-1&&a.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(c).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var o=String.fromCharCode(n);i!==0&&(o+=String.fromCharCode(i)),t.value=y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,o)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=fe.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=y.oidToDer(y.oidToDer(u.oid)):o=y.oidToDer(o));t.value.value.push(y.create(y.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=y.create(y.Class.UNIVERSAL,y.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var f=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=f.toHex(),t.value=y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,f.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var d=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!1,d))}if(t.authorityCertIssuer){var p=[y.create(y.Class.CONTEXT_SPECIFIC,4,!0,[mo(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,p))}if(t.serialNumber){var h=fe.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(t.name==="cRLDistributionPoints"){t.value=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);for(var a=t.value.value,g=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]),v=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<t.altNames.length;++l){u=t.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=fe.util.bytesFromIP(u.ip),o===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?o=y.oidToDer(y.oidToDer(u.oid)):o=y.oidToDer(o));v.value.push(y.create(y.Class.CONTEXT_SPECIFIC,u.type,!1,o))}g.value.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[v])),a.push(g)}if(typeof t.value=="undefined"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function wh(t,e){switch(t){case Ne["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.mgf.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(e.mgf.hash.algorithmOid).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(e.saltLength).getBytes())])),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,r);default:return y.create(y.Class.UNIVERSAL,y.Type.NULL,!1,"")}}function a6(t){var e=y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,o=y.Type.UTF8;"valueTagClass"in i&&(o=i.valueTagClass),o===y.Type.UTF8&&(s=fe.util.encodeUtf8(s));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var c=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(i.type).getBytes()),y.create(y.Class.UNIVERSAL,y.Type.SET,!0,[y.create(y.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var c6=new Date("1950-01-01T00:00:00Z"),u6=new Date("2050-01-01T00:00:00Z");function rS(t){return t>=c6&&t<u6?y.create(y.Class.UNIVERSAL,y.Type.UTCTIME,!1,y.dateToUtcTime(t)):y.create(y.Class.UNIVERSAL,y.Type.GENERALIZEDTIME,!1,y.dateToGeneralizedTime(t))}Q.getTBSCertificate=function(t){var e=rS(t.validity.notBefore),r=rS(t.validity.notAfter),n=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.CONTEXT_SPECIFIC,0,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.version).getBytes())]),y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,fe.util.hexToBytes(t.serialNumber)),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.siginfo.algorithmOid).getBytes()),wh(t.siginfo.algorithmOid,t.siginfo.parameters)]),mo(t.issuer),y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,r]),mo(t.subject),Q.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(y.create(y.Class.CONTEXT_SPECIFIC,1,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(y.create(y.Class.CONTEXT_SPECIFIC,2,!0,[y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(Q.certificateExtensionsToAsn1(t.extensions)),n};Q.getCertificationRequestInfo=function(t){var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.INTEGER,!1,y.integerToDer(t.version).getBytes()),mo(t.subject),Q.publicKeyToAsn1(t.publicKey),a6(t)]);return e};Q.distinguishedNameToAsn1=function(t){return mo(t)};Q.certificateToAsn1=function(t){var e=t.tbsCertificate||Q.getTBSCertificate(t);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.signatureOid).getBytes()),wh(t.signatureOid,t.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Q.certificateExtensionsToAsn1=function(t){var e=y.create(y.Class.CONTEXT_SPECIFIC,3,!0,[]),r=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(Q.certificateExtensionToAsn1(t[n]));return e};Q.certificateExtensionToAsn1=function(t){var e=y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[]);e.value.push(y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.id).getBytes())),t.critical&&e.value.push(y.create(y.Class.UNIVERSAL,y.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=y.toDer(r).getBytes()),e.value.push(y.create(y.Class.UNIVERSAL,y.Type.OCTETSTRING,!1,r)),e};Q.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||Q.getCertificationRequestInfo(t);return y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[e,y.create(y.Class.UNIVERSAL,y.Type.SEQUENCE,!0,[y.create(y.Class.UNIVERSAL,y.Type.OID,!1,y.oidToDer(t.signatureOid).getBytes()),wh(t.signatureOid,t.signatureParameters)]),y.create(y.Class.UNIVERSAL,y.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};Q.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(o){var a=r(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=fe.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];fe.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=fe.pki.certificateFromPem(o));var a=r(o.subject);if(!a)return!1;fe.util.isArray(a)||(a=[a]);for(var c=y.toDer(Q.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=y.toDer(Q.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!fe.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=fe.pki.certificateFromPem(o)),n(o.subject),!e.hasCertificate(o))return null;var c=r(o.subject);if(!fe.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=y.toDer(Q.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var f=y.toDer(Q.certificateToAsn1(c[l])).getBytes();u===f&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function r(o){return n(o),e.certs[o.hash]||null}function n(o){if(!o.hash){var a=fe.md.sha1.create();o.attributes=Q.RDNAttributesAsArray(mo(o),a),o.hash=a.digest().toHex()}}if(t)for(var i=0;i<t.length;++i){var s=t[i];e.addCertificate(s)}return e};Q.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Q.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i=="undefined"&&(i=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(i&&(i<c.validity.notBefore||i>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Q.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:i}),o===null){if(u=e[0]||t.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var f=u;fe.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){u=f.shift();try{d=u.verify(c)}catch(F){}}d||(o={message:"Certificate signature is invalid.",error:Q.certificateError.bad_certificate})}o===null&&(!u||l)&&!t.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Q.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:Q.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},h=0;o===null&&h<c.extensions.length;++h){var g=c.extensions[h];g.critical&&!(g.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:Q.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var v=c.getExtension("basicConstraints"),w=c.getExtension("keyUsage");if(w!==null&&(!w.keyCertSign||v===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Q.certificateError.bad_certificate}),o===null&&v!==null&&!v.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Q.certificateError.bad_certificate}),o===null&&w!==null&&"pathLenConstraint"in v){var C=a-1;C>v.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Q.certificateError.bad_certificate})}}var q=o===null?!0:o.error,W=r.verify?r.verify(q,a,n):q;if(W===!0)o=null;else throw q===!0&&(o={message:"The application rejected the certificate.",error:Q.certificateError.bad_certificate}),(W||W===0)&&(typeof W=="object"&&!fe.util.isArray(W)?(W.message&&(o.message=W.message),W.error&&(o.error=W.error)):typeof W=="string"&&(o.error=W)),o;s=!1,++a}while(e.length>0);return!0}});var oS=b((rV,sS)=>{var X=_e();Rs();Wn();vc();Cs();_c();z_();Ni();Qe();_h();var A=X.asn1,Xt=sS.exports=X.pkcs7=X.pkcs7||{};Xt.messageFromPem=function(t){var e=X.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=A.fromDer(e.body);return Xt.messageFromAsn1(n)};Xt.messageToPem=function(t,e){var r={type:"PKCS7",body:A.toDer(t.toAsn1()).getBytes()};return X.pem.encode(r,{maxline:e})};Xt.messageFromAsn1=function(t){var e={},r=[];if(!A.validate(t,Xt.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=A.derToOid(e.contentType),s;switch(i){case X.pki.oids.envelopedData:s=Xt.createEnvelopedData();break;case X.pki.oids.encryptedData:s=Xt.createEncryptedData();break;case X.pki.oids.signedData:s=Xt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};Xt.createSignedData=function(){var t=null;return t={type:X.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(xh(t,n,Xt.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,s=0;s<i.length;++s)t.certificates.push(X.pki.certificateFromAsn1(i[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(X.pki.certificateToAsn1(t.certificates[i]));var s=[],o=A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(t.version).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&o.value[0].value.push(A.create(A.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&o.value[0].value.push(A.create(A.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(A.create(A.Class.UNIVERSAL,A.Type.SET,!0,t.signerInfos)),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.type).getBytes()),o])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var o=n.certificate;typeof o=="string"&&(o=X.pki.certificateFromPem(o)),i=o.issuer.attributes,s=o.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=X.pki.privateKeyFromPem(a));var c=n.digestAlgorithm||X.pki.oids.sha1;switch(c){case X.pki.oids.sha1:case X.pki.oids.sha256:case X.pki.oids.sha384:case X.pki.oids.sha512:case X.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var l=!1,f=!1,d=0;d<u.length;++d){var p=u[d];if(!l&&p.type===X.pki.oids.contentType){if(l=!0,f)break;continue}if(!f&&p.type===X.pki.oids.messageDigest){if(f=!0,l)break;continue}}if(!l||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:i,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:X.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(X.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof X.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=X.util.encodeUtf8(t.content)),n.detached?t.detachedContent=A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=X.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var s=t.signers[i],o=s.digestAlgorithm;o in n||(n[o]=X.md[X.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=n[o]:s.md=X.md[X.pki.oids[o]].create()}t.digestAlgorithmIdentifiers=[];for(var o in n)t.digestAlgorithmIdentifiers.push(A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(o).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")]));return n}function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=A.derToOid(t.contentInfo.value[0].value),o=A.toDer(i);o.getByte(),A.getBerValueLength(o),o=o.getBytes();for(var a in n)n[a].start().update(o);for(var c=new Date,u=0;u<t.signers.length;++u){var l=t.signers[u];if(l.authenticatedAttributes.length===0){if(s!==X.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=A.create(A.Class.UNIVERSAL,A.Type.SET,!0,[]),d=0;d<l.authenticatedAttributes.length;++d){var p=l.authenticatedAttributes[d];p.type===X.pki.oids.messageDigest?p.value=n[l.digestAlgorithm].digest():p.type===X.pki.oids.signingTime&&(p.value||(p.value=c)),f.value.push(Sh(p)),l.authenticatedAttributesAsn1.value.push(Sh(p))}o=A.toDer(f).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=y6(t.signers)}};Xt.createEncryptedData=function(){var t=null;return t={type:X.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:X.pki.oids["aes256-CBC"]},fromAsn1:function(e){xh(t,e,Xt.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),iS(t)}},t};Xt.createEnvelopedData=function(){var t=null;return t={type:X.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:X.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=xh(t,e,Xt.asn1.envelopedDataValidator);t.recipients=d6(r.recipientInfos.value)},toAsn1:function(){return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.type).getBytes()),A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(t.version).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SET,!0,h6(t.recipients)),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,g6(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],s=i.issuer;if(i.serialNumber===e.serialNumber&&s.length===r.length){for(var o=!0,a=0;a<r.length;++a)if(s[a].type!==r[a].type||s[a].value!==r[a].value){o=!1;break}if(o)return i}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case X.pki.oids.rsaEncryption:case X.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=X.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}iS(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:X.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,s;switch(r){case X.pki.oids["aes128-CBC"]:n=16,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["aes192-CBC"]:n=24,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["aes256-CBC"]:n=32,i=16,s=X.aes.createEncryptionCipher;break;case X.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=X.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=X.util.createBuffer(X.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=X.util.createBuffer(X.random.getBytes(i));var o=s(e);if(o.start(t.encryptedContent.parameter.copy()),o.update(t.content),!o.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=o.output}for(var a=0;a<t.recipients.length;++a){var c=t.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case X.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},t};function l6(t){var e={},r=[];if(!A.validate(t,Xt.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:X.pki.RDNAttributesAsArray(e.issuer),serialNumber:X.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:A.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function f6(t){return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(t.version).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[X.pki.distinguishedNameToAsn1({attributes:t.issuer}),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,X.util.hexToBytes(t.serialNumber))]),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.encryptedContent.algorithm).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")]),A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function d6(t){for(var e=[],r=0;r<t.length;++r)e.push(l6(t[r]));return e}function h6(t){for(var e=[],r=0;r<t.length;++r)e.push(f6(t[r]));return e}function p6(t){var e=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,A.integerToDer(t.version).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[X.pki.distinguishedNameToAsn1({attributes:t.issuer}),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,X.util.hexToBytes(t.serialNumber))]),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.digestAlgorithm).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.signatureAlgorithm).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")])),e.value.push(A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=A.create(A.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(Sh(i))}e.value.push(r)}return e}function y6(t){for(var e=[],r=0;r<t.length;++r)e.push(p6(t[r]));return e}function Sh(t){var e;if(t.type===X.pki.oids.contentType)e=A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.value).getBytes());else if(t.type===X.pki.oids.messageDigest)e=A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===X.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=A.utcTimeToDate(i):i=A.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?e=A.create(A.Class.UNIVERSAL,A.Type.UTCTIME,!1,A.dateToUtcTime(i)):e=A.create(A.Class.UNIVERSAL,A.Type.GENERALIZEDTIME,!1,A.dateToGeneralizedTime(i))}return A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.type).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SET,!0,[e])])}function g6(t){return[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(X.pki.oids.data).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(t.algorithm).getBytes()),t.parameter?A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),A.create(A.Class.CONTEXT_SPECIFIC,0,!0,[A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,t.content.getBytes())])]}function xh(t,e,r){var n={},i=[];if(!A.validate(e,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=A.derToOid(n.contentType);if(o!==X.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(X.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==A.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[c].value}else a=n.encryptedContent;t.encryptedContent={algorithm:A.derToOid(n.encAlgorithm),parameter:X.util.createBuffer(n.encParameter.value),content:X.util.createBuffer(a)}}if(n.content){var a="";if(X.util.isArray(n.content))for(var c=0;c<n.content.length;++c){if(n.content[c].type!==A.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[c].value}else a=n.content;t.content=X.util.createBuffer(a)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function iS(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case X.pki.oids["aes128-CBC"]:case X.pki.oids["aes192-CBC"]:case X.pki.oids["aes256-CBC"]:e=X.aes.createDecryptionCipher(t.encryptedContent.key);break;case X.pki.oids.desCBC:case X.pki.oids["des-EDE3-CBC"]:e=X.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var uS=b((nV,cS)=>{"use strict";_h();var m6=_e(),aS=m6.pki,v6=(t,e)=>{let r=aS.setRsaPublicKey(e.n,e.e),n=aS.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);let i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e),n};async function E6(t,e){let r=t.map(e),i=(await Promise.all(r)).findIndex(s=>s);return t[i]}cS.exports={certificateForKey:v6,findAsync:E6}});var hS=b((iV,dS)=>{"use strict";oS();ef();var mi=_e(),{certificateForKey:b6,findAsync:w6}=uS(),vo=ge(),{fromString:lS}=(Dt(),Ft),{toString:_6}=(Lt(),Kt),{codes:Eo}=Ye(),Ah=new WeakMap,fS=class{constructor(e,r){if(!e)throw vo(new Error("keychain is required"),Eo.ERR_KEYCHAIN_REQUIRED);this.keychain=e,Ah.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw vo(new Error("Plain data must be a Uint8Array"),Eo.ERR_INVALID_PARAMETERS);let n=await this.keychain.findKeyByName(e),i=await this.keychain._getPrivateKey(e),s=Ah.get(this).dek,o=mi.pki.decryptRsaPrivateKey(i,s),a=await b6(n,o),c=mi.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=mi.util.createBuffer(r),c.encrypt();let u=mi.asn1.toDer(c.toAsn1()).getBytes();return lS(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw vo(new Error("CMS data is required"),Eo.ERR_INVALID_PARAMETERS);let r;try{let u=mi.util.createBuffer(_6(e,"ascii")),l=mi.asn1.fromDer(u);r=mi.pkcs7.messageFromAsn1(l)}catch(u){throw vo(new Error("Invalid CMS: "+u.message),Eo.ERR_INVALID_CMS)}let n=r.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),i=await w6(n,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!i){let u=n.map(l=>l.keyId);throw vo(new Error("Decryption needs one of the key(s): "+u.join(", ")),Eo.ERR_MISSING_KEYS,{missingKeys:u})}let s=await this.keychain.findKeyById(i.keyId);if(!s)throw vo(new Error("No key available to decrypto"),Eo.ERR_NO_KEY);let o=await this.keychain._getPrivateKey(s.name),a=Ah.get(this).dek,c=mi.pki.decryptRsaPrivateKey(o,a);return r.decrypt(i.recipient,c),lS(r.content.getBytes(),"ascii")}};dS.exports=fS});var bS=b((sV,ES)=>{"use strict";var pS=Oe(),yS=Object.assign(pS("libp2p:keychain"),{error:pS("libp2p:keychain:err")}),S6=B_(),x6=Ys(),os=Lu(),{Key:gS}=(iu(),sd),A6=hS(),ct=ge(),{codes:ut}=Ye(),{toString:as}=(Lt(),Kt),{fromString:kn}=(Dt(),Ft);gf();var C6="/pkcs8/",mS="/info/",vi=new WeakMap,cs={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},Ch={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function qn(t){return!t||typeof t!="string"?!1:t===S6(t.trim())}async function Ve(t){let e=200,r=1e3,n=Math.random()*(r-e)+e;throw await new Promise(i=>setTimeout(i,n)),t}function En(t){return new gS(C6+t)}function Ei(t){return new gS(mS+t)}var vS=class{constructor(e,r){if(!e)throw new Error("store is required");if(this.store=e,this.opts=x6(Ch,r),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<cs.minKeyLength)throw new Error(`dek.keyLength must be least ${cs.minKeyLength} bytes`);if(this.opts.dek.salt.length<cs.minSaltLength)throw new Error(`dek.saltLength must be least ${cs.minSaltLength} bytes`);if(this.opts.dek.iterationCount<cs.minIterationCount)throw new Error(`dek.iterationCount must be least ${cs.minIterationCount}`);let n=this.opts.pass?os.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";vi.set(this,{dek:n})}get cms(){return new A6(this,vi.get(this).dek)}static generateOptions(){let e=Object.assign({},Ch),r=Math.ceil(cs.minSaltLength/3)*3;return e.dek.salt=as(os.randomBytes(r),"base64"),e}static get options(){return Ch}async createKey(e,r,n=2048){let i=this;if(!qn(e)||e==="self")return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));if(typeof r!="string")return Ve(ct(new Error(`Invalid key type '${r}'`),ut.ERR_INVALID_KEY_TYPE));let s=En(e);if(await i.store.has(s))return Ve(ct(new Error(`Key '${e}' already exists`),ut.ERR_KEY_ALREADY_EXISTS));switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)return Ve(ct(new Error(`Invalid RSA key size ${n}`),ut.ERR_INVALID_KEY_SIZE));break;default:break}let a;try{let c=await os.keys.generateKeyPair(r,n),u=await c.id(),l=vi.get(this).dek,f=await c.export(l);a={name:e,id:u};let d=i.store.batch();d.put(s,kn(f)),d.put(Ei(e),kn(JSON.stringify(a))),await d.commit()}catch(c){return Ve(c)}return a}async listKeys(){let e=this,r={prefix:mS},n=[];for await(let i of e.store.query(r))n.push(JSON.parse(as(i.value)));return n}async findKeyById(e){try{return(await this.listKeys()).find(n=>n.id===e)}catch(r){return Ve(r)}}async findKeyByName(e){if(!qn(e))return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));let r=Ei(e);try{let n=await this.store.get(r);return JSON.parse(as(n))}catch(n){return Ve(ct(new Error(`Key '${e}' does not exist. ${n.message}`),ut.ERR_KEY_NOT_FOUND))}}async removeKey(e){let r=this;if(!qn(e)||e==="self")return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));let n=En(e),i=await r.findKeyByName(e),s=r.store.batch();return s.delete(n),s.delete(Ei(e)),await s.commit(),i}async renameKey(e,r){let n=this;if(!qn(e)||e==="self")return Ve(ct(new Error(`Invalid old key name '${e}'`),ut.ERR_OLD_KEY_NAME_INVALID));if(!qn(r)||r==="self")return Ve(ct(new Error(`Invalid new key name '${r}'`),ut.ERR_NEW_KEY_NAME_INVALID));let i=En(e),s=En(r),o=Ei(e),a=Ei(r);if(await n.store.has(s))return Ve(ct(new Error(`Key '${r}' already exists`),ut.ERR_KEY_ALREADY_EXISTS));try{let u=await n.store.get(i),l=await n.store.get(o),f=JSON.parse(as(l));f.name=r;let d=n.store.batch();return d.put(s,u),d.put(a,kn(JSON.stringify(f))),d.delete(i),d.delete(o),await d.commit(),f}catch(u){return Ve(u)}}async exportKey(e,r){if(!qn(e))return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));if(!r)return Ve(ct(new Error("Password is required"),ut.ERR_PASSWORD_REQUIRED));let n=En(e);try{let i=await this.store.get(n),s=as(i),o=vi.get(this).dek;return(await os.keys.import(s,o)).export(r)}catch(i){return Ve(i)}}async importKey(e,r,n){let i=this;if(!qn(e)||e==="self")return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));if(!r)return Ve(ct(new Error("PEM encoded key is required"),ut.ERR_PEM_REQUIRED));let s=En(e);if(await i.store.has(s))return Ve(ct(new Error(`Key '${e}' already exists`),ut.ERR_KEY_ALREADY_EXISTS));let a;try{a=await os.keys.import(r,n)}catch(f){return Ve(ct(new Error("Cannot read the key, most likely the password is wrong"),ut.ERR_CANNOT_READ_KEY))}let c;try{c=await a.id();let f=vi.get(this).dek;r=await a.export(f)}catch(f){return Ve(f)}let u={name:e,id:c},l=i.store.batch();return l.put(s,kn(r)),l.put(Ei(e),kn(JSON.stringify(u))),await l.commit(),u}async importPeer(e,r){let n=this;if(!qn(e))return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));if(!r||!r.privKey)return Ve(ct(new Error("Peer.privKey is required"),ut.ERR_MISSING_PRIVATE_KEY));let i=r.privKey,s=En(e);if(await n.store.has(s))return Ve(ct(new Error(`Key '${e}' already exists`),ut.ERR_KEY_ALREADY_EXISTS));try{let a=await i.id(),c=vi.get(this).dek,u=await i.export(c),l={name:e,id:a},f=n.store.batch();return f.put(s,kn(u)),f.put(Ei(e),kn(JSON.stringify(l))),await f.commit(),l}catch(a){return Ve(a)}}async _getPrivateKey(e){if(!qn(e))return Ve(ct(new Error(`Invalid key name '${e}'`),ut.ERR_INVALID_KEY_NAME));try{let r=En(e),n=await this.store.get(r);return as(n)}catch(r){return Ve(ct(new Error(`Key '${e}' does not exist. ${r.message}`),ut.ERR_KEY_NOT_FOUND))}}async rotateKeychainPass(e,r){if(typeof e!="string")return Ve(ct(new Error(`Invalid old pass type '${typeof e}'`),ut.ERR_INVALID_OLD_PASS_TYPE));if(typeof r!="string")return Ve(ct(new Error(`Invalid new pass type '${typeof r}'`),ut.ERR_INVALID_NEW_PASS_TYPE));if(r.length<20)return Ve(ct(new Error(`Invalid pass length ${r.length}`),ut.ERR_INVALID_PASS_LENGTH));yS("recreating keychain");let n=vi.get(this).dek;this.opts.pass=r;let i=r?os.pbkdf2(r,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";vi.set(this,{dek:i});let s=await this.listKeys();for(let o of s){let a=await this.store.get(En(o.name)),c=as(a),u=await os.keys.import(c,n),l=i.toString(),f=await u.export(l),d=this.store.batch(),p={name:o.name,id:o.id};d.put(En(o.name),kn(f)),d.put(Ei(o.name),kn(JSON.stringify(p))),await d.commit()}yS("keychain reconstructed")}};ES.exports=vS});var Fu=b((Mu,wS)=>{(function(t,e){typeof Mu=="object"&&typeof wS!="undefined"?e(Mu):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis!="undefined"?globalThis:t||self,e(t.streamingIterables={}))})(Mu,function(t){"use strict";async function*e(m,S){let R=[];for await(let O of S)R.push(O),R.length===m&&(yield R,R=[]);R.length>0&&(yield R)}function*r(m,S){let R=[];for(let O of S)R.push(O),R.length===m&&(yield R,R=[]);R.length>0&&(yield R)}function n(m,S){return S===void 0?R=>n(m,R):S[Symbol.asyncIterator]?e(m,S):r(m,S)}let i=Symbol("TIMEOUT"),s=m=>{let S;return[new Promise(R=>{S=setTimeout(()=>R(i),m)}),()=>{clearTimeout(S)}]};async function*o(m,S,R){let O=R[Symbol.asyncIterator](),H,ne=[],ce,oe,ae=()=>{he(),[ce,oe]=s(S)},he=()=>{oe&&oe(),ce=void 0};for(H=O.next();;){let ke=await(ce?Promise.race([H,ce]):H);if(ke===i||ke.done){if(ne.length&&(yield ne,ne=[]),he(),ke!==i)break;continue}if(H=O.next(),ne.push(ke.value),ne.length===1&&ae(),ne.length===m){yield ne,ne=[],he();continue}}}function a(m,S,R){return R===void 0?O=>a(m,S,O):R[Symbol.asyncIterator]&&S!==1/0?o(m,S,R):n(m,R)}function c(m){if(typeof m.next=="function")return m;if(typeof m[Symbol.iterator]=="function")return m[Symbol.iterator]();if(typeof m[Symbol.asyncIterator]=="function")return m[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function u(){let m,S;return{promise:new Promise((O,H)=>{S=O,m=H}),reject:m,resolve:S}}function l(m,S){let R=c(S),O=[],H=[],ne=!1,ce=!1;function oe(){for(;H.length>0&&O.length>0;){let ve=H.shift(),{error:nt,value:wt}=O.shift();nt?ve.reject(nt):ve.resolve({done:!1,value:wt})}for(;H.length>0&&ce;){let{resolve:ve}=H.shift();ve({done:!0,value:void 0})}}async function ae(){if(!ce&&!ne&&!(O.length>=m)){ne=!0;try{let{done:ve,value:nt}=await R.next();ve?ce=!0:O.push({value:nt})}catch(ve){ce=!0,O.push({error:ve})}oe(),ne=!1,ae()}}async function he(){if(O.length>0){let{error:nt,value:wt}=O.shift();if(nt)throw nt;return ae(),{done:!1,value:wt}}if(ce)return{done:!0,value:void 0};let ve=u();return H.push(ve),ae(),ve.promise}let ke={next:he,[Symbol.asyncIterator]:()=>ke};return ke}function*f(m,S){let R=[],O;try{for(let H of S)R.push(H),!(R.length<=m)&&(yield R.shift())}catch(H){O=H}for(let H of R)yield H;if(O)throw O}function d(m,S){return S===void 0?R=>d(m,R):m===0?S:S[Symbol.asyncIterator]?l(m,S):f(m,S)}async function p(m){let S=[];for await(let R of m)S.push(R);return S}function h(m){return m[Symbol.asyncIterator]?p(m):Array.from(m)}async function*g(m){for await(let S of m)yield*S}function*v(m){for(let S of m)yield*S}function w(...m){return m.find(R=>R[Symbol.asyncIterator]!==void 0)?g(m):v(m)}async function C(m){for await(let S of m);}function q(m){if(m[Symbol.asyncIterator])return C(m);for(let S of m);}async function*W(m,S){for await(let R of S)await m(R)&&(yield R)}function F(m,S){return S===void 0?R=>W(m,R):W(m,S)}async function*M(m){for await(let S of m)S&&typeof S!="string"&&(S[Symbol.iterator]||S[Symbol.asyncIterator])?yield*M(S):yield S}async function*re(m,S){for await(let R of S)yield await m(R)}function ie(m,S){return S===void 0?R=>re(m,R):re(m,S)}function z(m,S){return S===void 0?R=>z(m,R):F(R=>R!=null,M(ie(m,S)))}function Ae(m,S,R){let O=c(R),H=[],ne=[],ce=!1,oe=!1,ae=0,he=null;function ke(){for(;ne.length>0&&H.length>0;){let{resolve:Ce}=ne.shift(),pe=H.shift();Ce({done:!1,value:pe})}for(;ne.length>0&&ae===0&&ce;){let{resolve:Ce,reject:pe}=ne.shift();he?(pe(he),he=null):Ce({done:!0,value:void 0})}}async function ve(){if(ce){ke();return}if(!oe&&!(ae+H.length>=m)){oe=!0,ae++;try{let{done:Ce,value:pe}=await O.next();Ce?(ce=!0,ae--,ke()):nt(pe)}catch(Ce){ce=!0,ae--,he=Ce,ke()}oe=!1,ve()}}async function nt(Ce){try{let pe=await S(Ce);if(pe&&pe[Symbol.asyncIterator])for await(let it of pe)H.push(it);else H.push(pe)}catch(pe){ce=!0,he=pe}ae--,ke(),ve()}async function wt(){if(H.length===0){let pe=u();return ne.push(pe),ve(),pe.promise}let Ce=H.shift();return ve(),{done:!1,value:Ce}}let cr={next:wt,[Symbol.asyncIterator]:()=>cr};return cr}function ye(m,S,R){return S===void 0?(O,H)=>H?ye(m,O,H):ye(m,O):R===void 0?O=>ye(m,S,O):F(O=>O!=null,M(Ae(m,S,R)))}async function be(m){return new Promise(S=>{m.once("readable",()=>{S()})})}async function*ft(m){for(;;){let S=m.read();if(S!==null){yield S;continue}if(m._readableState.ended)break;await be(m)}}function bt(m){return typeof m[Symbol.asyncIterator]=="function"?m:ft(m)}async function*Fe(...m){let S=new Set(m.map(c));for(;S.size>0;)for(let R of S){let O=await R.next();O.done?S.delete(R):yield O.value}}function $e(m,...S){let R=m();for(let O of S)R=O(R);return R}async function*se(m,S,R){let O=null,H=ae=>({value:S(ae)}),ne=async function*(ae){for await(let he of ae){if(O)return;yield he}},ce=$e(()=>R,d(1),ne,ie(H),d(m-1)),oe=c(ce);for(;;){let{value:ae,done:he}=await oe.next();if(he)break;try{let ke=await ae.value;O||(yield ke)}catch(ke){O=ke}}if(O)throw O}function Jt(m,S,R){return S===void 0?(O,H)=>Jt(m,O,H):R===void 0?O=>Jt(m,S,O):m===1?ie(S,R):se(m,S,R)}function Ot(m,S,R){return S===void 0?(O,H)=>H?Ot(m,O,H):Ot(m,O):R===void 0?O=>Ot(m,S,O):F(O=>O!=null,M(Jt(m,S,R)))}async function*wn(...m){let S=m.map(c),R=new Set,O=new Map,H=null,ne=null,ce=null,oe=ve=>{H=ve,ne&&ne(ve)},ae=ve=>{ce&&ce(ve)},he=()=>new Promise((ve,nt)=>{if(H&&nt(H),O.size>0)return ve();ce=ve,ne=nt}),ke=ve=>{let nt=Promise.resolve(ve.next()).then(async({done:wt,value:cr})=>{wt||O.set(ve,cr),R.delete(nt)});R.add(nt),nt.then(ae,oe)};for(let ve of S)ke(ve);for(;;){if(R.size===0&&O.size===0)return;await he();for(let[ve,nt]of O)O.delete(ve),yield nt,ke(ve)}}async function er(m,S,R){let O=S;for await(let H of R)O=await m(O,H);return O}function Qr(m,S,R){return S===void 0?(O,H)=>H?er(m,O,H):Qr(m,O):R===void 0?O=>Qr(m,S,O):er(m,S,R)}async function*Y(m,S){let R=0;for await(let O of S)if(yield await O,R++,R>=m)break}function*Oo(m,S){let R=0;for(let O of S)if(yield O,R++,R>=m)break}function Do(m,S){return S===void 0?R=>Do(m,R):S[Symbol.asyncIterator]?Y(m,S):Oo(m,S)}async function*ps(m,S){for await(let R of S)await m(R),yield R}function tr(m,S){return S===void 0?R=>ps(m,R):ps(m,S)}let qr=m=>new Promise(S=>setTimeout(S,m));function E(m,S,R){if(!Number.isFinite(m))throw new TypeError("Expected `limit` to be a finite number");if(m<=0)throw new TypeError("Expected `limit` to be greater than 0");if(!Number.isFinite(S))throw new TypeError("Expected `interval` to be a finite number");return async function*(){let H=0,ne;for await(let ce of R){if(H<m){typeof ne=="undefined"&&(ne=Date.now()),H++,yield ce;continue}let oe=Date.now()-ne,ae=S-oe;ae>0&&await qr(ae),ne=Date.now(),H=1,yield ce}}()}function _(m,S,R){return R===void 0?O=>E(m,S,O):E(m,S,R)}function x(m,S){let R=m[0]+S[0],O=m[1]+S[1];if(O>=1e9){let H=O%1e9;R+=(O-H)/1e9,O=H}return[R,O]}async function*L(m,S){let R=S[Symbol.asyncIterator](),O=[0,0];for(;;){let H=process.hrtime(),{value:ne,done:ce}=await R.next(),oe=process.hrtime(H);if(O=x(O,oe),m.progress&&m.progress(oe,O),ce)return m.total&&m.total(O),ne;yield ne}}function*B(m,S){let R=S[Symbol.iterator](),O=[0,0];for(;;){let H=process.hrtime(),{value:ne,done:ce}=R.next(),oe=process.hrtime(H);if(O=x(O,oe),m.progress&&m.progress(oe,O),ce)return m.total&&m.total(O),ne;yield ne}}function D(m={},S){return S===void 0?R=>D(m,R):S[Symbol.asyncIterator]!==void 0?L(m,S):B(m,S)}function U(m,S,R){let O=c(R),H=[],ne=[],ce=!1,oe=!1,ae=0,he=null;function ke(){for(;ne.length>0&&H.length>0;){let{resolve:Ce}=ne.shift(),pe=H.shift();Ce({done:!1,value:pe})}for(;ne.length>0&&ae===0&&ce;){let{resolve:Ce,reject:pe}=ne.shift();he?(pe(he),he=null):Ce({done:!0,value:void 0})}}async function ve(){if(ce){ke();return}if(!oe&&!(ae+H.length>=m)){oe=!0,ae++;try{let{done:Ce,value:pe}=await O.next();Ce?(ce=!0,ae--,ke()):nt(pe)}catch(Ce){ce=!0,ae--,he=Ce,ke()}oe=!1,ve()}}async function nt(Ce){try{let pe=await S(Ce);H.push(pe)}catch(pe){ce=!0,he=pe}ae--,ke(),ve()}async function wt(){if(H.length===0){let pe=u();return ne.push(pe),ve(),pe.promise}let Ce=H.shift();return ve(),{done:!1,value:Ce}}let cr={next:wt,[Symbol.asyncIterator]:()=>cr};return cr}function T(m,S,R){return S===void 0?(O,H)=>H?T(m,O,H):T(m,O):R===void 0?O=>T(m,S,O):U(m,S,R)}async function P(m,S){let R=null,O=null,H=null,ne=he=>{R=he,O&&O(he)},ce=()=>{H&&H()},oe=()=>{m.removeListener("error",ne),m.removeListener("drain",ce)};m.once("error",ne);let ae=()=>new Promise((he,ke)=>{if(R)return ke(R);m.once("drain",ce),H=he,O=ke});for await(let he of S)if(m.write(he)===!1&&await ae(),R)break;if(oe(),R)throw R}function k(m,S){return S===void 0?R=>P(m,R):P(m,S)}t.batch=n,t.batchWithTimeout=a,t.buffer=d,t.collect=h,t.concat=w,t.consume=q,t.filter=F,t.flatMap=z,t.flatTransform=ye,t.flatten=M,t.fromStream=bt,t.getIterator=c,t.map=ie,t.merge=Fe,t.parallelFlatMap=Ot,t.parallelMap=Jt,t.parallelMerge=wn,t.pipeline=$e,t.reduce=Qr,t.take=Do,t.tap=tr,t.throttle=_,t.time=D,t.transform=T,t.writeToStream=k,Object.defineProperty(t,"__esModule",{value:!0})})});var SS=b((oV,_S)=>{_S.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),n=Object.create(null);function i(s,o){r[s]=o,e++,e>=t&&(e=0,n=r,r=Object.create(null))}return{has:function(s){return r[s]!==void 0||n[s]!==void 0},remove:function(s){r[s]!==void 0&&(r[s]=void 0),n[s]!==void 0&&(n[s]=void 0)},get:function(s){var o=r[s];if(o!==void 0)return o;if((o=n[s])!==void 0)return i(s,o),o},set:function(s,o){r[s]!==void 0?r[s]=o:i(s,o)},clear:function(){r=Object.create(null),n=Object.create(null)}}}});var AS=b((aV,xS)=>{"use strict";var I6=SS();xS.exports=t=>{let e=I6(t);return e.delete=e.remove,e}});var IS=b((CS,Ku)=>{(function(t){"use strict";var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function p(F){var M,re,ie,z=Y.prototype={constructor:Y,toString:null,valueOf:null},Ae=new Y(1),ye=20,be=4,ft=-7,bt=21,Fe=-1e7,$e=1e7,se=!1,Jt=1,Ot=0,wn={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},er="0123456789abcdefghijklmnopqrstuvwxyz",Qr=!0;function Y(E,_){var x,L,B,D,U,T,P,k,m=this;if(!(m instanceof Y))return new Y(E,_);if(_==null){if(E&&E._isBigNumber===!0){m.s=E.s,!E.c||E.e>$e?m.c=m.e=null:E.e<Fe?m.c=[m.e=0]:(m.e=E.e,m.c=E.c.slice());return}if((T=typeof E=="number")&&E*0==0){if(m.s=1/E<0?(E=-E,-1):1,E===~~E){for(D=0,U=E;U>=10;U/=10,D++);D>$e?m.c=m.e=null:(m.e=D,m.c=[E]);return}k=String(E)}else{if(!r.test(k=String(E)))return ie(m,k,T);m.s=k.charCodeAt(0)==45?(k=k.slice(1),-1):1}(D=k.indexOf("."))>-1&&(k=k.replace(".","")),(U=k.search(/e/i))>0?(D<0&&(D=U),D+=+k.slice(U+1),k=k.substring(0,U)):D<0&&(D=k.length)}else{if(w(_,2,er.length,"Base"),_==10&&Qr)return m=new Y(E),tr(m,ye+m.e+1,be);if(k=String(E),T=typeof E=="number"){if(E*0!=0)return ie(m,k,T,_);if(m.s=1/E<0?(k=k.slice(1),-1):1,Y.DEBUG&&k.replace(/^0\.0*|\./,"").length>15)throw Error(o+E)}else m.s=k.charCodeAt(0)===45?(k=k.slice(1),-1):1;for(x=er.slice(0,_),D=U=0,P=k.length;U<P;U++)if(x.indexOf(L=k.charAt(U))<0){if(L=="."){if(U>D){D=P;continue}}else if(!B&&(k==k.toUpperCase()&&(k=k.toLowerCase())||k==k.toLowerCase()&&(k=k.toUpperCase()))){B=!0,U=-1,D=0;continue}return ie(m,String(E),T,_)}T=!1,k=re(k,_,10,m.s),(D=k.indexOf("."))>-1?k=k.replace(".",""):D=k.length}for(U=0;k.charCodeAt(U)===48;U++);for(P=k.length;k.charCodeAt(--P)===48;);if(k=k.slice(U,++P)){if(P-=U,T&&Y.DEBUG&&P>15&&(E>u||E!==i(E)))throw Error(o+m.s*E);if((D=D-U-1)>$e)m.c=m.e=null;else if(D<Fe)m.c=[m.e=0];else{if(m.e=D,m.c=[],U=(D+1)%c,D<0&&(U+=c),U<P){for(U&&m.c.push(+k.slice(0,U)),P-=c;U<P;)m.c.push(+k.slice(U,U+=c));U=c-(k=k.slice(U)).length}else U-=P;for(;U--;k+="0");m.c.push(+k)}}else m.c=[m.e=0]}Y.clone=p,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(E){var _,x;if(E!=null)if(typeof E=="object"){if(E.hasOwnProperty(_="DECIMAL_PLACES")&&(x=E[_],w(x,0,d,_),ye=x),E.hasOwnProperty(_="ROUNDING_MODE")&&(x=E[_],w(x,0,8,_),be=x),E.hasOwnProperty(_="EXPONENTIAL_AT")&&(x=E[_],x&&x.pop?(w(x[0],-d,0,_),w(x[1],0,d,_),ft=x[0],bt=x[1]):(w(x,-d,d,_),ft=-(bt=x<0?-x:x))),E.hasOwnProperty(_="RANGE"))if(x=E[_],x&&x.pop)w(x[0],-d,-1,_),w(x[1],1,d,_),Fe=x[0],$e=x[1];else if(w(x,-d,d,_),x)Fe=-($e=x<0?-x:x);else throw Error(s+_+" cannot be zero: "+x);if(E.hasOwnProperty(_="CRYPTO"))if(x=E[_],x===!!x)if(x)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))se=x;else throw se=!x,Error(s+"crypto unavailable");else se=x;else throw Error(s+_+" not true or false: "+x);if(E.hasOwnProperty(_="MODULO_MODE")&&(x=E[_],w(x,0,9,_),Jt=x),E.hasOwnProperty(_="POW_PRECISION")&&(x=E[_],w(x,0,d,_),Ot=x),E.hasOwnProperty(_="FORMAT"))if(x=E[_],typeof x=="object")wn=x;else throw Error(s+_+" not an object: "+x);if(E.hasOwnProperty(_="ALPHABET"))if(x=E[_],typeof x=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(x))Qr=x.slice(0,10)=="0123456789",er=x;else throw Error(s+_+" invalid: "+x)}else throw Error(s+"Object expected: "+E);return{DECIMAL_PLACES:ye,ROUNDING_MODE:be,EXPONENTIAL_AT:[ft,bt],RANGE:[Fe,$e],CRYPTO:se,MODULO_MODE:Jt,POW_PRECISION:Ot,FORMAT:wn,ALPHABET:er}},Y.isBigNumber=function(E){if(!E||E._isBigNumber!==!0)return!1;if(!Y.DEBUG)return!0;var _,x,L=E.c,B=E.e,D=E.s;e:if({}.toString.call(L)=="[object Array]"){if((D===1||D===-1)&&B>=-d&&B<=d&&B===i(B)){if(L[0]===0){if(B===0&&L.length===1)return!0;break e}if(_=(B+1)%c,_<1&&(_+=c),String(L[0]).length==_){for(_=0;_<L.length;_++)if(x=L[_],x<0||x>=a||x!==i(x))break e;if(x!==0)return!0}}}else if(L===null&&B===null&&(D===null||D===1||D===-1))return!0;throw Error(s+"Invalid BigNumber: "+E)},Y.maximum=Y.max=function(){return Do(arguments,z.lt)},Y.minimum=Y.min=function(){return Do(arguments,z.gt)},Y.random=function(){var E=9007199254740992,_=Math.random()*E&2097151?function(){return i(Math.random()*E)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(x){var L,B,D,U,T,P=0,k=[],m=new Y(Ae);if(x==null?x=ye:w(x,0,d),U=n(x/c),se)if(crypto.getRandomValues){for(L=crypto.getRandomValues(new Uint32Array(U*=2));P<U;)T=L[P]*131072+(L[P+1]>>>11),T>=9e15?(B=crypto.getRandomValues(new Uint32Array(2)),L[P]=B[0],L[P+1]=B[1]):(k.push(T%1e14),P+=2);P=U/2}else if(crypto.randomBytes){for(L=crypto.randomBytes(U*=7);P<U;)T=(L[P]&31)*281474976710656+L[P+1]*1099511627776+L[P+2]*4294967296+L[P+3]*16777216+(L[P+4]<<16)+(L[P+5]<<8)+L[P+6],T>=9e15?crypto.randomBytes(7).copy(L,P):(k.push(T%1e14),P+=7);P=U/7}else throw se=!1,Error(s+"crypto unavailable");if(!se)for(;P<U;)T=_(),T<9e15&&(k[P++]=T%1e14);for(U=k[--P],x%=c,U&&x&&(T=l[c-x],k[P]=i(U/T)*T);k[P]===0;k.pop(),P--);if(P<0)k=[D=0];else{for(D=-1;k[0]===0;k.splice(0,1),D-=c);for(P=1,T=k[0];T>=10;T/=10,P++);P<c&&(D-=c-P)}return m.e=D,m.c=k,m}}(),Y.sum=function(){for(var E=1,_=arguments,x=new Y(_[0]);E<_.length;)x=x.plus(_[E++]);return x},re=function(){var E="0123456789";function _(x,L,B,D){for(var U,T=[0],P,k=0,m=x.length;k<m;){for(P=T.length;P--;T[P]*=L);for(T[0]+=D.indexOf(x.charAt(k++)),U=0;U<T.length;U++)T[U]>B-1&&(T[U+1]==null&&(T[U+1]=0),T[U+1]+=T[U]/B|0,T[U]%=B)}return T.reverse()}return function(x,L,B,D,U){var T,P,k,m,S,R,O,H,ne=x.indexOf("."),ce=ye,oe=be;for(ne>=0&&(m=Ot,Ot=0,x=x.replace(".",""),H=new Y(L),R=H.pow(x.length-ne),Ot=m,H.c=_(W(g(R.c),R.e,"0"),10,B,E),H.e=H.c.length),O=_(x,L,B,U?(T=er,E):(T=E,er)),k=m=O.length;O[--m]==0;O.pop());if(!O[0])return T.charAt(0);if(ne<0?--k:(R.c=O,R.e=k,R.s=D,R=M(R,H,ce,oe,B),O=R.c,S=R.r,k=R.e),P=k+ce+1,ne=O[P],m=B/2,S=S||P<0||O[P+1]!=null,S=oe<4?(ne!=null||S)&&(oe==0||oe==(R.s<0?3:2)):ne>m||ne==m&&(oe==4||S||oe==6&&O[P-1]&1||oe==(R.s<0?8:7)),P<1||!O[0])x=S?W(T.charAt(1),-ce,T.charAt(0)):T.charAt(0);else{if(O.length=P,S)for(--B;++O[--P]>B;)O[P]=0,P||(++k,O=[1].concat(O));for(m=O.length;!O[--m];);for(ne=0,x="";ne<=m;x+=T.charAt(O[ne++]));x=W(x,k,T.charAt(0))}return x}}(),M=function(){function E(L,B,D){var U,T,P,k,m=0,S=L.length,R=B%f,O=B/f|0;for(L=L.slice();S--;)P=L[S]%f,k=L[S]/f|0,U=O*P+k*R,T=R*P+U%f*f+m,m=(T/D|0)+(U/f|0)+O*k,L[S]=T%D;return m&&(L=[m].concat(L)),L}function _(L,B,D,U){var T,P;if(D!=U)P=D>U?1:-1;else for(T=P=0;T<D;T++)if(L[T]!=B[T]){P=L[T]>B[T]?1:-1;break}return P}function x(L,B,D,U){for(var T=0;D--;)L[D]-=T,T=L[D]<B[D]?1:0,L[D]=T*U+L[D]-B[D];for(;!L[0]&&L.length>1;L.splice(0,1));}return function(L,B,D,U,T){var P,k,m,S,R,O,H,ne,ce,oe,ae,he,ke,ve,nt,wt,cr,Ce=L.s==B.s?1:-1,pe=L.c,it=B.c;if(!pe||!pe[0]||!it||!it[0])return new Y(!L.s||!B.s||(pe?it&&pe[0]==it[0]:!it)?NaN:pe&&pe[0]==0||!it?Ce*0:Ce/0);for(ne=new Y(Ce),ce=ne.c=[],k=L.e-B.e,Ce=D+k+1,T||(T=a,k=h(L.e/c)-h(B.e/c),Ce=Ce/c|0),m=0;it[m]==(pe[m]||0);m++);if(it[m]>(pe[m]||0)&&k--,Ce<0)ce.push(1),S=!0;else{for(ve=pe.length,wt=it.length,m=0,Ce+=2,R=i(T/(it[0]+1)),R>1&&(it=E(it,R,T),pe=E(pe,R,T),wt=it.length,ve=pe.length),ke=wt,oe=pe.slice(0,wt),ae=oe.length;ae<wt;oe[ae++]=0);cr=it.slice(),cr=[0].concat(cr),nt=it[0],it[1]>=T/2&&nt++;do{if(R=0,P=_(it,oe,wt,ae),P<0){if(he=oe[0],wt!=ae&&(he=he*T+(oe[1]||0)),R=i(he/nt),R>1)for(R>=T&&(R=T-1),O=E(it,R,T),H=O.length,ae=oe.length;_(O,oe,H,ae)==1;)R--,x(O,wt<H?cr:it,H,T),H=O.length,P=1;else R==0&&(P=R=1),O=it.slice(),H=O.length;if(H<ae&&(O=[0].concat(O)),x(oe,O,ae,T),ae=oe.length,P==-1)for(;_(it,oe,wt,ae)<1;)R++,x(oe,wt<ae?cr:it,ae,T),ae=oe.length}else P===0&&(R++,oe=[0]);ce[m++]=R,oe[0]?oe[ae++]=pe[ke]||0:(oe=[pe[ke]],ae=1)}while((ke++<ve||oe[0]!=null)&&Ce--);S=oe[0]!=null,ce[0]||ce.splice(0,1)}if(T==a){for(m=1,Ce=ce[0];Ce>=10;Ce/=10,m++);tr(ne,D+(ne.e=m+k*c-1)+1,U,S)}else ne.e=k,ne.r=+S;return ne}}();function Oo(E,_,x,L){var B,D,U,T,P;if(x==null?x=be:w(x,0,8),!E.c)return E.toString();if(B=E.c[0],U=E.e,_==null)P=g(E.c),P=L==1||L==2&&(U<=ft||U>=bt)?q(P,U):W(P,U,"0");else if(E=tr(new Y(E),_,x),D=E.e,P=g(E.c),T=P.length,L==1||L==2&&(_<=D||D<=ft)){for(;T<_;P+="0",T++);P=q(P,D)}else if(_-=U,P=W(P,D,"0"),D+1>T){if(--_>0)for(P+=".";_--;P+="0");}else if(_+=D-T,_>0)for(D+1==T&&(P+=".");_--;P+="0");return E.s<0&&B?"-"+P:P}function Do(E,_){for(var x,L=1,B=new Y(E[0]);L<E.length;L++)if(x=new Y(E[L]),x.s)_.call(B,x)&&(B=x);else{B=x;break}return B}function ps(E,_,x){for(var L=1,B=_.length;!_[--B];_.pop());for(B=_[0];B>=10;B/=10,L++);return(x=L+x*c-1)>$e?E.c=E.e=null:x<Fe?E.c=[E.e=0]:(E.e=x,E.c=_),E}ie=function(){var E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_=/^([^.]+)\.$/,x=/^\.([^.]+)$/,L=/^-?(Infinity|NaN)$/,B=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(D,U,T,P){var k,m=T?U:U.replace(B,"");if(L.test(m))D.s=isNaN(m)?null:m<0?-1:1;else{if(!T&&(m=m.replace(E,function(S,R,O){return k=(O=O.toLowerCase())=="x"?16:O=="b"?2:8,!P||P==k?R:S}),P&&(k=P,m=m.replace(_,"$1").replace(x,"0.$1")),U!=m))return new Y(m,k);if(Y.DEBUG)throw Error(s+"Not a"+(P?" base "+P:"")+" number: "+U);D.s=null}D.c=D.e=null}}();function tr(E,_,x,L){var B,D,U,T,P,k,m,S=E.c,R=l;if(S){e:{for(B=1,T=S[0];T>=10;T/=10,B++);if(D=_-B,D<0)D+=c,U=_,P=S[k=0],m=P/R[B-U-1]%10|0;else if(k=n((D+1)/c),k>=S.length)if(L){for(;S.length<=k;S.push(0));P=m=0,B=1,D%=c,U=D-c+1}else break e;else{for(P=T=S[k],B=1;T>=10;T/=10,B++);D%=c,U=D-c+B,m=U<0?0:P/R[B-U-1]%10|0}if(L=L||_<0||S[k+1]!=null||(U<0?P:P%R[B-U-1]),L=x<4?(m||L)&&(x==0||x==(E.s<0?3:2)):m>5||m==5&&(x==4||L||x==6&&(D>0?U>0?P/R[B-U]:0:S[k-1])%10&1||x==(E.s<0?8:7)),_<1||!S[0])return S.length=0,L?(_-=E.e+1,S[0]=R[(c-_%c)%c],E.e=-_||0):S[0]=E.e=0,E;if(D==0?(S.length=k,T=1,k--):(S.length=k+1,T=R[c-D],S[k]=U>0?i(P/R[B-U]%R[U])*T:0),L)for(;;)if(k==0){for(D=1,U=S[0];U>=10;U/=10,D++);for(U=S[0]+=T,T=1;U>=10;U/=10,T++);D!=T&&(E.e++,S[0]==a&&(S[0]=1));break}else{if(S[k]+=T,S[k]!=a)break;S[k--]=0,T=1}for(D=S.length;S[--D]===0;S.pop());}E.e>$e?E.c=E.e=null:E.e<Fe&&(E.c=[E.e=0])}return E}function qr(E){var _,x=E.e;return x===null?E.toString():(_=g(E.c),_=x<=ft||x>=bt?q(_,x):W(_,x,"0"),E.s<0?"-"+_:_)}return z.absoluteValue=z.abs=function(){var E=new Y(this);return E.s<0&&(E.s=1),E},z.comparedTo=function(E,_){return v(this,new Y(E,_))},z.decimalPlaces=z.dp=function(E,_){var x,L,B,D=this;if(E!=null)return w(E,0,d),_==null?_=be:w(_,0,8),tr(new Y(D),E+D.e+1,_);if(!(x=D.c))return null;if(L=((B=x.length-1)-h(this.e/c))*c,B=x[B])for(;B%10==0;B/=10,L--);return L<0&&(L=0),L},z.dividedBy=z.div=function(E,_){return M(this,new Y(E,_),ye,be)},z.dividedToIntegerBy=z.idiv=function(E,_){return M(this,new Y(E,_),0,1)},z.exponentiatedBy=z.pow=function(E,_){var x,L,B,D,U,T,P,k,m,S=this;if(E=new Y(E),E.c&&!E.isInteger())throw Error(s+"Exponent not an integer: "+qr(E));if(_!=null&&(_=new Y(_)),T=E.e>14,!S.c||!S.c[0]||S.c[0]==1&&!S.e&&S.c.length==1||!E.c||!E.c[0])return m=new Y(Math.pow(+qr(S),T?2-C(E):+qr(E))),_?m.mod(_):m;if(P=E.s<0,_){if(_.c?!_.c[0]:!_.s)return new Y(NaN);L=!P&&S.isInteger()&&_.isInteger(),L&&(S=S.mod(_))}else{if(E.e>9&&(S.e>0||S.e<-1||(S.e==0?S.c[0]>1||T&&S.c[1]>=24e7:S.c[0]<8e13||T&&S.c[0]<=9999975e7)))return D=S.s<0&&C(E)?-0:0,S.e>-1&&(D=1/D),new Y(P?1/D:D);Ot&&(D=n(Ot/c+2))}for(T?(x=new Y(.5),P&&(E.s=1),k=C(E)):(B=Math.abs(+qr(E)),k=B%2),m=new Y(Ae);;){if(k){if(m=m.times(S),!m.c)break;D?m.c.length>D&&(m.c.length=D):L&&(m=m.mod(_))}if(B){if(B=i(B/2),B===0)break;k=B%2}else if(E=E.times(x),tr(E,E.e+1,1),E.e>14)k=C(E);else{if(B=+qr(E),B===0)break;k=B%2}S=S.times(S),D?S.c&&S.c.length>D&&(S.c.length=D):L&&(S=S.mod(_))}return L?m:(P&&(m=Ae.div(m)),_?m.mod(_):D?tr(m,Ot,be,U):m)},z.integerValue=function(E){var _=new Y(this);return E==null?E=be:w(E,0,8),tr(_,_.e+1,E)},z.isEqualTo=z.eq=function(E,_){return v(this,new Y(E,_))===0},z.isFinite=function(){return!!this.c},z.isGreaterThan=z.gt=function(E,_){return v(this,new Y(E,_))>0},z.isGreaterThanOrEqualTo=z.gte=function(E,_){return(_=v(this,new Y(E,_)))===1||_===0},z.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},z.isLessThan=z.lt=function(E,_){return v(this,new Y(E,_))<0},z.isLessThanOrEqualTo=z.lte=function(E,_){return(_=v(this,new Y(E,_)))===-1||_===0},z.isNaN=function(){return!this.s},z.isNegative=function(){return this.s<0},z.isPositive=function(){return this.s>0},z.isZero=function(){return!!this.c&&this.c[0]==0},z.minus=function(E,_){var x,L,B,D,U=this,T=U.s;if(E=new Y(E,_),_=E.s,!T||!_)return new Y(NaN);if(T!=_)return E.s=-_,U.plus(E);var P=U.e/c,k=E.e/c,m=U.c,S=E.c;if(!P||!k){if(!m||!S)return m?(E.s=-_,E):new Y(S?U:NaN);if(!m[0]||!S[0])return S[0]?(E.s=-_,E):new Y(m[0]?U:be==3?-0:0)}if(P=h(P),k=h(k),m=m.slice(),T=P-k){for((D=T<0)?(T=-T,B=m):(k=P,B=S),B.reverse(),_=T;_--;B.push(0));B.reverse()}else for(L=(D=(T=m.length)<(_=S.length))?T:_,T=_=0;_<L;_++)if(m[_]!=S[_]){D=m[_]<S[_];break}if(D&&(B=m,m=S,S=B,E.s=-E.s),_=(L=S.length)-(x=m.length),_>0)for(;_--;m[x++]=0);for(_=a-1;L>T;){if(m[--L]<S[L]){for(x=L;x&&!m[--x];m[x]=_);--m[x],m[L]+=a}m[L]-=S[L]}for(;m[0]==0;m.splice(0,1),--k);return m[0]?ps(E,m,k):(E.s=be==3?-1:1,E.c=[E.e=0],E)},z.modulo=z.mod=function(E,_){var x,L,B=this;return E=new Y(E,_),!B.c||!E.s||E.c&&!E.c[0]?new Y(NaN):!E.c||B.c&&!B.c[0]?new Y(B):(Jt==9?(L=E.s,E.s=1,x=M(B,E,0,3),E.s=L,x.s*=L):x=M(B,E,0,Jt),E=B.minus(x.times(E)),!E.c[0]&&Jt==1&&(E.s=B.s),E)},z.multipliedBy=z.times=function(E,_){var x,L,B,D,U,T,P,k,m,S,R,O,H,ne,ce,oe=this,ae=oe.c,he=(E=new Y(E,_)).c;if(!ae||!he||!ae[0]||!he[0])return!oe.s||!E.s||ae&&!ae[0]&&!he||he&&!he[0]&&!ae?E.c=E.e=E.s=null:(E.s*=oe.s,!ae||!he?E.c=E.e=null:(E.c=[0],E.e=0)),E;for(L=h(oe.e/c)+h(E.e/c),E.s*=oe.s,P=ae.length,S=he.length,P<S&&(H=ae,ae=he,he=H,B=P,P=S,S=B),B=P+S,H=[];B--;H.push(0));for(ne=a,ce=f,B=S;--B>=0;){for(x=0,R=he[B]%ce,O=he[B]/ce|0,U=P,D=B+U;D>B;)k=ae[--U]%ce,m=ae[U]/ce|0,T=O*k+m*R,k=R*k+T%ce*ce+H[D]+x,x=(k/ne|0)+(T/ce|0)+O*m,H[D--]=k%ne;H[D]=x}return x?++L:H.splice(0,1),ps(E,H,L)},z.negated=function(){var E=new Y(this);return E.s=-E.s||null,E},z.plus=function(E,_){var x,L=this,B=L.s;if(E=new Y(E,_),_=E.s,!B||!_)return new Y(NaN);if(B!=_)return E.s=-_,L.minus(E);var D=L.e/c,U=E.e/c,T=L.c,P=E.c;if(!D||!U){if(!T||!P)return new Y(B/0);if(!T[0]||!P[0])return P[0]?E:new Y(T[0]?L:B*0)}if(D=h(D),U=h(U),T=T.slice(),B=D-U){for(B>0?(U=D,x=P):(B=-B,x=T),x.reverse();B--;x.push(0));x.reverse()}for(B=T.length,_=P.length,B-_<0&&(x=P,P=T,T=x,_=B),B=0;_;)B=(T[--_]=T[_]+P[_]+B)/a|0,T[_]=a===T[_]?0:T[_]%a;return B&&(T=[B].concat(T),++U),ps(E,T,U)},z.precision=z.sd=function(E,_){var x,L,B,D=this;if(E!=null&&E!==!!E)return w(E,1,d),_==null?_=be:w(_,0,8),tr(new Y(D),E,_);if(!(x=D.c))return null;if(B=x.length-1,L=B*c+1,B=x[B]){for(;B%10==0;B/=10,L--);for(B=x[0];B>=10;B/=10,L++);}return E&&D.e+1>L&&(L=D.e+1),L},z.shiftedBy=function(E){return w(E,-u,u),this.times("1e"+E)},z.squareRoot=z.sqrt=function(){var E,_,x,L,B,D=this,U=D.c,T=D.s,P=D.e,k=ye+4,m=new Y("0.5");if(T!==1||!U||!U[0])return new Y(!T||T<0&&(!U||U[0])?NaN:U?D:1/0);if(T=Math.sqrt(+qr(D)),T==0||T==1/0?(_=g(U),(_.length+P)%2==0&&(_+="0"),T=Math.sqrt(+_),P=h((P+1)/2)-(P<0||P%2),T==1/0?_="5e"+P:(_=T.toExponential(),_=_.slice(0,_.indexOf("e")+1)+P),x=new Y(_)):x=new Y(T+""),x.c[0]){for(P=x.e,T=P+k,T<3&&(T=0);;)if(B=x,x=m.times(B.plus(M(D,B,k,1))),g(B.c).slice(0,T)===(_=g(x.c)).slice(0,T))if(x.e<P&&--T,_=_.slice(T-3,T+1),_=="9999"||!L&&_=="4999"){if(!L&&(tr(B,B.e+ye+2,0),B.times(B).eq(D))){x=B;break}k+=4,T+=4,L=1}else{(!+_||!+_.slice(1)&&_.charAt(0)=="5")&&(tr(x,x.e+ye+2,1),E=!x.times(x).eq(D));break}}return tr(x,x.e+ye+1,be,E)},z.toExponential=function(E,_){return E!=null&&(w(E,0,d),E++),Oo(this,E,_,1)},z.toFixed=function(E,_){return E!=null&&(w(E,0,d),E=E+this.e+1),Oo(this,E,_)},z.toFormat=function(E,_,x){var L,B=this;if(x==null)E!=null&&_&&typeof _=="object"?(x=_,_=null):E&&typeof E=="object"?(x=E,E=_=null):x=wn;else if(typeof x!="object")throw Error(s+"Argument not an object: "+x);if(L=B.toFixed(E,_),B.c){var D,U=L.split("."),T=+x.groupSize,P=+x.secondaryGroupSize,k=x.groupSeparator||"",m=U[0],S=U[1],R=B.s<0,O=R?m.slice(1):m,H=O.length;if(P&&(D=T,T=P,P=D,H-=D),T>0&&H>0){for(D=H%T||T,m=O.substr(0,D);D<H;D+=T)m+=k+O.substr(D,T);P>0&&(m+=k+O.slice(D)),R&&(m="-"+m)}L=S?m+(x.decimalSeparator||"")+((P=+x.fractionGroupSize)?S.replace(new RegExp("\\d{"+P+"}\\B","g"),"$&"+(x.fractionGroupSeparator||"")):S):m}return(x.prefix||"")+L+(x.suffix||"")},z.toFraction=function(E){var _,x,L,B,D,U,T,P,k,m,S,R,O=this,H=O.c;if(E!=null&&(T=new Y(E),!T.isInteger()&&(T.c||T.s!==1)||T.lt(Ae)))throw Error(s+"Argument "+(T.isInteger()?"out of range: ":"not an integer: ")+qr(T));if(!H)return new Y(O);for(_=new Y(Ae),k=x=new Y(Ae),L=P=new Y(Ae),R=g(H),D=_.e=R.length-O.e-1,_.c[0]=l[(U=D%c)<0?c+U:U],E=!E||T.comparedTo(_)>0?D>0?_:k:T,U=$e,$e=1/0,T=new Y(R),P.c[0]=0;m=M(T,_,0,1),B=x.plus(m.times(L)),B.comparedTo(E)!=1;)x=L,L=B,k=P.plus(m.times(B=k)),P=B,_=T.minus(m.times(B=_)),T=B;return B=M(E.minus(x),L,0,1),P=P.plus(B.times(k)),x=x.plus(B.times(L)),P.s=k.s=O.s,D=D*2,S=M(k,L,D,be).minus(O).abs().comparedTo(M(P,x,D,be).minus(O).abs())<1?[k,L]:[P,x],$e=U,S},z.toNumber=function(){return+qr(this)},z.toPrecision=function(E,_){return E!=null&&w(E,1,d),Oo(this,E,_,2)},z.toString=function(E){var _,x=this,L=x.s,B=x.e;return B===null?L?(_="Infinity",L<0&&(_="-"+_)):_="NaN":(E==null?_=B<=ft||B>=bt?q(g(x.c),B):W(g(x.c),B,"0"):E===10&&Qr?(x=tr(new Y(x),ye+B+1,be),_=W(g(x.c),x.e,"0")):(w(E,2,er.length,"Base"),_=re(W(g(x.c),B,"0"),10,E,L,!0)),L<0&&x.c[0]&&(_="-"+_)),_},z.valueOf=z.toJSON=function(){return qr(this)},z._isBigNumber=!0,F!=null&&Y.set(F),Y}function h(F){var M=F|0;return F>0||F===M?M:M-1}function g(F){for(var M,re,ie=1,z=F.length,Ae=F[0]+"";ie<z;){for(M=F[ie++]+"",re=c-M.length;re--;M="0"+M);Ae+=M}for(z=Ae.length;Ae.charCodeAt(--z)===48;);return Ae.slice(0,z+1||1)}function v(F,M){var re,ie,z=F.c,Ae=M.c,ye=F.s,be=M.s,ft=F.e,bt=M.e;if(!ye||!be)return null;if(re=z&&!z[0],ie=Ae&&!Ae[0],re||ie)return re?ie?0:-be:ye;if(ye!=be)return ye;if(re=ye<0,ie=ft==bt,!z||!Ae)return ie?0:!z^re?1:-1;if(!ie)return ft>bt^re?1:-1;for(be=(ft=z.length)<(bt=Ae.length)?ft:bt,ye=0;ye<be;ye++)if(z[ye]!=Ae[ye])return z[ye]>Ae[ye]^re?1:-1;return ft==bt?0:ft>bt^re?1:-1}function w(F,M,re,ie){if(F<M||F>re||F!==i(F))throw Error(s+(ie||"Argument")+(typeof F=="number"?F<M||F>re?" out of range: ":" not an integer: ":" not a primitive number: ")+String(F))}function C(F){var M=F.c.length-1;return h(F.e/c)==M&&F.c[M]%2!=0}function q(F,M){return(F.length>1?F.charAt(0)+"."+F.slice(1):F)+(M<0?"e":"e+")+M}function W(F,M,re){var ie,z;if(M<0){for(z=re+".";++M;z+=re);F=z+F}else if(ie=F.length,++M>ie){for(z=re,M-=ie;--M;z+=re);F+=z}else M<ie&&(F=F.slice(0,M)+"."+F.slice(M));return F}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof Ku!="undefined"&&Ku.exports?Ku.exports=e:(t||(t=typeof self!="undefined"&&self?self:window),t.BigNumber=e)})(CS)});var BS=b((TS,RS)=>{"use strict";var T6=Math.exp;TS=RS.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,n=0,i=0,s=0,o,a={};function c(u,l){return 1-T6(-(u-l)/e)}return a.push=function(l,f){if(o){let d=c(l,o),p=f-r,h=d*p;r=d*f+(1-d)*r,n=(1-d)*(n+p*h),i=Math.sqrt(n),s=r+d*p}else r=f;o=l},a.movingAverage=function(){return r},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return s},a}});var DS=b((cV,OS)=>{"use strict";var{EventEmitter:R6}=rr(),{BigNumber:Vu}=IS(),PS=BS(),B6=_a(),NS=class extends R6{constructor(e,r){super();this._options=r,this._queue=[],this._stats={dataReceived:Vu(0),dataSent:Vu(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let n=this._options.movingAverageIntervals;for(let i=0;i<e.length;i++){let s=e[i];this._stats[s]=Vu(0),this._movingAverages[s]={};for(let o=0;o<n.length;o++){let a=n[o];(this._movingAverages[s][a]=PS(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,r=this.movingAverages,n={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},i=Object.keys(r);for(let s of i){n.movingAverages[s]={};for(let o of Object.keys(r[s]))n.movingAverages[s][o]=r[s][o].movingAverage()}return n}push(e,r){this._queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=B6(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=i/(r||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],f=a[l];f||(f=a[l]=PS(l)),f.push(n,o)}}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);let i;Object.prototype.hasOwnProperty.call(this._stats,r)?i=this._stats[r]:i=this._stats[r]=Vu(0),this._stats[r]=i.plus(n),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=n}};OS.exports=NS});var qS=b((uV,kS)=>{"use strict";var P6=Ys(),{pipe:N6}=fr(),{tap:LS}=Fu(),O6=AS(),{METRICS:D6}=hu(),Ih=DS(),Th=["dataReceived","dataSent"],L6={in:"dataReceived",out:"dataSent"},ju=class{constructor(e){this._options=P6(D6,e),this._globalStats=new Ih(Th,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=O6(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._systems=new Map}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}getComponentMetrics(){return this._systems}updateComponentMetric({system:e="libp2p",component:r,metric:n,value:i}){this._systems.has(e)||this._systems.set(e,new Map);let s=this._systems.get(e);s.has(r)||s.set(r,new Map),s.get(r).set(n,i)}forPeer(e){let r=e.toB58String();return this._peerStats.get(r)||this._oldPeers.get(r)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let r=e.toB58String(),n=this._peerStats.get(r);n&&(n.stop(),this._peerStats.delete(r),this._oldPeers.set(r,n))}_onMessage({remotePeer:e,protocol:r,direction:n,dataLength:i}){if(!this._running)return;let s=L6[n],o=this.forPeer(e);if(o||(o=new Ih(Th,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,i),this._globalStats.push(s,i),r){let a=this.forProtocol(r);a||(a=new Ih(Th,this._options),this._protocolStats.set(r,a)),a.push(s,i)}}updatePlaceholder(e,r){if(!this._running)return;let n=this.forPeer(e),i=r.toB58String(),s=this.forPeer(r),o=n;s&&(o=ju.mergeStats(s,o),this._oldPeers.delete(i)),this._peerStats.delete(e.toB58String()),this._peerStats.set(i,o),o.start()}trackStream({stream:e,remotePeer:r,protocol:n}){let i=this,s=e.source;e.source=LS(a=>i._onMessage({remotePeer:r,protocol:n,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>N6(a,LS(c=>i._onMessage({remotePeer:r,protocol:n,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,r){return e.stop(),r.stop(),e._queue=[...e._queue,...r._queue],e}};kS.exports=ju});var $u=b((lV,KS)=>{"use strict";var US=rs(),MS=uo(),{pipe:k6}=fr(),q6=ge(),{fromString:U6}=(Dt(),Ft),M6=yd(),{source:F6}=xu(),FS=U6(`
`);function Rh(t){return MS.encode.single(new US([t,FS]))}function K6(t,e){t.push(Rh(e))}async function V6(t,e){t.push(e.reduce((r,n)=>r.append(Rh(n)),new US))}async function j6(t,e){let r=1,n={[Symbol.asyncIterator](){return this},next:()=>t.next(r)},i=n;e&&e.signal&&(i=F6(n,e.signal));let s=a=>{r=a},o=await k6(i,MS.decode({onLength:s}),M6);if(o.get(o.length-1)!==FS[0])throw q6(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return o.shallowSlice(0,-1)}KS.exports={encode:Rh,write:K6,writeAll:V6,read:j6}});var $S=b((fV,jS)=>{"use strict";var VS=Oe(),$6=ge(),bo=$u(),H6=lo(),wo=Object.assign(VS("mss:select"),{error:VS("mss:select:error")});jS.exports=async function(e,r,n,i){r=Array.isArray(r)?[...r]:[r];let{reader:s,writer:o,rest:a,stream:c}=H6(e),u=r.shift();if(!u)throw new Error("At least one protocol must be specified");n?(wo('select: write ["%s", "%s"]',n,u),bo.writeAll(o,[n,u])):(wo('select: write "%s"',u),bo.write(o,u));let l=(await bo.read(s,i)).toString();if(wo('select: read "%s"',l),l===n&&(l=(await bo.read(s,i)).toString(),wo('select: read "%s"',l)),l===u)return a(),{stream:c,protocol:u};for(let f of r){wo('select: write "%s"',f),bo.write(o,f);let d=(await bo.read(s,i)).toString();if(wo('select: read "%s" for "%s"',d,f),d===f)return a(),{stream:c,protocol:f}}throw a(),$6(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var Bh=b(HS=>{"use strict";HS.PROTOCOL_ID="/multistream/1.0.0"});var WS=b((hV,GS)=>{"use strict";var zS=Oe(),z6=rs(),_o=$u(),G6=lo(),{PROTOCOL_ID:Ph}=Bh(),Fa=Object.assign(zS("mss:handle"),{error:zS("mss:handle:error")});GS.exports=async function(e,r,n){r=Array.isArray(r)?r:[r];let{writer:i,reader:s,rest:o,stream:a}=G6(e);for(;;){let c=(await _o.read(s,n)).toString();if(Fa('read "%s"',c),c===Ph){Fa('respond with "%s" for "%s"',Ph,c),_o.write(i,Ph);continue}if(r.includes(c))return _o.write(i,c),Fa('respond with "%s" for "%s"',c,c),o(),{stream:a,protocol:c};if(c==="ls"){_o.write(i,new z6(r.map(u=>_o.encode(u)))),Fa('respond with "%s" for %s',r,c);continue}_o.write(i,"na"),Fa('respond with "na" for "%s"',c)}}});var ZS=b((pV,XS)=>{"use strict";var W6=ih(),YS=Oe(),QS=$u(),Y6=lo(),Q6=uo(),{pipe:X6}=fr(),Z6=Object.assign(YS("mss:ls"),{error:YS("mss:ls:error")});XS.exports=async function(e,r){let{reader:n,writer:i,rest:s,stream:o}=Y6(e);Z6('write "ls"'),QS.write(i,"ls"),s();let a=await QS.read(n,r),c=W6([a]),u=[];return await X6(c,Q6.decode(),async f=>{for await(let d of f)u.push(d.shallowSlice(0,-1).toString())}),{stream:o,protocols:u}}});var rx=b(Hu=>{"use strict";var JS=$S(),J6=WS(),ek=ZS(),{PROTOCOL_ID:Nh}=Bh();Hu.PROTOCOL_ID=Nh;var Oh=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(e){if(this._shaken)return;let{stream:r}=await JS(this._stream,Nh,void 0,e);this._stream=r,this._shaken=!0}},ex=class extends Oh{select(e,r){return JS(this._stream,e,this._shaken?void 0:Nh,r)}async ls(e){await this._handshake(e);let r=await ek(this._stream,e),{stream:n,protocols:i}=r;return this._stream=n,i}};Hu.Dialer=ex;var tx=class extends Oh{handle(e,r){return J6(this._stream,e,r)}};Hu.Listener=tx});var ix=b((gV,nx)=>{"use strict";var tk={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};nx.exports=tk});var lx=b((mV,ux)=>{"use strict";var sx=qt(),{Multiaddr:rk}=$t(),hr=ge(),{OPEN:nk,CLOSING:ox,CLOSED:Dh}=ix(),ax=Symbol.for("@libp2p/interface-connection/connection"),cx=class{constructor({localAddr:e,remoteAddr:r,localPeer:n,remotePeer:i,newStream:s,close:o,getStreams:a,stat:c}){ik(e,n,i,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=r,this.localPeer=n,this.remotePeer=i,this._stat={...c,status:nk},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[ax](){return!0}static isConnection(e){return Boolean(e&&e[ax])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===ox)throw hr(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Dh)throw hr(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:r,protocol:n}=await this._newStream(e);return this.addStream(r,{protocol:n}),{stream:r,protocol:n}}addStream(e,{protocol:r,metadata:n={}}){this.registry.set(e.id,{protocol:r,...n})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==Dh){if(this._closing)return this._closing;this.stat.status=ox,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=Dh}}};ux.exports=cx;function ik(t,e,r,n,i,s,o){if(t&&!rk.isMultiaddr(t))throw hr(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!sx.isPeerId(e))throw hr(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!sx.isPeerId(r))throw hr(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw hr(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw hr(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw hr(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw hr(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw hr(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw hr(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw hr(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw hr(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var dx=b(fx=>{"use strict";fx.Connection=lx()});var px=b((EV,hx)=>{"use strict";function sk(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}hx.exports=function(e){var r=void 0,n=void 0;function i(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');n=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),r=a}i(function(){}),e&&i(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,f=Array(l),d=0;d<l;d++)f[d]=arguments[d];return r[u].apply(null,[n].concat(sk(f.slice(1))))}}});return{setTarget:i,setHandler:s,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,o)}}});var Ex=b((bV,vx)=>{"use strict";var yx=Oe(),xt=Object.assign(yx("libp2p:upgrader"),{error:yx("libp2p:upgrader:err")}),pr=ge(),So=rx(),{Connection:ok}=dx(),ak=qt(),{pipe:ck}=fr(),gx=px(),{codes:yr}=Ye(),mx=class{constructor({localPeer:e,metrics:r,connectionGater:n,cryptos:i=new Map,muxers:s=new Map,onConnectionEnd:o=()=>{},onConnection:a=()=>{}}){this.connectionGater=n,this.localPeer=e,this.metrics=r,this.cryptos=i,this.muxers=s,this.protector=null,this.protocols=new Map,this.onConnection=a,this.onConnectionEnd=o}async upgradeInbound(e){let r,n,i,s,o,a,c;if(await this.connectionGater.denyInboundConnection(e))throw pr(new Error("The multiaddr connection is blocked by gater.acceptConnection"),yr.ERR_CONNECTION_INTERCEPTED);if(this.metrics){({setTarget:a,proxy:c}=gx());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}xt("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{if({conn:r,remotePeer:n,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos),await this.connectionGater.denyInboundEncryptedConnection(n,r))throw pr(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),yr.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:i,Muxer:s}=await this._multiplexInbound(r,this.muxers):i=r}catch(l){throw xt.error("Failed to upgrade inbound connection",l),await e.close(l),l}if(await this.connectionGater.denyInboundUpgradedConnection(n,r))throw pr(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),yr.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(c,n),a(n)),xt("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:i,Muxer:s,remotePeer:n})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(!r)throw pr(new Error("outbound connection must have a peer id"),yr.ERR_INVALID_MULTIADDR);let n=ak.createFromB58String(r);if(await this.connectionGater.denyOutboundConnection(n,e))throw pr(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),yr.ERR_CONNECTION_INTERCEPTED);let i,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=gx());let d=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>d}),e=this.metrics.trackStream({stream:e,remotePeer:l})}xt("Starting the outbound connection upgrade");let f=e;this.protector&&(f=await this.protector.protect(e));try{if({conn:i,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,f,n,this.cryptos),await this.connectionGater.denyOutboundEncryptedConnection(s,i))throw pr(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),yr.ERR_CONNECTION_INTERCEPTED);this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(i,this.muxers):o=i}catch(d){throw xt.error("Failed to upgrade outbound connection",d),await e.close(d),d}if(await this.connectionGater.denyOutboundUpgradedConnection(s,i))throw pr(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),yr.ERR_CONNECTION_INTERCEPTED);return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),xt("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:r,maConn:n,upgradedConn:i,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async d=>{if(!u)return;let p=new So.Listener(d);try{let{stream:h,protocol:g}=await p.handle(Array.from(this.protocols.keys()));xt("%s: incoming stream opened on %s",r,g),this.metrics&&this.metrics.trackStream({stream:h,remotePeer:o,protocol:g}),u.addStream(d,{protocol:g}),this._onStream({connection:u,stream:{...d,...h},protocol:g})}catch(h){xt.error(h)}},onStreamEnd:d=>{u.removeStream(d.id)}}),c=async d=>{xt("%s: starting new stream on %s",r,d);let p=a.newStream(),h=new So.Dialer(p);try{let{stream:g,protocol:v}=await h.select(d);return this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:v}),{stream:{...p,...g},protocol:v}}catch(g){throw xt.error("could not create new stream",g),pr(g,yr.ERR_UNSUPPORTED_PROTOCOL)}},ck(i,a,i).catch(xt.error));let l=n.timeline;n.timeline=new Proxy(l,{set:(...d)=>(u&&d[1]==="close"&&d[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){xt.error(p)}finally{this.onConnectionEnd(u)}})().catch(p=>{xt.error(p)}),Reflect.set(...d))}),n.timeline.upgraded=Date.now();let f=()=>{throw pr(new Error("connection is not multiplexed"),yr.ERR_CONNECTION_NOT_MULTIPLEXED)};return u=new ok({localAddr:n.localAddr,remoteAddr:n.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:r,timeline:n.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||f,getStreams:()=>a?a.streams:f(),close:async()=>{await n.close(),a&&a.streams.map(d=>d.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:r,protocol:n}){this.protocols.get(n)({connection:e,stream:r,protocol:n})}async _encryptInbound(e,r,n){let i=new So.Listener(r),s=Array.from(n.keys());xt("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await i.handle(s),c=n.get(a);if(xt("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw pr(o,yr.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r,n,i){let s=new So.Dialer(r),o=Array.from(i.keys());xt("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=i.get(c);if(xt("encrypting outbound connection to %j",n),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,n),protocol:c}}catch(a){throw pr(a,yr.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let n=new So.Dialer(e),i=Array.from(r.keys());xt("outbound selecting muxer %s",i);try{let{stream:s,protocol:o}=await n.select(i);xt("%s selected as muxer protocol",o);let a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw pr(s,yr.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let n=new So.Listener(e),i=Array.from(r.keys());xt("inbound handling muxers %s",i);try{let{stream:s,protocol:o}=await n.handle(i),a=r.get(o);return{stream:s,Muxer:a}}catch(s){throw pr(s,yr.ERR_MUXER_UNAVAILABLE)}}};vx.exports=mx});var wx=b((wV,bx)=>{"use strict";var uk=async function*(t,e){for await(let r of t)await e(r),yield r};bx.exports=uk});var Tx=b((_V,Ix)=>{"use strict";var _x=Oe(),us=ge(),{Multiaddr:Sx}=$t(),zu=qt(),{codes:Gr}=Ye(),xx=Eu(),Ax=mu(),{pipe:lk}=fr(),fk=Vi(),dk=ji(),hk=ad(),pk=wx(),je=Object.assign(_x("libp2p:peer-store:address-book"),{error:_x("libp2p:peer-store:address-book:err")}),Gu="change:multiaddrs",Cx=class{constructor(e,r,n){this._emit=e,this._store=r,this._addressFilter=n}async consumePeerRecord(e){je("consumePeerRecord await write lock");let r=await this._store.lock.writeLock();je("consumePeerRecord got write lock");let n,i;try{let s;try{s=xx.createFromProtobuf(e.payload)}catch(a){return je.error("invalid peer record received"),!1}n=s.peerId;let o=s.multiaddrs;if(!n.equals(e.peerId))return je("signing key does not match PeerId in the PeerRecord"),!1;if(!o||!o.length)return!1;if(await this._store.has(n)){let a=await this._store.load(n);if(a.peerRecordEnvelope){let c=await Ax.createFromProtobuf(a.peerRecordEnvelope);if(xx.createFromProtobuf(c.payload).seqNumber>=s.seqNumber)return!1}}i=await this._store.patchOrCreate(n,{addresses:await Lh(n,o,this._addressFilter,!0),peerRecordEnvelope:e.marshal()}),je(`stored provided peer record for ${s.peerId.toB58String()}`)}finally{je("consumePeerRecord release write lock"),r()}return this._emit(Gu,{peerId:n,multiaddrs:i.addresses.map(({multiaddr:s})=>s)}),!0}async getRawEnvelope(e){je("getRawEnvelope await read lock");let r=await this._store.lock.readLock();je("getRawEnvelope got read lock");try{return(await this._store.load(e)).peerRecordEnvelope}catch(n){if(n.code!==Gr.ERR_NOT_FOUND)throw n}finally{je("getRawEnvelope release read lock"),r()}}async getPeerRecord(e){let r=await this.getRawEnvelope(e);if(!!r)return Ax.createFromProtobuf(r)}async get(e){if(!zu.isPeerId(e))throw je.error("peerId must be an instance of peer-id to store data"),us(new Error("peerId must be an instance of peer-id"),Gr.ERR_INVALID_PARAMETERS);je("get wait for read lock");let r=await this._store.lock.readLock();je("get got read lock");try{return(await this._store.load(e)).addresses}catch(n){if(n.code!==Gr.ERR_NOT_FOUND)throw n}finally{je("get release read lock"),r()}return[]}async set(e,r){if(!zu.isPeerId(e))throw je.error("peerId must be an instance of peer-id to store data"),us(new Error("peerId must be an instance of peer-id"),Gr.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw je.error("multiaddrs must be an array of Multiaddrs"),us(new Error("multiaddrs must be an array of Multiaddrs"),Gr.ERR_INVALID_PARAMETERS);je("set await write lock");let n=await this._store.lock.writeLock();je("set got write lock");let i=!1,s;try{let o=await Lh(e,r,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(i=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length&&o.length===a.addresses.length)return}catch(a){if(a.code!==Gr.ERR_NOT_FOUND)throw a}s=await this._store.patchOrCreate(e,{addresses:o}),je(`set multiaddrs for ${e.toB58String()}`)}finally{je("set release write lock"),n()}this._emit(Gu,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),i||this._emit("peer",e)}async add(e,r){if(!zu.isPeerId(e))throw je.error("peerId must be an instance of peer-id to store data"),us(new Error("peerId must be an instance of peer-id"),Gr.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw je.error("multiaddrs must be an array of Multiaddrs"),us(new Error("multiaddrs must be an array of Multiaddrs"),Gr.ERR_INVALID_PARAMETERS);je("add await write lock");let n=await this._store.lock.writeLock();je("add got write lock");let i,s;try{let o=await Lh(e,r,this._addressFilter);if(!o.length)return;try{let a=await this._store.load(e);if(i=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...a.addresses.map(({multiaddr:c})=>c.toString())]).size===a.addresses.length)return}catch(a){if(a.code!==Gr.ERR_NOT_FOUND)throw a}s=await this._store.mergeOrCreate(e,{addresses:o}),je(`added multiaddrs for ${e.toB58String()}`)}finally{je("set release write lock"),n()}this._emit(Gu,{peerId:e,multiaddrs:s.addresses.map(o=>o.multiaddr)}),i||this._emit("peer",e)}async delete(e){if(!zu.isPeerId(e))throw je.error("peerId must be an instance of peer-id to store data"),us(new Error("peerId must be an instance of peer-id"),Gr.ERR_INVALID_PARAMETERS);je("delete await write lock");let r=await this._store.lock.writeLock();je("delete got write lock");let n;try{n=await this._store.has(e),await this._store.patchOrCreate(e,{addresses:[]})}finally{je("delete release write lock"),r()}n&&this._emit(Gu,{peerId:e,multiaddrs:[]})}async getMultiaddrsForPeer(e,r=n=>n){let n=await this.get(e);return r(n).map(i=>{let s=i.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};function Lh(t,e,r,n=!1){return lk(e,i=>pk(i,s=>{if(!Sx.isMultiaddr(s))throw je.error("multiaddr must be an instance of Multiaddr"),us(new Error("multiaddr must be an instance of Multiaddr"),Gr.ERR_INVALID_PARAMETERS)}),i=>dk(i,s=>r(t,s)),i=>hk(i,s=>({multiaddr:new Sx(s.toString()),isCertified:n})),i=>fk(i))}Ix.exports=Cx});var Ox=b((SV,Nx)=>{"use strict";var Rx=Oe(),Wu=ge(),{codes:xo}=Ye(),kh=qt(),{equals:yk}=(Sr(),_r),gr=Object.assign(Rx("libp2p:peer-store:key-book"),{error:Rx("libp2p:peer-store:key-book:err")}),Bx="change:pubkey",Px=class{constructor(e,r){this._emit=e,this._store=r}async set(e,r){if(!kh.isPeerId(e))throw gr.error("peerId must be an instance of peer-id to store data"),Wu(new Error("peerId must be an instance of peer-id"),xo.ERR_INVALID_PARAMETERS);if(!r)throw gr.error("publicKey must be an instance of PublicKey to store data"),Wu(new Error("publicKey must be an instance of PublicKey"),xo.ERR_INVALID_PARAMETERS);gr("set await write lock");let n=await this._store.lock.writeLock();gr("set got write lock");let i=!1;try{try{let s=await this._store.load(e);if(s.pubKey&&yk(s.pubKey.bytes,r.bytes))return}catch(s){if(s.code!==xo.ERR_NOT_FOUND)throw s}await this._store.patchOrCreate(e,{pubKey:r}),i=!0}finally{gr("set release write lock"),n()}i&&this._emit(Bx,{peerId:e,pubKey:r})}async get(e){if(!kh.isPeerId(e))throw gr.error("peerId must be an instance of peer-id to store data"),Wu(new Error("peerId must be an instance of peer-id"),xo.ERR_INVALID_PARAMETERS);gr("get await write lock");let r=await this._store.lock.readLock();gr("get got write lock");try{return(await this._store.load(e)).pubKey}catch(n){if(n.code!==xo.ERR_NOT_FOUND)throw n}finally{gr("get release write lock"),r()}}async delete(e){if(!kh.isPeerId(e))throw gr.error("peerId must be an instance of peer-id to store data"),Wu(new Error("peerId must be an instance of peer-id"),xo.ERR_INVALID_PARAMETERS);gr("delete await write lock");let r=await this._store.lock.writeLock();gr("delete got write lock");try{await this._store.patchOrCreate(e,{pubKey:void 0})}finally{gr("delete release write lock"),r()}this._emit(Bx,{peerId:e,pubKey:void 0})}};Nx.exports=Px});var qx=b((xV,kx)=>{"use strict";var Dx=Oe(),bi=ge(),{codes:Dr}=Ye(),Ao=qt(),{equals:gk}=(Sr(),_r),Je=Object.assign(Dx("libp2p:peer-store:metadata-book"),{error:Dx("libp2p:peer-store:metadata-book:err")}),Yu="change:metadata",Lx=class{constructor(e,r){this._emit=e,this._store=r}async get(e){if(!Ao.isPeerId(e))throw Je.error("peerId must be an instance of peer-id to store data"),bi(new Error("peerId must be an instance of peer-id"),Dr.ERR_INVALID_PARAMETERS);Je("get await read lock");let r=await this._store.lock.readLock();Je("get got read lock");try{return(await this._store.load(e)).metadata}catch(n){if(n.code!==Dr.ERR_NOT_FOUND)throw n}finally{Je("get release read lock"),r()}return new Map}async getValue(e,r){if(!Ao.isPeerId(e))throw Je.error("peerId must be an instance of peer-id to store data"),bi(new Error("peerId must be an instance of peer-id"),Dr.ERR_INVALID_PARAMETERS);Je("getValue await read lock");let n=await this._store.lock.readLock();Je("getValue got read lock");try{return(await this._store.load(e)).metadata.get(r)}catch(i){if(i.code!==Dr.ERR_NOT_FOUND)throw i}finally{Je("getValue release write lock"),n()}}async set(e,r){if(!Ao.isPeerId(e))throw Je.error("peerId must be an instance of peer-id to store data"),bi(new Error("peerId must be an instance of peer-id"),Dr.ERR_INVALID_PARAMETERS);if(!r||!(r instanceof Map))throw Je.error("valid metadata must be provided to store data"),bi(new Error("valid metadata must be provided"),Dr.ERR_INVALID_PARAMETERS);Je("set await write lock");let n=await this._store.lock.writeLock();Je("set got write lock");try{await this._store.mergeOrCreate(e,{metadata:r})}finally{Je("set release write lock"),n()}this._emit(Yu,{peerId:e,metadata:r})}async setValue(e,r,n){if(!Ao.isPeerId(e))throw Je.error("peerId must be an instance of peer-id to store data"),bi(new Error("peerId must be an instance of peer-id"),Dr.ERR_INVALID_PARAMETERS);if(typeof r!="string"||!(n instanceof Uint8Array))throw Je.error("valid key and value must be provided to store data"),bi(new Error("valid key and value must be provided"),Dr.ERR_INVALID_PARAMETERS);Je("setValue await write lock");let i=await this._store.lock.writeLock();Je("setValue got write lock");let s;try{try{let a=(await this._store.load(e)).metadata.get(r);if(a!=null&&gk(n,a))return}catch(o){if(o.code!==Dr.ERR_NOT_FOUND)throw o}s=await this._store.mergeOrCreate(e,{metadata:new Map([[r,n]])})}finally{Je("setValue release write lock"),i()}this._emit(Yu,{peerId:e,metadata:s.metadata})}async delete(e){if(!Ao.isPeerId(e))throw Je.error("peerId must be an instance of peer-id to store data"),bi(new Error("peerId must be an instance of peer-id"),Dr.ERR_INVALID_PARAMETERS);Je("delete await write lock");let r=await this._store.lock.writeLock();Je("delete got write lock");let n;try{n=await this._store.has(e),n&&await this._store.patch(e,{metadata:new Map})}finally{Je("delete release write lock"),r()}n&&this._emit(Yu,{peerId:e,metadata:new Map})}async deleteValue(e,r){if(!Ao.isPeerId(e))throw Je.error("peerId must be an instance of peer-id to store data"),bi(new Error("peerId must be an instance of peer-id"),Dr.ERR_INVALID_PARAMETERS);Je("deleteValue await write lock");let n=await this._store.lock.writeLock();Je("deleteValue got write lock");let i;try{i=(await this._store.load(e)).metadata,i.delete(r),await this._store.patch(e,{metadata:i})}catch(s){if(s.code!==Dr.ERR_NOT_FOUND)throw s}finally{Je("deleteValue release write lock"),n()}i&&this._emit(Yu,{peerId:e,metadata:i})}};kx.exports=Lx});var Kx=b((AV,Fx)=>{"use strict";var Ux=Oe(),Co=ge(),{codes:Wr}=Ye(),qh=qt(),ht=Object.assign(Ux("libp2p:peer-store:proto-book"),{error:Ux("libp2p:peer-store:proto-book:err")}),Qu="change:protocols",Mx=class{constructor(e,r){this._emit=e,this._store=r}async get(e){ht("get wait for read lock");let r=await this._store.lock.readLock();ht("get got read lock");try{return(await this._store.load(e)).protocols}catch(n){if(n.code!==Wr.ERR_NOT_FOUND)throw n}finally{ht("get release read lock"),r()}return[]}async set(e,r){if(!qh.isPeerId(e))throw ht.error("peerId must be an instance of peer-id to store data"),Co(new Error("peerId must be an instance of peer-id"),Wr.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw ht.error("protocols must be provided to store data"),Co(new Error("protocols must be provided"),Wr.ERR_INVALID_PARAMETERS);ht("set await write lock");let n=await this._store.lock.writeLock();ht("set got write lock");let i;try{try{let s=await this._store.load(e);if(new Set([...r]).size===s.protocols.length)return}catch(s){if(s.code!==Wr.ERR_NOT_FOUND)throw s}i=await this._store.patchOrCreate(e,{protocols:r}),ht(`stored provided protocols for ${e.toB58String()}`)}finally{ht("set release write lock"),n()}this._emit(Qu,{peerId:e,protocols:i.protocols})}async add(e,r){if(!qh.isPeerId(e))throw ht.error("peerId must be an instance of peer-id to store data"),Co(new Error("peerId must be an instance of peer-id"),Wr.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw ht.error("protocols must be provided to store data"),Co(new Error("protocols must be provided"),Wr.ERR_INVALID_PARAMETERS);ht("add await write lock");let n=await this._store.lock.writeLock();ht("add got write lock");let i;try{try{let s=await this._store.load(e);if(new Set([...s.protocols,...r]).size===s.protocols.length)return}catch(s){if(s.code!==Wr.ERR_NOT_FOUND)throw s}i=await this._store.mergeOrCreate(e,{protocols:r}),ht(`added provided protocols for ${e.toB58String()}`)}finally{ht("add release write lock"),n()}this._emit(Qu,{peerId:e,protocols:i.protocols})}async remove(e,r){if(!qh.isPeerId(e))throw ht.error("peerId must be an instance of peer-id to store data"),Co(new Error("peerId must be an instance of peer-id"),Wr.ERR_INVALID_PARAMETERS);if(!Array.isArray(r))throw ht.error("protocols must be provided to store data"),Co(new Error("protocols must be provided"),Wr.ERR_INVALID_PARAMETERS);ht("remove await write lock");let n=await this._store.lock.writeLock();ht("remove got write lock");let i;try{try{let s=await this._store.load(e),o=new Set(s.protocols);for(let a of r)o.delete(a);if(s.protocols.length===o.size)return;r=Array.from(o)}catch(s){if(s.code!==Wr.ERR_NOT_FOUND)throw s}i=await this._store.patchOrCreate(e,{protocols:r})}finally{ht("remove release write lock"),n()}this._emit(Qu,{peerId:e,protocols:i.protocols})}async delete(e){ht("delete await write lock");let r=await this._store.lock.writeLock();ht("delete got write lock");let n;try{n=await this._store.has(e),await this._store.patchOrCreate(e,{protocols:[]})}catch(i){if(i.code!==Wr.ERR_NOT_FOUND)throw i}finally{ht("delete release write lock"),r()}n&&this._emit(Qu,{peerId:e,protocols:[]})}};Fx.exports=Mx});var jx=b((CV,Vx)=>{"use strict";var wi=Sn(),Io=wi.Reader,Uh=wi.Writer,He=wi.util,Et=wi.roots["libp2p-peer"]||(wi.roots["libp2p-peer"]={});Et.Peer=function(){function t(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.addresses=He.emptyArray,t.prototype.protocols=He.emptyArray,t.prototype.metadata=He.emptyArray,t.prototype.pubKey=null,t.prototype.peerRecordEnvelope=null;var e;return Object.defineProperty(t.prototype,"_pubKey",{get:He.oneOfGetter(e=["pubKey"]),set:He.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_peerRecordEnvelope",{get:He.oneOfGetter(e=["peerRecordEnvelope"]),set:He.oneOfSetter(e)}),t.encode=function(n,i){if(i||(i=Uh.create()),n.addresses!=null&&n.addresses.length)for(var s=0;s<n.addresses.length;++s)Et.Address.encode(n.addresses[s],i.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var s=0;s<n.protocols.length;++s)i.uint32(18).string(n.protocols[s]);if(n.metadata!=null&&n.metadata.length)for(var s=0;s<n.metadata.length;++s)Et.Metadata.encode(n.metadata[s],i.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&i.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&i.uint32(42).bytes(n.peerRecordEnvelope),i},t.decode=function(n,i){n instanceof Io||(n=Io.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Et.Peer;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(Et.Address.decode(n,n.uint32()));break;case 2:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(n.string());break;case 3:o.metadata&&o.metadata.length||(o.metadata=[]),o.metadata.push(Et.Metadata.decode(n,n.uint32()));break;case 4:o.pubKey=n.bytes();break;case 5:o.peerRecordEnvelope=n.bytes();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof Et.Peer)return n;var i=new Et.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");i.addresses=[];for(var s=0;s<n.addresses.length;++s){if(typeof n.addresses[s]!="object")throw TypeError(".Peer.addresses: object expected");i.addresses[s]=Et.Address.fromObject(n.addresses[s])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");i.protocols=[];for(var s=0;s<n.protocols.length;++s)i.protocols[s]=String(n.protocols[s])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");i.metadata=[];for(var s=0;s<n.metadata.length;++s){if(typeof n.metadata[s]!="object")throw TypeError(".Peer.metadata: object expected");i.metadata[s]=Et.Metadata.fromObject(n.metadata[s])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?He.base64.decode(n.pubKey,i.pubKey=He.newBuffer(He.base64.length(n.pubKey)),0):n.pubKey.length&&(i.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?He.base64.decode(n.peerRecordEnvelope,i.peerRecordEnvelope=He.newBuffer(He.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(i.peerRecordEnvelope=n.peerRecordEnvelope)),i},t.toObject=function(n,i){i||(i={});var s={};if((i.arrays||i.defaults)&&(s.addresses=[],s.protocols=[],s.metadata=[]),n.addresses&&n.addresses.length){s.addresses=[];for(var o=0;o<n.addresses.length;++o)s.addresses[o]=Et.Address.toObject(n.addresses[o],i)}if(n.protocols&&n.protocols.length){s.protocols=[];for(var o=0;o<n.protocols.length;++o)s.protocols[o]=n.protocols[o]}if(n.metadata&&n.metadata.length){s.metadata=[];for(var o=0;o<n.metadata.length;++o)s.metadata[o]=Et.Metadata.toObject(n.metadata[o],i)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(s.pubKey=i.bytes===String?He.base64.encode(n.pubKey,0,n.pubKey.length):i.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,i.oneofs&&(s._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(s.peerRecordEnvelope=i.bytes===String?He.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):i.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,i.oneofs&&(s._peerRecordEnvelope="peerRecordEnvelope")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,wi.util.toJSONOptions)},t}();Et.Address=function(){function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.multiaddr=He.newBuffer([]),t.prototype.isCertified=null;var e;return Object.defineProperty(t.prototype,"_isCertified",{get:He.oneOfGetter(e=["isCertified"]),set:He.oneOfSetter(e)}),t.encode=function(n,i){return i||(i=Uh.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},t.decode=function(n,i){n instanceof Io||(n=Io.create(n));for(var s=i===void 0?n.len:n.pos+i,o=new Et.Address;n.pos<s;){var a=n.uint32();switch(a>>>3){case 1:o.multiaddr=n.bytes();break;case 2:o.isCertified=n.bool();break;default:n.skipType(a&7);break}}return o},t.fromObject=function(n){if(n instanceof Et.Address)return n;var i=new Et.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?He.base64.decode(n.multiaddr,i.multiaddr=He.newBuffer(He.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},t.toObject=function(n,i){i||(i={});var s={};return i.defaults&&(i.bytes===String?s.multiaddr="":(s.multiaddr=[],i.bytes!==Array&&(s.multiaddr=He.newBuffer(s.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(s.multiaddr=i.bytes===String?He.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(s.isCertified=n.isCertified,i.oneofs&&(s._isCertified="isCertified")),s},t.prototype.toJSON=function(){return this.constructor.toObject(this,wi.util.toJSONOptions)},t}();Et.Metadata=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.key="",t.prototype.value=He.newBuffer([]),t.encode=function(r,n){return n||(n=Uh.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&n.uint32(10).string(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&n.uint32(18).bytes(r.value),n},t.decode=function(r,n){r instanceof Io||(r=Io.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new Et.Metadata;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.key=r.string();break;case 2:s.value=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof Et.Metadata)return r;var n=new Et.Metadata;return r.key!=null&&(n.key=String(r.key)),r.value!=null&&(typeof r.value=="string"?He.base64.decode(r.value,n.value=He.newBuffer(He.base64.length(r.value)),0):r.value.length&&(n.value=r.value)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.key="",n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=He.newBuffer(i.value)))),r.key!=null&&r.hasOwnProperty("key")&&(i.key=r.key),r.value!=null&&r.hasOwnProperty("value")&&(i.value=n.bytes===String?He.base64.encode(r.value,0,r.value.length):n.bytes===Array?Array.prototype.slice.call(r.value):r.value),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,wi.util.toJSONOptions)},t}();Vx.exports=Et});var Mh=b((IV,$x)=>{$x.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var Hx=b(()=>{});var tA=b((BV,eA)=>{var mk=rr().EventEmitter,{nanoid:vk}=(ru(),id),{WORKER_REQUEST_READ_LOCK:zx,WORKER_RELEASE_READ_LOCK:Gx,MASTER_GRANT_READ_LOCK:Wx,WORKER_REQUEST_WRITE_LOCK:Yx,WORKER_RELEASE_WRITE_LOCK:Qx,MASTER_GRANT_WRITE_LOCK:Xx}=Mh(),Ka,Zx=(t,e,r,n,i)=>(s,o)=>{o&&o.type===r&&t.emit(e,o.name,()=>(s.send({type:i,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===n&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},Jx=(t,e,r,n)=>()=>{let i=vk();return process.send({type:e,identifier:i,name:t}),new Promise(s=>{let o=a=>{a&&a.type===r&&a.identifier===i&&(process.removeListener("message",o),s(()=>{process.send({type:n,identifier:i,name:t})}))};process.on("message",o)})};eA.exports=t=>{try{if(Ka=Hx(),!Object.keys(Ka).length)return}catch(e){return}if(Ka.isMaster||t.singleProcess){let e=new mk;return Ka.on("message",Zx(e,"requestReadLock",zx,Gx,Wx)),Ka.on("message",Zx(e,"requestWriteLock",Yx,Qx,Xx)),e}return{isWorker:!0,readLock:e=>Jx(e,zx,Wx,Gx),writeLock:e=>Jx(e,Yx,Xx,Qx)}}});var Fh=b((PV,rA)=>{var _i={},To=t=>{t.addEventListener("message",e=>{To.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{To.dispatchEvent("message",t,e)})};To.addEventListener=(t,e)=>{_i[t]||(_i[t]=[]),_i[t].push(e)};To.removeEventListener=(t,e)=>{!_i[t]||(_i[t]=_i[t].filter(r=>r===e))};To.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!_i[e]||_i[e].forEach(r=>r.apply(null,t))};rA.exports=To});var hA=b((NV,dA)=>{var Ek=rr().EventEmitter,{nanoid:bk}=(ru(),id),{WORKER_REQUEST_READ_LOCK:nA,WORKER_RELEASE_READ_LOCK:iA,MASTER_GRANT_READ_LOCK:sA,WORKER_REQUEST_WRITE_LOCK:oA,WORKER_RELEASE_WRITE_LOCK:aA,MASTER_GRANT_WRITE_LOCK:cA}=Mh(),uA=Fh(),lA=(t,e,r,n,i)=>(s,o)=>{if(!o||!o.data||o.data.type!==r)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};t.emit(e,a.name,()=>(s.postMessage({type:i,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let f={type:l.data.type,name:l.data.name,identifier:l.data.identifier};f&&f.type===n&&f.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},fA=(t,e,r,n)=>()=>{let i=bk();return globalThis.postMessage({type:e,identifier:i,name:t}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===r&&c.identifier===i&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:n,identifier:i,name:t})}))};globalThis.addEventListener("message",o)})},wk={singleProcess:!1};dA.exports=t=>{if(t=Object.assign({},wk,t),!!globalThis.document||t.singleProcess){let r=new Ek;return uA.addEventListener("message",lA(r,"requestReadLock",nA,iA,sA)),uA.addEventListener("message",lA(r,"requestWriteLock",oA,aA,cA)),r}return{isWorker:!0,readLock:r=>fA(r,nA,sA,iA),writeLock:r=>fA(r,oA,cA,aA)}}});var yA=b((OV,Kh)=>{"use strict";var _k=Object.prototype.hasOwnProperty,Zt="~";function Va(){}Object.create&&(Va.prototype=Object.create(null),new Va().__proto__||(Zt=!1));function Sk(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function pA(t,e,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new Sk(r,n||t,i),o=Zt?Zt+e:e;return t._events[o]?t._events[o].fn?t._events[o]=[t._events[o],s]:t._events[o].push(s):(t._events[o]=s,t._eventsCount++),t}function Xu(t,e){--t._eventsCount==0?t._events=new Va:delete t._events[e]}function zt(){this._events=new Va,this._eventsCount=0}zt.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)_k.call(r,n)&&e.push(Zt?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};zt.prototype.listeners=function(e){var r=Zt?Zt+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o};zt.prototype.listenerCount=function(e){var r=Zt?Zt+e:e,n=this._events[r];return n?n.fn?1:n.length:0};zt.prototype.emit=function(e,r,n,i,s,o){var a=Zt?Zt+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,f;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,i),!0;case 5:return c.fn.call(c.context,r,n,i,s),!0;case 6:return c.fn.call(c.context,r,n,i,s,o),!0}for(f=1,l=new Array(u-1);f<u;f++)l[f-1]=arguments[f];c.fn.apply(c.context,l)}else{var d=c.length,p;for(f=0;f<d;f++)switch(c[f].once&&this.removeListener(e,c[f].fn,void 0,!0),u){case 1:c[f].fn.call(c[f].context);break;case 2:c[f].fn.call(c[f].context,r);break;case 3:c[f].fn.call(c[f].context,r,n);break;case 4:c[f].fn.call(c[f].context,r,n,i);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[f].fn.apply(c[f].context,l)}}return!0};zt.prototype.on=function(e,r,n){return pA(this,e,r,n,!1)};zt.prototype.once=function(e,r,n){return pA(this,e,r,n,!0)};zt.prototype.removeListener=function(e,r,n,i){var s=Zt?Zt+e:e;if(!this._events[s])return this;if(!r)return Xu(this,s),this;var o=this._events[s];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&Xu(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==r||i&&!o[a].once||n&&o[a].context!==n)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:Xu(this,s)}return this};zt.prototype.removeAllListeners=function(e){var r;return e?(r=Zt?Zt+e:e,this._events[r]&&Xu(this,r)):(this._events=new Va,this._eventsCount=0),this};zt.prototype.off=zt.prototype.removeListener;zt.prototype.addListener=zt.prototype.on;zt.prefixed=Zt;zt.EventEmitter=zt;typeof Kh!="undefined"&&(Kh.exports=zt)});var mA=b((DV,gA)=>{"use strict";gA.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})))});var EA=b((LV,Zu)=>{"use strict";var xk=mA(),Vh=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},vA=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(t);return}let s=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(c){i(c)}return}let o=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,a=r instanceof Error?r:new Vh(o);typeof t.cancel=="function"&&t.cancel(),i(a)},e);xk(t.then(n,i),()=>{clearTimeout(s)})});Zu.exports=vA;Zu.exports.default=vA;Zu.exports.TimeoutError=Vh});var bA=b(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});function Ak(t,e,r){let n=0,i=t.length;for(;i>0;){let s=i/2|0,o=n+s;r(t[o],e)<=0?(n=++o,i-=s+1):i=s}return n}jh.default=Ak});var _A=b($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});var Ck=bA(),wA=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let n={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(n);return}let i=Ck.default(this._queue,n,(s,o)=>o.priority-s.priority);this._queue.splice(i,0,n)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};$h.default=wA});var AA=b(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});var Ik=yA(),SA=EA(),Tk=_A(),Ju=()=>{},Rk=new SA.TimeoutError,xA=class extends Ik{constructor(e){var r,n,i,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Ju,this._resolveIdle=Ju,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Tk.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Ju,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Ju,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((n,i)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&r.timeout===void 0?e():SA.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&i(Rk)});n(await o)}catch(o){i(o)}this._next()};this._queue.enqueue(s,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};Hh.default=xA});var CA=b((FV,zh)=>{"use strict";var el,MV=zh.exports.timeout=function(t,e){var r=new el,n;return Promise.race([t,new Promise(function(i,s){n=setTimeout(function(){s(r)},e)})]).then(function(i){return clearTimeout(n),i},function(i){throw clearTimeout(n),i})};el=zh.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};el.prototype=Object.create(Error.prototype);el.prototype.name="TimeoutError"});var TA=b((KV,Wh)=>{var Bk=tA(),Pk=hA(),{default:IA}=AA(),{timeout:Nk}=CA(),Ok=Fh(),ls={},Si;function Gh(t,e){let r,n=new Promise(i=>{r=i});return t.add(()=>Nk((()=>new Promise(i=>{r(()=>{i()})}))(),e.timeout)),n}var Dk=(t,e)=>{if(Si.isWorker)return{readLock:Si.readLock(t,e),writeLock:Si.writeLock(t,e)};let r=new IA({concurrency:1}),n=null;return{readLock:()=>{if(n)return Gh(n,e);n=new IA({concurrency:e.concurrency,autoStart:!1});let i=n,s=Gh(n,e);return r.add(()=>(i.start(),i.onIdle().then(()=>{n===i&&(n=null)}))),s},writeLock:()=>(n=null,Gh(r,e))}},Lk={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};Wh.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},Lk,e),Si||(Si=Bk(e)||Pk(e),Si.isWorker||(Si.on("requestReadLock",(r,n)=>{!ls[r]||ls[r].readLock().then(i=>n().finally(()=>i()))}),Si.on("requestWriteLock",async(r,n)=>{!ls[r]||ls[r].writeLock().then(i=>n().finally(()=>i()))}))),ls[t]||(ls[t]=Dk(t,e)),ls[t]);Wh.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(n){n.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return Ok(r),r}});var UA=b((VV,qA)=>{"use strict";var RA=Oe(),BA=qt(),PA=ge(),{codes:tl}=Ye(),{Key:kk}=(iu(),sd),{base32:qk}=(Ii(),Ci),{keys:{unmarshalPublicKey:Uk,marshalPublicKey:Mk}}=Lu(),{Multiaddr:NA}=$t(),{Peer:OA}=jx(),Fk=TA(),{equals:Kk}=(Sr(),_r),DA=Object.assign(RA("libp2p:peer-store:store"),{error:RA("libp2p:peer-store:store:err")}),LA="/peers/",kA=class{constructor(e){this._datastore=e,this.lock=Fk("peer-store",{singleProcess:!0})}_peerIdToDatastoreKey(e){if(!BA.isPeerId(e))throw DA.error("peerId must be an instance of peer-id to store data"),PA(new Error("peerId must be an instance of peer-id"),tl.ERR_INVALID_PARAMETERS);let r=e.toString();return new kk(`${LA}${r}`)}async has(e){return this._datastore.has(this._peerIdToDatastoreKey(e))}async delete(e){await this._datastore.delete(this._peerIdToDatastoreKey(e))}async load(e){let r=await this._datastore.get(this._peerIdToDatastoreKey(e)),n=OA.decode(r),i=n.pubKey?Uk(n.pubKey):e.pubKey,s=new Map;for(let o of n.metadata)s.set(o.key,o.value);return{...n,id:e,pubKey:i,addresses:n.addresses.map(({multiaddr:o,isCertified:a})=>({multiaddr:new NA(o),isCertified:a||!1})),metadata:s,peerRecordEnvelope:n.peerRecordEnvelope||void 0}}async save(e){if(e.pubKey!=null&&e.id.pubKey!=null&&!Kk(e.pubKey.bytes,e.id.pubKey.bytes))throw DA.error("peer publicKey bytes do not match peer id publicKey bytes"),PA(new Error("publicKey bytes do not match peer id publicKey bytes"),tl.ERR_INVALID_PARAMETERS);let r=new Set,n=OA.encode({addresses:e.addresses.filter(i=>r.has(i.multiaddr.toString())?!1:(r.add(i.multiaddr.toString()),!0)).sort((i,s)=>i.multiaddr.toString().localeCompare(s.multiaddr.toString())).map(({multiaddr:i,isCertified:s})=>({multiaddr:i.bytes,isCertified:s})),protocols:e.protocols.sort(),pubKey:e.pubKey?Mk(e.pubKey):void 0,metadata:[...e.metadata.keys()].sort().map(i=>({key:i,value:e.metadata.get(i)})),peerRecordEnvelope:e.peerRecordEnvelope}).finish();return await this._datastore.put(this._peerIdToDatastoreKey(e.id),n),this.load(e.id)}async patch(e,r){let n=await this.load(e);return await this._patch(e,r,n)}async patchOrCreate(e,r){let n;try{n=await this.load(e)}catch(i){if(i.code!==tl.ERR_NOT_FOUND)throw i;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,r,n)}async _patch(e,r,n){return await this.save({...n,...r,id:e})}async merge(e,r){let n=await this.load(e);return this._merge(e,r,n)}async mergeOrCreate(e,r){let n;try{n=await this.load(e)}catch(i){if(i.code!==tl.ERR_NOT_FOUND)throw i;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,r,n)}async _merge(e,r,n){let i=new Map;return(r.addresses||[]).forEach(s=>{i.set(s.multiaddr.toString(),s.isCertified)}),n.addresses.forEach(({multiaddr:s,isCertified:o})=>{let a=s.toString();i.set(a,Boolean(i.get(a)||o))}),await this.save({id:e,addresses:Array.from(i.entries()).map(([s,o])=>({multiaddr:new NA(s),isCertified:o})),protocols:Array.from(new Set([...n.protocols||[],...r.protocols||[]])),metadata:new Map([...n.metadata?n.metadata.entries():[],...r.metadata?r.metadata.entries():[]]),pubKey:r.pubKey||(n!=null?n.pubKey:void 0),peerRecordEnvelope:r.peerRecordEnvelope||(n!=null?n.peerRecordEnvelope:void 0)})}async*all(){for await(let e of this._datastore.queryKeys({prefix:LA})){let r=e.toString().split("/")[2],n=qk.decode(r);yield this.load(BA.createFromBytes(n))}}};qA.exports=kA});var VA=b((jV,KA)=>{"use strict";var MA=Oe(),{EventEmitter:Vk}=rr(),jk=Tx(),$k=Ox(),Hk=qx(),zk=Kx(),Gk=UA(),Lr=Object.assign(MA("libp2p:peer-store"),{error:MA("libp2p:peer-store:err")}),FA=class extends Vk{constructor({peerId:e,datastore:r,addressFilter:n}){super();this._peerId=e,this._store=new Gk(r),this.addressBook=new jk(this.emit.bind(this),this._store,n),this.keyBook=new $k(this.emit.bind(this),this._store),this.metadataBook=new Hk(this.emit.bind(this),this._store),this.protoBook=new zk(this.emit.bind(this),this._store)}async*getPeers(){Lr("getPeers await read lock");let e=await this._store.lock.readLock();Lr("getPeers got read lock");try{for await(let r of this._store.all())r.id.toB58String()!==this._peerId.toB58String()&&(yield r)}finally{Lr("getPeers release read lock"),e()}}async delete(e){Lr("delete await write lock");let r=await this._store.lock.writeLock();Lr("delete got write lock");try{await this._store.delete(e)}finally{Lr("delete release write lock"),r()}}async get(e){Lr("get await read lock");let r=await this._store.lock.readLock();Lr("get got read lock");try{return this._store.load(e)}finally{Lr("get release read lock"),r()}}async has(e){Lr("has await read lock");let r=await this._store.lock.readLock();Lr("has got read lock");try{return this._store.has(e)}finally{Lr("has release read lock"),r()}}};KA.exports=FA});var $A=b(($V,jA)=>{"use strict";function Wk(t,e,r){let n=new t(e,r);n._subscribeAdapter=n.subscribe,n._unsubscribeAdapter=n.unsubscribe;function i(o,a){a&&n.on(o,a),n._subscribeAdapter(o)}function s(o,a){a?n.removeListener(o,a):n.removeAllListeners(o),n.listenerCount(o)===0&&n._unsubscribeAdapter(o)}return n.subscribe=i,n.unsubscribe=s,n}jA.exports=Wk});var YA=b((HV,WA)=>{"use strict";var HA=()=>{},zA=Symbol.for("@libp2p/js-interfaces/topology"),GA=class{constructor({min:e=0,max:r=1/0,handlers:n={}}){this.min=e,this.max=r,this._onConnect=n.onConnect||HA,this._onDisconnect=n.onDisconnect||HA,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[zA](){return!0}static isTopology(e){return Boolean(e&&e[zA])}async setRegistrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};WA.exports=GA});var JA=b((zV,ZA)=>{"use strict";var QA=Oe(),Yk=Object.assign(QA("libp2p:registrar"),{error:QA("libp2p:registrar:err")}),Qk=ge(),{codes:{ERR_INVALID_PARAMETERS:Xk}}=Ye(),Zk=YA(),XA=class{constructor({peerStore:e,connectionManager:r}){this.peerStore=e,this.connectionManager=r,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}async register(e){if(!Zk.isTopology(e))throw Yk.error("topology must be an instance of interfaces/topology"),Qk(new Error("topology must be an instance of interfaces/topology"),Xk);let r=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(r,e),await e.setRegistrar(this),r}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,r]of this.topologies)r.disconnect(e.remotePeer)}};ZA.exports=XA});var Yh=b((GV,ja)=>{"use strict";var{Buffer:rl}=pi(),nl=rs();ja.exports=async function*(t){for await(let e of t)rl.isBuffer(e)?yield e:nl.isBufferList(e)?yield e.slice():yield rl.from(e)};ja.exports.toBuffer=ja.exports;ja.exports.toList=async function*(t){for await(let e of t)rl.isBuffer(e)?yield new nl().append(e):nl.isBufferList(e)?yield e:yield new nl().append(rl.from(e))}});var rC=b((WV,tC)=>{"use strict";var Ro=Sn(),eC=Ro.Reader,Jk=Ro.Writer,lt=Ro.util,$a=Ro.roots["libp2p-identify"]||(Ro.roots["libp2p-identify"]={});$a.Identify=function(){function t(e){if(this.listenAddrs=[],this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocolVersion="",t.prototype.agentVersion="",t.prototype.publicKey=lt.newBuffer([]),t.prototype.listenAddrs=lt.emptyArray,t.prototype.observedAddr=lt.newBuffer([]),t.prototype.protocols=lt.emptyArray,t.prototype.signedPeerRecord=lt.newBuffer([]),t.encode=function(r,n){if(n||(n=Jk.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.listenAddrs!=null&&r.listenAddrs.length)for(var i=0;i<r.listenAddrs.length;++i)n.uint32(18).bytes(r.listenAddrs[i]);if(r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(26).string(r.protocols[i]);return r.observedAddr!=null&&Object.hasOwnProperty.call(r,"observedAddr")&&n.uint32(34).bytes(r.observedAddr),r.protocolVersion!=null&&Object.hasOwnProperty.call(r,"protocolVersion")&&n.uint32(42).string(r.protocolVersion),r.agentVersion!=null&&Object.hasOwnProperty.call(r,"agentVersion")&&n.uint32(50).string(r.agentVersion),r.signedPeerRecord!=null&&Object.hasOwnProperty.call(r,"signedPeerRecord")&&n.uint32(66).bytes(r.signedPeerRecord),n},t.decode=function(r,n){r instanceof eC||(r=eC.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new $a.Identify;r.pos<i;){var o=r.uint32();switch(o>>>3){case 5:s.protocolVersion=r.string();break;case 6:s.agentVersion=r.string();break;case 1:s.publicKey=r.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(r.bytes());break;case 4:s.observedAddr=r.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(r.string());break;case 8:s.signedPeerRecord=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof $a.Identify)return r;var n=new $a.Identify;if(r.protocolVersion!=null&&(n.protocolVersion=String(r.protocolVersion)),r.agentVersion!=null&&(n.agentVersion=String(r.agentVersion)),r.publicKey!=null&&(typeof r.publicKey=="string"?lt.base64.decode(r.publicKey,n.publicKey=lt.newBuffer(lt.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.listenAddrs){if(!Array.isArray(r.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");n.listenAddrs=[];for(var i=0;i<r.listenAddrs.length;++i)typeof r.listenAddrs[i]=="string"?lt.base64.decode(r.listenAddrs[i],n.listenAddrs[i]=lt.newBuffer(lt.base64.length(r.listenAddrs[i])),0):r.listenAddrs[i].length&&(n.listenAddrs[i]=r.listenAddrs[i])}if(r.observedAddr!=null&&(typeof r.observedAddr=="string"?lt.base64.decode(r.observedAddr,n.observedAddr=lt.newBuffer(lt.base64.length(r.observedAddr)),0):r.observedAddr.length&&(n.observedAddr=r.observedAddr)),r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Identify.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return r.signedPeerRecord!=null&&(typeof r.signedPeerRecord=="string"?lt.base64.decode(r.signedPeerRecord,n.signedPeerRecord=lt.newBuffer(lt.base64.length(r.signedPeerRecord)),0):r.signedPeerRecord.length&&(n.signedPeerRecord=r.signedPeerRecord)),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.listenAddrs=[],i.protocols=[]),n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=lt.newBuffer(i.publicKey))),n.bytes===String?i.observedAddr="":(i.observedAddr=[],n.bytes!==Array&&(i.observedAddr=lt.newBuffer(i.observedAddr))),i.protocolVersion="",i.agentVersion="",n.bytes===String?i.signedPeerRecord="":(i.signedPeerRecord=[],n.bytes!==Array&&(i.signedPeerRecord=lt.newBuffer(i.signedPeerRecord)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?lt.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.listenAddrs&&r.listenAddrs.length){i.listenAddrs=[];for(var s=0;s<r.listenAddrs.length;++s)i.listenAddrs[s]=n.bytes===String?lt.base64.encode(r.listenAddrs[s],0,r.listenAddrs[s].length):n.bytes===Array?Array.prototype.slice.call(r.listenAddrs[s]):r.listenAddrs[s]}if(r.protocols&&r.protocols.length){i.protocols=[];for(var s=0;s<r.protocols.length;++s)i.protocols[s]=r.protocols[s]}return r.observedAddr!=null&&r.hasOwnProperty("observedAddr")&&(i.observedAddr=n.bytes===String?lt.base64.encode(r.observedAddr,0,r.observedAddr.length):n.bytes===Array?Array.prototype.slice.call(r.observedAddr):r.observedAddr),r.protocolVersion!=null&&r.hasOwnProperty("protocolVersion")&&(i.protocolVersion=r.protocolVersion),r.agentVersion!=null&&r.hasOwnProperty("agentVersion")&&(i.agentVersion=r.agentVersion),r.signedPeerRecord!=null&&r.hasOwnProperty("signedPeerRecord")&&(i.signedPeerRecord=n.bytes===String?lt.base64.encode(r.signedPeerRecord,0,r.signedPeerRecord.length):n.bytes===Array?Array.prototype.slice.call(r.signedPeerRecord):r.signedPeerRecord),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ro.util.toJSONOptions)},t}();tC.exports=$a});var fC=b((YV,lC)=>{"use strict";var nC=Oe(),mr=Object.assign(nC("libp2p:identify"),{error:nC("libp2p:identify:err")}),Qh=ge(),il=uo(),{pipe:sl}=fr(),{collect:iC,take:sC,consume:oC}=Fu(),{fromString:Bo}=(Dt(),Ft),e5=qt(),{Multiaddr:Xh}=$t(),{toBuffer:aC}=Yh(),Ha=rC(),cC=mu(),uC=Eu(),{MULTICODEC_IDENTIFY:t5,MULTICODEC_IDENTIFY_PUSH:r5,IDENTIFY_PROTOCOL_VERSION:n5,MULTICODEC_IDENTIFY_PROTOCOL_NAME:i5,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:s5,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:o5,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:a5}=wd(),{codes:Zh}=Ye(),fs=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${i5}/${o5}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${s5}/${a5}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let r=fs.getProtocolStr(e);this.identifyProtocolStr=r.identifyProtocolStr,this.identifyPushProtocolStr=r.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${n5}`,...e._options.host},this.connectionManager.on("peer:connect",n=>{this.identify(n).catch(mr.error)}),this.peerStore.on("change:multiaddrs",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(i=>mr.error(i))}),this.peerStore.on("change:protocols",({peerId:n})=>{n.toString()===this.peerId.toString()&&this.pushToPeerStore().catch(i=>mr.error(i))})}async start(){await this.peerStore.metadataBook.setValue(this.peerId,"AgentVersion",Bo(this._host.agentVersion)),await this.peerStore.metadataBook.setValue(this.peerId,"ProtocolVersion",Bo(this._host.protocolVersion))}async stop(){}async push(e){let r=await this.peerStore.addressBook.getRawEnvelope(this.peerId),n=this._libp2p.multiaddrs.map(o=>o.bytes),i=await this.peerStore.protoBook.get(this.peerId),s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await sl([Ha.Identify.encode({listenAddrs:n,signedPeerRecord:r,protocols:i}).finish()],il.encode(),a,oC)}catch(a){mr.error("could not push identify update to peer",a)}});return Promise.all(s)}async pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],r;for await(let n of this.peerStore.getPeers())n.protocols.includes(this.identifyPushProtocolStr)&&(r=this.connectionManager.get(n.id))&&e.push(r);await this.push(e)}async identify(e){let{stream:r}=await e.newStream(this.identifyProtocolStr),[n]=await sl([],r,il.decode(),sC(1),aC,iC);if(!n)throw Qh(new Error("No data could be retrieved"),Zh.ERR_CONNECTION_ENDED);let i;try{i=Ha.Identify.decode(n)}catch(d){throw Qh(d,Zh.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=i,l=await e5.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw Qh(new Error("identified peer does not match the expected peer"),Zh.ERR_INVALID_PEER);let f=fs.getCleanMultiaddr(c);try{let d=await cC.openAndCertify(u,uC.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(d)){await this.peerStore.protoBook.set(l,a),await this.peerStore.metadataBook.setValue(l,"AgentVersion",Bo(i.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",Bo(i.protocolVersion));return}}catch(d){mr("received invalid envelope, discard it and fallback to listenAddrs is available",d)}try{await this.peerStore.addressBook.set(l,o.map(d=>new Xh(d)))}catch(d){mr.error("received invalid addrs",d)}await this.peerStore.protoBook.set(l,a),await this.peerStore.metadataBook.setValue(l,"AgentVersion",Bo(i.agentVersion)),await this.peerStore.metadataBook.setValue(l,"ProtocolVersion",Bo(i.protocolVersion)),mr("received observed address of %s",f)}handleMessage({connection:e,stream:r,protocol:n}){switch(n){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:r});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:r});default:mr.error("cannot handle unknown protocol %s",n)}}async _handleIdentify({connection:e,stream:r}){try{let n=new Uint8Array(0);this.peerId.pubKey&&(n=this.peerId.pubKey.bytes);let i=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=await this.peerStore.protoBook.get(this.peerId),o=Ha.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:n,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:i,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();await sl([o],il.encode(),r,oC)}catch(n){mr.error("could not respond to identify request",n)}}async _handlePush({connection:e,stream:r}){let n;try{let[s]=await sl([],r,il.decode(),sC(1),aC,iC);n=Ha.Identify.decode(s)}catch(s){return mr.error("received invalid message",s)}let i=e.remotePeer;try{let s=await cC.openAndCertify(n.signedPeerRecord,uC.DOMAIN);if(await this.peerStore.addressBook.consumePeerRecord(s)){await this.peerStore.protoBook.set(i,n.protocols);return}}catch(s){mr("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{await this.peerStore.addressBook.set(i,n.listenAddrs.map(s=>new Xh(s)))}catch(s){mr.error("received invalid addrs",s)}try{await this.peerStore.protoBook.set(i,n.protocols)}catch(s){mr.error("received invalid protocols",s)}}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new Xh(e)}catch(r){return null}return null}},c5={IDENTIFY:t5,IDENTIFY_PUSH:r5};fs.multicodecs=c5;fs.Messsage=Ha;lC.exports=fs});var pC=b((QV,hC)=>{"use strict";var ds=Sn(),ol=ds.Reader,dC=ds.Writer,Po=ds.util,bn=ds.roots["libp2p-fetch"]||(ds.roots["libp2p-fetch"]={});bn.FetchRequest=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.identifier="",t.encode=function(r,n){return n||(n=dC.create()),r.identifier!=null&&Object.hasOwnProperty.call(r,"identifier")&&n.uint32(10).string(r.identifier),n},t.decode=function(r,n){r instanceof ol||(r=ol.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new bn.FetchRequest;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.identifier=r.string();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof bn.FetchRequest)return r;var n=new bn.FetchRequest;return r.identifier!=null&&(n.identifier=String(r.identifier)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.identifier=""),r.identifier!=null&&r.hasOwnProperty("identifier")&&(i.identifier=r.identifier),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ds.util.toJSONOptions)},t}();bn.FetchResponse=function(){function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.status=0,t.prototype.data=Po.newBuffer([]),t.encode=function(r,n){return n||(n=dC.create()),r.status!=null&&Object.hasOwnProperty.call(r,"status")&&n.uint32(8).int32(r.status),r.data!=null&&Object.hasOwnProperty.call(r,"data")&&n.uint32(18).bytes(r.data),n},t.decode=function(r,n){r instanceof ol||(r=ol.create(r));for(var i=n===void 0?r.len:r.pos+n,s=new bn.FetchResponse;r.pos<i;){var o=r.uint32();switch(o>>>3){case 1:s.status=r.int32();break;case 2:s.data=r.bytes();break;default:r.skipType(o&7);break}}return s},t.fromObject=function(r){if(r instanceof bn.FetchResponse)return r;var n=new bn.FetchResponse;switch(r.status){case"OK":case 0:n.status=0;break;case"NOT_FOUND":case 1:n.status=1;break;case"ERROR":case 2:n.status=2;break}return r.data!=null&&(typeof r.data=="string"?Po.base64.decode(r.data,n.data=Po.newBuffer(Po.base64.length(r.data)),0):r.data.length&&(n.data=r.data)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.status=n.enums===String?"OK":0,n.bytes===String?i.data="":(i.data=[],n.bytes!==Array&&(i.data=Po.newBuffer(i.data)))),r.status!=null&&r.hasOwnProperty("status")&&(i.status=n.enums===String?bn.FetchResponse.StatusCode[r.status]:r.status),r.data!=null&&r.hasOwnProperty("data")&&(i.data=n.bytes===String?Po.base64.encode(r.data,0,r.data.length):n.bytes===Array?Array.prototype.slice.call(r.data):r.data),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,ds.util.toJSONOptions)},t.StatusCode=function(){var e={},r=Object.create(e);return r[e[0]="OK"]=0,r[e[1]="NOT_FOUND"]=1,r[e[2]="ERROR"]=2,r}(),t}();hC.exports=bn});var gC=b((XV,yC)=>{"use strict";yC.exports={PROTOCOL:"/libp2p/fetch/0.0.1"}});var wC=b((EC,bC)=>{"use strict";var mC=Oe(),u5=Object.assign(mC("libp2p:fetch"),{error:mC("libp2p:fetch:err")}),Jh=ge(),{codes:e0}=Ye(),al=uo(),{FetchRequest:t0,FetchResponse:Yr}=pC(),vC=lo(),{PROTOCOL:l5}=gC(),za=class{constructor(e){this._lookupFunctions=new Map,this._libp2p=e,this.handleMessage=this.handleMessage.bind(this)}async fetch(e,r){u5("dialing %s to %s",this._protocol,e.toB58String?e.toB58String():e);let n=await this._libp2p.dial(e),{stream:i}=await n.newStream(za.PROTOCOL),s=vC(i),o=new t0({identifier:r});s.write(al.encode.single(t0.encode(o).finish()));let a=Yr.decode((await al.decode.fromReader(s.reader).next()).value.slice());switch(a.status){case Yr.StatusCode.OK:return a.data;case Yr.StatusCode.NOT_FOUND:return null;case Yr.StatusCode.ERROR:{let c=new TextDecoder().decode(a.data);throw Jh(new Error("Error in fetch protocol response: "+c),e0.ERR_INVALID_PARAMETERS)}default:throw Jh(new Error("Unknown response status"),e0.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:r}=e,n=vC(r),i=t0.decode((await al.decode.fromReader(n.reader).next()).value.slice()),s,o=this._getLookupFunction(i.identifier);if(o){let a=await o(i.identifier);a?s=new Yr({status:Yr.StatusCode.OK,data:a}):s=new Yr({status:Yr.StatusCode.NOT_FOUND})}else{let a=new TextEncoder().encode("No lookup function registered for key: "+i.identifier);s=new Yr({status:Yr.StatusCode.ERROR,data:a})}n.write(al.encode.single(Yr.encode(s).finish()))}_getLookupFunction(e){for(let r of this._lookupFunctions.keys())if(e.startsWith(r))return this._lookupFunctions.get(r);return null}registerLookupFunction(e,r){if(this._lookupFunctions.has(e))throw Jh(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),e0.ERR_KEY_ALREADY_EXISTS);this._lookupFunctions.set(e,r)}unregisterLookupFunction(e,r){r!=null&&this._lookupFunctions.get(e)!==r||this._lookupFunctions.delete(e)}};za.PROTOCOL=l5;EC=bC.exports=za});var SC=b((ZV,_C)=>{"use strict";_C.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var BC=b((JV,RC)=>{"use strict";var xC=Oe(),f5=Object.assign(xC("libp2p:ping"),{error:xC("libp2p:ping:err")}),d5=ge(),{codes:h5}=Ye(),p5=Lu(),{pipe:AC}=fr(),{toBuffer:y5}=Yh(),{collect:g5,take:m5}=Fu(),{equals:v5}=(Sr(),_r),{PROTOCOL_NAME:CC,PING_LENGTH:E5,PROTOCOL_VERSION:IC}=SC(),TC=class{static getProtocolStr(e){return`/${e._config.protocolPrefix}/${CC}/${IC}`}constructor(e){this._libp2p=e}handleMessage({stream:e}){return AC(e,e)}async ping(e){let r=`/${this._libp2p._config.protocolPrefix}/${CC}/${IC}`;f5("dialing %s to %s",r,e.toB58String?e.toB58String():e);let n=await this._libp2p.dial(e),{stream:i}=await n.newStream(r),s=Date.now(),o=p5.randomBytes(E5),[a]=await AC([o],i,u=>m5(1,u),y5,g5),c=Date.now();if(!v5(o,a))throw d5(new Error("Received wrong ping ack"),h5.ERR_WRONG_PING_ACK);return c-s}};RC.exports=TC});var PC=b(()=>{});var NC=b(r0=>{"use strict";Object.defineProperty(r0,"__esModule",{value:!0}),r0.promisify=cl;var b5="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function cl(t){if(typeof t!="function")throw new TypeError("Argument to promisify must be a function");var e=t[b5],r=cl.Promise||Promise;if(typeof r!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var n=this,i=arguments.length,s=Array(i),o=0;o<i;o++)s[o]=arguments[o];return new r(function(a,c){s.push(function(u){if(u)return c(u);for(var l=arguments.length,f=Array(1<l?l-1:0),d=1;d<l;d++)f[d-1]=arguments[d];if(f.length===1||!e)return a(f[0]);var p={};f.forEach(function(h,g){var v=e[g];v&&(p[v]=h)}),a(p)}),t.apply(n,s)})}}cl.argumentNames="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__",cl.Promise=void 0});var DC=b((n9,OC)=>{function w5(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}OC.exports=w5});var kC=b((i9,LC)=>{"use strict";var _5=DC(),ul=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,Ga=_5(),S5=ul&&!Ga,x5=Ga&&!ul,A5=Ga&&ul,C5=typeof d0=="function"&&typeof globalThis.process!="undefined"&&typeof globalThis.process.release!="undefined"&&globalThis.process.release.name==="node"&&!Ga,I5=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,T5=typeof globalThis.process!="undefined"&&typeof globalThis.process.env!="undefined"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",R5=typeof navigator!="undefined"&&navigator.product==="ReactNative";LC.exports={isTest:T5,isElectron:Ga,isElectronMain:x5,isElectronRenderer:A5,isNode:C5,isBrowser:S5,isWebWorker:I5,isEnvWithDom:ul,isReactNative:R5}});var UC=b((s9,qC)=>{function kr(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}qC.exports=kr;kr.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};kr.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};kr.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0};kr.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};kr.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};kr.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};kr.prototype.start=kr.prototype.try;kr.prototype.errors=function(){return this._errors};kr.prototype.attempts=function(){return this._attempts};kr.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],s=i.message,o=(t[s]||0)+1;t[s]=o,o>=r&&(e=i,r=o)}return e}});var MC=b(hs=>{var B5=UC();hs.operation=function(t){var e=hs.timeouts(t);return new B5(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};hs.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<e.retries;i++)n.push(this.createTimeout(i,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(i,e)),n.sort(function(s,o){return s-o}),n};hs.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return n=Math.min(n,e.maxTimeout),n};hs.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var n in t)typeof t[n]=="function"&&r.push(n)}for(var i=0;i<r.length;i++){var s=r[i],o=t[s];t[s]=function(c){var u=hs.operation(e),l=Array.prototype.slice.call(arguments,1),f=l.pop();l.push(function(d){u.retry(d)||(d&&(arguments[0]=u.mainError()),f.apply(this,arguments))}),u.attempt(function(){c.apply(t,l)})}.bind(t,o),t[s].options=e}}});var KC=b((a9,FC)=>{FC.exports=MC()});var jC=b((c9,ll)=>{"use strict";var P5=KC(),N5=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],n0=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},O5=(t,e,r)=>{let n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},D5=t=>N5.includes(t),VC=(t,e)=>new Promise((r,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};let i=P5.operation(e);i.attempt(async s=>{try{r(await t(s))}catch(o){if(!(o instanceof Error)){n(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof n0)i.stop(),n(o.originalError);else if(o instanceof TypeError&&!D5(o.message))i.stop(),n(o);else{O5(o,s,e);try{await e.onFailedAttempt(o)}catch(a){n(a);return}i.retry(o)||n(i.mainError())}}})});ll.exports=VC;ll.exports.default=VC;ll.exports.AbortError=n0});var HC=b((u9,$C)=>{"use strict";function L5(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}$C.exports=L5});var GC=b((l9,zC)=>{"use strict";var k5=HC();function q5(t){let{address:e}=t.nodeAddress();return k5(e)}zC.exports=q5});var JC=b((f9,ZC)=>{"use strict";var U5=PC(),WC=Oe(),{promisify:i0}=NC(),{Multiaddr:M5}=$t(),No=Object.assign(WC("libp2p:nat"),{error:WC("libp2p:nat:err")}),{isBrowser:YC}=kC(),s0=jC(),F5=_d(),QC=bd(),K5=ge(),{codes:{ERR_INVALID_PARAMETERS:V5}}=Ye(),j5=GC(),o0=7200;function $5(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var XC=class{constructor({peerId:e,addressManager:r,transportManager:n,...i}){if(this._peerId=e,this._addressManager=r,this._transportManager=n,this._enabled=i.enabled,this._externalIp=i.externalIp,this._options={description:i.description||`${QC.name}@${QC.version} ${this._peerId}`,ttl:i.ttl||o0,autoUpdate:i.keepAlive||!0,gateway:i.gateway,enablePMP:Boolean(i.pmp&&i.pmp.enabled)},this._options.ttl<o0)throw K5(new Error(`NatManager ttl should be at least ${o0} seconds`),V5)}start(){YC||!this._enabled||this._start().catch(e=>{No.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let r of e){let{family:n,host:i,port:s,transport:o}=r.toOptions();if(!r.isThinWaistAddress()||o!=="tcp"||j5(r)||n!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(F5(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=$5();No(`opening uPnP connection from ${c}:${u} to ${i}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(M5.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new U5(this._options),r=i0(e.map.bind(e)),n=i0(e.destroy.bind(e)),i=i0(e.externalIp.bind(e));return this._client={map:(...s)=>s0(()=>r(...s),{onFailedAttempt:No.error,unref:!0}),destroy:(...s)=>s0(()=>n(...s),{onFailedAttempt:No.error,unref:!0}),externalIp:(...s)=>s0(()=>i(...s),{onFailedAttempt:No.error,unref:!0})},this._client}async stop(){if(!(YC||!this._client))try{await this._client.destroy(),this._client=null}catch(e){No.error(e)}}};ZC.exports=XC});var dq=b((d9,iI)=>{"use strict";var eI=Oe(),Gt=Object.assign(eI("libp2p"),{error:eI("libp2p:err")}),{EventEmitter:H5}=rr(),a0=ge(),z5=qt(),{Multiaddr:G5}=$t(),{MemoryDatastore:W5}=(v1(),m1),Y5=W1(),Q5=eE(),c0=md(),{validate:X5}=mb(),{codes:fl,messages:Z5}=Ye(),J5=bb(),eq=qb(),tq=$b(),tI=B2(),rq=V2(),nq=w_(),rI=bS(),iq=qS(),sq=Pd(),oq=Ex(),aq=VA(),cq=$A(),uq=JA(),nI=fC(),u0=wC(),l0=BC(),lq=JC(),{updateSelfPeerRecord:fq}=Rd(),Wa=class extends H5{static async create(e){if(e.peerId)return new Wa(e);let r=await z5.create();return e.peerId=r,new Wa(e)}constructor(e){super();if(this._options=X5(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this._options.metrics.enabled){let n=new iq({...this._options.metrics});this.metrics=n}if(this.connectionGater={denyDialPeer:async()=>Promise.resolve(!1),denyDialMultiaddr:async()=>Promise.resolve(!1),denyInboundConnection:async()=>Promise.resolve(!1),denyOutboundConnection:async()=>Promise.resolve(!1),denyInboundEncryptedConnection:async()=>Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>Promise.resolve(!1),denyInboundUpgradedConnection:async()=>Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>Promise.resolve(!1),filterMultiaddrForPeer:async()=>Promise.resolve(!0),...this._options.connectionGater},this.peerStore=new aq({peerId:this.peerId,datastore:this.datastore&&this._options.peerStore.persistence?this.datastore:new W5,addressFilter:this.connectionGater.filterMultiaddrForPeer}),this.addresses=this._options.addresses,this.addressManager=new J5(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{fq(this).catch(n=>{Gt.error("Error updating self peer record",n)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new eq(this,{...this._options.connectionManager}),this._autodialler=new tq(this,{enabled:this._config.peerDiscovery.autoDial,minConnections:this._options.connectionManager.minConnections,autoDialInterval:this._options.connectionManager.autoDialInterval}),this._options.keychain&&this._options.keychain.datastore){Gt("creating keychain");let n=rI.generateOptions();this.keychain=new rI(this._options.keychain.datastore,{...n,...this._options.keychain}),Gt("keychain constructed")}if(this.upgrader=new oq({connectionGater:this.connectionGater,localPeer:this.peerId,metrics:this.metrics,onConnection:n=>this.connectionManager.onConnect(n),onConnectionEnd:n=>this.connectionManager.onDisconnect(n)}),this.transportManager=new sq({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new lq({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new uq({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw a0(new Error(Z5.CONN_ENCRYPTION_REQUIRED),fl.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(n=>{this.upgrader.cryptos.set(n.protocol,n)}),this.dialer=new nq({transportManager:this.transportManager,connectionGater:this.connectionGater,peerStore:this.peerStore,metrics:this.metrics,...this._options.dialer}),this._modules.transport.forEach(n=>{let i=n.prototype[Symbol.toStringTag],s=this._config.transport[i];this.transportManager.add(i,n,s)}),this._config.relay.enabled&&(this.transportManager.add(tI.prototype[Symbol.toStringTag],tI),this.relay=new rq(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(i=>{this.upgrader.muxers.set(i.multicodec,i)}),this.identifyService=new nI({libp2p:this})),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let n=this._modules.dht;this._dht=n.create({libp2p:this,...this._config.dht})}if(this._modules.pubsub){let n=this._modules.pubsub;this.pubsub=cq(n,this,this._config.pubsub)}this.peerRouting=new Y5(this),this.contentRouting=new Q5(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this),this.fetchService=new u0(this),this.pingService=new l0(this)}emit(e,...r){return e==="error"&&!this._events.error?(Gt.error(r),!1):super.emit(e,...r)}async start(){Gt("libp2p is starting"),this.identifyService&&await this.handle(Object.values(nI.getProtocolStr(this)),this.identifyService.handleMessage),this.fetchService&&await this.handle(u0.PROTOCOL,this.fetchService.handleMessage),this.pingService&&await this.handle(l0.getProtocolStr(this),this.pingService.handleMessage);try{await this._onStarting(),await this._onDidStart(),Gt("libp2p has started")}catch(e){throw this.emit("error",e),Gt.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Gt("libp2p is stopping");try{this._isStarted=!1,this.identifyService&&await this.identifyService.stop(),this.relay&&this.relay.stop(),this.peerRouting.stop(),await this._autodialler.stop(),await(this._dht&&this._dht.stop());for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),await this.unhandle(u0.PROTOCOL),await this.unhandle(l0.getProtocolStr(this)),this.dialer.destroy()}catch(e){e&&(Gt.error(e),this.emit("error",e))}Gt("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,r){return this._dial(e,r)}async dialProtocol(e,r,n){if(!r||!r.length)throw a0(new Error("no protocols were provided to open a stream"),fl.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,n)).newStream(r)}async _dial(e,r){let{id:n,multiaddrs:i}=c0(e);if(n.equals(this.peerId))throw a0(new Error("Cannot dial self"),fl.ERR_DIALED_SELF);let s=this.connectionManager.get(n);return s?i&&await this.peerStore.addressBook.add(n,i):s=await this.dialer.connectToPeer(e,r),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(i=>i.toString());e.length||(e=this.transportManager.getAddrs().map(i=>i.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(i=>i.toString()));let r=this._options.addresses.announceFilter,n=new Set(e);return r(Array.from(n).map(i=>new G5(i)))}async hangUp(e){let{id:r}=c0(e),n=this.connectionManager.connections.get(r.toB58String());!n||await Promise.all(n.map(i=>i.close()))}fetch(e,r){return this.fetchService.fetch(e,r)}ping(e){let{id:r,multiaddrs:n}=c0(e);return n?this.pingService.ping(n[0]):this.pingService.ping(r)}async handle(e,r){e=Array.isArray(e)?e:[e],e.forEach(n=>{this.upgrader.protocols.set(n,r)}),await this.peerStore.protoBook.add(this.peerId,e)}async unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(r=>{this.upgrader.protocols.delete(r)}),await this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),this._config.pubsub.enabled&&this.pubsub&&await this.pubsub.start(),this._config.dht.enabled&&(this._dht&&await this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start(),this.identifyService&&await this.identifyService.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e).catch(r=>{Gt.error(r)})});for await(let e of this.peerStore.getPeers())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._autodialler.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Gt.error(new Error(fl.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs).catch(r=>Gt.error(r)),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols).catch(r=>Gt.error(r))}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Gt("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(n){Gt.error(`could not connect to discovered peer ${e.toB58String()} with ${n}`)}}}async _setupPeerDiscovery(){let e=r=>{let n={enabled:!0};if(r.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[r.tag]&&(n={...n,...this._config.peerDiscovery[r.tag]}),n.enabled&&!this._discovery.has(r.tag)){let i;typeof r=="function"?i=new r(Object.assign({},n,{peerId:this.peerId,libp2p:this})):i=r,i.on("peer",this._onDiscoveryPeer),this._discovery.set(r.tag,i)}};for(let r of this._modules.peerDiscovery||[])e(r);for(let r of this.transportManager.getTransports())r.discovery&&e(r.discovery);await Promise.all(Array.from(this._discovery.values(),r=>r.start()))}};iI.exports=Wa});return dq();})();
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return Libp2p}));
