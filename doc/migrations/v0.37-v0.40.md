# Migrating to libp2p@40 <!-- omit in toc -->

A migration guide for refactoring your application code from libp2p v0.37.x to v0.40.0.

## Table of Contents <!-- omit in toc -->

- [Modules](#modules)

## Modules

Modules in the libp2p ecosystem no longer export constructors. This is because internally libp2p has switched to using constructor dependency injection so needs to control the lifecycle of the various components.

These modules now export factory functions that take the same arguments as the older constructors so migration should be relatively straightforward.

The most affected place will be where you configure your libp2p node:

**Before**

```js
import { createLibp2p } from 'libp2p'
import { TCP } from '@libp2p/tcp'
import { Noise } from '@chainsafe/libp2p-noise'

const createNode = async () => {
  const node = await createLibp2p({
    addresses: {
      listen: [
        '/ip4/0.0.0.0/tcp/0'
      ]
    },
    transports: [
      new TCP()
    ],
    connectionEncryption: [
      new Noise()
    ]
  })

  await node.start()
  return node
}

const node = await createNode()
await node.start()
// ...
```

**After**

```js
import { createLibp2p } from 'libp2p'
import { tcp } from '@libp2p/tcp'
import { noise } from '@chainsafe/libp2p-noise'

const createNode = async () => {
  const node = await createLibp2p({
    addresses: {
      listen: [
        '/ip4/0.0.0.0/tcp/0'
      ]
    },
    transports: [
      tcp()
    ],
    connectionEncryption: [
      noise()
    ]
  })

  await node.start()
  return node
}

const node = await createNode()
await node.start()
```
